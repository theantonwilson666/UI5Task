/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
        (c) Copyright 2009-2020 SAP SE. All rights reserved
    
 */
sap.ui.define(["sap/base/Log","sap/ui/model/odata/v4/AnnotationHelper","sap/fe/core/CommonUtils","sap/m/library","sap/base/strings/formatMessage","sap/fe/macros/CommonHelper","sap/fe/core/helpers/StableIdHelper","sap/fe/core/helpers/ModelHelper"],function(L,O,C,l,f,a,S,M){"use strict";var B=l.ButtonType;var A={getTargetContext:function(t){var T=t.getObject(t.getPath()),n=O.getNavigationPath(t.getPath());return n+"/"+T;},getNavigationContext:function(c){return O.getNavigationPath(c.getPath());},getNavigationInsertableRestrictions:function(c,s,r,I,b){var i,n,p="";for(i in r){n=r[i];if(n.NavigationProperty.$NavigationPropertyPath===s&&n.InsertRestrictions){if(n.InsertRestrictions.Insertable&&n.InsertRestrictions.Insertable.$Path){if(b){p=c.$Partner+"/";}return("{= ${"+p+n.InsertRestrictions.Insertable.$Path+"}  && ${ui>/editMode} === 'Editable' }");}return n.InsertRestrictions.Insertable?"{= ${ui>/editMode} === 'Editable' }":false;}}if(I&&I.$Path&&I.$Path.indexOf("/")>-1){var d=I.$Path.split("/");var N=d[0];var P=c.$Partner;if(N!==P){return"{= ${ui>/editMode} === 'Editable'}";}if(b){s="";}else{s=s+"/";}return"{=  ${ui>/editMode} === 'Editable' && ${"+s+I.$Path+"}}";}return"{= "+(I!==false)+" && ${ui>/editMode} === 'Editable'}";},showFooter:function(d,c){var h="";var s;var H=[];for(var i in d){var D=d[i];if(D.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"&&D.Determining===true){if(!D["@com.sap.vocabularies.UI.v1.Hidden"]){return true;}else if(D["@com.sap.vocabularies.UI.v1.Hidden"].$Path){if(H.indexOf(D["@com.sap.vocabularies.UI.v1.Hidden"].$Path)===-1){H.push(D["@com.sap.vocabularies.UI.v1.Hidden"].$Path);}}}}if(H.length){for(var b in H){if(H[b]){s="(%{"+H[b]+"} === true ? false : true )";}if(b==H.length-1){h=h+s;}else{h=h+s+"||";}}return("{= "+h+(c?" || ${ui>/editMode} === 'Editable' ":" ")+"|| ${internal>showMessageFooter} === true}");}else{return("{= "+(c?"${ui>/editMode} === 'Editable' || ":"")+"${internal>showMessageFooter} === true}");}},getActionContext:function(o){return C.getActionPath(o,true);},getPathToBoundActionOverload:function(o){var p=C.getActionPath(o,true);return p+"/@$ui5.overload/0";},buildButtonTypeExpressionForCriticality:function(d){var F=B.Default;var e;var c=d.Criticality;if(c){e="'{'= ({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Negative'') || ({0} === ''1'') || ({0} === 1) ? ''"+B.Reject+"'' : "+"({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Positive'') || ({0} === ''3'') || ({0} === 3) ? ''"+B.Accept+"'' : "+"''"+B.Default+"'' '}'";if(c.$Path){var s="${"+c.$Path+"}";F=f(e,s);}else if(c.$EnumMember){var b="'"+c.$EnumMember+"'";F=f(e,b);}}return F;},buildEmphasizedButtonExpression:function(i){if(!i){return B.Emphasized;}var F;var I,h,H="";i.forEach(function(d){var c=d.Criticality;var D=d["@com.sap.vocabularies.UI.v1.Hidden"];if(d.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"&&!I&&c){if(!F&&D===true){F=B.Emphasized;return;}if(D&&D.$Path){h=D.$Path;if(H){H=H+" && ";}H=H+"%{"+h+"} === true";F="{= ("+H+") ? 'Emphasized' : 'Default' }";}switch(c.$EnumMember){case"com.sap.vocabularies.UI.v1.CriticalityType/Negative":case"com.sap.vocabularies.UI.v1.CriticalityType/Positive":case"1":case 1:case"3":case 3:if(!D){F=B.Default;I=true;}F=F||B.Default;break;default:F=B.Emphasized;}if(c.$Path){var s=H?"!("+H+") && ":"";F="{= "+s+"((${"+c.$Path+"} === 'com.sap.vocabularies.UI.v1.CriticalityType/Negative') || (${"+c.$Path+"} === '1') || (${"+c.$Path+"} === 1) "+"|| (${"+c.$Path+"} === 'com.sap.vocabularies.UI.v1.CriticalityType/Positive') || (${"+c.$Path+"} === '3') || (${"+c.$Path+"} === 3)) ? "+"'Default'"+" : "+"'Emphasized'"+" }";}}});return F||B.Emphasized;},isStickySessionSupported:function(c,i){var m;if(arguments.length>1){m=i.context.getModel();}else{m=c;}return M.isStickySessionSupported(m);},isManifestAction:function(o){var b=["Primary","DefaultApply","Secondary","ForAction","ForNavigation"];return b.indexOf(o.type)<0;},getFooterVisible:function(F,d){var c=false;F.forEach(function(b){var i=this.isManifestAction(b);if(i){c=true;}}.bind(this));if(c){return true;}else{return this.showFooter(d,true);}},buildActionWrapper:function(o,t){var p=["$event",a.addSingleQuotes(o.handlerModule),a.addSingleQuotes(o.handlerMethod)];if(t&&t.id){var b={contexts:"${internal>selectedContexts}"};p.push(a.objectToString(b));}return"FPM.actionWrapper("+p.join(", ")+")";},getVariantBackReference:function(v,c){if(v&&v.variantManagement==="Page"){return"fe::PageVariantManagement";}if(v&&v.variantManagement==="Control"){return S.generate([c.filterBarId,"VariantManagement"]);}return undefined;}};return A;},true);
