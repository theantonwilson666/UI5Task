sap.ui.define(["../../templates/BaseConverter","../../ManifestSettings","sap/fe/core/converters/controls/Common/Action","sap/fe/core/converters/annotations/DataField","../../helpers/ID","sap/fe/core/converters/helpers/ConfigurableObject","sap/fe/core/converters/helpers/Key","sap/fe/core/templating/DataModelPathHelper"],function(B,M,A,D,I,C,K,a){"use strict";var _={};var g=a.getTargetObjectPath;var b=K.KeyHelper;var c=C.insertCustomElements;var F=I.FilterBarID;var d=I.ChartID;var e=D.isDataFieldForActionAbstract;var f=A.getActionsFromManifest;var h=M.ActionType;var V=M.VisualizationType;var T=B.TemplateType;function j(n,i){return q(n)||p(n,i)||l(n,i)||k();}function k(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function l(o,i){if(!o)return;if(typeof o==="string")return m(o,i);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(n);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(o,i);}function m(n,o){if(o==null||o>n.length)o=n.length;for(var i=0,v=new Array(o);i<o;i++){v[i]=n[i];}return v;}function p(n,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(n)))return;var o=[];var v=true;var w=false;var x=undefined;try{for(var y=n[Symbol.iterator](),z;!(v=(z=y.next()).done);v=true){o.push(z.value);if(i&&o.length===i)break;}}catch(E){w=true;x=E;}finally{try{if(!v&&y["return"]!=null)y["return"]();}finally{if(w)throw x;}}return o;}function q(i){if(Array.isArray(i))return i;}function r(i,v,n){var o=[];if(i){var w=i.Actions||[];w.forEach(function(x){var y,z,E;var G;if(e(x)&&!(((y=x.annotations)===null||y===void 0?void 0:(z=y.UI)===null||z===void 0?void 0:(E=z.Hidden)===null||E===void 0?void 0:E.valueOf())===true)&&!x.Inline&&!x.Determining){var H=b.generateKeyFromDataField(x);switch(x.$Type){case"com.sap.vocabularies.UI.v1.DataFieldForAction":G={type:h.DataFieldForAction,annotationPath:n.getEntitySetBasedAnnotationPath(x.fullyQualifiedName),key:H};break;case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":G={type:h.DataFieldForIntentBasedNavigation,annotationPath:n.getEntitySetBasedAnnotationPath(x.fullyQualifiedName),key:H};break;}}if(G){o.push(G);}});}return o;}function s(i,v,n){var o=r(i,v,n);return c(o,f(n.getManifestControlConfiguration(v).actions,n,o),{enableOnSelect:"overwrite",enabled:"overwrite"});}_.getChartActions=s;function t(v,i){var n;var o=i.getManifestWrapper();var w=i.getManifestControlConfiguration(v);var x=["Page","Control"].indexOf(o.getVariantManagement())>-1;var y=true;var P=[];if((w===null||w===void 0?void 0:(n=w.chartSettings)===null||n===void 0?void 0:n.personalization)!==undefined){y=w.chartSettings.personalization;}if(x&&y){if(y===true){return"Sort,Type,Item";}else if(typeof y==="object"){if(y.type){P.push("Type");}if(y.item){P.push("Item");}if(y.sort){P.push("Sort");}return P.join(",");}}return undefined;}_.getP13nMode=t;function u(i,v,n){var o,w,x;var y=s(i,v,n);var z=v.split("@"),E=j(z,1),G=E[0];if(G.lastIndexOf("/")===G.length-1){G=G.substr(0,G.length-1);}var H=(o=n.getDataModelObjectPath().targetEntityType.annotations)===null||o===void 0?void 0:(w=o.UI)===null||w===void 0?void 0:(x=w.HeaderInfo)===null||x===void 0?void 0:x.TypeNamePlural;var J=n.getDataModelObjectPath();var L=G.length===0;var N=J.targetEntitySet?J.targetEntitySet.name:J.startingEntitySet.name;var O=L?F(N):undefined;var P={"legendGroup":{"layout":{"position":"bottom"}}};return{type:V.Chart,id:d(L?N:G,V.Chart),collection:g(n.getDataModelObjectPath()),entityName:N,p13nMode:t(v,n),navigationPath:G,annotationPath:n.getAbsoluteAnnotationPath(v),filterId:O,vizProperties:JSON.stringify(P),actions:y,title:H,autoBindOnInit:n.getTemplateType()===T.ObjectPage};}_.createChartVisualization=u;return _;},false);
