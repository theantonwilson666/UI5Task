sap.ui.define(["../../templates/BaseConverter","./Table","./Chart","sap/fe/core/converters/helpers/IssueManager"],function(B,T,C,I){"use strict";var _={};var a=I.IssueCategory;var b=I.IssueSeverity;var c=I.IssueType;var d=C.createChartVisualization;var e=T.createTableVisualization;var f=T.createDefaultTableVisualization;var g=B.TemplateType;var h=function(r,v,s){var t=[];var u=r.Visualizations||[];var w=v.split("@")[0];if(u){var x=false;var y=false;var z=false;u.forEach(function(A){switch(A.$target.term){case"com.sap.vocabularies.UI.v1.LineItem":if(!x){if(!(s.getTemplateType()===g.ObjectPage&&z)){t.push({visualization:A.$target,annotationPath:"".concat(w).concat(A.value),converterContext:s});x=true;z=true;}}break;case"com.sap.vocabularies.UI.v1.Chart":if(!y&&(s.getTemplateType()===g.AnalyticalListPage&&!s.getManifestWrapper().getViewConfiguration()||s.getTemplateType()===g.ObjectPage&&!z)){t.push({visualization:A.$target,annotationPath:"".concat(w).concat(A.value),converterContext:s});y=true;z=true;}break;default:break;}});}return t;};function i(r,s,t){if(s){var u=t.getEntityTypeAnnotation(s);var v=u.annotation;if(v){if(v.term==="com.sap.vocabularies.UI.v1.SelectionPresentationVariant"){return v;}}else{throw new Error("Annotation Path for the SPV mentioned in the manifest is not found, Please add the SPV in the annotation");}}else{var w,x;return(w=r.annotations)===null||w===void 0?void 0:(x=w.UI)===null||x===void 0?void 0:x.SelectionPresentationVariant;}}_.getSelectionPresentationVariant=i;function j(S,r){var s=S&&S.PresentationVariant;if(s){return k(s,r);}}_.isSelectionPresentationCompliant=j;function k(r,s){var H=false,t=false;if(s){if(r&&r.Visualizations){var v=r.Visualizations;v.map(function(V){if(V.$target.term==="com.sap.vocabularies.UI.v1.LineItem"){H=true;}if(V.$target.term==="com.sap.vocabularies.UI.v1.Chart"){t=true;}});}return t&&H;}else{return r&&r.Visualizations&&!!r.Visualizations.find(function(u){return u.$target.term==="com.sap.vocabularies.UI.v1.LineItem";});}}_.isPresentationCompliant=k;function l(r){var s;return(s=r.annotations.UI)===null||s===void 0?void 0:s.LineItem;}_.getDefaultLineItem=l;function m(r){var s;return(s=r.annotations.UI)===null||s===void 0?void 0:s.Chart;}_.getDefaultChart=m;function n(r){var s,t;return(s=r.annotations)===null||s===void 0?void 0:(t=s.UI)===null||t===void 0?void 0:t.PresentationVariant;}_.getDefaultPresentationVariant=n;function o(r){var s,t;return(s=r.annotations)===null||s===void 0?void 0:(t=s.UI)===null||t===void 0?void 0:t.SelectionVariant;}_.getDefaultSelectionVariant=o;function p(r,s){var t=s.getManifestWrapper().getDefaultTemplateAnnotationPath();var u=i(r,t,s);var v;if(u){var w=u.SelectionVariant;if(w){return w;}}else{v=o(r);return v;}}_.getSelectionVariant=p;function q(v,r,s){var t=s.getEntityTypeAnnotation(v);var u=t.annotation;s=t.converterContext;var w=[];var x;var y="";var z,A;var D=u===null||u===void 0?void 0:u.term;if(D){switch(D){case"com.sap.vocabularies.UI.v1.LineItem":case"com.sap.vocabularies.UI.v1.Chart":w.push({visualization:u,annotationPath:v,converterContext:s});break;case"com.sap.vocabularies.UI.v1.PresentationVariant":x=u;w=w.concat(h(u,v,s));break;case"com.sap.vocabularies.UI.v1.SelectionPresentationVariant":x=u.PresentationVariant;y=x.fullyQualifiedName;if(!k(x)){var E=s.getEntityType();var F=l(E);if(F){w.push({visualization:F,annotationPath:s.getRelativeAnnotationPath(F.fullyQualifiedName,E),converterContext:s});}}else{w=w.concat(h(x,v,s));}break;default:break;}w.map(function(G){var u=G.visualization,H=G.annotationPath,s=G.converterContext;switch(u.term){case"com.sap.vocabularies.UI.v1.Chart":z=d(u,H,s);break;case"com.sap.vocabularies.UI.v1.LineItem":default:A=e(u,H,s,x,r);break;}});}else{A=f(s);s.getDiagnostics().addIssue(a.Annotation,b.Medium,c.MISSING_LINEITEM);}var V=[];var P=D==="com.sap.vocabularies.UI.v1.SelectionPresentationVariant"?y:u&&u.fullyQualifiedName;if(P===undefined){P="/";}if(z){V.push(z);}if(A){V.push(A);}return{visualizations:V,annotationPath:s.getEntitySetBasedAnnotationPath(P)};}_.getDataVisualizationConfiguration=q;return _;},false);
