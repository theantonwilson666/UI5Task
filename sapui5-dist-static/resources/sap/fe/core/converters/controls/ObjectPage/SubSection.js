sap.ui.define(["../../ManifestSettings","../../helpers/ID","../Common/Form","../Common/DataVisualization","../../helpers/ConfigurableObject","sap/fe/core/converters/controls/Common/Action","sap/fe/core/converters/helpers/Key","sap/fe/core/helpers/BindingExpression","sap/fe/core/converters/helpers/IssueManager","sap/fe/core/converters/controls/ObjectPage/HeaderFacet","../../objectPage/FormMenuActions"],function(M,I,F,D,C,A,K,B,a,H,b){"use strict";var _={};var g=b.getFormActions;var c=b.getFormHiddenActions;var d=b.getVisibilityEnablementFormMenuActions;var e=H.getDesignTimeMetadata;var f=a.IssueCategory;var h=a.IssueSeverity;var j=a.IssueType;var r=B.ref;var k=B.not;var l=B.fn;var m=B.equal;var p=B.compileBinding;var q=B.bindingExpression;var s=B.annotationExpression;var t=K.KeyHelper;var u=A.removeDuplicateActions;var v=A.getSemanticObjectMapping;var w=A.ButtonType;var x=A.isActionNavigable;var y=A.getEnabledBinding;var z=A.getActionsFromManifest;var P=C.Placement;var E=C.insertCustomElements;var G=D.getDataVisualizationConfiguration;var J=F.isReferenceFacet;var L=F.createFormDefinition;var S=I.SideContentID;var N=I.SubSectionID;var O=I.FormID;var Q=I.CustomSubSectionID;var R=M.ActionType;function T(n,i){return W(n)||V(n,i)||b1(n,i)||U();}function U(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function V(n,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(n)))return;var o=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=n[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){o.push(_s.value);if(i&&o.length===i)break;}}catch(v1){_d=true;_e=v1;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return o;}function W(i){if(Array.isArray(i))return i;}function X(o,i){var n=Object.keys(o);if(Object.getOwnPropertySymbols){var v1=Object.getOwnPropertySymbols(o);if(i)v1=v1.filter(function(w1){return Object.getOwnPropertyDescriptor(o,w1).enumerable;});n.push.apply(n,v1);}return n;}function Y(n){for(var i=1;i<arguments.length;i++){var o=arguments[i]!=null?arguments[i]:{};if(i%2){X(Object(o),true).forEach(function(v1){Z(n,v1,o[v1]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(n,Object.getOwnPropertyDescriptors(o));}else{X(Object(o)).forEach(function(v1){Object.defineProperty(n,v1,Object.getOwnPropertyDescriptor(o,v1));});}}return n;}function Z(o,i,n){if(i in o){Object.defineProperty(o,i,{value:n,enumerable:true,configurable:true,writable:true});}else{o[i]=n;}return o;}function $(i){return d1(i)||c1(i)||b1(i)||a1();}function a1(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function b1(o,i){if(!o)return;if(typeof o==="string")return e1(o,i);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(n);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e1(o,i);}function c1(i){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(i))return Array.from(i);}function d1(i){if(Array.isArray(i))return e1(i);}function e1(n,o){if(o==null||o>n.length)o=n.length;for(var i=0,v1=new Array(o);i<o;i++){v1[i]=n[i];}return v1;}var f1;(function(f1){f1["Unknown"]="Unknown";f1["Form"]="Form";f1["DataVisualization"]="DataVisualization";f1["XMLFragment"]="XMLFragment";f1["Placeholder"]="Placeholder";f1["Mixed"]="Mixed";})(f1||(f1={}));_.SubSectionType=f1;var g1=["com.sap.vocabularies.UI.v1.LineItem","com.sap.vocabularies.UI.v1.PresentationVariant","com.sap.vocabularies.UI.v1.SelectionPresentationVariant"];var h1=function(){var i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];return i.some(function(n){var o,v1;return g1.indexOf(n===null||n===void 0?void 0:(o=n.Target)===null||o===void 0?void 0:(v1=o.$target)===null||v1===void 0?void 0:v1.term)>-1;});};function i1(i,n){var o=i.reduce(function(o,v1){switch(v1.$Type){case"com.sap.vocabularies.UI.v1.ReferenceFacet":o.push(v1);break;case"com.sap.vocabularies.UI.v1.CollectionFacet":if(v1.Facets.find(function(w1){return w1.$Type==="com.sap.vocabularies.UI.v1.CollectionFacet";})){o.splice.apply(o,[o.length,0].concat($(v1.Facets)));}else{o.push(v1);}break;case"com.sap.vocabularies.UI.v1.ReferenceURLFacet":break;}return o;},[]);return o.map(function(v1){var w1,x1;return n1(v1,o,n,0,!((w1=v1)===null||w1===void 0?void 0:(x1=w1.Facets)===null||x1===void 0?void 0:x1.length));});}_.createSubSections=i1;var j1=function(i,n){var o,v1;return((o=i.ID)===null||o===void 0?void 0:o.toString())||((v1=i.Label)===null||v1===void 0?void 0:v1.toString())||n;};function k1(i,n,o){var v1=c(n,o)||[],w1=g(n,o),x1=E(i,z(w1,o,i,undefined,undefined,v1));return x1?d(u(x1)):i;}function l1(i,n){var o=new Array();switch(i.$Type){case"com.sap.vocabularies.UI.v1.CollectionFacet":o=i.Facets.filter(function(i){return J(i);}).reduce(function(o,i){return p1(o,i,n);},[]);break;case"com.sap.vocabularies.UI.v1.ReferenceFacet":o=p1([],i,n);break;}return k1(o,i,n);}function m1(i){var n=i===null||i===void 0?void 0:i.path;if(n){return"{= "+"!${"+n+"} ? '"+w.Transparent+"' : ${"+n+"}"+"}";}else if(i){return w.Ghost;}return w.Transparent;}function n1(n,o,v1,w1,x1){var y1,z1,A1,B1,C1;var D1=N({Facet:n});var E1={id:D1,key:j1(n,D1),title:p(s(n.Label)),type:f1.Unknown,annotationPath:v1.getEntitySetBasedAnnotationPath(n.fullyQualifiedName),visible:p(k(m(s((y1=n.annotations)===null||y1===void 0?void 0:(z1=y1.UI)===null||z1===void 0?void 0:z1.Hidden),true))),flexSettings:{designtime:e(n,n,v1)},level:w1,sideContent:undefined};var F1=[];var G1=[];var H1=[];var I1="";w1++;switch(n.$Type){case"com.sap.vocabularies.UI.v1.CollectionFacet":var J1=n.Facets;if(h1(J1)){for(var i=0;i<J1.length;i++){var K1,L1;if(g1.indexOf((K1=J1[i].Target)===null||K1===void 0?void 0:(L1=K1.$target)===null||L1===void 0?void 0:L1.term)>-1){G1.push(n1(J1[i],[],v1,w1,J1.length===1));H1.push(i);}}for(var _i=H1.length-1;_i>=0;_i--){J1.splice(H1[_i],1);}if(J1.length){n.Facets=J1;F1.push(n1(n,[],v1,w1,x1));}F1=F1.concat(G1);var N1=Y({},E1,{type:f1.Mixed,level:w1,content:F1});return N1;}else{var O1=Y({},E1,{type:f1.Form,formDefinition:L(n,v1),level:w1,actions:l1(n,v1)});return O1;}case"com.sap.vocabularies.UI.v1.ReferenceFacet":if(!n.Target.$target){I1="Unable to find annotationPath ".concat(n.Target.value);}else{switch(n.Target.$target.term){case"com.sap.vocabularies.UI.v1.LineItem":case"com.sap.vocabularies.UI.v1.Chart":case"com.sap.vocabularies.UI.v1.PresentationVariant":case"com.sap.vocabularies.UI.v1.SelectionPresentationVariant":var P1=G(n.Target.value,t1(n,o,v1),v1);var Q1=(A1=P1.visualizations[0])===null||A1===void 0?void 0:(B1=A1.annotation)===null||B1===void 0?void 0:B1.title;Q1?Q1:Q1=(C1=P1.visualizations[0])===null||C1===void 0?void 0:C1.title;var R1=Y({},E1,{type:f1.DataVisualization,level:w1,presentation:P1,showTitle:o1(x1,E1.title,Q1)});return R1;case"com.sap.vocabularies.UI.v1.FieldGroup":case"com.sap.vocabularies.UI.v1.Identification":case"com.sap.vocabularies.UI.v1.DataPoint":case"com.sap.vocabularies.UI.v1.StatusInfo":case"com.sap.vocabularies.Communication.v1.Contact":var S1=Y({},E1,{type:f1.Form,level:w1,formDefinition:L(n,v1),actions:l1(n,v1)});return S1;default:I1="For ".concat(n.Target.$target.term," Fragment");break;}}break;case"com.sap.vocabularies.UI.v1.ReferenceURLFacet":I1="For Reference URL Facet";break;default:break;}var T1=Y({},E1,{text:I1});return T1;}_.createSubSection=n1;function o1(i,n,o){if(i&&o===n){return false;}return true;}function p1(i,n,o){var v1=n.Target.$target;var w1=n.Target.value;var x1={};var y1=[];var z1=w1.split("@"),A1=T(z1,1),B1=A1[0];if(B1.length>0){if(B1.lastIndexOf("/")===B1.length-1){B1=B1.substr(0,B1.length-1);}}else{B1=undefined;}if(v1){switch(v1.term){case"com.sap.vocabularies.UI.v1.FieldGroup":y1=v1.Data;x1=z(o.getManifestControlConfiguration(v1).actions,o);break;case"com.sap.vocabularies.UI.v1.Identification":case"com.sap.vocabularies.UI.v1.StatusInfo":if(v1.qualifier){y1=v1;}break;}}return y1.reduce(function(i,C1){var D1,E1,F1,G1,H1,I1,J1,K1,L1,M1,N1,O1;var P1=C1===null||C1===void 0?void 0:(D1=C1.annotations)===null||D1===void 0?void 0:D1.UI;switch(C1.$Type){case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":if(((E1=C1.RequiresContext)===null||E1===void 0?void 0:E1.valueOf())===true){o.getDiagnostics().addIssue(f.Annotation,h.Low,j.MALFORMED_DATAFIELD_FOR_IBN.REQUIRESCONTEXT);}if(((F1=C1.Inline)===null||F1===void 0?void 0:F1.valueOf())===true){o.getDiagnostics().addIssue(f.Annotation,h.Low,j.MALFORMED_DATAFIELD_FOR_IBN.INLINE);}var Q1={};if(C1.Mapping){Q1.semanticObjectMapping=v(C1.Mapping);}i.push({type:R.DataFieldForIntentBasedNavigation,id:O({Facet:n},C1),key:t.generateKeyFromDataField(C1),text:(G1=C1.Label)===null||G1===void 0?void 0:G1.toString(),annotationPath:"",enabled:C1.NavigationAvailable!==undefined?p(m(s((H1=C1.NavigationAvailable)===null||H1===void 0?void 0:H1.valueOf()),true)):true,visible:p(k(m(s((I1=C1.annotations)===null||I1===void 0?void 0:(J1=I1.UI)===null||J1===void 0?void 0:(K1=J1.Hidden)===null||K1===void 0?void 0:K1.valueOf()),true))),buttonType:m1(P1===null||P1===void 0?void 0:P1.Emphasized),press:p(l("._intentBasedNavigation.navigate",[s(C1.SemanticObject),s(C1.Action),Q1])),customData:p({semanticObject:s(C1.SemanticObject),action:s(C1.Action)})});break;case"com.sap.vocabularies.UI.v1.DataFieldForAction":var R1=o.getManifestControlConfiguration(v1).actions;var S1=t.generateKeyFromDataField(C1);i.push({type:R.DataFieldForAction,id:O({Facet:n},C1),key:S1,text:(L1=C1.Label)===null||L1===void 0?void 0:L1.toString(),annotationPath:"",enabled:y(C1.ActionTarget),binding:B1?"{ 'path' : '"+B1+"'}":undefined,visible:p(k(m(s((M1=C1.annotations)===null||M1===void 0?void 0:(N1=M1.UI)===null||N1===void 0?void 0:(O1=N1.Hidden)===null||O1===void 0?void 0:O1.valueOf()),true))),requiresDialog:q1(C1.ActionTarget),buttonType:m1(P1===null||P1===void 0?void 0:P1.Emphasized),press:p(l("invokeAction",[C1.Action,{contexts:l("getBindingContext",[],q("","$source")),invocationGrouping:C1.InvocationGrouping==="UI.OperationGroupingType/ChangeSet"?"ChangeSet":"Isolated",label:s(C1.Label),model:l("getModel",[],q("/","$source")),isNavigable:x(R1&&R1[S1])}],r(".editFlow")))});break;}i=E(i,x1);return i;},i);}function q1(i){if(i){var n,o;var v1=(n=i.annotations)===null||n===void 0?void 0:(o=n.Common)===null||o===void 0?void 0:o.IsActionCritical;if(i.parameters.length>1||v1){return"Dialog";}else{return"None";}}else{return"None";}}_.isDialog=q1;function r1(i,n){var o={};Object.keys(i).forEach(function(v1){return o[v1]=s1(i[v1],v1,n);});return o;}_.createCustomSubSections=r1;function s1(i,n,o){var v1=i.sideContent?{template:i.sideContent.template,id:S(n),visible:false}:undefined;var w1=i.position;if(!w1){w1={placement:P.After};}var x1={type:f1.Unknown,id:i.id||Q(n),actions:z(i.actions,o),key:n,title:i.title,level:1,position:w1,visible:i.visible,sideContent:v1};if(i.template||i.name){x1.type=f1.XMLFragment;x1.template=i.template||i.name||"";}else{x1.type=f1.Placeholder;}return x1;}_.createCustomSubSection=s1;function t1(i,n,o){var v1=o.getManifestWrapper();if(v1.useIconTabBar()){return u1(i,n);}else{var w1,x1,y1,z1,A1,B1;var C1=o.getEntityType();if(((w1=C1.annotations)===null||w1===void 0?void 0:(x1=w1.UI)===null||x1===void 0?void 0:(y1=x1.Facets)===null||y1===void 0?void 0:y1.length)&&((z1=C1.annotations)===null||z1===void 0?void 0:(A1=z1.UI)===null||A1===void 0?void 0:(B1=A1.Facets)===null||B1===void 0?void 0:B1.length)>1){return u1(i,n);}else{return true;}}}function u1(i,n){return n.every(function(o){if(o!==i){if(o.$Type==="com.sap.vocabularies.UI.v1.ReferenceFacet"){var v1,w1,x1,y1,z1;var A1=o;if(((v1=A1.Target)===null||v1===void 0?void 0:(w1=v1.$target)===null||w1===void 0?void 0:w1.term)==="com.sap.vocabularies.UI.v1.LineItem"||((x1=A1.Target)===null||x1===void 0?void 0:(y1=x1.$target)===null||y1===void 0?void 0:y1.term)==="com.sap.vocabularies.UI.v1.PresentationVariant"||((z1=A1.Target.$target)===null||z1===void 0?void 0:z1.term)==="com.sap.vocabularies.UI.v1.SelectionPresentationVariant"){var B1,C1,D1,E1;return((B1=A1.annotations)===null||B1===void 0?void 0:(C1=B1.UI)===null||C1===void 0?void 0:C1.Hidden)!==undefined?(D1=A1.annotations)===null||D1===void 0?void 0:(E1=D1.UI)===null||E1===void 0?void 0:E1.Hidden:false;}return true;}else{var F1=o;return F1.Facets.every(function(G1){var H1,I1,J1,K1,L1,M1;var N1=G1;if(((H1=N1.Target)===null||H1===void 0?void 0:(I1=H1.$target)===null||I1===void 0?void 0:I1.term)==="com.sap.vocabularies.UI.v1.LineItem"||((J1=N1.Target)===null||J1===void 0?void 0:(K1=J1.$target)===null||K1===void 0?void 0:K1.term)==="com.sap.vocabularies.UI.v1.PresentationVariant"||((L1=N1.Target)===null||L1===void 0?void 0:(M1=L1.$target)===null||M1===void 0?void 0:M1.term)==="com.sap.vocabularies.UI.v1.SelectionPresentationVariant"){var O1,P1,Q1,R1;return((O1=N1.annotations)===null||O1===void 0?void 0:(P1=O1.UI)===null||P1===void 0?void 0:P1.Hidden)!==undefined?(Q1=N1.annotations)===null||Q1===void 0?void 0:(R1=Q1.UI)===null||R1===void 0?void 0:R1.Hidden:false;}return true;});}}return true;});}return _;},false);
