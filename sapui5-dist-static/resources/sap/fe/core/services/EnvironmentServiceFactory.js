sap.ui.define(["sap/ui/core/service/ServiceFactory","sap/ui/core/service/Service","../converters/MetaModelConverter","sap/ui/VersionInfo"],function(S,a,M,V){"use strict";var D=M.DefaultEnvironmentCapabilities;function _(i,C){if(!(i instanceof C)){throw new TypeError("Cannot call a class as a function");}}function b(t,p){for(var i=0;i<p.length;i++){var e=p[i];e.enumerable=e.enumerable||false;e.configurable=true;if("value"in e)e.writable=true;Object.defineProperty(t,e.key,e);}}function c(C,p,s){if(p)b(C.prototype,p);if(s)b(C,s);return C;}function d(s,e){if(typeof e!=="function"&&e!==null){throw new TypeError("Super expression must either be null or a function");}s.prototype=Object.create(e&&e.prototype,{constructor:{value:s,writable:true,configurable:true}});if(e)f(s,e);}function f(o,p){f=Object.setPrototypeOf||function f(o,p){o.__proto__=p;return o;};return f(o,p);}function g(e){return function(){var i=l(e),r;if(k()){var N=l(this).constructor;r=Reflect.construct(i,arguments,N);}else{r=i.apply(this,arguments);}return h(this,r);};}function h(s,e){if(e&&(typeof e==="object"||typeof e==="function")){return e;}return j(s);}function j(s){if(s===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return s;}function k(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}function l(o){l=Object.setPrototypeOf?Object.getPrototypeOf:function l(o){return o.__proto__||Object.getPrototypeOf(o);};return l(o);}var E=function(i){d(E,i);var n=g(E);function E(){_(this,E);return n.apply(this,arguments);}c(E,[{key:"init",value:function o(){var e=this;this.initPromise=new Promise(function(r,p){e.resolveFn=r;e.rejectFn=p;});var C=this.getContext();this.environmentCapabilities=Object.assign({},D);V.load().then(function(v){e.environmentCapabilities.Chart=!!v.libraries.find(function(p){return p.name==="sap.viz";});e.environmentCapabilities.MicroChart=!!v.libraries.find(function(p){return p.name==="sap.suite.ui.microchart";});e.environmentCapabilities.UShell=!!(sap&&sap.ushell&&sap.ushell.Container);e.environmentCapabilities.IntentBasedNavigation=!!(sap&&sap.ushell&&sap.ushell.Container);e.environmentCapabilities=Object.assign(e.environmentCapabilities,C.settings);e.resolveFn(e);}).catch(this.rejectFn);}},{key:"resolveLibrary",value:function r(o){return new Promise(function(p){try{sap.ui.getCore().loadLibrary("".concat(o.replace(/\./g,"/")),{async:true}).then(function(){p(true);}).catch(function(){p(false);});}catch(e){p(false);}});}},{key:"setCapabilities",value:function s(C){this.environmentCapabilities=C;}},{key:"getCapabilities",value:function e(){return this.environmentCapabilities;}},{key:"getInterface",value:function e(){return this;}}]);return E;}(a);var m=function(e){d(m,e);var i=g(m);function m(){_(this,m);return i.apply(this,arguments);}c(m,[{key:"createInstance",value:function o(s){var n=new E(s);return n.initPromise;}}]);return m;}(S);return m;},false);
