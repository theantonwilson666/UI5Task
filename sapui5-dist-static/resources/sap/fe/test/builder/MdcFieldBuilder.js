sap.ui.define(["./FEBuilder","sap/ui/test/OpaBuilder","sap/ui/mdc/enum/FieldDisplay","sap/fe/test/Utils","sap/ui/mdc/enum/ConditionValidated"],function(F,O,a,U,C){"use strict";var V=/(.+?) \((.+?)\)/;function _(e,v){e=(e&&[].concat(e))||[];v=(v&&[].concat(v))||[];return e.every(function(f,i){return i<v.length&&(f||"")==(v[i]||"");});}function b(D,e,E,A,v){switch(D){case a.Value:return _(e,A);case a.Description:return E===undefined?_(e,v):_(E,v);case a.ValueDescription:case a.DescriptionValue:return(_(e,A)&&(E===undefined||_(E,v)));default:throw new Error(U.formatMessage("unsupported field display '{0}'",D));}}function c(v,D){var r={};if(U.isOfType(v,Array)){r.value=v.length>0?v[0]:null;r.description=v.length>1?v[1]:undefined;}else if(U.isOfType(v,Object)){r.value=v.value;r.description=v.description;}else{switch(D){case a.Description:r.value=undefined;r.description=v;break;case a.ValueDescription:case a.DescriptionValue:var m=V.exec(v);if(m){r.value=D===a.ValueDescription?m[1]:m[2];r.description=D===a.ValueDescription?m[2]:m[1];break;}case a.Value:default:r.value=v;r.description=undefined;}}return r;}var d=function(){return F.apply(this,arguments);};d.create=function(o){return new d(o);};d.prototype=Object.create(F.prototype);d.prototype.constructor=d;d.prototype.hasValue=function(v){if(v===undefined){return this;}return this.has(d.Matchers.value(v));};d.prototype.hasConditionValues=function(v,o){if(v===undefined){return this;}return this.has(d.Matchers.conditionsValue(v,o));};d.prototype.doChangeValue=function(v){if(v===undefined){return this;}return this.doEnterText(v);};d.prototype.getStatesMatcher=function(s){return d.Matchers.states(s);};d.prototype.doPressKeyboardShortcut=function(s){return this.do(F.Actions.keyboardShortcut(s,"input"));};d.prototype.doOpenValueHelp=function(){return this.doPressKeyboardShortcut("F4");};d.Matchers={value:function(e){return function(f){if(!f.isA("sap.ui.mdc.Field")){throw new Error("Expected sap.ui.mdc.Field but got "+f.getMetadata().getName());}var E=c(e,f.getDisplay()),v=f.getValue(),D=f.getAdditionalValue();return b(f.getDisplay(),E.value,E.description,v,D);};},conditionsValue:function(e,o){if(!U.isOfType(e,Array)){e=[e];}return function(f){var E=e.map(function(v){return c(v,f.getDisplay());}),g=f.getConditions().map(function(i){return{conditionOperator:i.operator,conditionValue:c(i.values),conditionValidated:i.validated===C.Validated};}),h=function(v){return function(i){if(o&&i.conditionOperator!==o){return false;}return b(f.getDisplay(),v.value,v.description,i.conditionValue.value,i.conditionValidated?v.description:i.conditionValue.description);};};return(g&&E.every(function(v){return g.some(h(v));}));};},state:function(n,v){switch(n){case"content":return function(f){var o=f.getContentDisplay(),e=f.getContentEdit(),g=f.getContent(),h=(f.getAggregation("_content")||[]).concat(g||[],o||[],e||[]),m=F.Matchers.states(v);return h.some(m);};case"contentEdit":case"contentDisplay":return function(f){return F.Matchers.states(v)(f.getAggregation(n));};default:return F.Matchers.state(n,v);}},states:function(s){return F.Matchers.states(s,d.Matchers.state);}};d.Actions={};return d;});
