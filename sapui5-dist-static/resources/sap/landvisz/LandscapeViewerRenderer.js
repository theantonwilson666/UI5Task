/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2013 SAP AG. All rights reserved
 */
sap.ui.define(["sap/landvisz/library","sap/landvisz/Connector","sap/landvisz/internal/Connection","sap/landvisz/internal/DeploymentType","sap/landvisz/libs/lvsvg","sap/landvisz/OptionEntity","sap/ui/commons/layout/ResponsiveFlowLayout","sap/ui/commons/layout/ResponsiveFlowLayoutData"],function(a,C,b,D,c,O,R,d){"use strict";var f=a.ComponentType;var g=a.ConnectionLine;var h=a.DependencyType;var m=a.DependencyVisibility;var n=a.OptionType;var S=a.SolutionType;var V=a.ViewType;var L={};L.render=function(r,o){if(!this.initializationDone){o.initControls();o.initializationDone=true;r.write("<div");r.writeControlData(o);r.addClass("sapLandviszViewMainContainer");r.writeClasses();r.addStyle("width","100%");r.addStyle("height","100%");r.writeStyles();r.write(">");if(o.getVisibleDependency()==m.BOTH){o.networkViewVisible=true;o.boxViewVisible=true;}else if(o.getVisibleDependency()==m.NETWORK){o.networkViewVisible=true;o.boxViewVisible=false;}else if(o.getVisibleDependency()==m.BOX){o.networkViewVisible=false;o.boxViewVisible=true;}this._renderTitle(r,o);if(o.getViewType()==V.SOLUTION_VIEW){this._renderSolutionView(r,o);}else{r.write("<div");r.writeAttributeEscaped("id",o.getId()+"-viewLables");r.addClass("sapLandviszViews");r.writeClasses();r.write(">");if(o.networkViewVisible==true)this._renderNetworkViewHeader(r,o);if(o.boxViewVisible==true)this._renderBoxViewHeader(r,o);r.write("</div>");if(o.getShowDependencyNavigator()==true)this._renderNavigationPath(r,o);if(o.getShowClose()==true)this._renderCloseButton(r,o);if(o.getViewType()==V.SELECTION_VIEW)this._renderSelectionView(r,o);else if(o.getViewType()==V.DEPENDENCY_VIEW){this._renderDependencyView(r,o);}if(o.getViewType()==V.DEPENDENCY_VIEW)this._renderNavigationPanel(r,o);}r.write("</div>");}if(o.currentView==h.BOX_VIEW){var e=o.oHLayoutConnectionEntity.getContent();for(var i=0;i<e.length;i++){o.addAggregation("connectionEntities",e[i],false);}}var j=o.oHLayoutOptions.getContent();if(j.length>0){for(var i=0;i<j.length;i++)if(j[i]instanceof O)o.getSolutionOptions()[0].addOptionEntity(j[i]);}o.firstTime=false;};L._renderSolutionView=function(r,o){if(o.getShowDependencyNavigator()==true)this._renderNavigationPath(r,o);if(o.getShowClose()==true)this._renderCloseButton(r,o);r.write("<div");r.writeAttributeEscaped("id",o.getId()+"-solutionViewLables");r.addClass("sapLandviszViews");r.writeClasses();r.write(">");this._renderComponentViewHeader(r,o);this._renderDeploymentViewHeader(r,o);r.write("</div>");if(o.getSolutionType()==S.DEPLOYMENT_VIEW)this._renderOptions(r,o);var s=o.getSystems();for(var i=0;i<s.length;i++)s[i].setShowEntityActions(false);this._renderSolutionViewer(r,o);};L._renderComponentViewHeader=function(r,o){r.write("<div");r.writeAttributeEscaped("id",o.getId()+"-compViewLabel");r.addClass("sapLandviszView");r.writeClasses();r.write(">");o.compViewBtn.setText(o.getComponentViewLabel());o.compViewBtn.setLite(true);o.compViewBtn.addStyleClass("sapLandviszSolution_view_text");o.compViewBtn.setTooltip(o.getComponentViewTooltip());o.compViewBtn.setIcon("sap-icon://tree");var _=this;if(o.firstTime==true){o.compViewBtn.attachPress(function(e){o.currentSolutionView=S.COMPONENT_VIEW;o.compViewBtn.addStyleClass("selectedView");o.depViewBtn.removeStyleClass("selectedView");o.fireLoadSolutionView();});}r.renderControl(o.compViewBtn);r.write("</div>");};L._renderDeploymentViewHeader=function(r,o){r.write("<div");r.writeAttributeEscaped("id",o.getId()+"-deploymentViewLable");r.addClass("sapLandviszView");r.writeClasses();r.write(">");o.depViewBtn.setText(o.getDeploymentViewLabel());o.depViewBtn.setLite(true);o.depViewBtn.addStyleClass("sapLandviszSolution_view_text");o.depViewBtn.setTooltip(o.getDeploymentViewTooltip());o.depViewBtn.setIcon("sap-icon://dimension");var _=this;if(o.firstTime==true){o.depViewBtn.attachPress(function(e){o.currentSolutionView=S.DEPLOYMENT_VIEW;o.depViewBtn.addStyleClass("selectedView");o.compViewBtn.removeStyleClass("selectedView");o.fireLoadSolutionView();});}r.renderControl(o.depViewBtn);r.write("</div>");};L._renderSolutionViewer=function(r,o){if(null!=o.getPlugContent())this._renderPlugContent(r,o);r.write("<div");r.writeAttributeEscaped("id",o.getId()+"-solutionViewContainer");r.addClass("sapLandviszSolutionViewContainer");r.writeClasses();var w=o.windowWidth-2;r.addStyle("width",w+"px");var e;if(o.getSolutionType()==S.DEPLOYMENT_VIEW){e=o.getPlugContentHeight()+90;r.addStyle("position","absolute");}else{e=o.getPlugContentHeight()+35;}r.addStyle("height","calc(100% - "+e+"px)");r.addStyle("height","-webkit-calc(100% - "+e+"px)");r.addStyle("height","-moz-calc(100% - "+e+"px)");r.addStyle("height","-o-calc(100% - "+e+"px)");r.addStyle("top",e+"px");r.writeStyles();r.write(">");this._renderSolutionContainer(r,o);this._renderSolution(r,o);if(o.getShowDeploymentTypeSection()==true)this._renderSolutionDeploymentType(r,o);if(o.getSolutionType()==S.COMPONENT_VIEW)this._renderOptions(r,o);r.write("</div>");};L._renderPlugContent=function(r,o){r.write("<div");r.writeAttributeEscaped("id",o.getId()+"-solutionPlugContent");r.addStyle("top","32px");r.addStyle("width","100%");r.addStyle("position","absolute");r.writeStyles();r.write(">");r.renderControl(o.getPlugContent());r.write("</div>");};L._renderSolutionContainer=function(r,o){var e=o.getConnectors();o.connection.init();var i=o.getSolutionOptions();var j;if(i.length>0&&i[0].getType()==n.VIEW)j=o.getViewConnectedLayout();else j=o.connection.getBoxViewConnectedNodesLayout(e);var k=5;var l=Number((o.entityWidth*j.maxColumnCount)+((j.maxColumnCount+1)*k));var p=Number(o.boxModeHeight+o.entityHeight+(k*3));if(o.getSolutionOptions().length>0&&o.getSolutionType()==S.COMPONENT_VIEW)p=p+50;if(o.getShowDeploymentTypeSection()==true)p=p+40;r.write("<div");r.writeAttributeEscaped("id",o.getId()+"-solutionInnerContainer");r.addClass("sapLandviszBoxViewBorderContainer");r.writeClasses();r.addStyle("width",l+"px");r.addStyle("height",p+"px");r.writeStyles();r.write(">");r.write("</div>");};L._renderSolution=function(r,o){o.connection.init();var j=o.getSolutionOptions();var k;if(j.length>0&&j[0].getType()==n.VIEW)k=o.getViewConnectedLayout();else{k=o.getEntityConnectedLayout()}var l;var p;var q=5;if(k){var s=o.getId()+"-solutionInnerContainer";var t=o.$("solutionInnerContainer");setTimeout(function(){t.css("display","block");},1200);o.visibleEntities=[];var u=o.getSystems();for(var i=0;i<u.length;i++){l=u[i].getSystemId();var v=0;v=30+q;var w=30;if(k[l]){var x=0;if(k.thirdLevelEntitiesCount>0)x=30;var y=0;x+=Number((k[l].col*(o.entityWidth))+((k[l].col+1)*q));y+=Number(((k[l].row-1)*(o.entityHeight))+((k[l].row+1)*q)+o.boxModeHeight);u[i].left=x;u[i].top=y;u[i].viewType=V.SOLUTION_VIEW;o.visibleEntities.push(u[i]);r.renderControl(u[i]);}else{u[i].viewType=V.SOLUTION_VIEW;u[i].addStyleClass("sapLandviszDisplayNone");r.renderControl(u[i]);}}var z=o.getConnectionEntities();var A=0;for(var i=0;i<z.length;i++){A=0;p=z[i].getConnectionId();if(k[p]){x=Number(k[p].col*(o.entityWidth+10))+q;y=Number(k[p].row*(o.entityHeight+10))+q;A=Number(((k[p].colspan)*o.entityWidth)+((k[p].colspan-1)*q));}z[i].viewType=V.SOLUTION_VIEW;z[i].left=x;z[i].top=y;z[i].width=A;z[i].height=90;z[i].innerLeft=0;z[i].innerTop=0;z[i].innerWidth=A;z[i].innerHeight=90;r.renderControl(z[i]);z[i].addStyleClass("connectionBox");}}var B=o.$("navigation");var E=o.$("navigation_navigator");B.animate({height:'0px'},900,"swing",function(e){B.hide();});};L._renderSolutionDeploymentType=function(r,o){r.write("<div");r.writeAttributeEscaped("id",o.getId()+"-deploymentTypeContainer");r.addClass("sapLandviszDeploymentTypeContainer");r.writeClasses();r.write(">");var e=o.getSolutionOptions();var i;var l;var p;var q;var s;var t;var u=0;var v;var w;var x;var y;l=o.oHLayoutOptions.getContent();for(var j=1;j<l.length;j++){y=new Array();p=l[j].getOptionSources();v=l[j].getSelected();for(var k=0;k<p.length;k++){q=p[k].getSource();s=this._getDesiredSystem(o,p[k].getSource());if(null!=s&&s.getComponentType()==f.notDefined)continue;else if(k+1<p.length){t=this._getDesiredSystem(o,p[k+1].getSource());if(s.getComponentType()==t.getComponentType()){u++;}else{x=this._getDesiredSystem(o,p[k-u].getSource());w=this._renderDeploymentType(r,o,u,x.left,s.getComponentType(),s.getComponentTypeTooltip(),v,x.getSystemId());y.push(w);u=0}}else{x=this._getDesiredSystem(o,p[k-u].getSource());w=this._renderDeploymentType(r,o,u,x.left,s.getComponentType(),s.getComponentTypeTooltip(),v,x.getSystemId());y.push(w);u=0}}o.depTypeOptions[l[j].getId()]=y;}r.write("</div>");};L._getDesiredSystem=function(o,e){var s=o.getSystems();for(var i=0;i<s.length;i++){if(s[i].getSystemId()==e)return s[i];}return null;};L._renderDeploymentType=function(r,o,e,l,t,i,s,j){var k=new D();k.left=l;k.count=e;k.type=t;k.srcEntityId=j;k.setTooltip(i);k.standardWidth=o.entityWidth;if(s==true)k.addStyleClass("sapLandviszDisplayBlock");else k.addStyleClass("sapLandviszDisplayNone");r.renderControl(k);return k;};L._renderOptions=function(r,o){var e=o.getSolutionOptions();if(e.length<=0)return;r.write("<div");r.writeAttributeEscaped("id",o.getId()+"-optionContainer");if(o.getSolutionOptionType()==n.VIEW)r.addClass("sapLandviszOptionContainer");else if(o.getSolutionOptionType()==n.ENTITY)r.addClass("sapLandviszEntityOptionContainer");r.writeClasses();if(o.getSolutionOptionType()==n.VIEW){var w=o.windowWidth-2;r.addStyle("width",w+"px");r.writeStyles();}r.write(">");this._createOptions(r,o);r.write("</div>");};L._createOptions=function(r,o){if(o.getSolutionOptionType()==n.VIEW){this._renderViewOptions(r,o,o.getSolutionOptionType());}else if(o.getSolutionOptionType()==n.ENTITY){this._createEntityOptions(r,o);}};L._createEntityOptions=function(r,o){var e=o.getSolutionOptions();var k;var s=o.getSystems();var p;var q;var t=this;for(var i=0;i<e.length;i++){k=e[i].getOptionEntities();if(""==o.srcEntity)o.srcEntity=e[i].getCurrentEntity();for(var j=0;j<k.length;j++){for(var l=0;l<s.length;l++){if(o.srcEntity==s[l].getSystemId()){p=s[l].left;q=s[l].top;break;}}p=p+o.entityWidth/2-50+50*j;k[j].left=p;k[j].optionOn=e[i].getType();k[j].optionSrcEntityId=o.srcEntity;k[j].attachEvent("optionSelected",function(u){var v=u.getSource();var w=v.getOptionSources();var x;for(var i=0;i<w.length;i++){x=w[i].getSource();}if(o.srcEntity==x)return;o.selectedOptionEntity=v;for(var i=0;i<e.length;i++){k=e[i].getOptionEntities();for(var j=0;j<k.length;j++){if(o.srcEntity==k[j].optionSrcEntityId&&v.getId()==k[j].getId()){k[j].$().css({"background-color":"#008fd3","color":"#ffffff"});}else{k[j].$().css({"background-color":"transparent","color":"#00669c"});k[j].setSelected(false);}}}t._makeOptionVisible(r,o,u);});r.renderControl(k[j]);}}};L._renderViewOptions=function(r,o,e){var k=o.getSolutionOptions();var l=k[0].getOptionEntities();if(l.length>0){var t=o.getDeploymentOptionsLabel();o.deploymentOptionLabel.setText(t);o.deploymentOptionLabel.setTooltip(o.getDeploymentOptionsTooltip());o.deploymentOptionLabel.addStyleClass("sapLandviszOptionLabel");o.oHLayoutOptions.addContent(o.deploymentOptionLabel);}var p=this;for(var i=0;i<l.length;i++){l[i].optionOn=e;if(l[i].getSelected()==true){o.currentViewOptionId=l[i].getId();o.selectedOptionEntity=l[i];}l[i].attachEvent("optionSelected",function(q){var s=q.getSource();if(o.currentViewOptionId==s.getId())return;o.selectedOptionEntity=s;var u;l=o.oHLayoutOptions.getContent();l=o.getSolutionOptions()[0].getOptionEntities();for(var j=0;j<l.length;j++){u=l[j].$();u.css({"background-color":"transparent","color":"#00669c"});if(s.getId()==l[j].getId()){l[j].setSelected(true);}else{l[j].removeStyleClass("optionSelected");l[j].setSelected(false);}}p._makeOptionVisible(r,o,q);});o.oHLayoutOptions.addContent(l[i]);}r.renderControl(o.oHLayoutOptions);};L._makeOptionVisible=function(r,o,e){var i=e.getSource();if(i.optionOn==n.VIEW){this._makeViewOptionVisible(r,o,i);}else if(i.optionOn==n.ENTITY){this._makeEntityOptionVisible(r,o,i);}};L._makeViewOptionVisible=function(r,o,e){if(o.currentViewOptionId==e.getId())return;o.currentViewOptionId=e.getId();var s=o.getSystems();var j;for(var i=0;i<s.length;i++){s[i].removeStyleClass("sapLandviszDisplayNone");j=s[i].$();j.hide("600");}var k=o.$("deploymentTypeContainer");var l=o.depTypeOptions[o.selectedOptionEntity.getId()];var p=k.children();var q;for(var x=0;x<p.length;x++){q=jQuery(p[x]);q.css({"display":"none"});}var t=e.getOptionSources();var u;var v=o.getConnectors();var w=v[0].getSource();var y=[];var z;for(var i=0;i<t.length;i++){z=new C();u=t[i].getSource();z.setSource(w);z.setTarget(u);y.push(z);}var A;var B;var E=5;var j;var F;o.connection.init();var G=o.connection.getBoxViewConnectedNodesLayout(y);if(G){var H=Number((o.entityWidth*G.maxColumnCount)+((G.maxColumnCount+1)*E));var I=Number(o.boxModeHeight+o.entityHeight+(E*3));var k=o.$("deploymentTypeContainer");if(l&&l.length>0){I=I+40;k.css({"display":"block",});}else{k.css({"display":"none",});}var J=o.$("solutionInnerContainer");J.animate({width:H,height:I},400);setTimeout(function(){var J=o.$("solutionInnerContainer");var K=J[0].offsetLeft;var M=J[0].offsetTop;var N=0;var P=o.getConnectionEntities();for(var i=0;i<P.length;i++){B=P[i].getConnectionId();if(G[B]){Z=Number(G[B].col*(o.entityWidth+10));$=Number(G[B].row*(o.entityHeight+10));Z=Number(G[B].col*(o.entityWidth+10))+E;$=Number(G[B].row*(o.entityHeight+10))+E;P[i].left=Z+K;N=P[i].top;P[i].top=Z+M;F=Number(((G[B].colspan)*o.entityWidth)+((G[B].colspan-1)*E));var Q=P[i].$();Q.animate({left:P[i].left,top:P[i].top,width:F,height:90,},600,'swing');var T=jQuery(document.getElementById(P[i].getId()+"connectionRow"));T.animate({width:F,height:90,},600,'swing');var U=P[i].$("connectionLabel");var W=F-68;U.css({"max-width":W,});}}o.visibleEntities=[];for(var i=0;i<s.length;i++){A=s[i].getSystemId();var X=0;X=30+E;var Y=30;if(G[A]){var Z=0;var $=0;Z+=Number((G[A].col*(o.entityWidth))+((G[A].col+1)*E));$+=Number(((G[A].row-1)*(o.entityHeight))+((G[A].row+1)*E)+o.boxModeHeight);s[i].left=Z+K;s[i].top=$+M;j=s[i].$();j.css({left:Z+K,top:$+M});j.show("700");o.visibleEntities.push(s[i]);}}var k=o.$("deploymentTypeContainer");k.css({left:K,width:H,});var _;var a1;if(l&&l.length>0){for(var x=0;x<l.length;x++){q=l[x];for(var i=0;i<s.length;i++){if(s[i].getSystemId()==q.srcEntityId){a1=s[i];break;}}_=a1.left-K;q.$().css({"display":"block","left":_});}}},405);}};L._makeEntityOptionVisible=function(r,o,e){var s=o.getSystems();var j=e.getOptionSources();e.setSelected(true);var p;for(var i=0;i<j.length;i++){p=j[i].getSource();}if(o.srcEntity==p)return;var q;var t;var u;var v=false;for(var k=0;k<s.length;k++){if(o.srcEntity==s[k].getSystemId()){q=s[k].$();t=s[k].left;u=s[k].top;q.hide("800");break;}}setTimeout(function(){for(var l=0;l<s.length;l++){if(p==s[l].getSystemId()){q=s[l].$();q.css({left:t,top:u});s[l].left=t;s[l].top=u;s[l].removeStyleClass("sapLandviszDisplayNone");o.srcEntity=s[l].getSystemId();q.show("800");break;}}},810);};L._renderNavigationPath=function(r,o){r.write("<div");r.writeAttributeEscaped("id",o.getId()+"-navigationPath");r.addClass("sapLandviszDependencyPath");r.writeClasses();r.write(">");o.navigationPathLabel.setText(o.getNavigationPath());o.navigationPathLabel.setTooltip(o.getNavigationPath());o.navigationPathLabel.addStyleClass("sapLandviszDependencyPathLabel");r.renderControl(o.navigationPathLabel);r.write("</div>");};L._renderSelectionView=function(r,o){var s=o.getSystems();var e=s[0].getActionBar();for(var j=0;j<e.length;j++){e[j].attachEvent("changeView",function(q){o.resetView(s[0],q.oSource);},this);}var l=0;var t=0;var i=0;var k=0;var p=o.windowHeight-28-2;r.write("<div");r.addStyle("width","100%");r.addStyle("height",p+"px");r.addStyle("overflow","auto");r.addStyle("box-sizing","border-box");r.addStyle("top","28px");r.addStyle("position","absolute");r.writeStyles();r.writeAttributeEscaped("id",o.getId()+"-outerContainer");r.writeClasses();r.write(">");r.write("<div");r.writeAttributeEscaped("id",o.getId()+"-container");r.writeClasses();r.addStyle("position","absolute");r.addStyle("box-sizing","border-box");if(s[0].entityMaximized==true){i=o.windowWidth-40;k=o.windowHeight-66;l=20;t=20;s[0].sViewWidth=i;s[0].sViewHeight=k;}else if(s[0].expVisible==true){i=o.windowWidth-12;k=o.windowHeight;l=10;r.addStyle("position","relative");s[0].sViewWidth=i-o.entityWidth;s[0].sViewHeight=k;}else{s[0].sViewWidth=0;s[0].sViewHeight=0;}r.addStyle("left",l+"px");r.addStyle("top",t+"px");if(i!=0)r.addStyle("width",i+"px");else r.addStyle("width",o.entityWidth+"px");if(k!=0)r.addStyle("height",k+"px");else r.addStyle("height",o.entityHeight+"px");r.writeStyles();r.write(">");s[0].viewType=V.SELECTION_VIEW;s[0].display="block";r.renderControl(s[0]);r.write("</div>");r.write("</div>");};L._renderDependencyView=function(r,o){var s=o.getSystems();for(var i=0;i<s.length;i++)s[i].setShowEntityActions(false);r.write("<div");r.writeAttributeEscaped("id",o.getId()+"-viewContainer");r.writeClasses();var w=o.windowWidth-2;var e=o.windowHeight-26;r.addStyle("width",w+"px");r.addStyle("height",e+"px");r.addStyle("position","absolute");r.addStyle("overflow","hidden");r.addStyle("top",26+"px");r.writeStyles();r.write(">");this._renderBoxContainer(r,o);if(o.currentView!=""&&o.currentView==h.NETWORK_VIEW)this._renderNetworkView(r,o);else if(o.currentView!=""&&o.currentView==h.BOX_VIEW)this._renderBoxView(r,o);else if(o.getVisibleDependency()==m.BOTH){if(o.getDefaultDependencyView()==h.NETWORK_VIEW)this._renderNetworkView(r,o);if(o.getDefaultDependencyView()==h.BOX_VIEW)this._renderBoxView(r,o);}else if(o.getVisibleDependency()==m.NETWORK)this._renderNetworkView(r,o);else if(o.getVisibleDependency()==m.BOX)this._renderBoxView(r,o);this._renderBoxViewLabels(r,o);r.write("</div>");};L._renderCloseButton=function(r,o){r.write("<div");r.writeAttributeEscaped("id",o.getId()+"-closeBtn");r.addClass("sapLandviszCloseButton");r.writeClasses();r.write(">");o.closeImg.setSrc(sap.ui.resource("sap.landvisz","themes/base/img/framework/"+"16x16"+"/close_enable_dark.png"));o.closeImg.setTooltip(o.getCloseButtonTooltip());if(o.firstTime==true)o.closeImg.attachPress(function(e){o.fireClose();});r.renderControl(o.closeImg);r.write("</div>");};L._renderNetworkViewHeader=function(r,o){r.write("<div");r.writeAttributeEscaped("id",o.getId()+"-netwrokViewLable");r.addClass("sapLandviszView");r.writeClasses();r.write(">");o.networkViewBtn.setText(o.getNetworkDependencyLabel());o.networkViewBtn.setLite(true);o.networkViewBtn.addStyleClass("sapLandviszView_text");o.networkViewBtn.setTooltip(o.getNetworkDependencyLabel());var t=o.getViewType();o.networkViewBtn.setIcon("sap-icon://overview-chart");if(t==V.SELECTION_VIEW){o.networkViewBtn.setEnabled(false);}else if(t==V.DEPENDENCY_VIEW){o.networkViewBtn.setEnabled(true);}var _=this;if(o.firstTime==true){o.networkViewBtn.attachPress(function(e){o.networkViewBtn.addStyleClass("selectedView");o.boxViewBtn.removeStyleClass("selectedView");_.renderAllEntities(r,o,false);});}r.renderControl(o.networkViewBtn);r.write("</div>");};L._renderBoxViewHeader=function(r,o){r.write("<div");r.writeAttributeEscaped("id",o.getId()+"-boxViewLable");r.addClass("sapLandviszView");r.writeClasses();r.write(">");o.boxViewBtn.setText(o.getBoxDependencyLabel());o.boxViewBtn.setLite(true);o.boxViewBtn.addStyleClass("sapLandviszView_text");o.boxViewBtn.setTooltip(o.getBoxDependencyLabel());var t=o.getViewType();o.boxViewBtn.setIcon("sap-icon://table-view");if(t==V.SELECTION_VIEW){o.boxViewBtn.setEnabled(false);}else if(t==V.DEPENDENCY_VIEW){o.boxViewBtn.setEnabled(true);}var _=this;if(o.firstTime==true){o.boxViewBtn.attachPress(function(e){o.boxViewBtn.addStyleClass("selectedView");o.networkViewBtn.removeStyleClass("selectedView");_.renderAllBoxViewEntities(r,o,false);});}r.renderControl(o.boxViewBtn);r.write("</div>");};L._renderTitle=function(r,o){var e;e=o.getTitle();r.write("<div");r.writeAttributeEscaped("id",o.getId()+"-viewHeaderContainer");r.addClass("sapLandviszViewer_container_header");r.writeClasses();r.writeAttributeEscaped("title",e);r.write(">");r.writeEscaped(e);r.write("</div>");};L._renderNetworkView=function(r,o){this.renderAllEntities(r,o,true);};L.renderAllEntities=function(r,o,j){var k=o.getConnectors();o.currentView=h.NETWORK_VIEW;var l=o.$("boxViewContainer");if(l)l.css("display","none");var p=o.getBoxDependencyLevels();if(p){for(var i=0;i<p.length;i++){var q=o.$("boxViewLabel"+i);if(q)q.css("display","none");}}o.connection.init();var s;if(o.getConnectionLine()==g.Line)s=o.connection.getConnectedNodesLayout(k);else s=o.connection.getConnectedNodesLayoutTrack(k);var t=o.getSystems();var u=o.getConnectionEntities();var v=50;if(u.length>0)v=0;var w;var x;for(var i=0;i<t.length;i++){w=t[i].getSystemId();if(s[w]){var y=0;var z=0;y=Number(s[w].col*(o.entityWidth+10+v));z=Number(s[w].row*(o.entityHeight+10+v));}t[i].left=y;t[i].top=z;t[i].viewType=V.DEPENDENCY_VIEW;if(j==true)r.renderControl(t[i]);else this._moveEntityToPosition(y,z,t[i].getId());}for(var i=0;i<u.length;i++){x=u[i].getConnectionId();if(o.firstTime==true){u[i].attachEvent("connectionMouseover",function(e){o.onmouseenter(e);},this);u[i].attachEvent("connectionMouseout",function(e){o.onmouseleave(e);},this);}if(s[x]){y=Number(s[x].col*(o.entityWidth+10));z=Number(s[x].row*(o.entityHeight+10));}u[i].left=y;u[i].top=z;u[i].width=o.entityWidth;u[i].height=o.entityHeight;u[i].innerLeft=(o.entityWidth-50)/2;u[i].innerTop=(o.entityHeight-50)/2;u[i].innerWidth=50;u[i].innerHeight=50;u[i].viewType=o.currentView;if(j==true){u[i].addStyleClass("sapLandviszConnection_entity_container");r.renderControl(u[i]);}else{u[i].addStyleClass("sapLandviszConnection_entity_container");u[i].removeStyleClass("sapLandviszConnectionBox");this._animateConnectionEntityContainer(o.entityWidth,o.entityHeight,u[i]);}}if(o.connection.svgForConnections)o.connection.svgForConnections.style("display","block");else if(j==false){var A=o.$("navigation");var B=o.$("navigation_navigator");A.animate({height:'0px'},1000,"swing",function(e){A.hide();});setTimeout(function(){if(o.svgForConnections){o.connection.svgForConnections=o.svgForConnections;o.connection.svgForConnections.style("display","block");}else{var e=o.$("viewContainer");var E=e[0].scrollWidth-10;var F=e[0].scrollHeight-10;o.svgForConnections=c.getSVG(E,F,o.getId()+"-viewContainer");o.connection=b;o.connection.svgForConnections=o.svgForConnections;o.connection.renderConnections(o.getSystems(),o.getConnectionEntities(),this.getConnectionLine());}var G=o.$("viewContainer");var H=Number(G[0].scrollHeight);var I=Number(G[0].scrollWidth);var J=Number(G.height());var K=Number(G.width());if((I>K)||(H>J))o.getVisibleRegion();},1500);}};L._renderBoxContainer=function(r,o){var e=o.getConnectors();o.connection.init();var i=o.connection.getBoxViewConnectedNodesLayout(e);var j=5;var k=Number((o.entityWidth*i.maxColumnCount)+((i.maxColumnCount+1)*j));if(i.thirdLevelEntitiesCount>0){k+=30+j;}var l=Number(o.boxModeHeight+o.entityHeight+(j*3));if(i.thirdLevelEntitiesCount>0){l+=Number(o.entityHeight+j);}r.write("<div");r.writeAttributeEscaped("id",o.getId()+"-boxViewContainer");r.addClass("sapLandviszBoxViewBorderContainer");r.writeClasses();r.addStyle("width",k+"px");r.addStyle("height",l+"px");r.addStyle("top",10+"px");r.writeStyles();r.write(">");r.write("</div>");};L._renderBoxViewLabels=function(r,o){var l=30;var e=o.entityHeight;var j=5;var k=o.boxLeftMargine+j;var p=o.boxModeHeight+(j*2)+o.boxTopMargine;var q=o.getBoxDependencyLevels();var s;if(q){for(var i=0;i<q.length;i++){p+=((o.entityHeight+j)*i);s=o.getId()+"-boxViewLabel"+i;r.write("<div");r.writeAttributeEscaped("id",s);r.writeAttributeEscaped("title",q[i]);r.addClass("sapLandviszBoxContainerLevelHeader");r.writeClasses();r.addStyle("left",k+"px");r.addStyle("top",p+"px");r.addStyle("height",e+"px");r.addStyle("width",l+"px");r.addStyle("display","none");r.writeStyles();r.write(">");r.write("<div");r.addClass("sapLandviszLevelLabel");r.writeClasses();r.writeAttributeEscaped("id",s+"Level");r.writeAttributeEscaped("title",q[i]);r.addStyle("height","100%");r.addStyle("width","100%");r.addStyle("left","3px");r.writeStyles();r.write(">");r.writeEscaped(q[i]);r.write("</div>");r.write("</div>");}}};L._renderNavigationPanel=function(r,o){r.write("<div");r.writeAttributeEscaped("id",o.getId()+"-navigation");r.addClass("sapLandviszClv_container_frame_navigation");r.writeAttributeEscaped("draggable","true");r.addClass("no-draggable");r.addClass("no-resizable");r.addClass("ui-draggable");r.writeClasses();r.addStyle("bottom","0px");r.addStyle("right","0px");r.addStyle("height","28%");r.addStyle("background-size","100%");r.addStyle("display","block");r.writeStyles();r.write(">");r.write("<div");r.writeAttributeEscaped("id",o.getId()+"-navigation_header");r.addClass("navigationHeader");r.writeClasses();r.write(">");r.write("<div");r.writeAttributeEscaped("id",o.getId()+"-navigation_header_arrowup");r.addClass("navigationBarButton");r.addClass("arrowUp");r.writeClasses();r.writeAttributeEscaped("title",o.SHOW_NAV_TEXT);r.write(">");r.write("</div>");r.write("<div");r.writeAttributeEscaped("id",o.getId()+"-navigation_header_arrowdown");r.addClass("navigationBarButton");r.addClass("arrowDown");r.writeClasses();r.writeAttributeEscaped("title",o.HIDE_NAV_TEXT);r.write(">");r.write("</div>");r.write("</div>");r.write("<div");r.writeAttributeEscaped("id",o.getId()+"-navigation_navigator");r.writeAttributeEscaped("draggable","true");r.addClass("navigationNavigator");r.addClass("ui-draggable");r.writeClasses();r.write(">");r.write("</div>");r.write("</div>");};L._renderBoxView=function(r,o){this.renderAllBoxViewEntities(r,o,true);};L.renderAllBoxViewEntities=function(r,o,j){o.currentView=h.BOX_VIEW;if(o.connection.svgForConnections!=null)o.connection.svgForConnections.style("display","none");var s=o.getSystems();var k=o.getConnectionEntities();var l=o.getConnectors();o.connection.init();var p=o.connection.getBoxViewConnectedNodesLayout(l);var q;var t;var u=5;if(p){var v=o.$("boxViewContainer");setTimeout(function(){v.css("display","block");},1200);for(var i=0;i<s.length;i++){q=s[i].getSystemId();var w=0;w=30+u;var x=30;if(p[q]){var y=0;if(p.thirdLevelEntitiesCount>0)y=30;var z=0;y+=Number((p[q].col*(o.entityWidth))+((p[q].col+1)*u));z+=Number(((p[q].row-1)*(o.entityHeight))+((p[q].row+1)*u)+o.boxModeHeight);s[i].left=y;s[i].top=z;s[i].viewType=V.DEPENDENCY_VIEW;if(j==true){s[i].left=y;s[i].top=z;r.renderControl(s[i]);}else{s[i].left=y+o.boxLeftMargine;s[i].top=z+o.boxTopMargine;this._moveEntityToPosition(s[i].left,s[i].top,s[i].getId());}}}var A=0;for(var i=0;i<k.length;i++){if(o.firstTime==true){k[i].attachEvent("connectionMouseover",function(e){o.onmouseenter(e);},this);k[i].attachEvent("connectionMouseout",function(e){o.onmouseleave(e);},this);}A=0;t=k[i].getConnectionId();if(p[t]){if(o.currentView==h.BOX_VIEW){y=Number(p[t].col*(o.entityWidth+10))+u;z=Number(p[t].row*(o.entityHeight+10))+u;A=Number(((p[t].colspan)*o.entityWidth)+((p[t].colspan-1)*u));}}k[i].viewType=o.currentView;k[i].left=y;if(p.thirdLevelEntitiesCount>0)k[i].left=y+30;k[i].top=z;k[i].width=A;k[i].height=90;k[i].innerLeft=0;k[i].innerTop=0;k[i].innerWidth=A;k[i].innerHeight=90;if(o.getVisibleDependency()==m.BOTH&&o.getDefaultDependencyView()==h.NETWORK_VIEW){if(k[i].toolPopup.isOpen())k[i].toolPopup.close();}if(j==true){r.renderControl(k[i]);k[i].left=y;if(p.thirdLevelEntitiesCount>0)k[i].left=y+30;k[i].top=z;k[i].viewType=o.currentView;k[i].width=A;k[i].height=0;k[i].addStyleClass("sapLandviszConnectionBox");}else{k[i].left=y+o.boxLeftMargine;if(p.thirdLevelEntitiesCount>0)k[i].left=y+o.boxLeftMargine+30;k[i].top=z+o.boxTopMargine;k[i].addStyleClass("sapLandviszConnectionBox");k[i].removeStyleClass("sapLandviszConnection_entity_container");this._animateConnectionEntityContainer(A,90,k[i]);}}}if(p.thirdLevelEntitiesCount>0){o.hasBoxThirdLevel=true;var B=30;var E=o.entityHeight;var F=o.boxLeftMargine+u;var G=o.boxModeHeight+(u*2)+o.boxTopMargine;var H=o.getBoxDependencyLevels();var I="Systems";var J="Systems";if(j==false){setTimeout(function(){if(H){for(var i=0;i<H.length;i++){var e=o.$("boxViewLabel"+i);G+=((o.entityHeight+u)*i);e.css("display","block");e.css({left:F,top:G,width:B,height:E,});var N=o.$("boxViewLabel"+i+"Level");N.css({width:E,height:E,});}}},1000);}}if(j==false){var K=o.$("navigation");var M=o.$("navigation_navigator");K.animate({height:'0px'},900,"swing",function(e){K.hide();});setTimeout(function(){var e=o.$("viewContainer");var N=Number(e[0].scrollHeight);var P=Number(e[0].scrollWidth);var Q=Number(e.height());var T=Number(e.width());if((P>T)||(N>Q))o.getVisibleRegion();},1000);}};L._moveEntityToPosition=function(l,t,e){var i=jQuery(document.getElementById(e));i.animate({left:l,top:t,},1000);};L._animateConnectionEntityContainer=function(e,i,j){var k=j.$();k.animate({left:j.left,top:j.top,width:e,height:i,},1000,'swing');var l=j.getId()+"connectionRow";var o=jQuery(document.getElementById(l));o.animate({left:j.innerLeft,top:j.innerTop,width:j.innerWidth,height:j.innerHeight,},1000,'swing');};return L;},true);
