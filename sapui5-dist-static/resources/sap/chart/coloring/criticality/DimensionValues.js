/*!
 * SAPUI5

(c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(['sap/chart/coloring/ColoringUtils','sap/chart/ChartLog','sap/chart/data/TimeDimension','sap/chart/coloring/CriticalityType',"sap/ui/thirdparty/jquery"],function(C,a,T,b,q){"use strict";var D={};var v=function(c,A,d,o){var t=q.extend({},o);t.bHasOtherSeriesDim=C.hasOtherSeriesDim(A[0],d);t.type='Criticality';t.subType='DimensionValues';C.checkColoringDimension(A,d,c,t);var e=c[A[0]],f=Object.keys(e),g=C.find(A[0],d.aDim),i=g.getRole()==='series'?true:false;f.forEach(function(h){var j=e[h].Values,l=e[h].Legend;j=Array.isArray(j)?j:[j];if(j.length>1&&!l){throw new a('error','Colorings.Criticality.DimensionValues','Legend is mandatory when one criticality type has multiple values.');}if((i||o.bIsPie)&&j.length>1){throw new a('error','Colorings.Criticality.DimensionValues','Criticality on Series Dimension, only single value could be assigned to each CriticalityType.');}});};D.qualify=function(c,d,o,e){v(c,d,o,e);var s=d[0],f;if(s){f={dim:s,setting:c};}return f;};D.parse=function(c,d,s,l,o){var S={},L={},e=c.dim,f=[],g=c.setting[e],n=[];q.each(g,function(k,i){var j=!Array.isArray(i)?[i]:i;if(k!==b.Neutral){S[k]=j.map(function(p){return Array.isArray(p.Values)?p.Values:[p.Values];});f=Array.prototype.concat.apply(f,S[k]);}L[k]=j.map(function(p){var V=Array.isArray(p.Values)?p.Values[0]:p.Values;var r=(p.Legend!=null)?p.Legend:V;return r;});});if(g.Neutral){n=Array.isArray(g.Neutral.Values)?g.Neutral.Values:[g.Neutral.Values];}var N=function(i){return f.indexOf(i[e])===-1;};function h(V){return function(i){return V.indexOf(i[e])!==-1;};}var m={Negative:(S.Negative||[]).map(h),Critical:(S.Critical||[]).map(h),Positive:(S.Positive||[]).map(h),Neutral:[N]};return{callbacks:m,legend:L,aCriticalityValues:f.concat(n),status:s};};D.getContextHandler=function(c,l,o){var d=c.dim,e=c.parsed.aCriticalityValues;return function(f){var V=f.getProperty(d),g=this.getDimensionByName(d);if(e.indexOf(V)===-1){if(g._getFixedRole()==="series"||o.bIsPie){var h=new a('error','Colorings.Criticality.DimensionValues','Criticality on Series Dimension, all series must be applied coloring.');c.chartLog=h;}else{c.parsed.legend.Neutral=l.getText("COLORING_TYPE_OTHER");}}};};return D;});
