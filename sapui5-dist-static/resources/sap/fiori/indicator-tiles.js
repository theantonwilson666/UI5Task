//@ui5-bundle sap/fiori/indicator-tiles.js
sap.ui.predefine('sap/ushell/components/tiles/indicatorTileUtils/cache',[],function(){"use strict";var B={};var K={};var s="HANA_CLIENT";return{getCacheHanaClient:function(){return B[s];},setCacheHanaClient:function(d){B[s]=d;},getEvaluationByChipId:function(k){if(B[k]){return B[k];}return null;},getEvaluationById:function(k){return this.getEvaluationByChipId(k);},setEvaluationById:function(k,d){B[k]=d;},getFrontEndCacheDeferredObject:function(k){if(B[k]){return B[k];}return null;},setFrontEndCacheDefferedObject:function(k,d){B[k]=d;},getKpivalueById:function(k){if(K[k]){return K[k];}return null;},setKpivalueById:function(k,d){K[k]=d;}};},true);
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine('sap/suite/ui/commons/GenericTile',['sap/m/GenericTile','sap/m/GenericTileRenderer'],function(G,a){"use strict";var S=G.extend("sap.suite.ui.commons.GenericTile",{metadata:{deprecated:true,library:"sap.suite.ui.commons"},renderer:a});return S;});
sap.ui.predefine('sap/suite/ui/commons/HarveyBallMicroChart',['sap/suite/ui/microchart/library','sap/suite/ui/microchart/HarveyBallMicroChart','sap/suite/ui/microchart/HarveyBallMicroChartRenderer'],function(M,H,a){"use strict";var S=H.extend("sap.suite.ui.commons.HarveyBallMicroChart",{metadata:{deprecated:true,library:"sap.suite.ui.commons"},renderer:a});return S;});
sap.ui.predefine('sap/suite/ui/commons/HarveyBallMicroChartItem',['sap/suite/ui/microchart/HarveyBallMicroChartItem'],function(H){"use strict";var S=H.extend("sap.suite.ui.commons.HarveyBallMicroChartItem",{metadata:{deprecated:true,library:"sap.suite.ui.commons"}});return S;});
sap.ui.predefine('sap/suite/ui/commons/TileContent',['sap/m/TileContent','sap/m/TileContentRenderer'],function(M,T){"use strict";var a=M.extend("sap.suite.ui.commons.TileContent",{metadata:{deprecated:true,library:"sap.suite.ui.commons"},renderer:T});return a;});
sap.ui.predefine('sap/suite/ui/commons/library',["sap/ui/core/Core","sap/ui/core/library","sap/m/library"],function(){"use strict";sap.ui.getCore().initLibrary({name:"sap.suite.ui.commons",dependencies:["sap.ui.core","sap.m"],types:["sap.suite.ui.commons.BulletChartMode","sap.suite.ui.commons.CalculationBuilderComparisonOperatorType","sap.suite.ui.commons.CalculationBuilderFunctionType","sap.suite.ui.commons.CalculationBuilderItemType","sap.suite.ui.commons.CalculationBuilderLayoutType","sap.suite.ui.commons.CalculationBuilderLogicalOperatorType","sap.suite.ui.commons.CalculationBuilderOperatorType","sap.suite.ui.commons.CalculationBuilderValidationType","sap.suite.ui.commons.CommonBackground","sap.suite.ui.commons.ComparisonChartView","sap.suite.ui.commons.DeviationIndicator","sap.suite.ui.commons.FacetOverviewHeight","sap.suite.ui.commons.FrameType","sap.suite.ui.commons.HeaderContainerView","sap.suite.ui.commons.ImageEditorContainerMode","sap.suite.ui.commons.ImageEditorMode","sap.suite.ui.commons.ImageFormat","sap.suite.ui.commons.InfoTileSize","sap.suite.ui.commons.InfoTileTextColor","sap.suite.ui.commons.InfoTileValueColor","sap.suite.ui.commons.LoadState","sap.suite.ui.commons.MicroAreaChartView","sap.suite.ui.commons.MicroProcessFlowRenderType","sap.suite.ui.commons.networkgraph.ActionButtonPosition","sap.suite.ui.commons.networkgraph.BackgroundColor","sap.suite.ui.commons.networkgraph.ElementStatus","sap.suite.ui.commons.networkgraph.LayoutAlgorithmType","sap.suite.ui.commons.networkgraph.LayoutRenderType","sap.suite.ui.commons.networkgraph.LineArrowOrientation","sap.suite.ui.commons.networkgraph.LineArrowPosition","sap.suite.ui.commons.networkgraph.LineType","sap.suite.ui.commons.networkgraph.HeaderCheckboxState","sap.suite.ui.commons.networkgraph.NodePlacement","sap.suite.ui.commons.networkgraph.NodeShape","sap.suite.ui.commons.networkgraph.NodeSize","sap.suite.ui.commons.networkgraph.Orientation","sap.suite.ui.commons.networkgraph.RenderType","sap.suite.ui.commons.ProcessFlowConnectionLabelState","sap.suite.ui.commons.ProcessFlowConnectionState","sap.suite.ui.commons.ProcessFlowConnectionType","sap.suite.ui.commons.ProcessFlowDisplayState","sap.suite.ui.commons.ProcessFlowLaneState","sap.suite.ui.commons.ProcessFlowNodeState","sap.suite.ui.commons.ProcessFlowNodeType","sap.suite.ui.commons.ProcessFlowZoomLevel","sap.suite.ui.commons.SelectionState","sap.suite.ui.commons.statusindicator.FillingType","sap.suite.ui.commons.statusindicator.FillingDirectionType","sap.suite.ui.commons.taccount.TAccountPanelState","sap.suite.ui.commons.ThingGroupDesign","sap.suite.ui.commons.TimelineAlignment","sap.suite.ui.commons.TimelineAxisOrientation","sap.suite.ui.commons.TimelineFilterType","sap.suite.ui.commons.TimelineGroupType","sap.suite.ui.commons.TimelineScrollingFadeout","sap.suite.ui.commons.ValueStatus"],interfaces:[],controls:["sap.suite.ui.commons.BulletChart","sap.suite.ui.commons.BusinessCard","sap.suite.ui.commons.CalculationBuilder","sap.suite.ui.commons.CalculationBuilderExpression","sap.suite.ui.commons.CalculationBuilderFunction","sap.suite.ui.commons.CalculationBuilderInput","sap.suite.ui.commons.CalculationBuilderItem","sap.suite.ui.commons.CalculationBuilderValidationResult","sap.suite.ui.commons.CalculationBuilderVariable","sap.suite.ui.commons.ChartContainer","sap.suite.ui.commons.ChartContainerContent","sap.suite.ui.commons.ChartContainerToolbarPlaceholder","sap.suite.ui.commons.ChartTile","sap.suite.ui.commons.ColumnMicroChart","sap.suite.ui.commons.ComparisonChart","sap.suite.ui.commons.DateRangeScroller","sap.suite.ui.commons.DateRangeSlider","sap.suite.ui.commons.DateRangeSliderInternal","sap.suite.ui.commons.DeltaMicroChart","sap.suite.ui.commons.DynamicContainer","sap.suite.ui.commons.FacetOverview","sap.suite.ui.commons.FeedItemHeader","sap.suite.ui.commons.FeedTile","sap.suite.ui.commons.GenericTile","sap.suite.ui.commons.GenericTile2X2","sap.suite.ui.commons.HarveyBallMicroChart","sap.suite.ui.commons.HeaderCell","sap.suite.ui.commons.HeaderContainer","sap.suite.ui.commons.imageeditor.ImageEditor","sap.suite.ui.commons.imageeditor.ImageEditorContainer","sap.suite.ui.commons.InfoTile","sap.suite.ui.commons.JamContent","sap.suite.ui.commons.KpiTile","sap.suite.ui.commons.LaunchTile","sap.suite.ui.commons.LinkActionSheet","sap.suite.ui.commons.MicroAreaChart","sap.suite.ui.commons.MonitoringContent","sap.suite.ui.commons.MonitoringTile","sap.suite.ui.commons.networkgraph.Graph","sap.suite.ui.commons.networkgraph.Node","sap.suite.ui.commons.NewsContent","sap.suite.ui.commons.NoteTaker","sap.suite.ui.commons.NoteTakerCard","sap.suite.ui.commons.NoteTakerFeeder","sap.suite.ui.commons.NumericContent","sap.suite.ui.commons.NumericTile","sap.suite.ui.commons.PictureZoomIn","sap.suite.ui.commons.ProcessFlow","sap.suite.ui.commons.ProcessFlowConnection","sap.suite.ui.commons.ProcessFlowConnectionLabel","sap.suite.ui.commons.ProcessFlowLaneHeader","sap.suite.ui.commons.ProcessFlowNode","sap.suite.ui.commons.RepeaterViewConfiguration","sap.suite.ui.commons.SplitButton","sap.suite.ui.commons.statusindicator.StatusIndicator","sap.suite.ui.commons.statusindicator.ShapeGroup","sap.suite.ui.commons.statusindicator.Shape","sap.suite.ui.commons.statusindicator.Rectangle","sap.suite.ui.commons.statusindicator.Circle","sap.suite.ui.commons.statusindicator.CustomShape","sap.suite.ui.commons.statusindicator.PropertyThreshold","sap.suite.ui.commons.statusindicator.DiscreteThreshold","sap.suite.ui.commons.statusindicator.LibraryShape","sap.suite.ui.commons.taccount.TAccount","sap.suite.ui.commons.TargetFilter","sap.suite.ui.commons.ThingCollection","sap.suite.ui.commons.ThreePanelThingInspector","sap.suite.ui.commons.ThreePanelThingViewer","sap.suite.ui.commons.TileContent","sap.suite.ui.commons.TileContent2X2","sap.suite.ui.commons.Timeline","sap.suite.ui.commons.TimelineFilterListItem","sap.suite.ui.commons.TimelineItem","sap.suite.ui.commons.UnifiedThingGroup","sap.suite.ui.commons.UnifiedThingInspector","sap.suite.ui.commons.VerticalNavigationBar","sap.suite.ui.commons.ViewRepeater"],elements:["sap.suite.ui.commons.BulletChartData","sap.suite.ui.commons.ColumnData","sap.suite.ui.commons.ColumnMicroChartLabel","sap.suite.ui.commons.ComparisonData","sap.suite.ui.commons.CountingNavigationItem","sap.suite.ui.commons.FeedItem","sap.suite.ui.commons.HarveyBallMicroChartItem","sap.suite.ui.commons.HeaderCellItem","sap.suite.ui.commons.imageeditor.CustomSizeItem","sap.suite.ui.commons.MicroAreaChartItem","sap.suite.ui.commons.MicroAreaChartLabel","sap.suite.ui.commons.MicroAreaChartPoint","sap.suite.ui.commons.TargetFilterColumn","sap.suite.ui.commons.TargetFilterMeasureColumn","sap.suite.ui.commons.AriaProperties"],version:"1.88.0",extensions:{flChangeHandlers:{"sap.suite.ui.commons.Timeline":"sap/suite/ui/commons/flexibility/Timeline"}}});sap.suite.ui.commons.BulletChartMode={Actual:"Actual",Delta:"Delta"};sap.suite.ui.commons.CommonBackground={Lightest:"Lightest",ExtraLight:"ExtraLight",Light:"Light",MediumLight:"MediumLight",Medium:"Medium",Dark:"Dark",ExtraDark:"ExtraDark",Darkest:"Darkest"};sap.suite.ui.commons.ComparisonChartView={Normal:"Normal",Wide:"Wide"};sap.suite.ui.commons.CalculationBuilderComparisonOperatorType={"<":"<",">":">","<=":"<=",">=":">=","=":"=","!=":"!="};sap.suite.ui.commons.CalculationBuilderFunctionType={ABS:"ABS",Round:"ROUND",RoundUp:"RoundUp",RoundDown:"RoundDown",Case:"CASE",SQRT:"SQRT",NDIV0:"NDIV0",NODIM:"NODIM",SUMCT:"SUMCT",SUMGT:"SUMGT",SUMRT:"SUMRT"};sap.suite.ui.commons.CalculationBuilderItemType={Operator:"Operator",CustomOperator:"CustomOperator",Variable:"Variable",Constant:"Constant",Literal:"Literal",Function:"Function",CustomFunction:"CustomFunction",Empty:"Empty",Error:"Error"};sap.suite.ui.commons.CalculationBuilderLogicalOperatorType={AND:"AND",OR:"OR",XOR:"XOR",NOT:"NOT"};sap.suite.ui.commons.CalculationBuilderLayoutType={Default:"Default",VisualTextualReadOnly:"VisualTextualReadOnly",VisualOnly:"VisualOnly",TextualOnly:"TextualOnly"};sap.suite.ui.commons.CalculationBuilderOperatorType={"+":"+","-":"-","/":"/","*":"*","(":"(",")":")",",":","};sap.suite.ui.commons.CalculationBuilderValidationMode={FocusOut:"FocusOut",LiveChange:"LiveChange"};sap.suite.ui.commons.DeviationIndicator={Up:"Up",Down:"Down",None:"None"};sap.suite.ui.commons.FacetOverviewHeight={XS:"XS",S:"S",M:"M",L:"L",XL:"XL",XXL:"XXL",Auto:"Auto",None:"None"};sap.suite.ui.commons.FrameType={OneByOne:"OneByOne",TwoByOne:"TwoByOne",TwoThirds:"TwoThirds",Auto:"Auto"};sap.suite.ui.commons.HeaderContainerView={Horizontal:"Horizontal",Vertical:"Vertical"};sap.suite.ui.commons.InfoTileSize={XS:"XS",S:"S",M:"M",L:"L",Auto:"Auto"};sap.suite.ui.commons.InfoTileTextColor={Positive:"Positive",Critical:"Critical",Negative:"Negative"};sap.suite.ui.commons.InfoTileValueColor={Neutral:"Neutral",Good:"Good",Critical:"Critical",Error:"Error"};sap.suite.ui.commons.LoadState={Loading:"Loading",Loaded:"Loaded",Failed:"Failed",Disabled:"Disabled"};sap.suite.ui.commons.MicroAreaChartView={Normal:"Normal",Wide:"Wide"};sap.suite.ui.commons.MicroProcessFlowRenderType={Wrap:"Wrap",NoWrap:"NoWrap",Scrolling:"Scrolling",ScrollingWithResizer:"ScrollingWithResizer"};sap.suite.ui.commons.networkgraph.BackgroundColor={Default:"Default",White:"White"};sap.suite.ui.commons.networkgraph.ActionButtonPosition={Left:"Left",Right:"Right"};sap.suite.ui.commons.networkgraph.NodeShape={Circle:"Circle",Box:"Box",Custom:"Custom"};sap.suite.ui.commons.networkgraph.LineType={Solid:"Solid",Dashed:"Dashed",Dotted:"Dotted"};sap.suite.ui.commons.networkgraph.NodePlacement={BrandesKoepf:"BrandesKoepf",LinearSegments:"LinearSegments",Simple:"Simple"};sap.suite.ui.commons.networkgraph.ElementStatus={Standard:"Standard",Success:"Success",Warning:"Warning",Error:"Error",Information:"Information"};sap.suite.ui.commons.networkgraph.Orientation={LeftRight:"LeftRight",RightLeft:"RightLeft",TopBottom:"TopBottom",BottomTop:"BottomTop"};sap.suite.ui.commons.networkgraph.RenderType={Html:"Html",Svg:"Svg"};sap.suite.ui.commons.networkgraph.LineArrowOrientation={ParentOf:"ParentOf",ChildOf:"ChildOf",None:"None",Both:"Both"};sap.suite.ui.commons.networkgraph.LineArrowPosition={Start:"Start",Middle:"Middle",End:"End"};sap.suite.ui.commons.networkgraph.LayoutRenderType={LayeredWithGroups:"LayeredWithGroups",SwimLanes:"SwimLanes",Forces:"Forces",TwoColumns:"TwoColumns"};sap.suite.ui.commons.networkgraph.HeaderCheckboxState={Hidden:"Hidden",Checked:"Checked",Unchecked:"Unchecked"};sap.suite.ui.commons.ProcessFlowConnectionLabelState={Neutral:"Neutral",Positive:"Positive",Critical:"Critical",Negative:"Negative"};sap.suite.ui.commons.ProcessFlowConnectionState={Highlighted:"Highlighted",Dimmed:"Dimmed",Regular:"Regular",Selected:"Selected"};sap.suite.ui.commons.ProcessFlowConnectionType={Planned:"Planned",Normal:"Normal"};sap.suite.ui.commons.ProcessFlowDisplayState={Regular:"Regular",RegularFocused:"RegularFocused",Highlighted:"Highlighted",HighlightedFocused:"HighlightedFocused",Dimmed:"Dimmed",DimmedFocused:"DimmedFocused",Selected:"Selected",SelectedHighlighted:"SelectedHighlighted",SelectedHighlightedFocused:"SelectedHighlightedFocused",SelectedFocused:"SelectedFocused"};sap.suite.ui.commons.ProcessFlowLaneState={value:"value",state:"state"};sap.suite.ui.commons.ProcessFlowNodeState={Positive:"Positive",Negative:"Negative",Critical:"Critical",Planned:"Planned",Neutral:"Neutral",PlannedNegative:"PlannedNegative"};sap.suite.ui.commons.ProcessFlowNodeType={Single:"Single",Aggregated:"Aggregated"};sap.suite.ui.commons.ProcessFlowZoomLevel={One:"One",Two:"Two",Three:"Three",Four:"Four"};sap.suite.ui.commons.SelectionState={Selected:"Selected",NotSelected:"NotSelected",Semantic:"Semantic"};sap.suite.ui.commons.statusindicator.FillingDirectionType={Up:"Up",Down:"Down",Left:"Left",Right:"Right",Clockwise:"Clockwise",CounterClockwise:"CounterClockwise"};sap.suite.ui.commons.taccount.TAccountPanelState={Default:"Default",Table:"Table"};sap.suite.ui.commons.statusindicator.HorizontalAlignmentType={Left:"Left",Middle:"Middle",Right:"Right"};sap.suite.ui.commons.statusindicator.VerticalAlignmentType={Top:"Top",Middle:"Middle",Bottom:"Bottom"};sap.suite.ui.commons.statusindicator.SizeType={None:"None",Small:"Small",Medium:"Medium",Large:"Large",ExtraLarge:"ExtraLarge"};sap.suite.ui.commons.statusindicator.LabelPositionType={Top:"Top",Right:"Right",Bottom:"Bottom",Left:"Left"};sap.suite.ui.commons.statusindicator.FillingType={Linear:"Linear",Radial:"Radial",Circular:"Circular",None:"None"};sap.suite.ui.commons.ThingGroupDesign={ZeroIndent:"ZeroIndent",TopIndent:"TopIndent"};sap.suite.ui.commons.TimelineAlignment={Right:"Right",Left:"Left",Top:"Top",Bottom:"Bottom"};sap.suite.ui.commons.TimelineAxisOrientation={Vertical:"Vertical",Horizontal:"Horizontal"};sap.suite.ui.commons.TimelineFilterType={Data:"Data",Time:"Time",Search:"Search"};sap.suite.ui.commons.TimelineGroupType={None:"None",Year:"Year",Month:"Month",Quarter:"Quarter",Week:"Week",Day:"Day"};sap.suite.ui.commons.TimelineScrollingFadeout={None:"None",Area:"Area",AreaWithButtons:"AreaWithButtons"};sap.suite.ui.commons.ValueStatus={Good:"Good",Neutral:"Neutral",Critical:"Critical",Bad:"Bad"};sap.suite.ui.commons.ImageEditorMode={Resize:"Resize",CropRectangle:"CropRectangle",CropEllipse:"CropEllipse",CropCustomShape:"CropCustomShape",Default:"Default"};sap.suite.ui.commons.ImageEditorContainerMode={Transform:"Transform",Crop:"Crop",Filter:"Filter"};sap.suite.ui.commons.ImageFormat={Png:"Png",Jpeg:"Jpeg"};sap.suite.ui.commons.ImageEditorContainerButton={Transform:"Transform",Crop:"Crop",Filter:"Filter"};return sap.suite.ui.commons;});
// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.predefine('sap/ushell/components/tiles/cdm/applauncher/Component',["sap/ui/core/UIComponent","sap/ui/core/library"],function(U,c){"use strict";var V=c.mvc.ViewType;return U.extend("sap.ushell.components.tiles.cdm.applauncher.Component",{metadata:{},createContent:function(){var C=this.getComponentData();var p=C.properties.tilePersonalization||{};var s=C.startupParameters;if(s&&s["sap-system"]){p["sap-system"]=s["sap-system"][0];}var t=sap.ui.view({type:V.JS,viewName:"sap.ushell.components.tiles.cdm.applauncher.StaticTile",viewData:{properties:C.properties,configuration:p},async:true});t.loaded().then(function(v){this._oController=t.getController();}.bind(this));return t;},tileSetVisualProperties:function(n){if(this._oController){this._oController.updatePropertiesHandler(n);}},tileRefresh:function(){},tileSetVisible:function(i){},exit:function(){this._oController=null;}});});
sap.ui.predefine('sap/ushell/components/tiles/cdm/applauncher/StaticTile.controller',["sap/ushell/library","sap/ui/core/mvc/Controller","sap/ushell/Config","sap/ushell/services/AppType","sap/ushell/utils/WindowUtils","sap/ui/model/json/JSONModel","sap/m/library","sap/base/Log"],function(u,C,a,A,W,J,m,L){"use strict";var G=m.GenericTileScope;var b=m.GenericTileMode;var D=u.DisplayFormat;return C.extend("sap.ushell.components.tiles.cdm.applauncher.StaticTile",{_aDoableObject:{},_getConfiguration:function(){var c=this.getView().getViewData();c.properties.sizeBehavior=a.last("/core/home/sizeBehavior");c.properties.wrappingType=a.last("/core/home/wrappingType");return c;},onInit:function(){var v=this.getView();var M=new J();M.setData(this._getConfiguration());v.setModel(M);this._aDoableObject=a.on("/core/home/sizeBehavior").do(function(s){M.setProperty("/properties/sizeBehavior",s);});var V=this.getView().getViewData();var o=V.properties;var c=V.properties.contentProviderId;o.mode=o.mode||(o.icon?"ContentMode":"HeaderMode");if(o.displayFormat===D.Compact&&o.title&&o.targetURL){M.setProperty("/properties/mode",b.LineMode);}switch(o.displayFormat){case D.Flat:M.setProperty("/properties/frameType","OneByHalf");break;case D.FlatWide:M.setProperty("/properties/frameType","TwoByHalf");break;case D.StandardWide:M.setProperty("/properties/frameType","TwoByOne");break;default:{M.setProperty("/properties/frameType","OneByOne");}}if(a.last("/core/contentProviders/providerInfo/show")){sap.ushell.Container.getServiceAsync("ClientSideTargetResolution").then(function(d){return d.getSystemContext(c);}).then(function(s){M.setProperty("/properties/contentProviderLabel",s.label);}).catch(function(e){L.error("StaticTile.controller threw an error:",e);});}},onExit:function(){this._aDoableObject.off();},onPress:function(e){var t=this.getView().getViewData().properties;if(e.getSource().getScope&&e.getSource().getScope()===G.Display){var T=this._createTargetUrl();if(!T){return;}if(T[0]==="#"){hasher.setHash(T);}else{var l=a.last("/core/shell/enableRecentActivity")&&a.last("/core/shell/enableRecentActivityLogging");if(l){var r={title:t.title,appType:A.URL,url:t.targetURL,appId:t.targetURL};sap.ushell.Container.getRenderer("fiori2").logRecentActivity(r);}W.openURL(T,"_blank");}}},updatePropertiesHandler:function(n){var t=this.getView().getContent()[0],T=t.getTileContent()[0];if(typeof n.title!=="undefined"){t.setHeader(n.title);}if(typeof n.subtitle!=="undefined"){t.setSubheader(n.subtitle);}if(typeof n.icon!=="undefined"){T.getContent().setSrc(n.icon);}if(typeof n.info!=="undefined"){T.setFooter(n.info);}},_createTargetUrl:function(){var t=this.getView().getViewData().properties.targetURL,s=this.getView().getViewData().configuration["sap-system"],U,h;if(t&&s){U=sap.ushell.Container.getService("URLParsing");if(U.isIntentUrl(t)){h=U.parseShellHash(t);if(!h.params){h.params={};}h.params["sap-system"]=s;t="#"+U.constructShellHash(h);}else{t+=((t.indexOf("?")<0)?"?":"&")+"sap-system="+s;}}return t;},_getLeanUrl:function(){return W.getLeanURL(this._createTargetUrl());},_getCurrentProperties:function(){var t=this.getView().getContent()[0],T=t.getTileContent()[0],s=a.last("/core/home/sizeBehavior");return{title:t.getHeader(),subtitle:t.getSubheader(),info:T.getFooter(),icon:T.getContent().getSrc(),mode:t.getMode(),sizeBehavior:s};}});},true);
sap.ui.predefine('sap/ushell/components/tiles/cdm/applauncher/StaticTile.view',["sap/m/GenericTile","sap/m/ImageContent","sap/m/TileContent","sap/ui/core/mvc/JSView"],function(G,I,T){"use strict";sap.ui.jsview("sap.ushell.components.tiles.cdm.applauncher.StaticTile",{getControllerName:function(){return"sap.ushell.components.tiles.cdm.applauncher.StaticTile";},createContent:function(c){this.setHeight("100%");this.setWidth("100%");if(this.getContent().length===1){return this.getContent()[0];}return new G({mode:"{/properties/mode}",header:"{/properties/title}",subheader:"{/properties/subtitle}",size:"Auto",sizeBehavior:"{/properties/sizeBehavior}",frameType:"{/properties/frameType}",wrappingType:"{/properties/wrappingType}",url:{path:"/properties/targetURL",formatter:c._getLeanUrl.bind(c)},tileContent:new T({size:"Auto",footer:"{/properties/info}",content:new I({src:"{/properties/icon}"})}),press:[c.onPress,c],additionalTooltip:"{/properties/contentProviderLabel}"});}});});
sap.ui.predefine('sap/ushell/components/tiles/cdm/applauncherdynamic/Component',["sap/ui/core/UIComponent","sap/ui/core/library"],function(U,c){"use strict";var V=c.mvc.ViewType;return U.extend("sap.ushell.components.tiles.cdm.applauncherdynamic.Component",{metadata:{},createContent:function(){var C=this.getComponentData();var p=C.properties||{};var P=p.tilePersonalization||{};var i=p.indicatorDataSource;if(i&&i.path){P.serviceUrl=i.path;P.serviceRefreshInterval=i.refresh;}var s=C.startupParameters;if(s&&s["sap-system"]&&s["sap-system"][0]){P["sap-system"]=s["sap-system"][0];}if(P.serviceUrl&&P.serviceUrl.charAt(0)!=="/"&&p.dataSource&&p.dataSource.uri){var S=p.dataSource.uri;if(P["sap-system"]){if(S.charAt(S.length-1)==="/"){S=S.slice(0,S.length-1);}S+=";o="+P["sap-system"];}if(S.charAt(S.length-1)!=="/"){S+="/";}S+=P.serviceUrl;P.serviceUrl=S;}var t=sap.ui.view({type:V.JS,viewName:"sap.ushell.components.tiles.cdm.applauncherdynamic.DynamicTile",viewData:{properties:p,configuration:P},async:true});this.oPromise=t.loaded().then(function(v){this._oController=v.getController();this._oController.visibleHandler(this.bIsVisible);return v;}.bind(this));return t;},tileSetVisualProperties:function(n){if(this._oController){this._oController.updateVisualPropertiesHandler(n);}},tileRefresh:function(){if(this._oController){this._oController.refreshHandler();}},tileSetVisible:function(i){if(this._oController){this._oController.visibleHandler(i);}else{this.bIsVisible=i;}},exit:function(){this._oController=null;}});});
sap.ui.predefine('sap/ushell/components/tiles/cdm/applauncherdynamic/DynamicTile.controller',["sap/ui/core/mvc/Controller","sap/ushell/components/tiles/utils","sap/ui/core/format/NumberFormat","sap/ushell/Config","sap/ushell/services/AppType","sap/ushell/utils/WindowUtils","sap/ui/model/json/JSONModel","sap/m/library","sap/ushell/library","sap/base/Log","sap/base/util/merge","sap/ushell/utils/DynamicTileRequest"],function(C,u,N,a,A,W,J,m,b,L,c,D){"use strict";var G=m.GenericTileScope;var d=b.DisplayFormat;var e="sap.ushell.components.tiles.cdm.applauncherdynamic.DynamicTile";return C.extend(e,{timer:null,_aDoableObject:{},oDataRequest:null,_getConfiguration:function(v){var o={};var U;var h;o.configuration=v.configuration;o.properties=v.properties;o.properties.info=o.properties.info||"";o.properties.number_value="...";o.properties.number_value_state="Neutral";o.properties.number_state_arrow="None";o.properties.number_factor="";o.properties.number_unit=o.properties.numberUnit||"";var s=o.configuration["sap-system"];var t=o.properties.targetURL;if(t&&s){U=sap.ushell.Container.getService("URLParsing");if(U.isIntentUrl(t)){h=U.parseShellHash(t);if(!h.params){h.params={};}h.params["sap-system"]=s;t="#"+U.constructShellHash(h);}else{t+=((t.indexOf("?")<0)?"?":"&")+"sap-system="+s;}o.properties.targetURL=t;}o.properties.sizeBehavior=a.last("/core/home/sizeBehavior");o.properties.wrappingType=a.last("/core/home/wrappingType");return o;},onInit:function(){var v=this.getView();var M=new J();var V=v.getViewData();var o=V.properties;M.setData(this._getConfiguration(V));var s=o.contentProviderId;if(a.last("/core/contentProviders/providerInfo/show")){this.oSystemContextPromise=sap.ushell.Container.getServiceAsync("ClientSideTargetResolution").then(function(f){return f.getSystemContext(s);}).then(function(S){M.setProperty("/properties/contentProviderLabel",S.label);}).catch(function(E){L.error("DynamicTile.controller threw an error:",E);});}switch(o.displayFormat){case d.Flat:M.setProperty("/properties/frameType","OneByHalf");break;case d.FlatWide:M.setProperty("/properties/frameType","TwoByHalf");break;case d.StandardWide:M.setProperty("/properties/frameType","TwoByOne");break;default:{M.setProperty("/properties/frameType","OneByOne");}}v.setModel(M);this._aDoableObject=a.on("/core/home/sizeBehavior").do(function(S){M.setProperty("/properties/sizeBehavior",S);});},refreshHandler:function(){this.loadData(0);},visibleHandler:function(i){if(i){if(!this.oDataRequest||this.timer===null){this.initUpdateDynamicData();}}else{this.stopRequests();}},updateVisualPropertiesHandler:function(n){var p=this.getView().getModel().getProperty("/properties");var f=false;if(typeof n.title!=="undefined"){p.title=n.title;f=true;}if(typeof n.subtitle!=="undefined"){p.subtitle=n.subtitle;f=true;}if(typeof n.icon!=="undefined"){p.icon=n.icon;f=true;}if(typeof n.targetURL!=="undefined"){p.targetURL=n.targetURL;f=true;}if(typeof n.info!=="undefined"){p.info=n.info;f=true;}if(f){this.getView().getModel().setProperty("/properties",p);}},stopRequests:function(){if(this.timer){clearTimeout(this.timer);this.timer=null;}if(this.oDataRequest){this.oDataRequest.abort();}},onPress:function(E){if(E.getSource().getScope&&E.getSource().getScope()===G.Display){var t=this.getView().getModel().getProperty("/properties/targetURL"),T=this.getView().getModel().getProperty("/properties/title");if(!t){return;}else if(t[0]==="#"){hasher.setHash(t);}else{var l=a.last("/core/shell/enableRecentActivity")&&a.last("/core/shell/enableRecentActivityLogging");if(l){var r={title:T,appType:A.URL,url:t,appId:t};sap.ushell.Container.getRenderer("fiori2").logRecentActivity(r);}W.openURL(t,"_blank");}}},initUpdateDynamicData:function(){var M=this.getView().getModel();var s=M.getProperty("/configuration/serviceUrl");var S=M.getProperty("/configuration/serviceRefreshInterval");if(!S){S=0;}else if(S<10){L.warning("Refresh Interval "+S+" seconds for service URL "+s+" is less than 10 seconds, which is not supported. Increased to 10 seconds automatically.",null,e);S=10;}if(s){this.loadData(S);}},successHandlerFn:function(r){this.updatePropertiesHandler(r);},errorHandlerFn:function(M){var s=M&&M.message?M.message:M;var U=this.getView().getModel().getProperty("/configuration/serviceUrl");if(M.statusText==="Abort"){L.info("Data request from service "+U+" was aborted",null,e);}else{if(M.response){s+=" - "+M.response.statusCode+" "+M.response.statusText;}L.error("Failed to update data via service "+U+": "+s,null,e);this._setTileIntoErrorState();}},_setTileIntoErrorState:function(){var r=u.getResourceBundleModel().getResourceBundle();this.updatePropertiesHandler({number:"???",info:r.getText("dynamic_data.error")});},loadData:function(s){var M=this.getView().getModel();var U=M.getProperty("/configuration/serviceUrl");var f=M.getProperty("/properties/contentProviderId");if(!U){L.error("No service URL given!",e);this._setTileIntoErrorState();return;}if(!this.oDataRequest||this.oDataRequest.sUrl!==U){if(this.oDataRequest){this.oDataRequest.destroy();}this.sRequestUrl=U;this.oDataRequest=new D(U,this.successHandlerFn.bind(this),this.errorHandlerFn.bind(this),f);}else if(this.oDataRequest){this.oDataRequest.refresh();}if(s>0){L.info("Wait "+s+" seconds before calling "+U+" again",null,e);this.timer=setTimeout(this.loadData.bind(this,s),(s*1000));}},onExit:function(){if(this.oDataRequest){this.stopRequests();this.oDataRequest.destroy();}this._aDoableObject.off();},addParamsToUrl:function(U,t){var p="",f=U.indexOf("?")!==-1,i;if(t&&t.length>0){for(i=0;i<t.length;i=i+1){p+=t[i];if(i<t.length-1){p+="&";}}}if(p.length>0){if(!f){U+="?";}else{U+="&";}U+=p;}return U;},_normalizeNumber:function(n,f,g,i){var h;if(isNaN(n)){h=n;}else{var o=N.getFloatInstance({maxFractionDigits:i});if(!g){var j=Math.abs(n);if(j>=1000000000){g="B";n/=1000000000;}else if(j>=1000000){g="M";n/=1000000;}else if(j>=1000){g="K";n/=1000;}}h=o.format(n);}var k=h;var l=k[f-1];f-=(l==="."||l===",")?1:0;k=k.substring(0,f);return{displayNumber:k,numberFactor:g};},updatePropertiesHandler:function(o){var f=u.getResourceBundleModel().getResourceBundle().getText("dynamic_data.error");var p=this.getView().getModel().getProperty("/properties");var U={title:o.title||p.title||"",subtitle:o.subtitle||p.subtitle||"",icon:o.icon||p.icon||"",targetURL:o.targetURL||p.targetURL||"",number_value:!isNaN(o.number)?o.number:"...",number_digits:o.numberDigits>=0?o.numberDigits:4,info:p.info===f?o.info||"":o.info||p.info||"",number_unit:o.numberUnit||p.number_unit||"",number_state_arrow:o.stateArrow||p.number_state_arrow||"None",number_value_state:o.numberState||p.number_value_state||"Neutral",number_factor:o.numberFactor||p.number_factor||""};var t=[];if(o.targetParams){t.push(o.targetParams);}if(o.results){var s,g,i,n;var h=0;for(i=0,n=o.results.length;i<n;i=i+1){g=o.results[i].number||0;if(typeof g==="string"){g=parseInt(g,10);}h=h+g;s=o.results[i].targetParams;if(s){t.push(s);}}U.number_value=h;}if(t.length>0){U.targetURL=this.addParamsToUrl(U.targetURL,t);}if(!isNaN(o.number)){if(typeof o.number==="string"){o.number=o.number.trim();}var S=this._shouldProcessDigits(o.number,o.numberDigits),j=U.icon?4:5;if(o.number&&o.number.length>=j||S){var k=this._normalizeNumber(o.number,j,o.numberFactor,o.numberDigits);U.number_factor=k.numberFactor;U.number_value=k.displayNumber;}else{var l=N.getFloatInstance({maxFractionDigits:j});U.number_value=l.format(o.number);}}if(U.number_value_state){switch(U.number_value_state){case"Positive":U.number_value_state="Good";break;case"Negative":U.number_value_state="Error";break;default:}}U.sizeBehavior=a.last("/core/home/sizeBehavior");c(p,U);this.getView().getModel().refresh();},_shouldProcessDigits:function(s,i){var n;s=typeof(s)!=="string"?s.toString():s;if(s.indexOf(".")!==-1){n=s.split(".")[1].length;if(n>i){return true;}}return false;},formatters:{leanURL:W.getLeanURL}});},true);
sap.ui.predefine('sap/ushell/components/tiles/cdm/applauncherdynamic/DynamicTile.view',["sap/m/GenericTile","sap/m/TileContent","sap/m/NumericContent","sap/m/library"],function(G,T,N,m){"use strict";var V=m.ValueColor;sap.ui.jsview("sap.ushell.components.tiles.cdm.applauncherdynamic.DynamicTile",{getControllerName:function(){return"sap.ushell.components.tiles.cdm.applauncherdynamic.DynamicTile";},createContent:function(c){this.setHeight("100%");this.setWidth("100%");if(this.getContent().length===1){return this.getContent()[0];}return new G({size:"Auto",header:"{/properties/title}",subheader:"{/properties/subtitle}",sizeBehavior:"{/properties/sizeBehavior}",frameType:"{/properties/frameType}",wrappingType:"{/properties/wrappingType}",url:{parts:["/properties/targetURL"],formatter:c.formatters&&c.formatters.leanURL},tileContent:[new T({size:"Auto",footer:"{/properties/info}",footerColor:{path:"/data/display_info_state",formatter:function(f){if(!V[f]){f=V.Neutral;}return f;}},unit:"{/properties/number_unit}",content:[new N({truncateValueTo:5,scale:"{/properties/number_factor}",value:"{/properties/number_value}",indicator:"{/properties/number_state_arrow}",valueColor:{path:"/properties/number_value_state",formatter:function(s){if(!s||s==="Neutral"||!V[s]){return V.None;}return s;}},icon:"{/properties/icon}",withMargin:false,width:"100%"})]})],additionalTooltip:"{/properties/contentProviderLabel}",press:[c.onPress,c]});}});});
sap.ui.predefine('sap/ushell/components/tiles/generic',["sap/ui/core/mvc/Controller","sap/ui/model/analytics/odata4analytics","sap/ushell/components/tiles/indicatorTileUtils/smartBusinessUtil","sap/ushell/components/tiles/sbtilecontent","sap/m/library","sap/ui/core/format/DateFormat","sap/m/MessageToast","sap/ui/model/json/JSONModel","sap/ui/thirdparty/jquery","sap/base/Log"],function(C,o,s,a,m,D,M,J,q,L){"use strict";var b=m.DeviationIndicator;var V=m.ValueColor;var F=m.FrameType;var c=m.LoadState;var g=C.extend("sap.ushell.components.tiles.generic",{getTile:function(){return this.oKpiTileView.oGenericTile;},_updateTileModel:function(n){var d=this.getTile().getModel().getData();q.extend(d,n);this.getTile().getModel().setData(d);},logError:function(e){this._updateTileModel({value:"",scale:"",unit:""});L.error(e);if(this.getView().getViewData().deferredObj){this.getView().getViewData().deferredObj.reject();}else{this.oKpiTileView.oGenericTile.setState(c.Failed);}},getKeyForCallCheck:function(){if(this.oKpiTileView.getViewName()=="sap.ushell.components.tiles.indicatornumeric.NumericTile"){return this.oConfig.TILE_PROPERTIES.id+"left";}return this.oConfig.TILE_PROPERTIES.id+"right";},getRelativeTime:function(){var d=sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate(),t;if(q.type(this.cacheTime)=="date"){t=this.cacheTime;}else{t=new Date(parseInt(this.cacheTime.substr(6),10));}var r=sap.ushell.components.tiles.indicatorTileUtils.util.getTimeDifference(d-t),e,f;switch(r.unit){case"minutes":f=sap.ushell.components.tiles.indicatorTileUtils.util.getMillisecond(r.time,"minutes");d=d-f;e=new Date(d);break;case"hours":f=sap.ushell.components.tiles.indicatorTileUtils.util.getMillisecond(r.time,"hours");d=d-f;e=new Date(d);break;case"days":f=sap.ushell.components.tiles.indicatorTileUtils.util.getMillisecond(r.time,"days");d=d-f;e=new Date(d);break;}return e;},setTimeStamp:function(){this.updateTimeStampjobScheduled=false;var f=D.getDateTimeInstance({relative:true,relativeSource:"auto",style:"short"});var t=f.format(this.getRelativeTime());this.oKpiTileView.oNVConfS.setRefreshOption(true);this.oKpiTileView.oNVConfS.setTimestamp(t);this.updateTimeStampjobScheduled=false;var k=this.oConfig.TILE_PROPERTIES.id+"time";var r=sap.ushell.components.tiles.indicatorTileUtils.util.getScheduledJob(k);if(r){clearTimeout(r);r=undefined;}sap.ushell.components.tiles.indicatorTileUtils.util.scheduleTimeStampJob.call(this,this.oTileApi.visible.isVisible());},isACurrencyMeasure:function(d){var e=this.DEFINITION_DATA.EVALUATION.ODATA_ENTITYSET;return sap.ushell.components.tiles.indicatorTileUtils.util.getFormattingMetadata(this.oRunTimeODataModel,e,d)._hasCurrency;},isCurrencyMeasure:function(d){var t=this;var e=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);if(e&&e.Data){var k=e.Data&&JSON.parse(e.Data);if(sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){if(t.oKpiTileView.getViewName()=="sap.ushell.components.tiles.indicatornumeric.NumericTile"){k=k.leftData;}else{k=k.rightData;}}if(t.oKpiTileView.getViewName()=="sap.ushell.components.tiles.indicatorcomparison.ComparisonTile"||t.oConfig.TILE_PROPERTIES.tileType==="CM"){if(k&&k.data&&k.data.length){for(var i=0;i<k.data.length;i++){if(k.data[i]&&k.data[i].measure==d){if(q.type(k.data[i].isCurM)=="boolean"){return k.data[i].isCurM;}return t.isACurrencyMeasure(d);}return t.isACurrencyMeasure(d);}}else{return t.isACurrencyMeasure(d);}}if(k&&q.type(k.isCurM)=="boolean"){return k.isCurM;}return t.isACurrencyMeasure(d);}return t.isACurrencyMeasure(d);},formSelectStatement:function(d){var t=Object.keys(d);var f="";for(var i=0;i<t.length;i++){if((d[t[i]]!==undefined)&&(d.fullyFormedMeasure)){f=f+","+d[t[i]];}}return f;},setThresholdValues:function(){var t=this;try{var T={};T.fullyFormedMeasure=this.DEFINITION_DATA.EVALUATION.COLUMN_NAME;if(this.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){var d=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);switch(this.DEFINITION_DATA.EVALUATION.GOAL_TYPE){case"MI":T.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");T.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);if(d&&d.Data&&d.Data.length){d.Data=JSON.parse(d.Data);T.trendValue=Number(d.Data.trend);T.targetValue=Number(d.Data.target);T.criticalHighValue=Number(d.Data.ch);T.warningHighValue=Number(d.Data.wh);d.Data=JSON.stringify(d.Data);}break;case"MA":T.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");T.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);if(d&&d.Data&&d.Data.length){d.Data=JSON.parse(d.Data);T.criticalLowValue=Number(d.Data.cl);T.warningLowValue=Number(d.Data.wl);T.trendValue=Number(d.Data.trend);T.targetValue=Number(d.Data.target);d.Data=JSON.stringify(d.Data);}break;case"RA":T.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");T.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");T.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);if(d&&d.Data&&d.Data.length){d.Data=JSON.parse(d.Data);T.criticalLowValue=Number(d.Data.cl);T.warningLowValue=Number(d.Data.wl);T.trendValue=Number(d.Data.trend);T.targetValue=Number(d.Data.target);T.criticalHighValue=Number(d.Data.ch);T.warningHighValue=Number(d.Data.wh);d.Data=JSON.stringify(d.Data);}break;}}else if(this.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="RELATIVE"){T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);T.criticalHighValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","FIXED");T.criticalLowValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","FIXED");T.warningHighValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","FIXED");T.warningLowValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","FIXED");}else{T.criticalHighValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","FIXED");T.criticalLowValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","FIXED");T.warningHighValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","FIXED");T.warningLowValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","FIXED");T.targetValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","FIXED");T.trendValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","FIXED");}return T;}catch(e){t.logError(e);}},setNoData:function(){var v=this.getView().getViewData();if(v.parentController){v.parentController.setNoData();if(v.deferredObj){v.deferredObj.resolve();}}else{try{this._updateTileModel({value:"",scale:"",unit:"",footerNum:this.oResourceBundle.getText("sb.noDataAvailable"),footerComp:this.oResourceBundle.getText("sb.noDataAvailable")});this.oKpiTileView.oGenericTile.setState(c.Loaded);}catch(e){}}},getLocalCache:function(d){var l={};l.ChipId=d.ChipId;l.Data=d.Data;l.CacheMaxAge=d.CacheMaxAgeUnit;l.CacheMaxAgeUnit=d.CacheMaxAgeUnit;l.CacheType=d.CacheType;l.CachedTime=sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate();return l;},fetchKpiValue:function(d,E,r,A){var t=this;var k=0;try{var f=this.DEFINITION_DATA.EVALUATION.ODATA_ENTITYSET;var T=this.setThresholdValues();var h=T.fullyFormedMeasure;var i=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);var j=t.oTileApi.configuration.getParameterValueAsString("timeStamp");var l=sap.ushell.components.tiles.indicatorTileUtils.util.isCacheValid(t.oConfig.TILE_PROPERTIES.id,j,t.chipCacheTime,t.chipCacheTimeUnit,t.tilePressed);var n=sap.ushell.components.tiles.indicatorTileUtils.util.getBoolValue(r);var p=this.getKeyForCallCheck();var u=true;if(sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){u=sap.ushell.components.tiles.indicatorTileUtils.util.isCallInProgress(p);if(u==undefined){u=true;}}if(u){if((!i||(!l&&t.oTileApi.visible.isVisible())||n||(A&&t.oTileApi.visible.isVisible())||t.getView().getViewData().refresh)){sap.ushell.components.tiles.indicatorTileUtils.util.setUnsetCallInProgress(p,false);if(t.kpiValueFetchDeferred){t.kpiValueFetchDeferred=false;var v=sap.ushell.components.tiles.indicatorTileUtils.util.prepareFilterStructure(this.DEFINITION_DATA.EVALUATION_FILTERS,this.DEFINITION_DATA.ADDITIONAL_FILTERS);var Q=sap.ushell.components.tiles.indicatorTileUtils.util.prepareQueryServiceUri(t.oRunTimeODataModel,f,h,null,v);if(Q){this.QUERY_SERVICE_MODEL=Q.model;this.queryUriForKpiValue=Q.uri;this.queryServiceUriODataReadRef=this.QUERY_SERVICE_MODEL.read(Q.uri,null,null,true,function(x){t.backEndCallMade=true;t.kpiValueFetchDeferred=true;sap.ushell.components.tiles.indicatorTileUtils.util.setUnsetCallInProgress(p,true);if(x&&x.results&&x.results.length&&x.results[0][t.DEFINITION_DATA.EVALUATION.COLUMN_NAME]!=null){k=x.results[0][t.DEFINITION_DATA.EVALUATION.COLUMN_NAME];var y={};if(Q.unit[0]){t._updateTileModel({unit:x.results[0][Q.unit[0].name]});y.uom=x.results[0][Q.unit[0].name];}if(t.oConfig.TILE_PROPERTIES.frameType=="TwoByOne"){y.numericValue=k;}else{y.value=k;}if(t.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){T.criticalHighValue=x.results[0][T.sCriticalHigh];T.criticalLowValue=x.results[0][T.sCriticalLow];T.warningHighValue=x.results[0][T.sWarningHigh];T.warningLowValue=x.results[0][T.sWarningLow];T.targetValue=x.results[0][T.sTarget];T.trendValue=x.results[0][T.sTrend];}else if(t.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="RELATIVE"){T.targetValue=Number(x.results[0][T.sTarget]);T.criticalHighValue=T.targetValue*T.criticalHighValue/100;T.criticalLowValue=T.targetValue*T.criticalLowValue/100;T.warningHighValue=T.targetValue*T.warningHighValue/100;T.warningLowValue=T.targetValue*T.warningLowValue/100;T.trendValue=Number(x.results[0][T.sTrend]);}y.cl=T.criticalLowValue;y.ch=T.criticalHighValue;y.wl=T.warningLowValue;y.wh=T.warningHighValue;y.trend=T.trendValue;y.target=T.targetValue;y.isCurM=t.isCurrencyMeasure(t.oConfig.EVALUATION.COLUMN_NAME);var z={};z.ChipId=t.oConfig.TILE_PROPERTIES.id;z.Data=JSON.stringify(y);z.CacheMaxAge=Number(t.chipCacheTime);z.CacheMaxAgeUnit=t.chipCacheTimeUnit;z.CacheType=1;var B=t.getLocalCache(z);if(!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,B);var U=false;if(i){U=true;}if(t.chipCacheTime){sap.ushell.components.tiles.indicatorTileUtils.util.writeFrontendCacheByChipAndUserId(t.oTileApi,t.oConfig.TILE_PROPERTIES.id,z,U,function(x){if(x){t.cacheTime=x&&x.CachedTime;sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,x);t.setTimeStamp(t.cacheTime);}if(t.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){q.proxy(t.setTimeStamp(t.cacheTime),t);}});}}else{var G=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id),H;if(G){if(!G.CachedTime){G.CachedTime=sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate();}H=G.Data;if(H){H=JSON.parse(H);if(t.oKpiTileView.getViewName()=="sap.ushell.components.tiles.indicatornumeric.NumericTile"){H.leftData=y;}else{H.rightData=y;}}G.Data=JSON.stringify(H);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,G);}else{H={};if(t.oKpiTileView.getViewName()=="sap.ushell.components.tiles.indicatornumeric.NumericTile"){H.leftData=y;}else{H.rightData=y;}B.Data=JSON.stringify(H);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,B);}t.cacheWriteData=y;}t.cacheTime=sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate();t.updateDatajobScheduled=false;var I=t.oConfig.TILE_PROPERTIES.id+"data";var K=sap.ushell.components.tiles.indicatorTileUtils.util.getScheduledJob(I);if(K){clearTimeout(K);K=undefined;}d.call(t,k,T);}else{sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,{empty:"empty"});t.setNoData();}},function(x){t.kpiValueFetchDeferred=true;sap.ushell.components.tiles.indicatorTileUtils.util.setUnsetCallInProgress(p,true);if(x&&x.response){L.error(x.message+" : "+x.request.requestUri);E.call(t,x);}});}else{t.kpiValueFetchDeferred=true;sap.ushell.components.tiles.indicatorTileUtils.util.setUnsetCallInProgress(p,true);t.logError("Error Preparing Query Service URI");}}}else if(t.DEFINITION_DATA.TILE_PROPERTIES.frameType==F.OneByOne){var w;if(i&&i.Data){w=i.Data&&JSON.parse(i.Data);k=w.value;if(w.uom){t._updateTileModel({unit:w.uom});}if(t.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){T.criticalHighValue=w.ch;T.criticalLowValue=w.cl;T.warningHighValue=w.wh;T.warningLowValue=w.wl;T.targetValue=w.target;T.trendValue=w.trend;}else if(t.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="RELATIVE"){T.targetValue=Number(w.target);T.criticalHighValue=T.targetValue*T.ch/100;T.criticalLowValue=T.targetValue*T.cl/100;T.warningHighValue=T.targetValue*T.wh/100;T.warningLowValue=T.targetValue*T.wl/100;T.trendValue=Number(w.trend);}t.cacheTime=i.CachedTime;if(t.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){q.proxy(t.setTimeStamp(i.CachedTime),t);}d.call(t,k,T);}else{t.setNoData();}}else if(i&&i.Data){w=i.Data&&JSON.parse(i.Data);if(t.oKpiTileView.getViewName()=="sap.ushell.components.tiles.indicatornumeric.NumericTile"){w=w.leftData;}else{w=w.rightData;}k=w.numericValue;if(w.unit){t._updateTileModel({unit:w.unit});}if(t.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){T.criticalHighValue=w.ch;T.criticalLowValue=w.cl;T.warningHighValue=w.wh;T.warningLowValue=w.wl;T.targetValue=w.target;T.trendValue=w.trend;}else if(t.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="RELATIVE"){T.targetValue=Number(w.target);T.criticalHighValue=T.targetValue*T.criticalHighValue/100;T.criticalLowValue=T.targetValue*T.criticalLowValue/100;T.warningHighValue=T.targetValue*T.warningHighValue/100;T.warningLowValue=T.targetValue*T.warningLowValue/100;T.trendValue=Number(w.trend);}t.cacheTime=i.CachedTime;if(t.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){q.proxy(t.setTimeStamp(i.CachedTime),t);}d.call(t,k,T);}else{t.setNoData();}}}catch(e){t.logError(e);}},getRunTimeODataModel:function(u,S){if(window["sap-ushell-config"].cacheBusting){u=sap.ushell.components.tiles.indicatorTileUtils.util.cacheBustingMechanism(u);}if(!this.oRunTimeODataModel){this.oRunTimeODataModel=sap.ushell.components.tiles.indicatorTileUtils.util.getODataModelByServiceUri(u);}if(this.oRunTimeODataModel.getServiceMetadata()){S();}else{this.oRunTimeODataModel.attachMetadataLoaded(S);}},parse_sapclient:function(){var i,S,r,f,d;S="P_SAPClient";r="$$$";f=this.oConfig.EVALUATION_FILTERS;if(f.constructor!==Array){return;}if(f.length<1){return;}for(i in f){d=f[i];if(d.NAME===S&&d.VALUE_1===r){break;}d=null;}if(d){q.when(sap.ushell.components.tiles.indicatorTileUtils.util.getHanaClient()).done(function(e){d.VALUE_1=e;});}},fetchEvaluation:function(d,f,r,i){var t=this;var p=this.oConfig.TILE_PROPERTIES.sb_metadata||"HANA";t.DEFINITION_DATA=d;t._updateTileModel(this.DEFINITION_DATA);var h=sap.ushell.components.tiles.indicatorTileUtils.util.getBoolValue(r);if((t.oTileApi.visible.isVisible()&&!t.firstTimeVisible)||h||i){q.when(sap.ushell.components.tiles.indicatorTileUtils.util.getFrontendCache(d,t.oTileApi)).done(function(j){t.firstTimeVisible=true;j=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);if(j||Number(t.oTileApi.configuration.getParameterValueAsString("isSufficient"))){f.call();}else{try{if(!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)||!t.dataCallInProgress){t.dataCallInProgress=true;var k=sap.ushell.components.tiles.indicatorTileUtils.cache.getEvaluationById(t.oConfig.TILE_PROPERTIES.id);if(k){t.oConfig.EVALUATION_FILTERS=k.EVALUATION_FILTERS;f.call();}else if(t.evaluationFetchDeferred){t.evaluationFetchDeferred=false;sap.ushell.components.tiles.indicatorTileUtils.util.getFilterFromRunTimeService(t.oConfig,t.oTileApi,function(l){t.evaluationFetchDeferred=true;t.oConfig.EVALUATION_FILTERS=l;if(p.toUpperCase()==="HANA"){t.parse_sapclient();}sap.ushell.components.tiles.indicatorTileUtils.cache.setEvaluationById(t.oConfig.TILE_PROPERTIES.id,t.oConfig);f.call();});}}}catch(e){t.evaluationFetchDeferred=true;t.logError("no evaluation data");}}}).fail(function(){t.firstTimeVisible=true;if(Number(t.oTileApi.configuration.getParameterValueAsString("isSufficient"))){f.call();}else{try{var j=sap.ushell.components.tiles.indicatorTileUtils.cache.getEvaluationById(t.oConfig.TILE_PROPERTIES.id);if(j){t.oConfig.EVALUATION_FILTERS=j.EVALUATION_FILTERS;f.call();}else{sap.ushell.components.tiles.indicatorTileUtils.util.getFilterFromRunTimeService(t.oConfig,t.oTileApi,function(k){t.oConfig.EVALUATION_FILTERS=k;if(p.toUpperCase()==="HANA"){t.parse_sapclient();}sap.ushell.components.tiles.indicatorTileUtils.cache.setEvaluationById(t.oConfig.TILE_PROPERTIES.id,t.oConfig);f.call();});}}catch(e){t.logError("no evaluation data");}}});}},refreshHandler:function(r,A){var t=this;var i=sap.ushell.components.tiles.indicatorTileUtils.util.getBoolValue(r);var d=sap.ushell.components.tiles.indicatorTileUtils.util.getBoolValue(A);if(!t.firstTimeVisible||i||d){t.fetchEvaluation(t.oConfig,function(){var u;if(t.oConfig.TILE_PROPERTIES.tileType=="NT"||t.oConfig.TILE_PROPERTIES.tileType=="AT"||t.oKpiTileView.getViewName()=="sap.ushell.components.tiles.indicatornumeric.NumericTile"||t.oKpiTileView.getViewName()=="sap.ushell.components.tiles.indicatordeviation.DeviationTile"){u=t.oTileApi.url.addSystemToServiceUrl(t.oConfig.EVALUATION.ODATA_URL);t.getRunTimeODataModel(u,function(){if(t.KPI_VALUE_REQUIRED){t.fetchKpiValue(function(k,T){this.KPIVALUE=k;t.doProcess(k,T);},t.logError,r,d);}else{t.doProcess();}});}else{u=t.oTileApi.url.addSystemToServiceUrl(t.oConfig.EVALUATION.ODATA_URL);t.getRunTimeODataModel(u,function(){if(t.KPI_VALUE_REQUIRED){t.doProcess(t.KPIVALUE,t.setThresholdValues());}else{t.doProcess(i,d);}});}},r,d);}},visibleHandler:function(i){if(!i){this.firstTimeVisible=false;sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.queryServiceUriODataReadRef);sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.trendChartODataReadRef);sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.comparisionChartODataRef);}if(i){this.refreshHandler(this);}},getChipConfiguration:function(d){var t=this;try{sap.ushell.components.tiles.indicatorTileUtils.util.getParsedChip(t.oTileApi.configuration.getParameterValueAsString("tileConfiguration"),t.oTileApi.preview.isEnabled(),function(f){t.oConfig=f;var h=sap.ushell.components.tiles.indicatorTileUtils.util.getChipTitle(t.oConfig);var i=sap.ushell.components.tiles.indicatorTileUtils.util.getChipSubTitle(t.oConfig);if(t.oTileApi.search){t.oTileApi.search.setKeywords([h,i]);}if(t.oTileApi.preview){t.oTileApi.preview.setTargetUrl(sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system));}d.call();});}catch(e){t.logError(e.message);}},onAfterTileRendering:function(){var t=this;this.firstTimeVisible=false;this.oKpiTileView=this.getView();this.updateDatajobScheduled=false;this.updateTimeStampjobScheduled=false;this.oViewData=this.oKpiTileView.getViewData();this.tilePressed=false;this.kpiValueFetchDeferred=true;this.evaluationFetchDeferred=true;this.backEndCallMade=false;if(!sap.ushell.components.tiles.utils){q.sap.require("sap.ushell.components.tiles.utils");}this.oResourceBundle=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle();this.oTileApi=this.oViewData.chip;this.system=this.oTileApi.url.getApplicationSystem();this.oKpiTileView.oGenericTile.setState(c.Loading);this.getChipConfiguration(function(){var n;t.chipCacheTime=sap.ushell.components.tiles.indicatorTileUtils.util.getCachingTime(t.oConfig);t.chipCacheTimeUnit=sap.ushell.components.tiles.indicatorTileUtils.util.getCachingTimeUnit(t.oConfig);if(t.oTileApi.preview.isEnabled()){t.doDummyProcess();t.oKpiTileView.oGenericTile.attachPress(function(){M.show(t.oResourceBundle.getText("sb.NavigationHelp"));});}else if(t.oConfig.BLANKTILE||t.oConfig.TILE_PROPERTIES.blankTile){t.doDummyProcess();n=sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system);t.oKpiTileView.oGenericTile.$().wrap("<a href ='"+n+"'></a>");t.oKpiTileView.oGenericTile.attachPress(function(){t.tilePressed=true;sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(t.queryServiceUriODataReadRef);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,null);window.location.hash=n;});}else{if(t.oTileApi.visible&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){t.oTileApi.visible.attachVisible(t.visibleHandler.bind(t));}n=sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system);t.oKpiTileView.oGenericTile.$().wrap("<a href ='"+n+"' style='display: block;'></a>");t.oKpiTileView.oGenericTile.attachPress(function(){t.tilePressed=true;sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(t.queryServiceUriODataReadRef);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,null);window.location.hash=n;});if(!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){t.oKpiTileView.oNVConfS.attachRefresh(function(){t.oKpiTileView.oGenericTile.setState(c.Loading);q.proxy(t.refreshHandler(true),t);});}t.fetchEvaluation(t.oConfig,function(){t.DEFINITION_DATA=t.oConfig;var u=t.oTileApi.url.addSystemToServiceUrl(t.oConfig.EVALUATION.ODATA_URL);var d=t.oTileApi.configuration.getParameterValueAsString("timeStamp");var i=sap.ushell.components.tiles.indicatorTileUtils.util.isCacheValid(t.oConfig.TILE_PROPERTIES.id,d,t.chipCacheTime,t.chipCacheTimeUnit,t.tilePressed);if(!i||t.getView().getViewData().refresh){t.getRunTimeODataModel(u,function(){if(t.KPI_VALUE_REQUIRED){t.fetchKpiValue(function(k,T){this.KPIVALUE=k;t.doProcess(k,T);},t.logError);}else{t.doProcess();}});}else if(t.KPI_VALUE_REQUIRED){t.fetchKpiValue(function(k,T){this.KPIVALUE=k;t.doProcess(k,T);},t.logError);}else{t.doProcess();}});}});},onAfterRendering:function(){this.onAfterTileRendering();},_setLocalModelToTile:function(){if(!this.getTile().getModel()){this.getTile().setModel(new J({}));}},autoFormatter:function(n,i){i=i||false;if(!n){return"";}return sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(n),this.oConfig.EVALUATION.SCALING,this.oConfig.EVALUATION.DECIMAL_PRECISION,i);},setToolTip:function(d,e,t){var f=this,h,T=this.setThresholdValues(),i=this.oConfig.EVALUATION.COLUMN_NAME,j=this.isCurrencyMeasure(i),v;if(t=="CONT"||t=="COMP"){if(this.oKpiTileView.getContent()[0].getTileContent().length){h=f.oKpiTileView.getContent()[0].getTileContent()[0].getContent();var k,l,n,p,r,u,w,x,y;if(e&&e[0]){k=e[0].title;p=this.autoFormatter(e[0].value,j);w=sap.ushell.components.tiles.indicatorTileUtils.util.getSemanticColorName(e[0].color);}if(e&&e[1]){l=e[1].title;r=this.autoFormatter(e[1].value,j);x=sap.ushell.components.tiles.indicatorTileUtils.util.getSemanticColorName(e[1].color);}if(e&&e[2]){n=e[2].title;u=this.autoFormatter(e[2].value,j);y=sap.ushell.components.tiles.indicatorTileUtils.util.getSemanticColorName(e[2].color);}var z={};z["0"]=this.oConfig.EVALUATION.COLUMN_NAME+",asc";z["1"]=this.oConfig.EVALUATION.COLUMN_NAME+",desc";z["2"]=this.oConfig.TILE_PROPERTIES.dimension+",asc";z["3"]=this.oConfig.TILE_PROPERTIES.dimension+",desc";var A=z[this.oConfig.TILE_PROPERTIES.sortOrder||"0"].split(",");v={measure:this.oConfig.EVALUATION.COLUMN_NAME,contributionTile:A,m1:k,v1:p,c1:w,m2:l,v2:r,c2:x,m3:n,v3:u,c3:y};sap.ushell.components.tiles.indicatorTileUtils.util.setTooltipInTile(h,t,v);}}else{var B="";if(d=="Error"){B="sb.error";}if(d=="Neutral"){B="sb.neutral";}if(d=="Critical"){B="sb.critical";}if(d=="Good"){B="sb.good";}v={status:B,actual:this.autoFormatter(e,j),target:this.autoFormatter(T.targetValue,j),cH:this.autoFormatter(T.criticalHighValue,j),wH:this.autoFormatter(T.warningHighValue,j),wL:this.autoFormatter(T.warningLowValue,j),cL:this.autoFormatter(T.criticalLowValue,j)};h=f.oKpiTileView.getContent()[0].getTileContent()[0]&&f.oKpiTileView.getContent()[0].getTileContent()[0].getContent();sap.ushell.components.tiles.indicatorTileUtils.util.setTooltipInTile(h,t,v);}},getTrendColor:function(t){var d=this,w,f,h,i;try{var j=this.DEFINITION_DATA.EVALUATION.GOAL_TYPE;var r=V.Neutral;if(j==="MI"){if(t.criticalHighValue&&t.warningHighValue){i=Number(t.criticalHighValue);h=Number(t.warningHighValue);if(this.CALCULATED_KPI_VALUE<h){r=V.Good;}else if(this.CALCULATED_KPI_VALUE<=i){r=V.Critical;}else{r=V.Error;}}}else if(j==="MA"){if(t.criticalLowValue&&t.warningLowValue){f=Number(t.criticalLowValue);w=Number(t.warningLowValue);if(this.CALCULATED_KPI_VALUE<f){r=V.Error;}else if(this.CALCULATED_KPI_VALUE<=w){r=V.Critical;}else{r=V.Good;}}}else if(t.warningLowValue&&t.warningHighValue&&t.criticalLowValue&&t.criticalHighValue){i=Number(t.criticalHighValue);h=Number(t.warningHighValue);w=Number(t.warningLowValue);f=Number(t.criticalLowValue);if(this.CALCULATED_KPI_VALUE<f||this.CALCULATED_KPI_VALUE>i){r=V.Error;}else if((this.CALCULATED_KPI_VALUE>=f&&this.CALCULATED_KPI_VALUE<=w)||(this.CALCULATED_KPI_VALUE>=h&&this.CALCULATED_KPI_VALUE<=i)){r=V.Critical;}else{r=V.Good;}}return r;}catch(e){d.logError(e);}},getTrendIndicator:function(t){var d=this;t=Number(t);try{var f=b.None;if(t>this.CALCULATED_KPI_VALUE){f=b.Down;}else if(t<this.CALCULATED_KPI_VALUE){f=b.Up;}return f;}catch(e){d.logError(e);}},setTextInTile:function(){var t=this;var d=sap.ushell.components.tiles.indicatorTileUtils.util.getTileTitleSubtitle(this.oTileApi);this._updateTileModel({header:d.title||sap.ushell.components.tiles.indicatorTileUtils.util.getChipTitle(t.oConfig),subheader:d.subTitle||sap.ushell.components.tiles.indicatorTileUtils.util.getChipSubTitle(t.oConfig)});},_getEvaluationThresholdMeasures:function(){var t=[];t.push(this.oConfig.EVALUATION.COLUMN_NAME);if(this.oConfig.EVALUATION.VALUES_SOURCE==="MEASURE"){var d=this.oConfig.EVALUATION_VALUES;if(d&&d.length){for(var i=0;i<d.length;i++){if((d[i]).COLUMN_NAME&&!((d[i]).FIXED)){t.push((d[i]).COLUMN_NAME);}}}}return t;},onExit:function(){sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.queryServiceUriODataReadRef);sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.trendChartODataReadRef);sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.comparisionChartODataRef);}});return g;});
sap.ui.predefine('sap/ushell/components/tiles/indicatorArea/AreaChartTile.controller',["sap/ushell/components/tiles/generic","sap/m/library","sap/suite/ui/microchart/AreaMicroChartItem","sap/suite/ui/microchart/AreaMicroChartPoint","sap/ui/thirdparty/jquery"],function(g,m,A,d,q){"use strict";var F=m.FrameType;var L=m.LoadState;var f=g.extend("sap.ushell.components.tiles.indicatorArea.AreaChartTile",{onInit:function(){this.KPI_VALUE_REQUIRED=false;},doProcess:function(r,i){this.onAfterFinalEvaluation(r,i);},doDummyProcess:function(){var t=this;this.setTextInTile();t._updateTileModel({footer:"",description:"",width:"100%",height:"100%",chart:{color:"Good",data:[{day:0,balance:0},{day:30,balance:20},{day:60,balance:20},{day:100,balance:80}]},target:{color:"Error",data:[{day:0,balance:0},{day:30,balance:30},{day:60,balance:40},{day:100,balance:90}]},maxThreshold:{color:"Good",data:[{day:0,balance:0},{day:30,balance:40},{day:60,balance:50},{day:100,balance:100}]},innerMaxThreshold:{color:"Error",data:[]},innerMinThreshold:{color:"Neutral",data:[]},minThreshold:{color:"Error",data:[{day:0,balance:0},{day:30,balance:20},{day:60,balance:30},{day:100,balance:70}]},minXValue:0,maxXValue:100,minYValue:0,maxYValue:100,firstXLabel:{label:"June 123",color:"Error"},lastXLabel:{label:"June 30",color:"Error"},firstYLabel:{label:"0M",color:"Good"},lastYLabel:{label:"80M",color:"Critical"},minLabel:{},maxLabel:{}});this.oKpiTileView.oGenericTile.setState(L.Loaded);},scheduleJob:function(a){if(this.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(this.oConfig)){sap.ushell.components.tiles.indicatorTileUtils.util.scheduleFetchDataJob.call(this,this.oTileApi.visible.isVisible());}},onAfterFinalEvaluation:function(r,h){var t=this;var E=this.DEFINITION_DATA.EVALUATION.ODATA_ENTITYSET;var M=this.DEFINITION_DATA.EVALUATION.COLUMN_NAME;var v=sap.ushell.components.tiles.indicatorTileUtils.util.prepareFilterStructure(this.DEFINITION_DATA.EVALUATION_FILTERS,this.DEFINITION_DATA.ADDITIONAL_FILTERS);var j=this.DEFINITION_DATA.TILE_PROPERTIES.dimension;if(j==undefined){this.logError();return;}var k=this.DEFINITION_DATA.EVALUATION.GOAL_TYPE;var l=this.DEFINITION_DATA.EVALUATION_VALUES;var n=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);if(sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){if(n){var o=n.Data&&JSON.parse(n.Data);}}var p=t.oTileApi.configuration.getParameterValueAsString("timeStamp");var s=sap.ushell.components.tiles.indicatorTileUtils.util.isCacheValid(t.oConfig.TILE_PROPERTIES.id,p,t.chipCacheTime,t.chipCacheTimeUnit,t.tilePressed);var u=M;if(this.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){switch(k){case"MI":t.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");t.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");t.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");t.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");if(t.sWarningHigh&&t.sCriticalHigh&&t.sTarget){u+=","+t.sWarningHigh+","+t.sCriticalHigh+","+t.sTarget;}break;case"MA":t.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");t.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");t.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");t.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");if(t.sWarningLow&&t.sCriticalLow&&t.sTarget){u+=","+t.sWarningLow+","+t.sCriticalLow+","+t.sTarget;}break;case"RA":t.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");t.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");t.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");t.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");t.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");t.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");if(t.sWarningLow&&t.sCriticalLow&&t.sTarget&&t.sWarningHigh&&t.sCriticalHigh){u+=","+t.sWarningLow+","+t.sCriticalLow+","+t.sTarget+","+t.sWarningHigh+","+t.sCriticalHigh;}break;}}var w=sap.ushell.components.tiles.indicatorTileUtils.util.getBoolValue(r);if((o&&!o.rightData)||!n||(!s&&t.oTileApi.visible.isVisible())||w||(h&&t.oTileApi.visible.isVisible())||t.getView().getViewData().refresh){if(t.kpiValueFetchDeferred){t.kpiValueFetchDeferred=false;var Q=sap.ushell.components.tiles.indicatorTileUtils.util.prepareQueryServiceUri(t.oRunTimeODataModel,E,u,j,v);if(Q){this.queryUriForTrendChart=Q.uri;var x={};try{this.trendChartODataReadRef=Q.model.read(Q.uri,null,null,true,function(a){t.kpiValueFetchDeferred=true;if(a&&a.results&&a.results.length){if(Q.unit[0]){t.unit=a.results[0][Q.unit[0].name];t.CURRENCY_CODE=t.unit;x.unit=Q.unit[0];x.unit.name=Q.unit[0].name;}t.queryUriResponseForTrendChart=a;j=sap.ushell.components.tiles.indicatorTileUtils.util.findTextPropertyForDimension(t.oRunTimeODataModel,E,j);a.results.splice(10);a.firstXlabel=a.results[0][j];a.lastXlabel=a.results[a.results.length-1][j];x.data=a;if(x&&x.data&&x.data.results&&x.data.results.length){for(var i=0;i<x.data.results.length;i++){delete x.data.results[i].__metadata;}}x.isCurM=t.isCurrencyMeasure(t.oConfig.EVALUATION.COLUMN_NAME);x.dimensionName=j;_(a,t.DEFINITION_DATA.EVALUATION.VALUES_SOURCE);var c={};t.cacheTime=sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate();c.ChipId=t.oConfig.TILE_PROPERTIES.id;c.Data=JSON.stringify(x);c.CacheMaxAge=Number(t.chipCacheTime);c.CacheMaxAgeUnit=t.chipCacheTimeUnit;c.CacheType=1;var b=t.getLocalCache(c);if(t.DEFINITION_DATA.TILE_PROPERTIES.frameType==F.TwoByOne){var B=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id),C;if(B){if(!B.CachedTime){B.CachedTime=sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate();}C=B.Data;if(C){C=JSON.parse(C);C.rightData=x;}B.Data=JSON.stringify(C);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,B);}else{C={};C.rightData=x;b.Data=JSON.stringify(C);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,b);}t.cacheWriteData=x;t.getView().getViewData().deferredObj.resolve();}else{sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,b);var U=false;if(n){U=true;}if(t.chipCacheTime){sap.ushell.components.tiles.indicatorTileUtils.util.writeFrontendCacheByChipAndUserId(t.oTileApi,t.oConfig.TILE_PROPERTIES.id,c,U,function(a){if(a){t.cacheTime=a&&a.CachedTime;sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,a);t.setTimeStamp();}if(t.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){q.proxy(t.setTimeStamp(t.cacheTime),t);}});}t.oKpiTileView.oGenericTile.setState(L.Loaded);t.updateDatajobScheduled=false;var D=t.oConfig.TILE_PROPERTIES.id+"data";var G=sap.ushell.components.tiles.indicatorTileUtils.util.getScheduledJob(D);if(G){clearTimeout(G);G=undefined;}q.proxy(t.scheduleJob(t.cacheTime),t);}}else{t.setNoData();}},function(a){t.kpiValueFetchDeferred=true;if(a&&a.response){t.logError("Data call failed");}});}catch(e){t.kpiValueFetchDeferred=true;t.logError(e);}}else{t.kpiValueFetchDeferred=true;t.logError();}}}else if(n&&n.Data){try{var y;var z=t.oConfig&&t.oConfig.TILE_PROPERTIES&&t.oConfig.TILE_PROPERTIES.tileType;if(z.indexOf("DT-")==-1){y=n.Data&&JSON.parse(n.Data);}else{y=n.Data&&JSON.parse(n.Data);y=y.rightData;}if(y.unit){t.unit=y.data.results[0][y.unit.name];t.CURRENCY_CODE=t.unit;}t.cacheTime=n.CachedTime;if(t.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){q.proxy(t.setTimeStamp(t.cacheTime),t);}t.queryUriResponseForTrendChart=y.data;j=y.dimensionName;_(y.data,t.DEFINITION_DATA.EVALUATION.VALUES_SOURCE);if(t.oConfig.TILE_PROPERTIES.frameType==F.OneByOne){t.oKpiTileView.oGenericTile.setState(L.Loaded);}else{t.getView().getViewData().deferredObj.resolve();}q.proxy(t.scheduleJob(t.cacheTime),t);}catch(e){t.logError(e);}}else{t.setNoData();}function _(B,C){var D=[];var G=[];var H=[];var I=[];var J=[];var K=[];var N=B.firstXlabel;var O,P,R,S,T;var U=B.lastXlabel;var V=Number(B.results[0][M]);var W=Number(B.results[B.results.length-1][M]);var i;for(i in B.results){B.results[i][j]=Number(i);B.results[i][M]=Number(B.results[i][M]);if(t.sWarningHigh){B.results[i][t.sWarningHigh]=Number(B.results[i][t.sWarningHigh]);}if(t.sCriticalHigh){B.results[i][t.sCriticalHigh]=Number(B.results[i][t.sCriticalHigh]);}if(t.sCriticalLow){B.results[i][t.sCriticalLow]=Number(B.results[i][t.sCriticalLow]);}if(t.sWarningLow){B.results[i][t.sWarningLow]=Number(B.results[i][t.sWarningLow]);}if(t.sTarget){B.results[i][t.sTarget]=Number(B.results[i][t.sTarget]);}if(t.sWarningHigh){H.push(B.results[i][t.sWarningHigh]);}if(t.sCriticalHigh){I.push(B.results[i][t.sCriticalHigh]);}if(t.sCriticalLow){J.push(B.results[i][t.sCriticalLow]);}if(t.sWarningLow){K.push(B.results[i][t.sWarningLow]);}D.push(B.results[i][j]);G.push(B.results[i][M]);}try{N=sap.ushell.components.tiles.indicatorTileUtils.util.formatOdataObjectToString(N);U=sap.ushell.components.tiles.indicatorTileUtils.util.formatOdataObjectToString(U);}catch(e){t.logError(e);}var X=Number(V);if(t.oConfig.EVALUATION.SCALING==-2){X*=100;}var Y=Math.min.apply(Math,G);var c=t.isCurrencyMeasure(t.oConfig.EVALUATION.COLUMN_NAME);var Z=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(X,t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION,c,t.CURRENCY_CODE);if(t.oConfig.EVALUATION.SCALING==-2){Z+=" %";}var $=Z.toString();var a1=Number(W);if(t.oConfig.EVALUATION.SCALING==-2){a1*=100;}var b1=Math.max.apply(Math,G);c=t.isCurrencyMeasure(t.oConfig.EVALUATION.COLUMN_NAME);var c1=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(a1,t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION,c,t.CURRENCY_CODE);if(t.oConfig.EVALUATION.SCALING==-2){c1+=" %";}var d1=c1.toString();try{var e1=sap.ushell.components.tiles.indicatorTileUtils.util.formatOdataObjectToString(Math.min.apply(Math,D));var f1=sap.ushell.components.tiles.indicatorTileUtils.util.formatOdataObjectToString(Math.max.apply(Math,D));}catch(e){t.logError(e);}if(C=="MEASURE"){if(H.length!=0){t.firstwH=H[e1];t.lastwH=H[f1];}if(I.length!=0){t.firstcH=I[e1];t.lastcH=I[f1];}if(J.length!=0){t.firstcL=J[e1];t.lastcL=J[f1];}if(K.length!=0){t.firstwL=K[e1];t.lastwL=K[f1];}}var g1={width:"100%",height:"100%",unit:t.unit||"",chart:{color:"Neutral",data:B.results},size:"Auto",minXValue:e1,maxXValue:f1,minYValue:Y,maxYValue:b1,firstXLabel:{label:N+"",color:"Neutral"},lastXLabel:{label:U+"",color:"Neutral"},firstYLabel:{label:$+"",color:"Neutral"},lastYLabel:{label:d1+"",color:"Neutral"},minLabel:{},maxLabel:{}};var h1;switch(k){case"MA":for(i in l){if(l[i].TYPE=="CL"){g1.minThreshold={color:"Error"};h1={};h1[j]="";h1[M]=Number(l[i].FIXED);t.cl=Number(l[i].FIXED);g1.minThreshold.data=(C=="MEASURE")?B.results:[h1];O=(C=="MEASURE")?t.sCriticalLow:M;}else if(l[i].TYPE=="WL"){g1.maxThreshold={color:"Good"};h1={};h1[j]="";h1[M]=Number(l[i].FIXED);g1.maxThreshold.data=(C=="MEASURE")?B.results:[h1];P=(C=="MEASURE")?t.sWarningLow:M;t.wl=Number(l[i].FIXED);}else if(l[i].TYPE=="TA"){h1={};h1[j]="";h1[M]=Number(l[i].FIXED);g1.target={color:"Neutral"};g1.target.data=(C=="MEASURE")?B.results:[h1];T=(C=="MEASURE")?t.sTarget:M;}}g1.innerMinThreshold={data:[]};g1.innerMaxThreshold={data:[]};if(C=="FIXED"){g1.firstYLabel.color=V<t.cl?"Error":((t.cl<=V)&&(V<=t.wl))?"Critical":(V>t.wl)?"Good":"Neutral";g1.lastYLabel.color=W<t.cl?"Error":((t.cl<=W)&&(W<=t.wl))?"Critical":(W>t.wl)?"Good":"Neutral";}else if(C=="MEASURE"&&t.firstwL&&t.lastwL&&t.firstcL&&t.lastcL){g1.firstYLabel.color=V<t.firstcL?"Error":((t.firstcL<=V)&&(V<=t.firstwL))?"Critical":(V>t.firstwL)?"Good":"Neutral";g1.lastYLabel.color=W<t.lastcL?"Error":((t.lastcL<=W)&&(W<=t.lastwL))?"Critical":(W>t.lastwL)?"Good":"Neutral";}break;case"MI":for(i in l){if(l[i].TYPE=="CH"){h1={};h1[j]="";h1[M]=Number(l[i].FIXED);t.ch=Number(l[i].FIXED);g1.maxThreshold={color:"Error"};g1.maxThreshold.data=(C=="MEASURE")?B.results:[h1];P=(C=="MEASURE")?t.sCriticalHigh:M;}else if(l[i].TYPE=="WH"){h1={};h1[j]="";h1[M]=Number(l[i].FIXED);t.wh=Number(l[i].FIXED);g1.minThreshold={color:"Good"};g1.minThreshold.data=(C=="MEASURE")?B.results:[h1];O=(C=="MEASURE")?t.sWarningHigh:M;}else if(l[i].TYPE=="TA"){h1={};h1[j]="";h1[M]=Number(l[i].FIXED);g1.target={color:"Neutral"};g1.target.data=(C=="MEASURE")?B.results:[h1];T=(C=="MEASURE")?t.sTarget:M;}}if(C=="FIXED"){g1.firstYLabel.color=V>t.ch?"Error":((t.wh<=V)&&(V<=t.ch))?"Critical":(V<t.wh)?"Good":"Neutral";g1.lastYLabel.color=W>t.ch?"Error":((t.wh<=W)&&(W<=t.ch))?"Critical":(W<t.wh)?"Good":"Neutral";}else if(C=="MEASURE"&&t.firstwH&&t.lastwH&&t.firstcH&&t.lastcH){g1.firstYLabel.color=V>t.firstcH?"Error":((t.firstwH<=V)&&(V<=t.firstcH))?"Critical":(V<t.firstwH)?"Good":"Neutral";g1.lastYLabel.color=W>t.lastcH?"Error":((t.lastwH<=W)&&(W<=t.lastcH))?"Critical":(W<t.lastwH)?"Good":"Neutral";}g1.innerMaxThreshold={data:[]};g1.innerMinThreshold={data:[]};break;case"RA":for(i in l){if(l[i].TYPE=="CH"){h1={};h1[j]="";h1[M]=Number(l[i].FIXED);t.ch=Number(l[i].FIXED);g1.maxThreshold={color:"Error"};g1.maxThreshold.data=(C=="MEASURE")?B.results:[h1];P=(C=="MEASURE")?t.sCriticalHigh:M;}else if(l[i].TYPE=="WH"){h1={};h1[j]="";h1[M]=Number(l[i].FIXED);t.wh=Number(l[i].FIXED);g1.innerMaxThreshold={color:"Good"};g1.innerMaxThreshold.data=(C=="MEASURE")?B.results:[h1];S=(C=="MEASURE")?t.sWarningHigh:M;}else if(l[i].TYPE=="WL"){h1={};h1[j]="";h1[M]=Number(l[i].FIXED);t.wl=Number(l[i].FIXED);g1.innerMinThreshold={color:"Good"};g1.innerMinThreshold.data=(C=="MEASURE")?B.results:[h1];R=(C=="MEASURE")?t.sWarningLow:M;}else if(l[i].TYPE=="CL"){h1={};h1[j]="";h1[M]=Number(l[i].FIXED);t.cl=Number(l[i].FIXED);g1.minThreshold={color:"Error"};g1.minThreshold.data=(C=="MEASURE")?B.results:[h1];O=(C=="MEASURE")?t.sCriticalLow:M;}else if(l[i].TYPE=="TA"){h1={};h1[j]="";h1[M]=Number(l[i].FIXED);g1.target={color:"Neutral"};g1.target.data=(C=="MEASURE")?B.results:[h1];T=(C=="MEASURE")?t.sTarget:M;}}if(C=="FIXED"){g1.firstYLabel.color=(V>t.ch||V<t.cl)?"Error":((t.wh<=V)&&(V<=t.ch))||((t.cl<=V)&&(V<=t.wl))?"Critical":((V>=t.wl)&&(V<=t.wh))?"Good":"Neutral";g1.lastYLabel.color=(W>t.ch||W<t.cl)?"Error":((t.wh<=W)&&(W<=t.ch))||((t.cl<=W)&&(W<=t.wl))?"Critical":((W>=t.wl)&&(W<=t.wh))?"Good":"Neutral";}else if(C=="MEASURE"&&t.firstwL&&t.lastwL&&t.firstcL&&t.lastcL&&t.firstwH&&t.lastwH&&t.firstcH&&t.lastcH){g1.firstYLabel.color=(V>t.firstcH||V<t.firstcL)?"Error":((t.firstwH<=V)&&(V<=t.firstcH))||((t.firstcL<=V)&&(V<=t.firstwL))?"Critical":((V>=t.firstwL)&&(V<=t.firstwH))?"Good":"Neutral";g1.lastYLabel.color=(W>t.lastcH||W<t.lastcL)?"Error":((t.lastwH<=W)&&(W<=t.lastcH))||((t.lastcL<=W)&&(W<=t.lastwL))?"Critical":((W>=t.lastwL)&&(W<=t.lastwH))?"Good":"Neutral";}break;}var i1=function(k1,a,b,C){return new A({color:"{/"+k1+"/color}",points:{path:"/"+k1+"/data",template:new d({x:"{"+a+"}",y:"{"+b+"}"})}});};var j1=t.getView().oNVConfContS;j1.setTarget(i1("target",j,T));j1.setInnerMinThreshold(i1("innerMinThreshold",j,R));j1.setInnerMaxThreshold(i1("innerMaxThreshold",j,S));j1.setMinThreshold(i1("minThreshold",j,O));j1.setMaxThreshold(i1("maxThreshold",j,P));j1.setChart(i1("chart",j,M));t.setTextInTile();if(t.getView().getViewData().parentController){t.getView().getViewData().parentController._updateTileModel(g1);}else{t._updateTileModel(g1);}}}});return f;});
sap.ui.predefine('sap/ushell/components/tiles/indicatorArea/AreaChartTile.view',["sap/ui/core/mvc/JSView","sap/ushell/components/tiles/indicatorTileUtils/oData4Analytics","sap/ushell/components/tiles/indicatorTileUtils/smartBusinessUtil","sap/suite/ui/microchart/AreaMicroChartItem","sap/suite/ui/microchart/AreaMicroChartPoint","sap/suite/ui/microchart/AreaMicroChartLabel","sap/m/library","sap/suite/ui/microchart/AreaMicroChart","sap/m/GenericTile","sap/ui/model/json/JSONModel"],function(J,o,s,A,a,b,M,c,G,d){"use strict";var L=M.LoadState;sap.ui.getCore().loadLibrary("sap.suite.ui.microchart");sap.ui.jsview("sap.ushell.components.tiles.indicatorArea.AreaChartTile",{getControllerName:function(){return"sap.ushell.components.tiles.indicatorArea.AreaChartTile";},createContent:function(){this.setHeight("100%");this.setWidth("100%");var h="Lorem ipsum";var e="Lorem ipsum";var S=M.Size;var t=sap.ushell.components.tiles.indicatorTileUtils.util.getTileTitleSubtitle(this.getViewData().chip);if(t.title&&t.subTitle){h=t.title;e=t.subTitle;}var f=function(n){return new A({color:"Good",points:{path:"/"+n+"/data",template:new a({x:"{day}",y:"{balance}"})}});};var g=function(n){return new b({label:"{/"+n+"/label}",color:"{/"+n+"/color}"});};var i={subheader:e,header:h,footerNum:"",footerComp:"",scale:"",unit:"",value:8888,size:"Auto",frameType:"OneByOne",state:L.Loading};this.oNVConfContS=new c({width:"{/width}",height:"{/height}",size:S.Responsive,target:f("target"),innerMinThreshold:f("innerMinThreshold"),innerMaxThreshold:f("innerMaxThreshold"),minThreshold:f("minThreshold"),maxThreshold:f("maxThreshold"),chart:f("chart"),minXValue:"{/minXValue}",maxXValue:"{/maxXValue}",minYValue:"{/minYValue}",maxYValue:"{/maxYValue}",firstXLabel:g("firstXLabel"),lastXLabel:g("lastXLabel"),firstYLabel:g("firstYLabel"),lastYLabel:g("lastYLabel"),minLabel:g("minLabel"),maxLabel:g("maxLabel")});this.oNVConfS=new sap.ushell.components.tiles.sbtilecontent({unit:"{/unit}",size:"{/size}",footer:"{/footerNum}",content:this.oNVConfContS});this.oGenericTile=new G({subheader:"{/subheader}",frameType:"{/frameType}",size:"{/size}",header:"{/header}",tileContent:[this.oNVConfS]});var j=new d();j.setData(i);this.oGenericTile.setModel(j);return this.oGenericTile;}});},true);
sap.ui.predefine('sap/ushell/components/tiles/indicatorDual/DualTile.controller',["sap/m/MessageToast","sap/m/library","sap/ui/core/library","sap/ui/core/format/DateFormat","sap/ui/thirdparty/jquery"],function(M,m,c,D,q){"use strict";var a=m.DeviationIndicator;var V=m.ValueColor;var F=m.FrameType;var S=m.Size;var L=m.LoadState;var b=c.mvc.ViewType;sap.ui.controller("sap.ushell.components.tiles.indicatorDual.DualTile",{getRelativeTime:function(){var d=sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate();this.cacheTime=(q.type(this.cacheTime)=="date")?this.cacheTime:new Date(parseInt(this.cacheTime.substr(6),10));var r=sap.ushell.components.tiles.indicatorTileUtils.util.getTimeDifference(d-this.cacheTime),e,o;switch(r.unit){case"minutes":o=sap.ushell.components.tiles.indicatorTileUtils.util.getMillisecond(r.time,"minutes");d=d-o;e=new Date(d);break;case"hours":o=sap.ushell.components.tiles.indicatorTileUtils.util.getMillisecond(r.time,"hours");d=d-o;e=new Date(d);break;case"days":o=sap.ushell.components.tiles.indicatorTileUtils.util.getMillisecond(r.time,"days");d=d-o;e=new Date(d);break;}return e;},getTile:function(){return this.oKpiTileView.oGenericTile;},setTimeStamp:function(){this.updateTimeStampjobScheduled=false;var f=D.getDateTimeInstance({relative:true,relativeSource:"auto"});var t=f.format(this.getRelativeTime());var l=this.getView().oGenericTile.getTileContent()[0];if(l){if(l.setRefreshOption){l.setRefreshOption(true);}if(l.setTimestamp){l.setTimestamp(t);}}this.updateTimeStampjobScheduled=false;var k=this.oConfig.TILE_PROPERTIES.id+"time";var r=sap.ushell.components.tiles.indicatorTileUtils.util.getScheduledJob(k);if(r){clearTimeout(r);r=undefined;}sap.ushell.components.tiles.indicatorTileUtils.util.scheduleTimeStampJob.call(this,this.oTileApi.visible.isVisible());},getLocalCache:function(d){var l={};l.ChipId=d.ChipId;l.Data=d.Data;l.CacheMaxAge=d.CacheMaxAgeUnit;l.CacheMaxAgeUnit=d.CacheMaxAgeUnit;l.CacheType=d.CacheType;l.CachedTime=sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate();return l;},refreshPress:function(){this.initProcess(true);},_getView:function(v,d,r){var e=this.oKpiTileView.getViewData();var f=sap.ui.view({type:b.JS,viewName:v,viewData:q.extend(true,{},e,{parentController:this},{deferredObj:d},{refresh:r})});return f;},logError:function(){this._updateTileModel({value:"",scale:"",unit:""});if(this.getView().getViewData().deferredObj){this.getView().getViewData().deferredObj.reject();}},doProcess:function(r){sap.ushell.components.tiles.indicatorTileUtils.util.setUnsetCallInProgress(this.oKpiTileView.oConfig.TILE_PROPERTIES.id+"defferedLeft",this.deferred_left);sap.ushell.components.tiles.indicatorTileUtils.util.setUnsetCallInProgress(this.oKpiTileView.oConfig.TILE_PROPERTIES.id+"defferedRight",this.deferred_right);var t=this;this.getView().oGenericTile.removeAllTileContent();var s=this.getView().oGenericTile;this.system=this.oTileApi.url.getApplicationSystem();this.oKpiTileView.oGenericTile.setState(L.Loading);var d=t.tileType.split("-")[1];try{var v;v="sap.ushell.components.tiles.indicatornumeric.NumericTile";this.leftView=t._getView(v,this.deferred_left,r);this.leftView.getController().dataCallInProgress=false;s.addTileContent(this.leftView.oGenericTile.getTileContent()[0]);switch(d){case"CM":v="sap.ushell.components.tiles.indicatorcomparison.ComparisonTile";this.rightView=t._getView(v,this.deferred_right,r);this.rightView.getController().dataCallInProgress=false;s.addTileContent(this.rightView.oGenericTile.getTileContent()[0]);break;case"CT":v="sap.ushell.components.tiles.indicatorcontribution.ContributionTile";this.rightView=t._getView(v,this.deferred_right,r);this.rightView.getController().dataCallInProgress=false;s.addTileContent(this.rightView.oGenericTile.getTileContent()[0]);break;case"AT":v="sap.ushell.components.tiles.indicatordeviation.DeviationTile";this.rightView=t._getView(v,this.deferred_right,r);this.rightView.getController().dataCallInProgress=false;s.addTileContent(this.rightView.oGenericTile.getTileContent()[0]);break;case"TT":v="sap.ushell.components.tiles.indicatorArea.AreaChartTile";this.rightView=t._getView(v,this.deferred_right,r);this.rightView.getController().dataCallInProgress=false;s.addTileContent(this.rightView.oGenericTile.getTileContent()[0]);break;}this.leftView.getController().onAfterTileRendering();this.rightView.getController().onAfterTileRendering();var l=this.getView().oGenericTile.getTileContent()[0];if(l&&l.attachRefresh){l.attachRefresh(this.refreshPress.bind(t));}}catch(e){this.logError(e);}},_updateTileModel:function(n){var d=this.getTile().getModel().getData();q.extend(d,n);this.getTile().getModel().setData(d);},setTextInTile:function(){var t=this;var d=sap.ushell.components.tiles.indicatorTileUtils.util.getTileTitleSubtitle(this.oTileApi);this._updateTileModel({header:d.title||sap.ushell.components.tiles.indicatorTileUtils.util.getChipTitle(t.oConfig),subheader:d.subTitle||sap.ushell.components.tiles.indicatorTileUtils.util.getChipSubTitle(t.oConfig)});},doDummyProcess:function(){var t=this;try{t.setTextInTile();switch(t.tileType){case"DT-CM":t._updateTileModel({value:1,size:S.Auto,frameType:F.TwoByOne,state:L.Loading,valueColor:V.Good,indicator:a.None,title:"Liquidity Structure",footer:"Current Quarter",description:"Apr 1st 2013 (B$)",data:[{title:"Measure 1",value:1,color:"Good"},{title:"Measure 2",value:2,color:"Good"},{title:"Measure 3",value:3,color:"Good"}]});break;case"DT-AT":t._updateTileModel({valueColor:"Good",value:100,frameType:F.TwoByOne,unit:"USD",actual:{value:120,color:V.Good},targetValue:100,thresholds:[{value:0,color:V.Error},{value:50,color:V.Critical},{value:150,color:V.Critical},{value:200,color:V.Error}],showActualValue:true,showTargetValue:true});break;case"DT-CT":t._updateTileModel({value:8888,size:S.Auto,frameType:F.TwoByOne,state:L.Loading,valueColor:V.Error,indicator:a.None,title:"US Profit Margin",footer:"Current Quarter",description:"Maximum deviation",data:[{title:"Americas",value:10,color:"Neutral",displayValue:""},{title:"EMEA",value:50,color:"Neutral",displayValue:""},{title:"APAC",value:-20,color:"Neutral",displayValue:""}]});break;case"DT-TT":this._updateTileModel({value:8888,size:S.Auto,frameType:F.TwoByOne,state:L.Loading,valueColor:V.Error,indicator:a.None,title:"Liquidity Structure",footer:"Current Quarter",description:"Apr 1st 2013 (B$)",width:"100%",height:"100%",chart:{color:"Good",data:[{day:0,balance:0},{day:30,balance:20},{day:60,balance:20},{day:100,balance:80}]},target:{color:"Error",data:[{day:0,balance:0},{day:30,balance:30},{day:60,balance:40},{day:100,balance:90}]},maxThreshold:{color:"Good",data:[{day:0,balance:0},{day:30,balance:40},{day:60,balance:50},{day:100,balance:100}]},innerMaxThreshold:{color:"Error",data:[]},innerMinThreshold:{color:"Neutral",data:[]},minThreshold:{color:"Error",data:[{day:0,balance:0},{day:30,balance:20},{day:60,balance:30},{day:100,balance:70}]},minXValue:0,maxXValue:100,minYValue:0,maxYValue:100,firstXLabel:{label:"June 123",color:"Error"},lastXLabel:{label:"June 30",color:"Error"},firstYLabel:{label:"0M",color:"Good"},lastYLabel:{label:"80M",color:"Critical"},minLabel:{},maxLabel:{}});break;}}catch(e){}},visibleHandler:function(i){if(!i){if(this.leftView){this.leftView.getController().firstTimeVisible=false;}if(this.rightView){this.rightView.getController().firstTimeVisible=false;}sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.queryServiceUriODataReadRef);sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.trendChartODataReadRef);sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.comparisionChartODataRef);}if(i){if(this.leftView){this.leftView.getController().refreshHandler();}if(this.rightView){this.rightView.getController().refreshHandler();}}},initProcess:function(r){var t=this;this.oKpiTileView=this.getView();this.oResourceBundle=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle();this.viewData={};t.viewData=this.oKpiTileView.getViewData();this.oTileApi=this.viewData.chip;if(this.oTileApi.visible){this.oTileApi.visible.attachVisible(this.visibleHandler.bind(this));}this.deferred_left=new q.Deferred();this.deferred_right=new q.Deferred();q.when(this.deferred_left,this.deferred_right).done(function(){t.setTextInTile();t.oConfig=t.oKpiTileView.oConfig;t.chipCacheTime=sap.ushell.components.tiles.indicatorTileUtils.util.getCachingTime(t.oConfig);t.chipCacheTimeUnit=sap.ushell.components.tiles.indicatorTileUtils.util.getCachingTimeUnit(t.oConfig);var l=t.leftView.getController().cacheWriteData;var d=t.rightView.getController().cacheWriteData;t.oKpiTileView.oGenericTile.setState(L.Loaded);var n=sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oKpiTileView.oConfig,t.system);t.oKpiTileView.oGenericTile.$().wrap("<a href ='"+n+"'></a>");t.oKpiTileView.oGenericTile.attachPress(function(){t.tilePressed=true;sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oKpiTileView.oConfig.TILE_PROPERTIES.id,null);window.location.hash=n;});var e={};var w={};w.leftData=l;w.rightData=d;e.ChipId=t.oConfig.TILE_PROPERTIES.id;e.Data=JSON.stringify(w);e.CacheMaxAge=Number(t.chipCacheTime);e.CacheMaxAgeUnit=t.chipCacheTimeUnit;e.CacheType=1;var f=t.getLocalCache(e);if(w.leftData&&w.rightData){sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,f);}var g=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);if(t.chipCacheTime&&w.leftData&&w.rightData){sap.ushell.components.tiles.indicatorTileUtils.util.writeFrontendCacheByChipAndUserId(t.oTileApi,t.oConfig.TILE_PROPERTIES.id,e,false,function(h){if(h){sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,h);t.cacheTime=h.CachedTime;t.setTimeStamp.call(t);}});}if(t.chipCacheTime){if(!t.cacheTime){t.cacheTime=g.CachedTime;}t.setTimeStamp.call(t);sap.ushell.components.tiles.indicatorTileUtils.util.scheduleFetchDataJob.call(t,t.oTileApi.visible.isVisible());}}).fail(function(){t.oKpiTileView.oGenericTile.setState(L.Failed);});t.tileType=t.oKpiTileView.oConfig.TILE_PROPERTIES.tileType;this.oTileApi=t.viewData.chip;if(this.oTileApi.preview.isEnabled()){this.doDummyProcess();t.oKpiTileView.oGenericTile.attachPress(function(){M.show(t.oResourceBundle.getText("sb.NavigationHelp"));});}else{this.doProcess(r);}},onAfterRendering:function(){this.initProcess();},setNoData:function(){try{this._updateTileModel({value:"",scale:"",unit:"",footerNum:this.oResourceBundle.getText("sb.noDataAvailable"),footerComp:this.oResourceBundle.getText("sb.noDataAvailable")});this.oKpiTileView.oGenericTile.setState(L.Loaded);}catch(e){}},getChipConfiguration:function(d){var t=this;try{sap.ushell.components.tiles.indicatorTileUtils.util.getParsedChip(t.oTileApi.configuration.getParameterValueAsString("tileConfiguration"),t.oTileApi.preview.isEnabled(),function(f){t.oConfig=f;d.call();});}catch(e){t.logError(e.message);}}});return{};},true);
sap.ui.predefine('sap/ushell/components/tiles/indicatorDual/DualTile.view',["sap/ui/core/mvc/JSView","sap/ushell/components/tiles/indicatorTileUtils/oData4Analytics","sap/ushell/components/tiles/indicatorTileUtils/smartBusinessUtil","sap/ushell/components/tiles/sbtilecontent","sap/m/NumericContent","sap/suite/ui/microchart/ComparisonMicroChartData","sap/suite/ui/microchart/ComparisonMicroChart","sap/suite/ui/microchart/AreaMicroChartItem","sap/suite/ui/microchart/AreaMicroChartPoint","sap/suite/ui/microchart/AreaMicroChartLabel","sap/suite/ui/microchart/AreaMicroChart","sap/suite/ui/microchart/BulletMicroChartData","sap/suite/ui/microchart/BulletMicroChart","sap/m/library","sap/m/GenericTile","sap/ui/model/json/JSONModel"],function(J,d,s,a,N,C,b,A,c,e,f,B,g,m,G,h){"use strict";var S=m.Size;sap.ui.getCore().loadLibrary("sap.suite.ui.microchart");sap.ui.jsview("sap.ushell.components.tiles.indicatorDual.DualTile",{getControllerName:function(){return"sap.ushell.components.tiles.indicatorDual.DualTile";},createContent:function(){this.setHeight("100%");this.setWidth("100%");var t=this;t.oGenericTileData={};sap.ushell.components.tiles.indicatorTileUtils.util.getParsedChip(t.getViewData().chip.configuration.getParameterValueAsString("tileConfiguration"),t.getViewData().chip.preview.isEnabled(),function(p){t.oConfig=p;});t.tileType=t.oConfig.TILE_PROPERTIES.tileType;t.oNumericContent=new N({value:"{/value}",scale:"{/scale}",unit:"{/unit}",indicator:"{/indicator}",size:"{/size}",formatterValue:"{/isFormatterValue}",truncateValueTo:5,valueColor:"{/valueColor}",nullifyValue:false});t.oLeftTileContent=new sap.ushell.components.tiles.sbtilecontent({unit:"{/unit}",size:"{/size}",footer:"{/footerNum}",content:t.oNumericContent});var o;switch(t.tileType){case"DT-CM":o=new C({title:"{title}",value:"{value}",color:"{color}",displayValue:"{displayValue}"});t.oComparisionContent=new b({size:"{/size}",scale:"{/scale}",data:{template:o,path:"/data"}});t.oRightContent=new sap.ushell.components.tiles.sbtilecontent({unit:"{/unit}",size:"{/size}",footer:"{/footerNum}",content:t.oComparisionContent});break;case"DT-CT":o=new C({title:"{title}",value:"{value}",color:"{color}",displayValue:"{displayValue}"});t.oContributionContent=new b({size:"{/size}",scale:"{/scale}",data:{template:o,path:"/data"}});t.oRightContent=new sap.ushell.components.tiles.sbtilecontent({unit:"{/unit}",size:"{/size}",footer:"{/footerNum}",content:t.oContributionContent});break;case"DT-TT":var i=function(p){return new A({color:"Good",points:{path:"/"+p+"/data",template:new c({x:"{day}",y:"{balance}"})}});};var j=function(p){return new e({label:"{/"+p+"/label}",color:"{/"+p+"/color}"});};var k=new f({width:"{/width}",height:"{/height}",size:"{/size}",target:i("target"),innerMinThreshold:i("innerMinThreshold"),innerMaxThreshold:i("innerMaxThreshold"),minThreshold:i("minThreshold"),maxThreshold:i("maxThreshold"),chart:i("chart"),minXValue:"{/minXValue}",maxXValue:"{/maxXValue}",minYValue:"{/minYValue}",maxYValue:"{/maxYValue}",firstXLabel:j("firstXLabel"),lastXLabel:j("lastXLabel"),firstYLabel:j("firstYLabel"),lastYLabel:j("lastYLabel"),minLabel:j("minLabel"),maxLabel:j("maxLabel")});t.oRightContent=new sap.ushell.components.tiles.sbtilecontent({unit:"{/unit}",size:"{/size}",content:k});break;case"DT-AT":var l=new B({value:"{value}",color:"{color}"});var n=new g({size:S.Auto,scale:"{/scale}",actual:{value:"{/actual/value}",color:"{/actual/color}"},targetValue:"{/targetValue}",actualValueLabel:"{/actualValueLabel}",targetValueLabel:"{/targetValueLabel}",thresholds:{template:l,path:"/thresholds"},state:"{/state}",showActualValue:"{/showActualValue}",showTargetValue:"{/showTargetValue}"});t.oRightContent=new sap.ushell.components.tiles.sbtilecontent({unit:"{/unit}",size:"{/size}",footer:"{/footerNum}",content:n});break;}t.oGenericTile=new G({subheader:"{/subheader}",frameType:"TwoByOne",size:"{/size}",header:"{/header}",tileContent:[t.oLeftTileContent,t.oRightContent]});t.oGenericTileModel=new h();t.oGenericTileModel.setData(t.oGenericTileData);t.oGenericTile.setModel(t.oGenericTileModel);return t.oGenericTile;}});},true);
sap.ui.predefine('sap/ushell/components/tiles/indicatorDualComparison/DualComparison.controller',["sap/ushell/components/tiles/indicatorTileUtils/smartBusinessUtil","sap/m/library","sap/ui/thirdparty/jquery","sap/base/Log"],function(u,m,q,L){"use strict";var S=m.Size;var D=m.DeviationIndicator;var V=m.ValueColor;var a=m.LoadState;sap.ui.controller("tiles.indicatorDualComparison.DualComparison",{getTile:function(){return this.oDualComparisonView.oGenericTile;},_updateTileModel:function(n){var b=this.getTile().getModel().getData();q.extend(b,n);this.getTile().getModel().setData(b);},setTitle:function(){var t=this;var b=sap.ushell.components.tiles.indicatorTileUtils.util.getTileTitleSubtitle(this.oChip);this._updateTileModel({header:b.title||sap.ushell.components.tiles.indicatorTileUtils.util.getChipTitle(t.oConfig),subheader:b.subTitle||sap.ushell.components.tiles.indicatorTileUtils.util.getChipSubTitle(t.oConfig)});},logError:function(e){this.oDualComparisonView.oGenericTile.setState(a.Failed);this.oDualComparisonView.oGenericTile.setState(a.Failed);sap.ushell.components.tiles.indicatorTileUtils.util.logError(e);},formSelectStatement:function(o){var t=Object.keys(o);var f="";for(var i=0;i<t.length;i++){if((o[t[i]]!==undefined)&&(o.fullyFormedMeasure)){f+=","+o[t[i]];}}return f;},setThresholdValues:function(){var t=this;try{var T={};T.fullyFormedMeasure=this.DEFINITION_DATA.EVALUATION.COLUMN_NAME;if(this.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){switch(this.DEFINITION_DATA.EVALUATION.GOAL_TYPE){case"MI":T.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");T.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);break;case"MA":T.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");T.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);break;case"RA":T.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");T.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");T.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);break;}}else{T.criticalHighValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","FIXED");T.criticalLowValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","FIXED");T.warningHighValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","FIXED");T.warningLowValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","FIXED");T.targetValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","FIXED");T.trendValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","FIXED");}return T;}catch(e){t.logError(e);}},getTrendColor:function(t){var b=this;var c,w,d,f;try{var i=this.DEFINITION_DATA.EVALUATION.GOAL_TYPE;var r=V.Neutral;if(i==="MI"){if(t.criticalHighValue&&t.warningHighValue){c=Number(t.criticalHighValue);w=Number(t.warningHighValue);if(this.CALCULATED_KPI_VALUE<w){r=V.Good;}else if(this.CALCULATED_KPI_VALUE<=c){r=V.Critical;}else{r=V.Error;}}}else if(i==="MA"){if(t.criticalLowValue&&t.warningLowValue){d=Number(t.criticalLowValue);f=Number(t.warningLowValue);if(this.CALCULATED_KPI_VALUE<d){r=V.Error;}else if(this.CALCULATED_KPI_VALUE<=f){r=V.Critical;}else{r=V.Good;}}}else if(t.warningLowValue&&t.warningHighValue&&t.criticalLowValue&&t.criticalHighValue){c=Number(t.criticalHighValue);w=Number(t.warningHighValue);f=Number(t.warningLowValue);d=Number(t.criticalLowValue);if(this.CALCULATED_KPI_VALUE<d||this.CALCULATED_KPI_VALUE>c){r=V.Error;}else if((this.CALCULATED_KPI_VALUE>=d&&this.CALCULATED_KPI_VALUE<=f)||(this.CALCULATED_KPI_VALUE>=w&&this.CALCULATED_KPI_VALUE<=c)){r=V.Critical;}else{r=V.Good;}}return r;}catch(e){b.logError(e);}},_processDataForComparisonChart:function(d,b,c){var f=[],e={},i,t,l;var g;var T=[];var h=this;for(i=0;i<d.results.length;i++){var j=d.results[i];}T=sap.ushell.components.tiles.indicatorTileUtils.util.getAllMeasuresWithLabelText(this.oConfig.EVALUATION.ODATA_URL,this.oConfig.EVALUATION.ODATA_ENTITYSET);for(i=0,l=T.length;i<l;i++){t=T[i];e[t.key]=t.value;}var k=h.oConfig.TILE_PROPERTIES.COLUMN_NAMES||h.oConfig.EVALUATION.COLUMN_NAMES;for(i=0;i<k.length;i++){var n={};var o=k[i];n.value=Number(j[o.COLUMN_NAME]);var p=Number(j[o.COLUMN_NAME]);if(h.oConfig.EVALUATION.SCALING==-2){p*=100;}g=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(p,h.oConfig.EVALUATION.SCALING,h.oConfig.EVALUATION.DECIMAL_PRECISION);if(h.oConfig.EVALUATION.SCALING==-2){g+=" %";}n.displayValue=g.toString();if(c[i]&&j[c[i].name]){n.displayValue+=" "+j[c[i].name];}n.color=o.semanticColor;n.title=e[o.COLUMN_NAME]||o.COLUMN_NAME;f.push(n);}return f;},getTrendIndicator:function(t,v){var b=this;t=Number(t);try{var c=D.None;if(t>v){c=D.Down;}else if(t<v){c=D.Up;}return c;}catch(e){b.logError(e);}},fetchKpiValue:function(s,E){var t=this;try{var U=this.oConfig.EVALUATION.ODATA_URL,b=this.oConfig.EVALUATION.ODATA_ENTITYSET,c;if(this.oConfig.TILE_PROPERTIES.semanticMeasure){c=this.oConfig.EVALUATION.COLUMN_NAME+","+this.oConfig.TILE_PROPERTIES.semanticMeasure;}else{c=this.oConfig.EVALUATION.COLUMN_NAME;var d=c;if(this.oConfig.TILE_PROPERTIES.COLUMN_NAMES){for(var j=0;j<this.oConfig.TILE_PROPERTIES.COLUMN_NAMES.length;j++){if(this.oConfig.TILE_PROPERTIES.COLUMN_NAMES[j].COLUMN_NAME!=this.oConfig.EVALUATION.COLUMN_NAME){d=d+","+this.oConfig.TILE_PROPERTIES.COLUMN_NAMES[j].COLUMN_NAME;}}}}var f=this.oConfig.EVALUATION_VALUES;var g=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);if(!g){var v=sap.ushell.components.tiles.indicatorTileUtils.util.prepareFilterStructure(this.oConfig.EVALUATION_FILTERS,this.oConfig.ADDITIONAL_FILTERS);var o={};o["0"]=c+",asc";o["1"]=c+",desc";var h=o[this.oConfig.TILE_PROPERTIES.sortOrder||"0"].split(",");var k=sap.ushell.components.tiles.indicatorTileUtils.util.prepareQueryServiceUri(t.oChip.url.addSystemToServiceUrl(U),b,d,null,v,3);if(this.oConfig.TILE_PROPERTIES.semanticMeasure){k.uri+="&$orderby="+h[0]+" "+h[2];}else{k.uri+="&$orderby="+h[0]+" "+h[1];}this.writeData={};this.comparisionChartODataRef=k.model.read(k.uri,null,null,true,function(f){if(f&&f.results&&f.results.length){if(k.unit){t.writeData.unit=k.unit;}t.oConfig.TILE_PROPERTIES.FINALVALUE=f;t.oConfig.TILE_PROPERTIES.FINALVALUE=t._processDataForComparisonChart(t.oConfig.TILE_PROPERTIES.FINALVALUE,d.split(",")[0],k.unit);t.writeData.data=f;var n;for(var i=0;i<t.oConfig.TILE_PROPERTIES.FINALVALUE.length;i++){if(t.oConfig.TILE_PROPERTIES.FINALVALUE[i].title==t.DEFINITION_DATA.EVALUATION.COLUMN_NAME){t.writeData.numericData=t.oConfig.TILE_PROPERTIES.FINALVALUE[i];calculatedValueforScaling=t.oConfig.TILE_PROPERTIES.FINALVALUE[i].value;t.getTrendIndicator(t.setThresholdValues().trendValue,calculatedValueforScaling);t._updateTileModel({valueColor:t.oConfig.TILE_PROPERTIES.FINALVALUE[i].color,value:sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(n),t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION).toString()});break;}}sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,t.writeData);s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);}else if(f.results.length==0){t.oConfig.TILE_PROPERTIES.FINALVALUE=f;t.writeData.data=f;sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,t.writeData);s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);}else{E.call(t,"no Response from QueryServiceUri");}},function(i){if(i&&i.response){L.error(i.message+" : "+i.request.requestUri);E.call(t,i);}});if(!t.writeData.numericData){var l=sap.ushell.components.tiles.indicatorTileUtils.util.prepareFilterStructure(t.DEFINITION_DATA.EVALUATION_FILTERS,t.DEFINITION_DATA.ADDITIONAL_FILTERS);var Q=sap.ushell.components.tiles.indicatorTileUtils.util.prepareQueryServiceUri(t.oChip.url.addSystemToServiceUrl(U),b,c,null,l);if(Q){t.QUERY_SERVICE_MODEL=Q.model;t.queryUriForKpiValue=Q.uri;t.numericODataReadRef=t.QUERY_SERVICE_MODEL.read(Q.uri,null,null,true,function(f){if(f&&f.results&&f.results.length){if(Q.unit){t._updateTileModel({unitNumeric:f.results[0][Q.unit.name]});t.writeData.unitNumeric=Q.unit;t.writeData.unitNumeric.name=Q.unit.name;}t.writeData.numericData=f.results[0];t.DEFINITION_DATA.value=t.writeData.numericData[t.DEFINITION_DATA.EVALUATION.COLUMN_NAME];t.writeData.numericData.color=t.getTrendColor(t.setThresholdValues());t.DEFINITION_DATA.valueColor=t.writeData.numericData.color;var i="";var n=f.results[0][t.DEFINITION_DATA.EVALUATION.COLUMN_NAME];var p=t.getTrendIndicator(t.setThresholdValues().trendValue,n);if(t.oConfig.EVALUATION.SCALING==-2){n*=100;t.getView().oNumericContent.setFormatterValue(false);}i=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(n),t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION);if(t.oConfig.EVALUATION.SCALING==-2){t._updateTileModel({scale:"%"});}t._updateTileModel({value:i.toString(),valueColor:t.writeData.numericData.color,indicator:p});}else{E.call(t,"no Response from QueryServiceUri");}});}}}else{if(g.unit){t._updateTileModel({unit:g.data.results[0][g.unit.name]});}if(g.data&&g.data.results&&g.data.results.length){t.oConfig.TILE_PROPERTIES.FINALVALUE=g.data;t._updateTileModel({value:g.data.results[0][t.DEFINITION_DATA.EVALUATION.COLUMN_NAME]});t.oConfig.TILE_PROPERTIES.FINALVALUE=t._processDataForComparisonChart(t.oConfig.TILE_PROPERTIES.FINALVALUE,d,t.writeData.unit);s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);}else if(f.results.length==0){t.oConfig.TILE_PROPERTIES.FINALVALUE=g.data;s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);}else{E.call(t,"no Response from QueryServiceUri");}}}catch(e){E.call(t,e);}},flowWithoutDesignTimeCall:function(){var t=this;this.DEFINITION_DATA=this.oConfig;this._updateTileModel(this.DEFINITION_DATA);if(this.oChip.visible.isVisible()&&!this.firstTimeVisible){this.firstTimeVisible=true;this.fetchKpiValue(function(k){this.CALCULATED_KPI_VALUE=k;t.oDualComparisonView.oGenericTile.setFrameType("TwoByOne");t.oDualComparisonView.oGenericTile.removeAllTileContent();t.oDualComparisonView.oGenericTile.addTileContent(t.oDualComparisonView.oNumericTile);t.oDualComparisonView.oGenericTile.addTileContent(t.oDualComparisonView.oComparisonTile);var c=this.CALCULATED_KPI_VALUE;var b,d;for(var i=0;i<c.length;i++){if(c[i].title==t.DEFINITION_DATA.EVALUATION.COLUMN_NAME){d=c[i].value;b=c[i].color||"Neutral";t._updateTileModel({value:sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(d),t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION).toString(),valueColor:b});break;}}if(!b&&!d){b=t.DEFINITION_DATA.valueColor;d=t.DEFINITION_DATA.value;}this._updateTileModel({value:sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(d),t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION).toString(),data:this.CALCULATED_KPI_VALUE});var n=sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system);t.oDualComparisonView.oGenericTile.$().wrap("<a href ='"+n+"'></a>");this.oDualComparisonView.oGenericTile.setState(a.Loaded);var s="";if(b=="Error"){s="sb.error";}if(b=="Neutral"){s="sb.neutral";}if(b=="Critical"){s="sb.critical";}if(b=="Good"){s="sb.good";}var T=t.setThresholdValues();var e,f,g,v,h,j,l,o,p;if(this.CALCULATED_KPI_VALUE&&this.CALCULATED_KPI_VALUE[0]){e=this.CALCULATED_KPI_VALUE[0].title;v=this.CALCULATED_KPI_VALUE[0].value;l=sap.ushell.components.tiles.indicatorTileUtils.util.getSemanticColorName(this.CALCULATED_KPI_VALUE[0].color);}if(this.CALCULATED_KPI_VALUE&&this.CALCULATED_KPI_VALUE[1]){f=this.CALCULATED_KPI_VALUE[1].title;h=this.CALCULATED_KPI_VALUE[1].value;o=sap.ushell.components.tiles.indicatorTileUtils.util.getSemanticColorName(this.CALCULATED_KPI_VALUE[1].color);}if(this.CALCULATED_KPI_VALUE&&this.CALCULATED_KPI_VALUE[2]){g=this.CALCULATED_KPI_VALUE[2].title;j=this.CALCULATED_KPI_VALUE[2].value;p=sap.ushell.components.tiles.indicatorTileUtils.util.getSemanticColorName(this.CALCULATED_KPI_VALUE[2].color);}var r={status:s,actual:d,target:T.targetValue,cH:T.criticalHighValue,wH:T.warningHighValue,wL:T.warningLowValue,cL:T.criticalLowValue};var w={m1:e,v1:v,c1:l,m2:f,v2:h,c2:o,m3:g,v3:j,c3:p};var C=t.oDualComparisonView.oGenericTile.getTileContent()[0].getContent();var x=t.oDualComparisonView.oGenericTile.getTileContent()[1].getContent();sap.ushell.components.tiles.indicatorTileUtils.util.setTooltipInTile(C,"NT",r);sap.ushell.components.tiles.indicatorTileUtils.util.setTooltipInTile(x,"COMP",w);},this.logError);}},flowWithDesignTimeCall:function(){var t=this;try{var b=sap.ushell.components.tiles.indicatorTileUtils.cache.getEvaluationById(this.oConfig.EVALUATION.ID);if(b){t.oConfig.EVALUATION_FILTERS=b.EVALUATION_FILTERS;t.flowWithoutDesignTimeCall();}else{sap.ushell.components.tiles.indicatorTileUtils.util.getFilterFromRunTimeService(this.oConfig,function(f){t.oConfig.EVALUATION_FILTERS=f;sap.ushell.components.tiles.indicatorTileUtils.cache.setEvaluationById(t.oConfig.TILE_PROPERTIES.id,t.oConfig);t.flowWithoutDesignTimeCall();});}}catch(e){this.logError(e);}},refreshHandler:function(c){if(!c.firstTimeVisible){if(Number(this.oChip.configuration.getParameterValueAsString("isSufficient"))){c.flowWithoutDesignTimeCall();}else{c.flowWithDesignTimeCall();}}},visibleHandler:function(i){if(!i){this.firstTimeVisible=false;sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.comparisionChartODataRef);}if(i){this.refreshHandler(this);}},onInit:function(){var t=this;this.firstTimeVisible=false;this.oDualComparisonView=this.getView();this.oChip=this.oDualComparisonView.getViewData().chip;if(this.oChip.visible){this.oChip.visible.attachVisible(this.visibleHandler.bind(this));}this.system=this.oChip.url.getApplicationSystem();this.oDualComparisonView.oGenericTile.setState(a.Loading);try{sap.ushell.components.tiles.indicatorTileUtils.util.getParsedChip(this.oChip.configuration.getParameterValueAsString("tileConfiguration"),this.oChip.preview.isEnabled(),function(c){t.oConfig=c;if(t.oChip.preview){t.oChip.preview.setTargetUrl(sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system));}if(t.oChip.preview.isEnabled()){t.setTitle();t._updateTileModel({value:1,size:S.Auto,frameType:"TwoByOne",state:a.Loading,valueColor:V.Good,indicator:D.None,title:"Liquidity Structure",footer:"Current Quarter",description:"Apr 1st 2013 (B$)",data:[{title:"Measure 1",value:1,color:"Good"},{title:"Measure 2",value:2,color:"Good"},{title:"Measure 3",value:3,color:"Good"}]});t.oDualComparisonView.oGenericTile.setState(a.Loaded);}else{t.setTitle();t.oDualComparisonView.oGenericTile.attachPress(function(){sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(t.comparisionChartODataRef);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,null);window.location.hash=sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system);});if(Number(t.oChip.configuration.getParameterValueAsString("isSufficient"))){sap.ushell.components.tiles.indicatorTileUtils.cache.setEvaluationById(t.oConfig.TILE_PROPERTIES.id,t.oConfig);t.flowWithoutDesignTimeCall();}else{t.flowWithDesignTimeCall();}}});}catch(e){this.logError(e);}},onExit:function(){sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.comparisionChartODataRef);}});return{};},true);
sap.ui.predefine('sap/ushell/components/tiles/indicatorDualComparison/DualComparison.view',["sap/ui/core/mvc/JSView","sap/ca/ui/model/format/NumberFormat","sap/ui/model/analytics/odata4analytics","sap/ushell/components/tiles/indicatorTileUtils/smartBusinessUtil","sap/m/NumericContent","sap/m/TileContent","sap/suite/ui/microchart/ComparisonMicroChartData","sap/suite/ui/microchart/ComparisonMicroChart","sap/m/GenericTile","sap/ui/model/json/JSONModel"],function(J,N,o,s,a,T,C,b,G,c){"use strict";sap.ui.getCore().loadLibrary("sap.suite.ui.microchart");sap.ui.jsview("tiles.indicatorDualComparison.DualComparison",{getControllerName:function(){return"tiles.indicatorDualComparison.DualComparison";},createContent:function(){this.setHeight("100%");this.setWidth("100%");var t=this;t.oGenericTileData={};t.oNumericContent=new a({value:"{/value}",scale:"{/scale}",unit:"{/unit}",indicator:"{/indicator}",size:"{/size}",formatterValue:true,truncateValueTo:6,valueColor:"{/valueColor}"});t.oNumericTile=new T({unit:"{/unit}",size:"{/size}",footer:"{/footerNum}",content:t.oNumericContent});t.oCmprsDataTmpl=new C({title:"{title}",value:"{value}",color:"{color}",displayValue:"{displayValue}"});t.oCmprsChrtTmpl=new b({size:"{/size}",scale:"{/scale}",data:{template:t.oCmprsDataTmpl,path:"/data"}});t.oComparisonTile=new T({unit:"{/unit}",size:"{/size}",footer:"{/footerComp}",content:t.oCmprsChrtTmpl});t.oGenericTile=new G({subheader:"{/subheader}",frameType:"{/frameType}",size:"{/size}",header:"{/header}",tileContent:[t.oNumericTile,t.oComparisonTile]});t.oGenericTileModel=new c();t.oGenericTileModel.setData(t.oGenericTileData);t.oGenericTile.setModel(t.oGenericTileModel);return t.oGenericTile;}});},true);
sap.ui.predefine('sap/ushell/components/tiles/indicatorDualContribution/DualContribution.controller',["sap/m/library","sap/ui/thirdparty/jquery","sap/base/Log"],function(m,q,L){"use strict";var V=m.ValueColor;var S=m.Size;var D=m.DeviationIndicator;var a=m.LoadState;sap.ui.controller("tiles.indicatorDualContribution.DualContribution",{getTile:function(){return this.oDualContributionView.oGenericTile;},_updateTileModel:function(n){var b=this.getTile().getModel().getData();q.extend(b,n);this.getTile().getModel().setData(b);this.getTile().getModel().updateBindings();},setTitle:function(){var t=this;var b=sap.ushell.components.tiles.indicatorTileUtils.util.getTileTitleSubtitle(this.oChip);this._updateTileModel({header:b.title||sap.ushell.components.tiles.indicatorTileUtils.util.getChipTitle(t.oConfig),subheader:b.subTitle||sap.ushell.components.tiles.indicatorTileUtils.util.getChipSubTitle(t.oConfig)});},formSelectStatement:function(o){var t=Object.keys(o);var f="";for(var i=0;i<t.length;i++){if((o[t[i]]!==undefined)&&(o.fullyFormedMeasure)){f+=","+o[t[i]];}}return f;},logError:function(e){this.oDualContributionView.oGenericTile.setState(a.Failed);this.oDualContributionView.oGenericTile.setState(a.Failed);sap.ushell.components.tiles.indicatorTileUtils.util.logError(e);},setThresholdValues:function(){var t=this;try{var T={};T.fullyFormedMeasure=this.DEFINITION_DATA.EVALUATION.COLUMN_NAME;if(this.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){switch(this.DEFINITION_DATA.EVALUATION.GOAL_TYPE){case"MI":T.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");T.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);break;case"MA":T.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");T.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);break;case"RA":T.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");T.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");T.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);break;}}else{T.criticalHighValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","FIXED");T.criticalLowValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","FIXED");T.warningHighValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","FIXED");T.warningLowValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","FIXED");T.targetValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","FIXED");T.trendValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","FIXED");}return T;}catch(e){t.logError(e);}},getTrendIndicator:function(t,v){var b=this;t=Number(t);try{var c=D.None;if(t>v){c=D.Down;}else if(t<v){c=D.Up;}return c;}catch(e){b.logError(e);}},_processDataForComparisonChart:function(d,b,c){var s=this.oConfig.TILE_PROPERTIES.semanticMeasure;var f=[];var t;for(var i=0;i<d.results.length;i++){var g=d.results[i];var h={};try{h.title=g[c].toString();}catch(e){h.title="";}h.value=Number(g[b]);var j=Number(g[b]);if(this.oConfig.EVALUATION.SCALING==-2){j*=100;}t=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(j,this.oConfig.EVALUATION.SCALING,this.oConfig.EVALUATION.DECIMAL_PRECISION);h.displayValue=t.toString();if(typeof s==="undefined"){h.color="Neutral";}else if(this.oConfig.EVALUATION.GOAL_TYPE==="MA"){if(h.value>g[s]){h.color="Good";}else{h.color="Error";}}else if(this.oConfig.EVALUATION.GOAL_TYPE==="MI"){if(h.value<g[s]){h.color="Good";}else{h.color="Error";}}else{h.color="Neutral";}f.push(h);}return f;},fetchKpiValue:function(s,E){var t=this;try{var u=this.oConfig.EVALUATION.ODATA_URL,b=this.oConfig.EVALUATION.ODATA_ENTITYSET,c;if(this.oConfig.TILE_PROPERTIES.semanticMeasure){c=this.oConfig.EVALUATION.COLUMN_NAME+","+this.oConfig.TILE_PROPERTIES.semanticMeasure;}else{c=this.oConfig.EVALUATION.COLUMN_NAME;}var d=this.oConfig.TILE_PROPERTIES.dimension;var f=this.oConfig.EVALUATION_VALUES;var g=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);if(!g){var v=sap.ushell.components.tiles.indicatorTileUtils.util.prepareFilterStructure(this.oConfig.EVALUATION_FILTERS,this.oConfig.ADDITIONAL_FILTERS);var o={};o["0"]=c+",asc";o["1"]=c+",desc";o["2"]=d+",asc";o["3"]=d+",desc";var h=o[this.oConfig.TILE_PROPERTIES.sortOrder||"0"].split(",");var i=sap.ushell.components.tiles.indicatorTileUtils.util.prepareQueryServiceUri(t.oChip.url.addSystemToServiceUrl(u),b,c,d,v,3);if(this.oConfig.TILE_PROPERTIES.semanticMeasure){i.uri+="&$top=3&$orderby="+h[0]+" "+h[2];}else{i.uri+="&$top=3&$orderby="+h[0]+" "+h[1];}this.comparisionChartODataRef=i.model.read(i.uri,null,null,true,function(f){if(i.unit[0]){t._updateTileModel({unitContribution:f.results[0][i.unit[0].name]});t.writeData.unitContribution=i.unit[0];t.writeData.unitContribution.name=i.unit[0].name;}if(f&&f.results&&f.results.length){d=sap.ushell.components.tiles.indicatorTileUtils.util.findTextPropertyForDimension(t.oChip.url.addSystemToServiceUrl(u),b,d);t.writeData.dimension=d;t.oConfig.TILE_PROPERTIES.FINALVALUE=f;t.oConfig.TILE_PROPERTIES.FINALVALUE=t._processDataForComparisonChart(t.oConfig.TILE_PROPERTIES.FINALVALUE,c.split(",")[0],d);t.writeData.data=f;sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,t.writeData);s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);}else if(f.results.length==0){t.oConfig.TILE_PROPERTIES.FINALVALUE=f;t.writeData.data=f;sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,t.writeData);}else{E.call(t,"no Response from QueryServiceUri");}},function(p){if(p&&p.response){L.error(p.message+" : "+p.request.requestUri);E.call(t,p);}});var j=sap.ushell.components.tiles.indicatorTileUtils.util.prepareFilterStructure(t.DEFINITION_DATA.EVALUATION_FILTERS,t.DEFINITION_DATA.ADDITIONAL_FILTERS);var Q=sap.ushell.components.tiles.indicatorTileUtils.util.prepareQueryServiceUri(t.oChip.url.addSystemToServiceUrl(u),b,c,null,j);if(Q){t.QUERY_SERVICE_MODEL=Q.model;t.queryUriForKpiValue=Q.uri;t.numericODataReadRef=t.QUERY_SERVICE_MODEL.read(Q.uri,null,null,true,function(f){if(f&&f.results&&f.results.length){if(Q.unit){t._updateTileModel({unitNumeric:f.results[0][Q.unit.name]});t.writeData.unitNumeric=Q.unit;t.writeData.unitNumeric.name=Q.unit.name;}t.writeData.numericData=f;var l="";var k=f.results[0][t.DEFINITION_DATA.EVALUATION.COLUMN_NAME];var n=t.getTrendIndicator(t.setThresholdValues().trendValue,k);if(t.oConfig.EVALUATION.SCALING==-2){k*=100;t.getView().oNumericContent.setFormatterValue(false);}t.DEFINITION_DATA.value=k;l=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(k),t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION);if(t.oConfig.EVALUATION.SCALING==-2){t._updateTileModel({scale:"%"});}t._updateTileModel({value:l.toString(),valueColor:t.DEFINITION_DATA.TILE_PROPERTIES.semanticColorContribution,indicator:n});s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE,k);}else{E.call(t,"no Response from QueryServiceUri");}});}}else{var T=t.setThresholdValues();var k;if(g.unitContribution){t._updateTileModel({unitContribution:g.data.results[0][g.unitContribution.name]});}if(g.unitNumeric){t._updateTileModel({unitNumeric:g.numericData.results[0][g.unitNumeric.name]});}if(g.data&&g.data.results&&g.data.results.length){d=g.dimension;t.oConfig.TILE_PROPERTIES.FINALVALUE=g.data;t.oConfig.TILE_PROPERTIES.FINALVALUE=t._processDataForComparisonChart(t.oConfig.TILE_PROPERTIES.FINALVALUE,c.split(",")[0],d);s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);}else if(f.results.length==0){t.oConfig.TILE_PROPERTIES.FINALVALUE=g.data;}else{E.call(t,"no Response from QueryServiceUri");}if(g.numericData&&g.numericData.results&&g.numericData.results.length){k=g.numericData.results[0][t.DEFINITION_DATA.EVALUATION.COLUMN_NAME];if(t.oConfig.EVALUATION.SCALING==-2){k*=100;t.getView().oNumericContent.setFormatterValue(false);}var l=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(k),t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION);if(t.oConfig.EVALUATION.SCALING==-2){t._updateTileModel({scale:"%"});}var n=t.getTrendIndicator(T.trendValue,k);t._updateTileModel({value:l.toString(),indicator:n,valueColor:t.DEFINITION_DATA.TILE_PROPERTIES.semanticColorContribution});s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE,k);}else{E.call(t,"no Response from QueryServiceUri");}}}catch(e){E.call(t,e);}},flowWithoutDesignTimeCall:function(){var t=this;this.DEFINITION_DATA=this.oConfig;this._updateTileModel(this.DEFINITION_DATA);if(this.oChip.visible.isVisible()&&!this.firstTimeVisible){this.firstTimeVisible=true;this.fetchKpiValue(function(k,c){this.CALCULATED_KPI_VALUE=k;if(t.oConfig.TILE_PROPERTIES.frameType=="TwoByOne"){t.oDualContributionView.oGenericTile.setFrameType("TwoByOne");t.oDualContributionView.oGenericTile.removeAllTileContent();t.oDualContributionView.oGenericTile.addTileContent(t.oDualContributionView.oNumericTile);t.oDualContributionView.oGenericTile.addTileContent(t.oDualContributionView.oComparisonTile);}else{t.oDualContributionView.oGenericTile.setFrameType("OneByOne");t.oDualContributionView.oGenericTile.removeAllTileContent();t.oDualContributionView.oGenericTile.addTileContent(t.oDualContributionView.oComparisonTile);}var d=this.CALCULATED_KPI_VALUE;var b=this.DEFINITION_DATA.TILE_PROPERTIES.semanticColorContribution;for(var i=0;i<this.CALCULATED_KPI_VALUE.length;i++){d[i].color=b;}this._updateTileModel({data:d});var T=t.setThresholdValues();var n=sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system);t.oDualContributionView.oGenericTile.$().wrap("<a href ='"+n+"'></a>");this.oDualContributionView.oGenericTile.setState(a.Loaded);var s="";if(b=="Error"){s="sb.error";}if(b=="Neutral"){s="sb.neutral";}if(b=="Critical"){s="sb.critical";}if(b=="Good"){s="sb.good";}T=t.setThresholdValues();var e,f,g,v,h,j,l,o,p;if(this.CALCULATED_KPI_VALUE&&this.CALCULATED_KPI_VALUE[0]){e=this.CALCULATED_KPI_VALUE[0].title;v=this.CALCULATED_KPI_VALUE[0].value;l=sap.ushell.components.tiles.indicatorTileUtils.util.getSemanticColorName(this.CALCULATED_KPI_VALUE[0].color);}if(this.CALCULATED_KPI_VALUE&&this.CALCULATED_KPI_VALUE[1]){f=this.CALCULATED_KPI_VALUE[1].title;h=this.CALCULATED_KPI_VALUE[1].value;o=sap.ushell.components.tiles.indicatorTileUtils.util.getSemanticColorName(this.CALCULATED_KPI_VALUE[1].color);}if(this.CALCULATED_KPI_VALUE&&this.CALCULATED_KPI_VALUE[2]){g=this.CALCULATED_KPI_VALUE[2].title;j=this.CALCULATED_KPI_VALUE[2].value;p=sap.ushell.components.tiles.indicatorTileUtils.util.getSemanticColorName(this.CALCULATED_KPI_VALUE[2].color);}var r={status:s,actual:c,target:T.targetValue,cH:T.criticalHighValue,wH:T.warningHighValue,wL:T.warningLowValue,cL:T.criticalLowValue};var u={m1:e,v1:v,c1:l,m2:f,v2:h,c2:o,m3:g,v3:j,c3:p};var C=t.oDualContributionView.oGenericTile.getTileContent()[0].getContent();var w=t.oDualContributionView.oGenericTile.getTileContent()[1].getContent();sap.ushell.components.tiles.indicatorTileUtils.util.setTooltipInTile(C,"NT",r);sap.ushell.components.tiles.indicatorTileUtils.util.setTooltipInTile(w,"CONT",u);},this.logError);}},flowWithDesignTimeCall:function(){var t=this;try{var b=sap.ushell.components.tiles.indicatorTileUtils.cache.getEvaluationById(this.oConfig.EVALUATION.ID);if(b){t.oConfig.EVALUATION_FILTERS=b.EVALUATION_FILTERS;t.flowWithoutDesignTimeCall();}else{sap.ushell.components.tiles.indicatorTileUtils.util.getFilterFromRunTimeService(this.oConfig,function(f){t.oConfig.EVALUATION_FILTERS=f;sap.ushell.components.tiles.indicatorTileUtils.cache.setEvaluationById(t.oConfig.TILE_PROPERTIES.id,t.oConfig);t.flowWithoutDesignTimeCall();});}}catch(e){this.logError(e);}},refreshHandler:function(c){if(!c.firstTimeVisible){if(Number(this.oChip.configuration.getParameterValueAsString("isSufficient"))){c.flowWithoutDesignTimeCall();}else{c.flowWithDesignTimeCall();}}},visibleHandler:function(i){if(!i){this.firstTimeVisible=false;sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.comparisionChartODataRef);}if(i){this.refreshHandler(this);}},onInit:function(){var t=this;t.writeData={};this.firstTimeVisible=false;this.oDualContributionView=this.getView();this.oChip=this.oDualContributionView.getViewData().chip;if(this.oChip.visible){this.oChip.visible.attachVisible(this.visibleHandler.bind(this));}this.system=this.oChip.url.getApplicationSystem();this.oDualContributionView.oGenericTile.setState(a.Loading);try{sap.ushell.components.tiles.indicatorTileUtils.util.getParsedChip(this.oChip.configuration.getParameterValueAsString("tileConfiguration"),this.oChip.preview.isEnabled(),function(c){t.oConfig=c;if(t.oChip.preview){t.oChip.preview.setTargetUrl(sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system));}if(t.oChip.preview.isEnabled()){t.setTitle();t._updateTileModel({value:8888,size:S.Auto,frameType:"TwoByOne",state:a.Loading,valueColor:V.Error,indicator:D.None,title:"US Profit Margin",footer:"Current Quarter",description:"Maximum deviation",data:[{title:"Americas",value:10,color:"Neutral",displayValue:""},{title:"EMEA",value:50,color:"Neutral",displayValue:""},{title:"APAC",value:-20,color:"Neutral",displayValue:""}]});t.oDualContributionView.oGenericTile.setState(a.Loaded);}else{t.setTitle();t.oDualContributionView.oGenericTile.attachPress(function(){sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(t.comparisionChartODataRef);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,null);window.location.hash=sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system);});if(Number(t.oChip.configuration.getParameterValueAsString("isSufficient"))){sap.ushell.components.tiles.indicatorTileUtils.cache.setEvaluationById(t.oConfig.TILE_PROPERTIES.id,t.oConfig);t.flowWithoutDesignTimeCall();}else{t.flowWithDesignTimeCall();}}});}catch(e){this.logError(e);}},onExit:function(){sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.comparisionChartODataRef);}});},true);
sap.ui.predefine('sap/ushell/components/tiles/indicatorDualContribution/DualContribution.view',["sap/ui/core/mvc/JSView","sap/ca/ui/model/format/NumberFormat","sap/ui/model/analytics/odata4analytics","sap/ushell/components/tiles/indicatorTileUtils/smartBusinessUtil","sap/m/NumericContent","sap/m/TileContent","sap/suite/ui/microchart/ComparisonMicroChartData","sap/suite/ui/microchart/ComparisonMicroChart","sap/m/GenericTile","sap/ui/model/json/JSONModel"],function(J,N,o,s,a,T,C,b,G,c){"use strict";sap.ui.getCore().loadLibrary("sap.suite.ui.microchart");sap.ui.jsview("tiles.indicatorDualContribution.DualContribution",{getControllerName:function(){return"tiles.indicatorDualContribution.DualContribution";},createContent:function(){this.setHeight("100%");this.setWidth("100%");var t=this;t.oGenericTileData={};t.oNumericContent=new a({value:"{/value}",scale:"{/scale}",indicator:"{/indicator}",size:"{/size}",formatterValue:true,truncateValueTo:6,valueColor:"{/valueColor}"});t.oNumericTile=new T({unit:"{/unitNumeric}",size:"{/size}",footer:"{/footerNum}",content:t.oNumericContent});t.oCmprsDataTmpl=new C({title:"{title}",value:"{value}",color:"{color}",displayValue:"{displayValue}"});t.oCmprsChrtTmpl=new b({size:"{/size}",scale:"{/scale}",data:{template:t.oCmprsDataTmpl,path:"/data"}});t.oComparisonTile=new T({unit:"{/unitContribution}",size:"{/size}",footer:"{/footerComp}",content:t.oCmprsChrtTmpl});t.oGenericTile=new G({subheader:"{/subheader}",frameType:"{/frameType}",size:"{/size}",header:"{/header}",tileContent:[t.oNumericTile,t.oComparisonTile]});t.oGenericTileModel=new c();t.oGenericTileModel.setData(t.oGenericTileData);t.oGenericTile.setModel(t.oGenericTileModel);return t.oGenericTile;}});},true);
sap.ui.predefine('sap/ushell/components/tiles/indicatorDualDeviation/DualDeviation.controller',["sap/ui/model/json/JSONModel","sap/m/library","sap/ui/thirdparty/jquery"],function(J,m,q){"use strict";var D=m.DeviationIndicator;var V=m.ValueColor;var L=m.LoadState;sap.ui.controller("tiles.indicatorDualDeviation.DualDeviation",{logError:function(e){this.oDualDeviationView.oGenericTile.setState(L.Failed);this.oDualDeviationView.oGenericTile.setState(L.Failed);sap.ushell.components.tiles.indicatorTileUtils.util.logError(e);},getThresholdsObjAndColor:function(t){try{var T={};T.arrObj=[];T.returnColor=V.Neutral;var i=this.DEFINITION_DATA.EVALUATION.GOAL_TYPE;var w,c,a,b;if(i==="MI"){a=Number(t.criticalHighValue)||0;b=Number(t.warningHighValue)||0;if(a&&b){a=window.parseFloat(a);b=window.parseFloat(b);T.arrObj.push({value:a,color:V.Error});T.arrObj.push({value:b,color:V.Critical});if(this.CALCULATED_KPI_VALUE<b){T.returnColor=V.Good;}else if(this.CALCULATED_KPI_VALUE<=a){T.returnColor=V.Critical;}else{T.returnColor=V.Error;}}}else if(i==="MA"){c=Number(t.criticalLowValue)||0;w=Number(t.warningLowValue)||0;if(c&&w){c=window.parseFloat(c);w=window.parseFloat(w);T.arrObj.push({value:c,color:V.Error});T.arrObj.push({value:w,color:V.Critical});if(this.CALCULATED_KPI_VALUE<c){T.returnColor=V.Error;}else if(this.CALCULATED_KPI_VALUE<=w){T.returnColor=V.Critical;}else{T.returnColor=V.Good;}}}else{a=Number(t.criticalHighValue)||0;b=Number(t.warningHighValue)||0;c=Number(t.criticalLowValue)||0;w=Number(t.warningLowValue)||0;if(w&&b&&c&&c){a=window.parseFloat(a);b=window.parseFloat(b);w=window.parseFloat(w);c=window.parseFloat(c);T.arrObj.push({value:a,color:V.Error});T.arrObj.push({value:b,color:V.Critical});T.arrObj.push({value:w,color:V.Critical});T.arrObj.push({value:c,color:V.Error});if(this.CALCULATED_KPI_VALUE<c||this.CALCULATED_KPI_VALUE>a){T.returnColor=V.Error;}else if((this.CALCULATED_KPI_VALUE>=c&&this.CALCULATED_KPI_VALUE<=w)||(this.CALCULATED_KPI_VALUE>=b&&this.CALCULATED_KPI_VALUE<=a)){T.returnColor=V.Critical;}else{T.returnColor=V.Good;}}}return T;}catch(e){this.logError(e);}},getTrendIndicator:function(t,v){var a=this;t=Number(t);try{var b=D.None;if(t>v){b=D.Down;}else if(t<v){b=D.Up;}return b;}catch(e){a.logError(e);}},getTile:function(){return this.oDualDeviationView.oGenericTile;},_updateTileModel:function(n){var a=this.getTile().getModel().getData();q.extend(a,n);this.getTile().getModel().setData(a);},formSelectStatement:function(o){var t=Object.keys(o);var f="";for(var i=0;i<t.length;i++){if((o[t[i]]!==undefined)&&(o.fullyFormedMeasure)){f+=","+o[t[i]];}}return f;},setThresholdValues:function(){var t=this;var T={};T.fullyFormedMeasure=this.DEFINITION_DATA.EVALUATION.COLUMN_NAME;if(this.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){switch(this.DEFINITION_DATA.EVALUATION.GOAL_TYPE){case"MI":T.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");T.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);break;case"MA":T.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");T.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);break;case"RA":T.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");T.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");T.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);break;}}else{T.criticalHighValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","FIXED");T.criticalLowValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","FIXED");T.warningHighValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","FIXED");T.warningLowValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","FIXED");T.targetValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","FIXED");T.trendValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","FIXED");}return T;},fetchKpiValue:function(s,E){var t=this;var k=0;try{var u=this.DEFINITION_DATA.EVALUATION.ODATA_URL;var a=this.DEFINITION_DATA.EVALUATION.ODATA_ENTITYSET;var T=this.setThresholdValues();var M=T.fullyFormedMeasure;var c=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);if(!c){var v=sap.ushell.components.tiles.indicatorTileUtils.util.prepareFilterStructure(this.DEFINITION_DATA.EVALUATION_FILTERS,this.DEFINITION_DATA.ADDITIONAL_FILTERS);var Q=sap.ushell.components.tiles.indicatorTileUtils.util.prepareQueryServiceUri(t.oTileApi.url.addSystemToServiceUrl(u),a,M,null,v);if(Q){this.QUERY_SERVICE_MODEL=Q.model;this.queryUriForKpiValue=Q.uri;try{this.queryServiceUriODataReadRef=this.QUERY_SERVICE_MODEL.read(Q.uri,null,null,true,function(f){t.writeData={};if(f&&f.results&&f.results.length){k=f.results[0][t.DEFINITION_DATA.EVALUATION.COLUMN_NAME];if(Q.unit[0]){t._updateTileModel({unit:f.results[0][Q.unit[0].name]});t.writeData.unit=Q.unit[0];t.writeData.unit.name=Q.unit[0].name;}t.writeData.numericData=f;var S="",d;var b=k;if(t.oConfig.EVALUATION.SCALING==-2){b*=100;t.getView().oNumericContent.setFormatterValue(false);}S=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(b),t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION);d=t.getTrendIndicator(T.trendValue,b);if(t.oConfig.EVALUATION.SCALING==-2){t._updateTileModel({scale:"%"});}t._updateTileModel({value:S.toString(),indicator:d,valueColor:t.getThresholdsObjAndColor(T).returnColor});t.writeData.data=f;sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,t.writeData);if(t.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){T.criticalHighValue=f.results[0][T.sCriticalHigh];T.criticalLowValue=f.results[0][T.sCriticalLow];T.warningHighValue=f.results[0][T.sWarningHigh];T.warningLowValue=f.results[0][T.sWarningLow];T.targetValue=f.results[0][T.sTarget];T.trendValue=f.results[0][T.sTrend];}s.call(t,k,T);}else{E.call(t,"no Response from QueryServiceUri");}},function(f){if(f&&f.response){E.call(t,f.message);}});}catch(e){t.logError("Error in Query Service URI");}}}else if(c.data&&c.data.results&&c.data.results.length){var b,S,d;T=t.setThresholdValues();b=c.data.results[0][t.DEFINITION_DATA.EVALUATION.COLUMN_NAME];if(t.oConfig.EVALUATION.SCALING==-2){b*=100;t.getView().oNumericContent.setFormatterValue(true);}if(t.oConfig.EVALUATION.SCALING==-2){t._updateTileModel({scale:"%"});}S=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(b),t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION);d=t.getTrendIndicator(T.trendValue,b);if(c.unit){t._updateTileModel({unit:c.data.results[0][c.unit.name]});}t._updateTileModel({indicator:d,value:S.toString()});if(t.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){T.criticalHighValue=c.data.results[0][T.sCriticalHigh];T.criticalLowValue=c.data.results[0][T.sCriticalLow];T.warningHighValue=c.data.results[0][T.sWarningHigh];T.warningLowValue=c.data.results[0][T.sWarningLow];T.targetValue=c.data.results[0][T.sTarget];T.trendValue=c.data.results[0][T.sTrend];}s.call(t,c.data.results[0][t.DEFINITION_DATA.EVALUATION.COLUMN_NAME],T);}else{E.call(t,"no Response from QueryServiceUri");}}catch(e){E.call(t,e);}},flowWithoutDesignTimeCall:function(){var t=this;var f,a;this.DEFINITION_DATA=this.oConfig;this._updateTileModel(this.DEFINITION_DATA);if(this.oTileApi.visible.isVisible()&&!this.firstTimeVisible){this.firstTimeVisible=true;this.fetchKpiValue(function(k,b){var c=Number(k);if(this.oConfig.EVALUATION.SCALING==-2){c*=100;}f=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(c),this.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION);this.CALCULATED_KPI_VALUE=Number(k);var d={};var e=this.getThresholdsObjAndColor(b);var g={value:Number(k),color:e.returnColor};d.valueColor=g.color;d.actualValueLabel=f.toString();d.actual=g;var h=this.DEFINITION_DATA.EVALUATION_VALUES,i;if(this.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){i=Number(b.targetValue);if(this.oConfig.EVALUATION.SCALING==-2){i*=100;}a=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(i,this.oConfig.EVALUATION.SCALING,this.oConfig.EVALUATION.DECIMAL_PRECISION);d.targetValue=Number(b.targetValue);d.targetValueLabel=a.toString();}else{for(var j=0;j<h.length;j++){if(h[j].TYPE==="TA"){i=Number(h[j].FIXED);if(this.oConfig.EVALUATION.SCALING==-2){i*=100;}a=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(i);d.targetValue=Number(h[j].FIXED);d.targetValueLabel=a.toString();}}}this._updateTileModel(d);var n=sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system);t.oDualDeviationView.oGenericTile.$().wrap("<a href ='"+n+"'></a>");this.oDualDeviationView.oGenericTile.setState(L.Loaded);var s="";if(d.valueColor=="Error"){s="sb.error";}if(d.valueColor=="Neutral"){s="sb.neutral";}if(d.valueColor=="Critical"){s="sb.critical";}if(d.valueColor=="Good"){s="sb.good";}var v={status:s,actual:c,target:b.targetValue,cH:b.criticalHighValue,wH:b.warningHighValue,wL:b.warningLowValue,cL:b.criticalLowValue};var l=v;var C=t.oDualDeviationView.oGenericTile.getTileContent()[0].getContent();var o=t.oDualDeviationView.oGenericTile.getTileContent()[1].getContent();sap.ushell.components.tiles.indicatorTileUtils.util.setTooltipInTile(C,"NT",v);sap.ushell.components.tiles.indicatorTileUtils.util.setTooltipInTile(o,"DT",l);},this.logError);}},flowWithDesignTimeCall:function(){var t=this;try{var a=sap.ushell.components.tiles.indicatorTileUtils.cache.getEvaluationById(this.oConfig.EVALUATION.ID);if(a){t.oConfig.EVALUATION_FILTERS=a.EVALUATION_FILTERS;t.flowWithoutDesignTimeCall();}else{sap.ushell.components.tiles.indicatorTileUtils.util.getFilterFromRunTimeService(this.oConfig,function(f){t.oConfig.EVALUATION_FILTERS=f;sap.ushell.components.tiles.indicatorTileUtils.cache.setEvaluationById(t.oConfig.TILE_PROPERTIES.id,t.oConfig);t.flowWithoutDesignTimeCall();});}}catch(e){this.logError(e);}},refreshHandler:function(c){if(!c.firstTimeVisible){if(Number(this.oTileApi.configuration.getParameterValueAsString("isSufficient"))){c.flowWithoutDesignTimeCall();}else{c.flowWithDesignTimeCall();}}},visibleHandler:function(i){if(!i){this.firstTimeVisible=false;sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.queryServiceUriODataReadRef);}if(i){this.refreshHandler(this);}},setTextInTile:function(){var t=this;var a=sap.ushell.components.tiles.indicatorTileUtils.util.getTileTitleSubtitle(this.oTileApi);this._updateTileModel({header:a.title||sap.ushell.components.tiles.indicatorTileUtils.util.getChipTitle(t.oConfig),subheader:a.subTitle||sap.ushell.components.tiles.indicatorTileUtils.util.getChipSubTitle(t.oConfig)});},onInit:function(){var t=this;this.firstTimeVisible=false;this.oDualDeviationView=this.getView();this.oViewData=this.oDualDeviationView.getViewData();this.oTileApi=this.oViewData.chip;if(this.oTileApi.visible){this.oTileApi.visible.attachVisible(this.visibleHandler.bind(this));}this.system=this.oTileApi.url.getApplicationSystem();this.oDualDeviationView.oGenericTile.setState(L.Loading);try{sap.ushell.components.tiles.indicatorTileUtils.util.getParsedChip(t.oTileApi.configuration.getParameterValueAsString("tileConfiguration"),t.oTileApi.preview.isEnabled(),function(c){t.oConfig=c;t.setTextInTile();if(t.oTileApi.preview){t.oTileApi.preview.setTargetUrl(sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system));}if(t.oTileApi.preview.isEnabled()){t._updateTileModel({valueColor:"Good",value:100,frameType:"TwoByOne",unit:"USD",actual:{value:120,color:V.Good},targetValue:100,thresholds:[{value:0,color:V.Error},{value:50,color:V.Critical},{value:150,color:V.Critical},{value:200,color:V.Error}],showActualValue:true,showTargetValue:true});t.oDualDeviationView.oGenericTile.setState(L.Loaded);}else{t.oDualDeviationView.oGenericTile.attachPress(function(){sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(t.queryServiceUriODataReadRef);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,null);window.location.hash=sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system);});if(Number(t.oTileApi.configuration.getParameterValueAsString("isSufficient"))){sap.ushell.components.tiles.indicatorTileUtils.cache.setEvaluationById(t.oConfig.TILE_PROPERTIES.id,t.oConfig);t.flowWithoutDesignTimeCall();}else{t.flowWithDesignTimeCall();}}});}catch(e){this.logError(e);}},_setLocalModelToTile:function(){if(!this.getTile().getModel()){this.getTile().setModel(new J({}));}},onExit:function(){sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.queryServiceUriODataReadRef);}});return{};},true);
sap.ui.predefine('sap/ushell/components/tiles/indicatorDualDeviation/DualDeviation.view',["sap/ui/core/mvc/JSView","sap/ca/ui/model/format/NumberFormat","sap/ui/model/analytics/odata4analytics","sap/ushell/components/tiles/indicatorTileUtils/smartBusinessUtil","sap/m/library","sap/m/NumericContent","sap/m/TileContent","sap/suite/ui/microchart/BulletMicroChartData","sap/suite/ui/microchart/BulletMicroChart","sap/m/GenericTile","sap/ui/model/json/JSONModel"],function(J,N,o,s,m,a,T,B,b,G,c){"use strict";var S=m.Size;var L=m.LoadState;sap.ui.getCore().loadLibrary("sap.suite.ui.microchart");sap.ui.jsview("tiles.indicatorDualDeviation.DualDeviation",{getControllerName:function(){return"tiles.indicatorDualDeviation.DualDeviation";},createContent:function(){var t=this;this.setHeight("100%");this.setWidth("100%");var h="Lorem ipsum";var d="Lorem ipsum";var e=sap.ushell.components.tiles.indicatorTileUtils.util.getTileTitleSubtitle(this.getViewData().chip);if(e.title&&e.subTitle){h=e.title;d=e.subTitle;}var f={subheader:d,header:h,footerNum:"",footerComp:"",frameType:"TwoByOne",state:L.Loading,scale:""};t.oNumericContent=new a({value:"{/value}",scale:"{/scale}",unit:"{/unit}",indicator:"{/indicator}",size:"{/size}",formatterValue:true,truncateValueTo:6,valueColor:"{/valueColor}"});t.oNumericTile=new T({unit:"{/unit}",size:"{/size}",footer:"{/footerNum}",content:t.oNumericContent});var g=new B({value:"{value}",color:"{color}"});t.oBCTmpl=new b({size:S.Auto,scale:"{/scale}",actual:{value:"{/actual/value}",color:"{/actual/color}"},targetValue:"{/targetValue}",actualValueLabel:"{/actualValueLabel}",targetValueLabel:"{/targetValueLabel}",thresholds:{template:g,path:"/thresholds"},state:"{/state}",showActualValue:"{/showActualValue}",showTargetValue:"{/showTargetValue}"});var n=new T({unit:"{/unit}",size:"{/size}",footer:"{/footerNum}",content:t.oBCTmpl});t.oGenericTile=new G({subheader:"{/subheader}",frameType:"{/frameType}",size:"{/size}",header:"{/header}",tileContent:[t.oNumericTile,n]});var i=new c();i.setData(f);t.oGenericTile.setModel(i);return t.oGenericTile;}});},true);
sap.ui.predefine('sap/ushell/components/tiles/indicatorDualTrend/DualTrend.controller',["sap/ui/model/json/JSONModel","sap/suite/ui/microchart/AreaMicroChartPoint","sap/suite/ui/microchart/AreaMicroChartItem","sap/m/library","sap/ui/thirdparty/jquery"],function(J,A,c,m,q){"use strict";var S=m.Size;var V=m.ValueColor;var D=m.DeviationIndicator;var L=m.LoadState;sap.ui.controller("tiles.indicatorDualTrend.DualTrend",{logError:function(e){this.oDualTrendView.oGenericTile.setState(L.Failed);this.oDualTrendView.oGenericTile.setState(L.Failed);sap.ushell.components.tiles.indicatorTileUtils.util.logError(e);},formSelectStatement:function(o){var t=Object.keys(o);var f="";for(var i=0;i<t.length;i++){if((o[t[i]]!==undefined)&&(o.fullyFormedMeasure)){f+=","+o[t[i]];}}return f;},setThresholdValues:function(){var t=this;try{var T={};T.fullyFormedMeasure=this.DEFINITION_DATA.EVALUATION.COLUMN_NAME;if(this.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){switch(this.DEFINITION_DATA.EVALUATION.GOAL_TYPE){case"MI":T.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");T.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);break;case"MA":T.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");T.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);break;case"RA":T.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");T.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");T.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);break;}}else{T.criticalHighValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","FIXED");T.criticalLowValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","FIXED");T.warningHighValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","FIXED");T.warningLowValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","FIXED");T.targetValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","FIXED");T.trendValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","FIXED");}return T;}catch(e){t.logError(e);}},getTrendIndicator:function(t,v){var a=this;t=Number(t);try{var b=D.None;if(t>v){b=D.Down;}else if(t<v){b=D.Up;}return b;}catch(e){a.logError(e);}},getTile:function(){return this.oDualTrendView.oGenericTile;},getTrendColor:function(t){var a=this;try{var i=this.DEFINITION_DATA.EVALUATION.GOAL_TYPE;var r=V.Neutral;if(i==="MI"){if(t.criticalHighValue&&t.warningHighValue){t.criticalHighValue=Number(t.criticalHighValue);t.warningHighValue=Number(t.warningHighValue);if(this.CALCULATED_KPI_VALUE<t.warningHighValue){r=V.Good;}else if(this.CALCULATED_KPI_VALUE<=t.criticalHighValue){r=V.Critical;}else{r=V.Error;}}}else if(i==="MA"){if(t.criticalLowValue&&t.warningLowValue){t.criticalLowValue=Number(t.criticalLowValue);t.warningLowValue=Number(t.warningLowValue);if(this.CALCULATED_KPI_VALUE<t.criticalLowValue){r=V.Error;}else if(this.CALCULATED_KPI_VALUE<=t.warningLowValue){r=V.Critical;}else{r=V.Good;}}}else if(t.warningLowValue&&t.warningHighValue&&t.criticalLowValue&&t.criticalHighValue){t.criticalHighValue=Number(t.criticalHighValue);t.warningHighValue=Number(t.warningHighValue);t.warningLowValue=Number(t.warningLowValue);t.criticalLowValue=Number(t.criticalLowValue);if(this.CALCULATED_KPI_VALUE<t.criticalLowValue||this.CALCULATED_KPI_VALUE>t.criticalHighValue){r=V.Error;}else if((this.CALCULATED_KPI_VALUE>=t.criticalLowValue&&this.CALCULATED_KPI_VALUE<=t.warningLowValue)||(this.CALCULATED_KPI_VALUE>=t.warningHighValue&&this.CALCULATED_KPI_VALUE<=t.criticalHighValue)){r=V.Critical;}else{r=V.Good;}}return r;}catch(e){a.logError(e);}},_updateTileModel:function(n){var a=this.getTile().getModel().getData();q.extend(a,n);this.getTile().getModel().setData(a);},onAfterFinalEvaluation:function(){var t=this;var u=this.DEFINITION_DATA.EVALUATION.ODATA_URL;var E=this.DEFINITION_DATA.EVALUATION.ODATA_ENTITYSET;var M=this.DEFINITION_DATA.EVALUATION.COLUMN_NAME;var v=sap.ushell.components.tiles.indicatorTileUtils.util.prepareFilterStructure(this.DEFINITION_DATA.EVALUATION_FILTERS,this.DEFINITION_DATA.ADDITIONAL_FILTERS);var d=this.DEFINITION_DATA.TILE_PROPERTIES.dimension;if(d==undefined){this.logError();return;}var g=this.DEFINITION_DATA.EVALUATION.GOAL_TYPE,f=this.DEFINITION_DATA.EVALUATION_VALUES,Q;if(this.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){var h=M;switch(g){case"MI":t.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");t.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");t.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");t.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");if(t.sWarningHigh&&t.sCriticalHigh&&t.sTarget){h+=","+t.sWarningHigh+","+t.sCriticalHigh+","+t.sTarget;}break;case"MA":t.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");t.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");t.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");t.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");if(t.sWarningLow&&t.sCriticalLow&&t.sTarget){h+=","+t.sWarningLow+","+t.sCriticalLow+","+t.sTarget;}break;case"RA":t.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");t.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");t.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");t.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");t.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");t.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");if(t.sWarningLow&&t.sCriticalLow&&t.sTarget&&t.sWarningHigh&&t.sCriticalHigh){h+=","+t.sWarningLow+","+t.sCriticalLow+","+t.sTarget+","+t.sWarningHigh+","+t.sCriticalHigh;}break;}Q=sap.ushell.components.tiles.indicatorTileUtils.util.prepareQueryServiceUri(t.oTileApi.url.addSystemToServiceUrl(u),E,h,d,v);}else{Q=sap.ushell.components.tiles.indicatorTileUtils.util.prepareQueryServiceUri(t.oTileApi.url.addSystemToServiceUrl(u),E,M,d,v);}var j=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);if(!j){if(Q){this.queryUriForTrendChart=Q.uri;t.writeData={};try{this.trendChartODataReadRef=Q.model.read(Q.uri,null,null,true,function(a){if(a&&a.results&&a.results.length){if(Q.unit[0]){t.unit=a.results[0][Q.unit[0].name];t.writeData.unit=Q.unit[0];t.writeData.unit.name=Q.unit[0].name;}t.queryUriResponseForTrendChart=a;d=sap.ushell.components.tiles.indicatorTileUtils.util.findTextPropertyForDimension(t.oTileApi.url.addSystemToServiceUrl(u),E,d);a.firstXlabel=a.results[0][d];a.lastXlabel=a.results[a.results.length-1][d];t.writeData.data=a;t.writeData.dimensionName=d;sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,t.writeData);var n=sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system);t.oDualTrendView.oGenericTile.$().wrap("<a href ='"+n+"'></a>");t.oDualTrendView.oGenericTile.setState(L.Loaded);_(a,t.DEFINITION_DATA.EVALUATION.VALUES_SOURCE);}else{t.logError("no Response from QueryServiceUri");}},function(a){if(a&&a.response){t.logError("Data call failed");}});}catch(e){t.logError(e);}}else{t.logError();}v=sap.ushell.components.tiles.indicatorTileUtils.util.prepareFilterStructure(t.DEFINITION_DATA.EVALUATION_FILTERS,t.DEFINITION_DATA.ADDITIONAL_FILTERS);Q=sap.ushell.components.tiles.indicatorTileUtils.util.prepareQueryServiceUri(t.oTileApi.url.addSystemToServiceUrl(u),E,M,null,v);if(Q){t.QUERY_SERVICE_MODEL=Q.model;t.queryUriForKpiValue=Q.uri;t.numericODataReadRef=t.QUERY_SERVICE_MODEL.read(Q.uri,null,null,true,function(a){if(a&&a.results&&a.results.length){var s="";var k=a.results[0][t.DEFINITION_DATA.EVALUATION.COLUMN_NAME];t.writeData.numericData=a;if(t.oConfig.EVALUATION.SCALING==-2){k*=100;}s=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(k),t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION);if(t.oConfig.EVALUATION.SCALING==-2){t._updateTileModel({scale:"%"});}var l=t.getTrendIndicator(t.setThresholdValues().trendValue,k);t._updateTileModel({value:s.toString(),valueColor:t.getTrendColor(t.setThresholdValues()),indicator:l});}else{fnError.call(t,"no Response from QueryServiceUri");}});}}else{try{if(j.unit!==undefined){t.unit=j.data.results[0][j.unit.name];}t.queryUriResponseForTrendChart=j.data;d=j.dimensionName;var k=j.numericData.results[0][t.DEFINITION_DATA.EVALUATION.COLUMN_NAME];var l=t.getTrendIndicator(t.setThresholdValues().trendValue,j.data.results[0][t.DEFINITION_DATA.EVALUATION.COLUMN_NAME]);var s=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(k),t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION);t.oDualTrendView.oGenericTile.setState(L.Loaded);_(j.data,t.DEFINITION_DATA.EVALUATION.VALUES_SOURCE);t._updateTileModel({value:s.toString(),valueColor:t.getTrendColor(t.setThresholdValues()),indicator:l});}catch(e){t.logError(e);}}function _(n,o){var p=[];var r=[];var w=[];var x=[];var y=[];var z=[];var B=n.firstXlabel;var C,F,G,H,I;var K=n.lastXlabel;var N=Number(n.results[0][M]);var O=Number(n.results[n.results.length-1][M]);var i;for(i in n.results){n.results[i][d]=Number(i);n.results[i][M]=Number(n.results[i][M]);if(t.sWarningHigh){n.results[i][t.sWarningHigh]=Number(n.results[i][t.sWarningHigh]);}if(t.sCriticalHigh){n.results[i][t.sCriticalHigh]=Number(n.results[i][t.sCriticalHigh]);}if(t.sCriticalLow){n.results[i][t.sCriticalLow]=Number(n.results[i][t.sCriticalLow]);}if(t.sWarningLow){n.results[i][t.sWarningLow]=Number(n.results[i][t.sWarningLow]);}if(t.sTarget){n.results[i][t.sTarget]=Number(n.results[i][t.sTarget]);}if(t.sWarningHigh){w.push(n.results[i][t.sWarningHigh]);}if(t.sCriticalHigh){x.push(n.results[i][t.sCriticalHigh]);}if(t.sCriticalLow){y.push(n.results[i][t.sCriticalLow]);}if(t.sWarningLow){z.push(n.results[i][t.sWarningLow]);}p.push(n.results[i][d]);r.push(n.results[i][M]);}try{B=sap.ushell.components.tiles.indicatorTileUtils.util.formatOdataObjectToString(B);K=sap.ushell.components.tiles.indicatorTileUtils.util.formatOdataObjectToString(K);}catch(e){t.logError(e);}var P=Number(N);if(t.oConfig.EVALUATION.SCALING==-2){P*=100;}var R=Math.min.apply(Math,r);var T=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(P,t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION);if(t.oConfig.EVALUATION.SCALING==-2){T+=" %";}var U=T.toString();var W=Number(O);if(t.oConfig.EVALUATION.SCALING==-2){W*=100;}var X=Math.max.apply(Math,r);var Y=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(W,t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION);if(t.oConfig.EVALUATION.SCALING==-2){Y+=" %";}var Z=Y.toString();try{var $=sap.ushell.components.tiles.indicatorTileUtils.util.formatOdataObjectToString(Math.min.apply(Math,p));var a1=sap.ushell.components.tiles.indicatorTileUtils.util.formatOdataObjectToString(Math.max.apply(Math,p));}catch(e){t.logError(e);}if(o=="MEASURE"){if(w.length!=0){t.firstwH=w[$];t.lastwH=w[a1];}if(x.length!=0){t.firstcH=x[$];t.lastcH=x[a1];}if(y.length!=0){t.firstcL=y[$];t.lastcL=y[a1];}if(z.length!=0){t.firstwL=z[$];t.lastwL=z[a1];}}var b1={width:"100%",height:"100%",unit:t.unit||"",chart:{color:"Neutral",data:n.results},size:"Auto",minXValue:$,maxXValue:a1,minYValue:R,maxYValue:X,firstXLabel:{label:B+"",color:"Neutral"},lastXLabel:{label:K+"",color:"Neutral"},firstYLabel:{label:U+"",color:"Neutral"},lastYLabel:{label:Z+"",color:"Neutral"},minLabel:{},maxLabel:{}},c1;switch(g){case"MA":for(i in f){if(f[i].TYPE=="CL"){b1.minThreshold={color:"Error"};c1={};c1[d]="";c1[M]=Number(f[i].FIXED);t.cl=Number(f[i].FIXED);b1.minThreshold.data=(o=="MEASURE")?n.results:[c1];C=(o=="MEASURE")?t.sCriticalLow:M;}else if(f[i].TYPE=="WL"){b1.maxThreshold={color:"Good"};c1={};c1[d]="";c1[M]=Number(f[i].FIXED);b1.maxThreshold.data=(o=="MEASURE")?n.results:[c1];F=(o=="MEASURE")?t.sWarningLow:M;t.wl=Number(f[i].FIXED);}else if(f[i].TYPE=="TA"){c1={};c1[d]="";c1[M]=Number(f[i].FIXED);b1.target={color:"Neutral"};b1.target.data=(o=="MEASURE")?n.results:[c1];I=(o=="MEASURE")?t.sTarget:M;}}b1.innerMinThreshold={data:[]};b1.innerMaxThreshold={data:[]};if(o=="FIXED"){b1.firstYLabel.color=N<t.cl?"Error":((t.cl<=N)&&(N<=t.wl))?"Critical":(N>t.wl)?"Good":"Neutral";b1.lastYLabel.color=O<t.cl?"Error":((t.cl<=O)&&(O<=t.wl))?"Critical":(O>t.wl)?"Good":"Neutral";}else if(o=="MEASURE"&&t.firstwL&&t.lastwL&&t.firstcL&&t.lastcL){b1.firstYLabel.color=N<t.firstcL?"Error":((t.firstcL<=N)&&(N<=t.firstwL))?"Critical":(N>t.firstwL)?"Good":"Neutral";b1.lastYLabel.color=O<t.lastcL?"Error":((t.lastcL<=O)&&(O<=t.lastwL))?"Critical":(O>t.lastwL)?"Good":"Neutral";}break;case"MI":for(i in f){if(f[i].TYPE=="CH"){c1={};c1[d]="";c1[M]=Number(f[i].FIXED);t.ch=Number(f[i].FIXED);b1.maxThreshold={color:"Error"};b1.maxThreshold.data=(o=="MEASURE")?n.results:[c1];F=(o=="MEASURE")?t.sCriticalHigh:M;}else if(f[i].TYPE=="WH"){c1={};c1[d]="";c1[M]=Number(f[i].FIXED);t.wh=Number(f[i].FIXED);b1.minThreshold={color:"Good"};b1.minThreshold.data=(o=="MEASURE")?n.results:[c1];C=(o=="MEASURE")?t.sWarningHigh:M;}else if(f[i].TYPE=="TA"){c1={};c1[d]="";c1[M]=Number(f[i].FIXED);b1.target={color:"Neutral"};b1.target.data=(o=="MEASURE")?n.results:[c1];I=(o=="MEASURE")?t.sTarget:M;}}if(o=="FIXED"){b1.firstYLabel.color=N>t.ch?"Error":((t.wh<=N)&&(N<=t.ch))?"Critical":(N<t.wh)?"Good":"Neutral";b1.lastYLabel.color=O>t.ch?"Error":((t.wh<=O)&&(O<=t.ch))?"Critical":(O<t.wh)?"Good":"Neutral";}else if(o=="MEASURE"&&t.firstwH&&t.lastwH&&t.firstcH&&t.lastcH){b1.firstYLabel.color=N>t.firstcH?"Error":((t.firstwH<=N)&&(N<=t.firstcH))?"Critical":(N<t.firstwH)?"Good":"Neutral";b1.lastYLabel.color=O>t.lastcH?"Error":((t.lastwH<=O)&&(O<=t.lastcH))?"Critical":(O<t.lastwH)?"Good":"Neutral";}b1.innerMaxThreshold={data:[]};b1.innerMinThreshold={data:[]};break;case"RA":for(i in f){if(f[i].TYPE=="CH"){c1={};c1[d]="";c1[M]=Number(f[i].FIXED);t.ch=Number(f[i].FIXED);b1.maxThreshold={color:"Error"};b1.maxThreshold.data=(o=="MEASURE")?n.results:[c1];F=(o=="MEASURE")?t.sCriticalHigh:M;}else if(f[i].TYPE=="WH"){c1={};c1[d]="";c1[M]=Number(f[i].FIXED);t.wh=Number(f[i].FIXED);b1.innerMaxThreshold={color:"Good"};b1.innerMaxThreshold.data=(o=="MEASURE")?n.results:[c1];H=(o=="MEASURE")?t.sWarningHigh:M;}else if(f[i].TYPE=="WL"){c1={};c1[d]="";c1[M]=Number(f[i].FIXED);t.wl=Number(f[i].FIXED);b1.innerMinThreshold={color:"Good"};b1.innerMinThreshold.data=(o=="MEASURE")?n.results:[c1];G=(o=="MEASURE")?t.sWarningLow:M;}else if(f[i].TYPE=="CL"){c1={};c1[d]="";c1[M]=Number(f[i].FIXED);t.cl=Number(f[i].FIXED);b1.minThreshold={color:"Error"};b1.minThreshold.data=(o=="MEASURE")?n.results:[c1];C=(o=="MEASURE")?t.sCriticalLow:M;}else if(f[i].TYPE=="TA"){c1={};c1[d]="";c1[M]=Number(f[i].FIXED);b1.target={color:"Neutral"};b1.target.data=(o=="MEASURE")?n.results:[c1];I=(o=="MEASURE")?t.sTarget:M;}}if(o=="FIXED"){b1.firstYLabel.color=(N>t.ch||N<t.cl)?"Error":((t.wh<=N)&&(N<=t.ch))||((t.cl<=N)&&(N<=t.wl))?"Critical":((N>=t.wl)&&(N<=t.wh))?"Good":"Neutral";b1.lastYLabel.color=(O>t.ch||O<t.cl)?"Error":((t.wh<=O)&&(O<=t.ch))||((t.cl<=O)&&(O<=t.wl))?"Critical":((O>=t.wl)&&(O<=t.wh))?"Good":"Neutral";}else if(o=="MEASURE"&&t.firstwL&&t.lastwL&&t.firstcL&&t.lastcL&&t.firstwH&&t.lastwH&&t.firstcH&&t.lastcH){b1.firstYLabel.color=(N>t.firstcH||N<t.firstcL)?"Error":((t.firstwH<=N)&&(N<=t.firstcH))||((t.firstcL<=N)&&(N<=t.firstwL))?"Critical":((N>=t.firstwL)&&(N<=t.firstwH))?"Good":"Neutral";b1.lastYLabel.color=(O>t.lastcH||O<t.lastcL)?"Error":((t.lastwH<=O)&&(O<=t.lastcH))||((t.lastcL<=O)&&(O<=t.lastwL))?"Critical":((O>=t.lastwL)&&(O<=t.lastwH))?"Good":"Neutral";}break;}var d1=function(e1,a,b){return new c({color:"{/"+e1+"/color}",points:{path:"/"+e1+"/data",template:new A({x:"{"+a+"}",y:"{"+b+"}"})}});};t.getTile().getTileContent()[1].getContent().setTarget(d1("target",d,I));t.getTile().getTileContent()[1].getContent().setInnerMinThreshold(d1("innerMinThreshold",d,G));t.getTile().getTileContent()[1].getContent().setInnerMaxThreshold(d1("innerMaxThreshold",d,H));t.getTile().getTileContent()[1].getContent().setMinThreshold(d1("minThreshold",d,C));t.getTile().getTileContent()[1].getContent().setMaxThreshold(d1("maxThreshold",d,F));t.getTile().getTileContent()[1].getContent().setChart(d1("chart",d,M));t._updateTileModel(b1);}},flowWithoutDesignTimeCall:function(){this.DEFINITION_DATA=this.oConfig;this._updateTileModel(this.DEFINITION_DATA);if(this.oTileApi.visible.isVisible()&&!this.firstTimeVisible){this.firstTimeVisible=true;}this.onAfterFinalEvaluation();},flowWithDesignTimeCall:function(){var t=this;try{var a=sap.ushell.components.tiles.indicatorTileUtils.cache.getEvaluationById(this.oConfig.EVALUATION.ID);if(a){t.oConfig.EVALUATION_FILTERS=a.EVALUATION_FILTERS;t.flowWithoutDesignTimeCall();}else{sap.ushell.components.tiles.indicatorTileUtils.util.getFilterFromRunTimeService(this.oConfig,function(f){t.oConfig.EVALUATION_FILTERS=f;sap.ushell.components.tiles.indicatorTileUtils.cache.setEvaluationById(t.oConfig.TILE_PROPERTIES.id,t.oConfig);t.flowWithoutDesignTimeCall();});}}catch(e){this.logError(e);}},refreshHandler:function(C){if(!C.firstTimeVisible){if(Number(this.oTileApi.configuration.getParameterValueAsString("isSufficient"))){C.flowWithoutDesignTimeCall();}else{C.flowWithDesignTimeCall();}}},visibleHandler:function(i){if(!i){this.firstTimeVisible=false;sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.trendChartODataReadRef);}if(i){this.refreshHandler(this);}},setTextInTile:function(){var t=this;this._updateTileModel({header:t.oTileApi.preview.getTitle()||sap.ushell.components.tiles.indicatorTileUtils.util.getChipTitle(t.oConfig),subheader:t.oTileApi.preview.getDescription()||sap.ushell.components.tiles.indicatorTileUtils.util.getChipSubTitle(t.oConfig)});},onInit:function(){var t=this;this.firstTimeVisible=false;this.oDualTrendView=this.getView();this.oViewData=this.oDualTrendView.getViewData();this.oTileApi=this.oViewData.chip;if(this.oTileApi.visible){this.oTileApi.visible.attachVisible(this.visibleHandler.bind(this));}this.system=this.oTileApi.url.getApplicationSystem();this.oDualTrendView.oGenericTile.setState(L.Loading);if(this.oTileApi.preview.isEnabled()){this.setTextInTile();this._updateTileModel({value:8888,size:S.Auto,frameType:"TwoByOne",state:L.Loading,valueColor:V.Error,indicator:D.None,title:"Liquidity Structure",footer:"Current Quarter",description:"Apr 1st 2013 (B$)",width:"100%",height:"100%",chart:{color:"Good",data:[{day:0,balance:0},{day:30,balance:20},{day:60,balance:20},{day:100,balance:80}]},target:{color:"Error",data:[{day:0,balance:0},{day:30,balance:30},{day:60,balance:40},{day:100,balance:90}]},maxThreshold:{color:"Good",data:[{day:0,balance:0},{day:30,balance:40},{day:60,balance:50},{day:100,balance:100}]},innerMaxThreshold:{color:"Error",data:[]},innerMinThreshold:{color:"Neutral",data:[]},minThreshold:{color:"Error",data:[{day:0,balance:0},{day:30,balance:20},{day:60,balance:30},{day:100,balance:70}]},minXValue:0,maxXValue:100,minYValue:0,maxYValue:100,firstXLabel:{label:"June 123",color:"Error"},lastXLabel:{label:"June 30",color:"Error"},firstYLabel:{label:"0M",color:"Good"},lastYLabel:{label:"80M",color:"Critical"},minLabel:{},maxLabel:{}});this.oDualTrendView.oGenericTile.setState(L.Loaded);}else{try{sap.ushell.components.tiles.indicatorTileUtils.util.getParsedChip(this.oTileApi.configuration.getParameterValueAsString("tileConfiguration"),function(a){t.oConfig=a;t.setTextInTile();t.oDualTrendView.oGenericTile.attachPress(function(){sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(t.trendChartODataReadRef);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,null);window.location.hash=sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system);});if(Number(t.oTileApi.configuration.getParameterValueAsString("isSufficient"))){sap.ushell.components.tiles.indicatorTileUtils.cache.setEvaluationById(t.oConfig.TILE_PROPERTIES.id,t.oConfig);t.flowWithoutDesignTimeCall();}else{t.flowWithDesignTimeCall();}});}catch(e){this.logError(e);}}},_setLocalModelToTile:function(){if(!this.getTile().getModel()){this.getTile().setModel(new J({}));}},onExit:function(){sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.trendChartODataReadRef);}});return{};},true);
sap.ui.predefine('sap/ushell/components/tiles/indicatorDualTrend/DualTrend.view',["sap/ui/core/mvc/JSView","sap/ca/ui/model/format/NumberFormat","sap/ui/model/analytics/odata4analytics","sap/ushell/components/tiles/indicatorTileUtils/smartBusinessUtil","sap/suite/ui/microchart/AreaMicroChartItem","sap/suite/ui/microchart/AreaMicroChartPoint","sap/suite/ui/microchart/AreaMicroChartLabel","sap/suite/ui/microchart/AreaMicroChart","sap/m/TileContent","sap/m/NumericContent","sap/m/GenericTile","sap/ui/model/json/JSONModel"],function(J,N,o,s,A,a,b,c,T,d,G,e){"use strict";sap.ui.getCore().loadLibrary("sap.suite.ui.microchart");sap.ui.jsview("tiles.indicatorDualTrend.DualTrend",{getControllerName:function(){return"tiles.indicatorDualTrend.DualTrend";},createContent:function(){this.setHeight("100%");this.setWidth("100%");var f=function(m){return new A({color:"Good",points:{path:"/"+m+"/data",template:new a({x:"{day}",y:"{balance}"})}});};var g=function(m){return new b({label:"{/"+m+"/label}",color:"{/"+m+"/color}"});};var h={footer:"",header:"",subheader:""};var n=new c({width:"{/width}",height:"{/height}",size:"{/size}",target:f("target"),innerMinThreshold:f("innerMinThreshold"),innerMaxThreshold:f("innerMaxThreshold"),minThreshold:f("minThreshold"),maxThreshold:f("maxThreshold"),chart:f("chart"),minXValue:"{/minXValue}",maxXValue:"{/maxXValue}",minYValue:"{/minYValue}",maxYValue:"{/maxYValue}",firstXLabel:g("firstXLabel"),lastXLabel:g("lastXLabel"),firstYLabel:g("firstYLabel"),lastYLabel:g("lastYLabel"),minLabel:g("minLabel"),maxLabel:g("maxLabel")});var i=new T({unit:"{/unit}",size:"{/size}",content:n});var j=new d({value:"{/value}",scale:"{/scale}",unit:"{/unit}",indicator:"{/indicator}",size:"{/size}",formatterValue:true,truncateValueTo:6,valueColor:"{/valueColor}"});var k=new T({unit:"{/unit}",size:"{/size}",content:j});this.oGenericTile=new G({subheader:"{/subheader}",frameType:"TwoByOne",size:"{/size}",header:"{/header}",tileContent:[k,i]});var l=new e();l.setData(h);this.oGenericTile.setModel(l);return this.oGenericTile;}});},true);
sap.ui.predefine('sap/ushell/components/tiles/indicatorHarveyBall/HarveyBallTile.controller',["sap/ui/model/json/JSONModel","sap/suite/ui/commons/library"],function(J,a){"use strict";var I=a.InfoTileValueColor;var b=a.InfoTileSize;var L=a.LoadState;sap.ui.controller("tiles.indicatorHarveyBall.HarveyBallTile",{onInit:function(){this.getView().setModel(new J());this.initializeVariables();this.attachHandlers();this.getVariable("tile").setState(L.Loading);this.readChipConfiguration();},attachHandlers:function(){var t=this;var c=this.getVariable("chip");if(c.visible){c.visible.attachVisible(function(v){if(v){t.onVisible();}else{t.abortAllOpenODataRequests();}});}this.getVariable("tile").attachPress(function(){t.abortAllOpenODataRequests();var i=t.getVariable("indicatorUtils");t.getVariable("cache").setKpivalueById(t.getVariable("chipId"),null);window.location.hash=i.getNavigationTarget(t.getVariable("evalData"),t.getVariable("system"));});},initializeVariables:function(){this._variables={};this._oDataRequests={};var v=this.getView();var V=v.getViewData();var t=v.oTile;var c=V.chip;this.setVariable("indicatorUtils",sap.ushell.components.tiles.indicatorTileUtils.util);this.setVariable("cache",sap.ushell.components.tiles.indicatorTileUtils.cache);this.setVariable("hasAppeared",false);this.setVariable("chip",c);this.setVariable("tile",t);this.setVariable("tileControl",t.getTileContent()[0].getContent());this.setVariable("configurationString",c.configuration.getParameterValueAsString("tileConfiguration"));this.setVariable("system",c.url.getApplicationSystem());},getVariable:function(k){return this._variables[k];},setVariable:function(k,v){this._variables[k]=v;},readChipConfiguration:function(){var t=this;var c=this.getVariable("chip");var u=this.getVariable("indicatorUtils");u.getParsedChip(this.getVariable("configurationString"),function(e){t.setVariable("evalData",e);t.setVariable("chipId",e.TILE_PROPERTIES.id);t.setVariable("tileProperties",e.TILE_PROPERTIES);if(c.preview){c.preview.setTargetUrl(u.getNavigationTarget(e,t.getVariable("system")));t.loadPreviewData();if(c.preview.isEnabled()){t.getVariable("tile").setState(L.Loaded);}else{t.loadActualData();}}});},loadPreviewData:function(){var t=this.getVariable("indicatorUtils").getTileTitleSubtitle(this.getVariable("chip"));this.getView().getModel().setData({fractionValue:34,value:100,size:b.Auto,frameType:"OneByOne",color:"Good",state:L.Loading,header:t.title||this.getVariable("indicatorUtils").getChipTitle(this.getVariable("evalData")),subheader:t.subTitle||this.getVariable("indicatorUtils").getChipSubTitle(this.getVariable("evalData"))});},loadActualData:function(){if(Number(this.getVariable("chip").configuration.getParameterValueAsString("isSufficient"))){this.getVariable("cache").setEvaluationById(this.getVariable("chipId"),this.getVariable("evalData"));this.onEvalFiltersFetched();}else{this.fetchEvalFilters(this.onEvalFiltersFetched);}},registerOpenODataRequest:function(k,r){this._oDataRequests[k]=r;},deregisterOpenODataRequest:function(k){delete this._oDataRequests[k];},abortAllOpenODataRequests:function(){for(var c in this._oDataRequests){try{this.getVariable("indicatorUtils").abortPendingODataCalls(this._oDataRequests[c]);delete this._oDataRequests[c];}catch(e){}}},fetchKpiValue:function(p){function m(o,u,C,S,j){var D=o.read(u,null,null,true,function(l){t.deregisterOpenODataRequest(C.type);if(l&&l.results&&l.results.length){try{if(C.thresholds&&C.thresholds.length){t._setThresholdValues(l.results[0]);}k[C.type]=l.results[0][C.measure];k.unit=k.unit||l.results[0][C.unit]||"";if(--h==0){t.getVariable("cache").setKpivalueById(t.getVariable("chipId"),k);S.call(t,k);}}catch(e){t.logError(e);}}else{j.call(t,"no data");}},function(e){t.deregisterOpenODataRequest(C.type);if(e&&e.response){j.call(t,e.message);}});t.registerOpenODataRequest(C.type,D);}var t=this;var i=this.getVariable("indicatorUtils");var c=this.getVariable("cache").getKpivalueById(this.getVariable("chipId"));if(c){p.fnS.call(t,c);}else{var M=p.measure1,s=p.measure2;var u=p.url,E=p.entitySet;var v=p.filters;var f=p.fractionFilters.concat(v);var q,Q;var d,g,k;var h=2;f.forEach(function(e){e.value=e.value+"";e.valueTo=e.valueTo+"";});if(p.thresholds&&p.thresholds.length){q=i.prepareQueryServiceUri(this.getVariable("chip").url.addSystemToServiceUrl(u),E,M+","+p.thresholds,null,v);}else{q=i.prepareQueryServiceUri(this.getVariable("chip").url.addSystemToServiceUrl(u),E,M,null,v);}Q=i.prepareQueryServiceUri(this.getVariable("chip").url.addSystemToServiceUrl(u),E,s,null,f);d=q.unit[0];g=Q.unit[0];k={kpiValue:null,fractionValue:null,unit:""};if(q){m(q.model,q.uri,{measure:M,type:"kpiValue",unit:d,thresholds:p.thresholds},p.fnS,p.fnE);}if(Q){m(Q.model,Q.uri,{measure:s,type:"fractionValue",unit:g},p.fnS,p.fnE);}if(!(q&&Q)){p.fnE.call(t,"Error Preparing Query Service URI");}}},_setThresholdValues:function(d){var t=this.getVariable("oThreshold"),e;if(t){if(this.getVariable("evalData").EVALUATION.VALUES_SOURCE=="RELATIVE"){if(t.TA.COLUMN_NAME){t.TA.VALUE=parseFloat(d[t.TA.COLUMN_NAME]);for(e in t){if(!t[e].COLUMN_NAME){t[e].VALUE=t.TA.VALUE*t[e].VALUE/100;}}}}else{for(e in t){if(t[e].COLUMN_NAME){t[e].VALUE=parseFloat(d[t[e].COLUMN_NAME]);}}}}this.setVariable("oThreshold",t);},getThresholdObject:function(){var t=this.getVariable("oThreshold");if(!t){var T=this.getVariable("evalData").EVALUATION_VALUES;t={};for(var i=0,l=T.length;i<l;i++){t[T[i].TYPE]={VALUE:parseFloat(T[i].FIXED),COLUMN_NAME:T[i].COLUMN_NAME};}this.setVariable("oThreshold",t);}return t;},hasSomeValue:function(){var f=true;if(arguments.length){for(var i=0,l=arguments.length;i<l;i++){if(!(arguments[i]||arguments[i]=="0")){f=false;break;}}}else{f=false;}return f;},getTrendColor:function(k){var c="Neutral";var t,g,W,d,C,e;if(this.getVariable("tileProperties").isFractionMeasure){t=this.getThresholdObject();g=this.getVariable("evalData").EVALUATION.GOAL_TYPE;if(g=="MA"){W=t.WL;C=t.CL;if(this.hasSomeValue(W,C)){c="Good";if(k<C.VALUE){c="Error";}else if(k<=W.VALUE){c="Critical";}}}else if(g=="MI"){d=t.WH;e=t.CH;if(this.hasSomeValue(d,e)){c="Error";if(k<d.VALUE){c="Good";}else if(k<=e.VALUE){c="Critical";}}}else{W=t.WL;C=t.CL;d=t.WH;e=t.CH;if(this.hasSomeValue(d,e,C,W)){if(k<=C.VALUE||k>=d.VALUE){c="Error";}else if((W.VALUE>=k&&k>=C.VALUE)||(e.VALUE>=k&&k>=d.VALUE)){c="Critical";}else{c="Good";}}}}return I[c];},_getThresholdMeasures:function(){var t=[];var T=this.getThresholdObject();for(var e in T){if(T[e].COLUMN_NAME){t.push(T[e].COLUMN_NAME);}}return t;},onEvalFiltersFetched:function(){var t=this;if(this.getVariable("chip").visible.isVisible()&&!this.getVariable("hasAppeared")){try{var k=this.getVariable("evalData");var u=k.EVALUATION.ODATA_URL;var E=k.EVALUATION.ODATA_ENTITYSET;var c=this.getVariable("tileProperties");var h=[];var v=this.getVariable("indicatorUtils").prepareFilterStructure(k.EVALUATION_FILTERS,k.ADDITIONAL_FILTERS);var f=k.EVALUATION.COLUMN_NAME;var d=f;var g=[];if(c.isFractionMeasure){d=c.harveyTotalMeasure;g=this._getThresholdMeasures();}else{h=this.getVariable("indicatorUtils").prepareFilterStructure(c.harveyFilters||h);}this.setVariable("totalMeasure",d);this.setVariable("fractionMeasure",f);this.fetchKpiValue({measure1:d,measure2:f,entitySet:E,thresholds:g,url:u,filters:v,fractionFilters:h,fnS:function(i){i.kpiValue=Number(i.kpiValue);i.fractionValue=Number(i.fractionValue);t.setVariable("kpiValue",i.kpiValue);t.setVariable("fractionValue",i.fractionValue);t.onKpiValueFetched(i.kpiValue,i.unit,i.fractionValue);},fnE:this.logError});t.setVariable("hasAppeared",true);}catch(e){this.logError(e);}}},fetchEvalFilters:function(s){var t=this;try{var c=this.getVariable("cache").getEvaluationById(this.getVariable("chipId"));if(c){this.getVariable("evalData").EVALUATION_FILTERS=c.EVALUATION_FILTERS;s();}else{var d=this.getVariable("indicatorUtils").getFilterFromRunTimeService(this.getVariable("evalData"),function(f){t.deregisterOpenODataRequest("kpiFilterRequest");t.getVariable("evalData").EVALUATION_FILTERS=f;t.getVariable("cache").setEvaluationById(t.getVariable("chipId"),t.getVariable("evalData"));s.call(t);},function(e){this.logError(e);t.deregisterOpenODataRequest("kpiFilterRequest");});this.registerOpenODataRequest("kpiFilterRequest",d);}}catch(e){this.logError(e);}},onKpiValueFetched:function(k,d,f,e){var i=this.getVariable("indicatorUtils");var s=k;var g=f;var h=this.getVariable("evalData");var j=h.EVALUATION.SCALING;if(j==-2){s*=100;g*=100;}var c=this.isACurrencyMeasure(this.getVariable("totalMeasure"));s=i.getLocaleFormattedValue(Number(s),j,null,c,d);c=this.isACurrencyMeasure(this.getVariable("fractionMeasure"));g=i.getLocaleFormattedValue(Number(g),j,null,c,d);this.getView().getModel().setProperty("/totalLabel",s+" "+d);this.getView().getModel().setProperty("/fractionLabel",g+" "+e);this.getView().getModel().setProperty("/color",this.getTrendColor(f));this.getView().getModel().setProperty("/value",k);this.getView().getModel().setProperty("/fractionValue",f);var n=i.getNavigationTarget(this.getVariable("evalData"),this.getVariable("system"));this.getVariable("tile").$().wrap("<a href ='"+n+"'></a>");this.getVariable("tile").setState(L.Loaded);},logError:function(e){this.getVariable("tile").setState(L.Failed);this.getVariable("indicatorUtils").logError(e,this.getVariable("tile"));},onVisible:function(){if(!this.getVariable("hasAppeared")){if(Number(this.getVariable("chip").configuration.getParameterValueAsString("isSufficient"))){this.onEvalFiltersFetched();}else{this.fetchEvalFilters(this.onEvalFiltersFetched);}}},onExit:function(){this.abortAllOpenODataRequests();}});});
sap.ui.predefine('sap/ushell/components/tiles/indicatorTileUtils/oData4Analytics',["sap/ui/model/odata/ODataModel","sap/ui/model/FilterOperator","sap/ui/model/Filter","sap/ui/model/Sorter","sap/ui/core/Core"],function(O,F,c,S){"use strict";sap=sap||{};sap.ushell=sap.ushell||{};sap.ushell.components=sap.ushell.components||{};sap.ushell.components.tiles.indicatorTileUtils=sap.ushell.components.tiles.indicatorTileUtils||{};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics=sap.ushell.components.tiles.indicatorTileUtils.odata4analytics||{};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.constants={};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.constants.SAP_NAMESPACE="http://www.sap.com/Protocols/SAPData";sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.constants.VERSION="0.7";sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.helper={renderPropertyKeyValue:function(f,p){if(f.charAt(0)=="'"){throw"Illegal property value starting with a quote";}switch(p){case"Edm.String":return"'"+f+"'";case"Edm.DateTime":return"datetime'"+f+"'";case"Edm.Guid":return"guid'"+f+"'";case"Edm.Time":return"time'"+f+"'";case"Edm.DateTimeOffset":return"datetimeoffset'"+f+"'";default:return f;}},renderPropertyFilterValue:function(f,p){if(f.charAt(0)=="'"){throw"Illegal property value starting with a quote";}switch(p){case"Edm.String":return"'"+f+"'";case"Edm.DateTime":return"datetime'"+f+"'";case"Edm.Guid":return"guid'"+f+"'";case"Edm.Time":return"time'"+f+"'";case"Edm.DateTimeOffset":return"datetimeoffset'"+f+"'";default:return f;}},tokenizeNametoLabelText:function(n){var l="";l=n.replace(/([^A-Z0-9_]+)([A-Z0-9_])/g,"$1 $2");l=l.replace(/([A-Z0-9_]{2,})([A-Z0-9_])([^A-Z0-9_]+)/g,"$1 $2$3");l=l.replace(/(.*) _E$/,"$1");l=l.replace(/(.*) _(.*)/g,"$1 $2");return l;}};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Model=function(m,a){this._init(m,a);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Model.ReferenceByURI=function(u){return{sServiceURI:u};};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Model.ReferenceByModel=function(m){return{oModel:m};};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Model.ReferenceWithWorkaround=function(m,w){return{oModelReference:m,aWorkaroundID:w};};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Model.prototype={_init:function(m,a){this._oActivatedWorkarounds={};if(m&&m.aWorkaroundID){var w=m.aWorkaroundID;for(var i=0;i<w.length;i++){this._oActivatedWorkarounds[w[i]]=true;}m=m.oModelReference;}if(!m||(!m.sServiceURI&&!m.oModel)){throw"Usage with oModelReference being an instance of Model.ReferenceByURI or Model.ReferenceByModel";}if(m.oModel){this._oModel=m.oModel;}else{this._oModel=new O(m.sServiceURI);}if(this._oModel.getServiceMetadata().dataServices==undefined){throw"Model could not be loaded";}this.mergeV2Annotations(a);this._oQueryResultSet={};this._oParameterizationSet={};this._oEntityTypeSet={};this._oEntitySetSet={};this._oEntityTypeNameToEntitySetMap={};var s=this._oModel.getServiceMetadata().dataServices.schema[0];var C;for(i=-1,C;C=s.entityContainer[++i];){if(C.isDefaultEntityContainer=="true"){this._oDefaultEntityContainer=C;break;}}var e=s.entityType;var q=[],p=[],u=[];var j;for(i=-1,t;t=e[++i];){var P=false;if(t.extensions!=undefined){var E;for(j=-1;E=t.extensions[++j];){if(E.namespace==sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.constants.SAP_NAMESPACE&&E.name=="semantics"){P=true;switch(E.value){case"aggregate":q.push(t);break;case"parameters":p.push(t);break;default:u.push(t);}}if(P){continue;}}if(!P){u.push(t);}}else{u.push(t);}}for(i=-1,t;t=u[++i];){var o=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.EntityType(this._oModel.getServiceMetadata(),s,t);this._oEntityTypeSet[o.getQName()]=o;var b=this._getEntitySetsOfType(s,o.getQName());if(b.length==0){throw"Invalid consumption model: No entity set for entity type annotated with parameters semantics";}if(b.length>1){throw"Unsupported consumption model: More than one entity set for entity type annotated with parameters semantics";}var d=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.EntitySet(this._oModel.getServiceMetadata(),s,b[0][0],b[0][1]);this._oEntitySetSet[d.getQName()]=d;this._oEntityTypeNameToEntitySetMap[o.getQName()]=d;}var f={};for(i=-1,t;t=p[++i];){o=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.EntityType(this._oModel.getServiceMetadata(),s,t);this._oEntityTypeSet[o.getQName()]=o;b=this._getEntitySetsOfType(s,o.getQName());if(b.length==0){throw"Invalid consumption model: No entity set for entity type annotated with parameters semantics";}if(b.length>1){throw"Unsupported consumption model: More than one entity set for entity type annotated with parameters semantics";}d=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.EntitySet(this._oModel.getServiceMetadata(),s,b[0][0],b[0][1]);this._oEntitySetSet[d.getQName()]=d;this._oEntityTypeNameToEntitySetMap[o.getQName()]=d;var g=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Parameterization(o,d);this._oParameterizationSet[g.getName()]=g;f[o.getQName()]=g;var h=o.getQName();if(s.association!=undefined){var A;for(j=-1;A=s.association[++j];){if(A.referentialConstraint==undefined){continue;}var k=null;if(A.end[0].type==h&&A.end[0].multiplicity=="*"&&A.end[1].multiplicity=="1"){k=A.end[1].type;}else if(A.end[1].type==h&&A.end[1].multiplicity=="*"&&A.end[0].multiplicity=="1"){k=A.end[0].type;}if(!k){continue;}if(A.referentialConstraint.dependent.propertyRef.length!=1){continue;}var l=g.findParameterByName(A.referentialConstraint.dependent.propertyRef[0].name);if(l==null){continue;}var v=this._oEntityTypeSet[k];var V=this._oEntityTypeNameToEntitySetMap[k];l.setValueSetEntity(v,V);}}}var t;for(i=-1,t;t=q[++i];){o=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.EntityType(this._oModel.getServiceMetadata(),s,t);this._oEntityTypeSet[o.getQName()]=o;var Q=o.getQName();g=null;var n=null;if(s.association!=undefined){for(j=-1,A;A=s.association[++j];){var r=null;if(A.end[0].type==Q){r=A.end[1].type;}else if(A.end[1].type==Q){r=A.end[0].type;}else{continue;}var M=null;M=f[r];if(M!=null){if(g!=null){throw"LIMITATION: Unable to handle multiple parameter entity types of query entity "+o.name;}else{g=M;n=A;}}}}b=this._getEntitySetsOfType(s,o.getQName());if(b.length!=1){throw"Invalid consumption model: There must be exactly one entity set for an entity type annotated with aggregating semantics";}d=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.EntitySet(this._oModel.getServiceMetadata(),s,b[0][0],b[0][1]);this._oEntitySetSet[d.getQName()]=d;this._oEntityTypeNameToEntitySetMap[o.getQName()]=d;var x=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.QueryResult(this,o,d,g);this._oQueryResultSet[x.getName()]=x;if(g){g.setTargetQueryResult(x,n);}}},oUI5ODataModelAnnotatableObject:{objectName:"schema",keyPropName:"namespace",extensions:true,aSubObject:[{objectName:"entityType",keyPropName:"name",extensions:true,aSubObject:[{objectName:"property",keyPropName:"name",aSubObject:[],extensions:true}]},{objectName:"entityContainer",keyPropName:"name",extensions:false,aSubObject:[{objectName:"entitySet",keyPropName:"name",extensions:true,aSubObject:[]}]}]},mergeV2Annotations:function(a){try{var A=JSON.parse(a);}catch(e){return;}var m;try{m=this._oModel.getServiceMetadata().dataServices;}catch(e){return;}for(var p in A){if(!(this.oUI5ODataModelAnnotatableObject.objectName===p)){continue;}if(!(A[p]instanceof Array)){continue;}this.mergeV2AnnotationLevel(m[this.oUI5ODataModelAnnotatableObject.objectName],A[this.oUI5ODataModelAnnotatableObject.objectName],this.oUI5ODataModelAnnotatableObject);break;}return;},mergeV2AnnotationLevel:function(M,a,u){for(var i=-1,A;A=a[++i];){for(var j=-1,o;o=M[++j];){if(!(A[u.keyPropName]==o[u.keyPropName])){continue;}if(A.extensions!=undefined){if(o.extensions==undefined){o.extensions=[];}for(var l=-1,b;b=A.extensions[++l];){var f=false;for(var m=-1,d;d=o.extensions[++m];){if(b.name==d.name&&b.namespace==d.namespace){d.value=b.value;f=true;break;}}if(!f){o.extensions.push(b);}}}for(var k=-1,U;U=u.aSubObject[++k];){for(var p in A){if(!(U.objectName==p)){continue;}if(!(A[U.objectName]instanceof Array)){continue;}if((o[U.objectName]==undefined)||(!(o[U.objectName]instanceof Array))){continue;}this.mergeV2AnnotationLevel(o[U.objectName],A[U.objectName],U);break;}}}}return;},findQueryResultByName:function(n){var q=this._oQueryResultSet[n];if(!q&&this._oDefaultEntityContainer){var Q=this._oDefaultEntityContainer.name+"."+n;q=this._oQueryResultSet[Q];}return q;},getAllQueryResultNames:function(){if(this._aQueryResultNames){return this._aQueryResultNames;}this._aQueryResultNames=new Array(0);for(var n in this._oQueryResultSet){this._aQueryResultNames.push(this._oQueryResultSet[n].getName());}return this._aQueryResultNames;},getAllQueryResults:function(){return this._oQueryResultSet;},getODataModel:function(){return this._oModel;},_getEntitySetsOfType:function(s,q){var e=[];for(var i=-1,E;E=s.entityContainer[++i];){for(var j=-1,o;o=E.entitySet[++j];){if(o.entityType==q){e.push([E,o]);}}}return e;},_oModel:null,_oDefaultEntityContainer:null,_aQueryResultNames:null,_oQueryResultSet:null,_oParameterizationSet:null,_oEntityTypeSet:null,_oEntitySetSet:null,_oEntityTypeNameToEntitySetMap:null,_oActivatedWorkarounds:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.QueryResult=function(m,e,E,p){this._init(m,e,E,p);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.QueryResult.prototype={_init:function(m,e,E,p,a){this._oModel=m;this._oEntityType=e;this._oEntitySet=E;this._oParameterization=p;this._oDimensionSet={};this._oMeasureSet={};var P=e.getTypeDescription().property;var A={};for(var i=-1,o;o=P[++i];){if(o.extensions==undefined){continue;}for(var j=-1,b;b=o.extensions[++j];){if(!b.namespace==sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.constants.SAP_NAMESPACE){continue;}switch(b.name){case"aggregation-role":switch(b.value){case"dimension":var d=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Dimension(this,o);this._oDimensionSet[d.getName()]=d;break;case"measure":var M=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Measure(this,o);this._oMeasureSet[M.getName()]=M;break;case"totaled-properties-list":this._oTotaledPropertyListProperty=o;break;}break;case"attribute-for":var D=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.DimensionAttribute(this,o);A[D.getKeyProperty()]=D;break;}}}for(var s in A){D=A[s];D.getDimension().addAttribute(D);}if(m._oActivatedWorkarounds.IdentifyTextPropertiesByName){var f=[];for(var g in this._oDimensionSet){d=this._oDimensionSet[g];if(!d.getTextProperty()){var t=null;t=e.findPropertyByName(g+"Name");if(!t){t=e.findPropertyByName(g+"Text");}if(!t){t=e.findPropertyByName(g+"Desc");}if(!t){t=e.findPropertyByName(g+"Description");}if(t){d.setTextProperty(t);f.push(t.name);}}}var h;for(i=-1,h;h=f[++i];){delete this._oDimensionSet[h];}}},getName:function(){return this.getEntitySet().getQName();},getParameterization:function(){return this._oParameterization;},getAllDimensionNames:function(){if(this._aDimensionNames){return this._aDimensionNames;}this._aDimensionNames=[];for(var n in this._oDimensionSet){this._aDimensionNames.push(this._oDimensionSet[n].getName());}return this._aDimensionNames;},getAllDimensions:function(){return this._oDimensionSet;},getAllMeasureNames:function(){if(this._aMeasureNames){return this._aMeasureNames;}this._aMeasureNames=[];for(var n in this._oMeasureSet){this._aMeasureNames.push(this._oMeasureSet[n].getName());}return this._aMeasureNames;},getAllMeasures:function(){return this._oMeasureSet;},findDimensionByName:function(n){return this._oDimensionSet[n];},getTotaledPropertiesListProperty:function(){return this._oTotaledPropertyListProperty;},findMeasureByName:function(n){return this._oMeasureSet[n];},getModel:function(){return this._oModel;},getEntityType:function(){return this._oEntityType;},getEntitySet:function(){return this._oEntitySet;},_oModel:null,_oEntityType:null,_oEntitySet:null,_oParameterization:null,_aDimensionNames:null,_oDimensionSet:null,_aMeasureNames:null,_oMeasureSet:null,_oTotaledPropertyListProperty:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Parameterization=function(e,E){this._init(e,E);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Parameterization.prototype={_init:function(e,E){this._oEntityType=e;this._oEntitySet=E;this._oParameterSet={};var p=e.getTypeDescription().property;for(var i=-1,P;P=p[++i];){if(P.extensions==undefined){continue;}for(var j=-1,o;o=P.extensions[++j];){if(!o.namespace==sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.constants.SAP_NAMESPACE){continue;}switch(o.name){case"parameter":var a=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Parameter(this,P);this._oParameterSet[a.getName()]=a;break;}}}},setTargetQueryResult:function(q,a){this._oQueryResult=q;var Q=this._oEntityType.getSchema().namespace+"."+a.name;var n=this._oEntityType.getTypeDescription().navigationProperty;if(!n){throw"Invalid consumption model: Parameters entity type lacks navigation property for association to query result entity type";}for(var i=-1,N;N=n[++i];){if(N.relationship==Q){this._oNavPropToQueryResult=N.name;}}if(!this._oNavPropToQueryResult){throw"Invalid consumption model: Parameters entity type lacks navigation property for association to query result entity type";}},getName:function(){return this.getEntitySet().getQName();},getAllParameterNames:function(){if(this._aParameterNames){return this._aParameterNames;}this._aParameterNames=[];for(var n in this._oParameterSet){this._aParameterNames.push(this._oParameterSet[n].getName());}return this._aParameterNames;},getAllParameters:function(){return this._oParameterSet;},findParameterByName:function(n){return this._oParameterSet[n];},getNavigationPropertyToQueryResult:function(){return this._oNavPropToQueryResult;},getEntityType:function(){return this._oEntityType;},getEntitySet:function(){return this._oEntitySet;},_oEntityType:null,_oEntitySet:null,_oQueryResult:null,_oNavPropToQueryResult:null,_aParameterNames:null,_oParameterSet:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Parameter=function(p,P){this._init(p,P);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Parameter.prototype={_init:function(p,P){this._oParameterization=p;this._oProperty=P;var e=p.getEntityType();if(P.extensions!=undefined){for(var i=-1,E;E=P.extensions[++i];){if(!E.namespace==sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.constants.SAP_NAMESPACE){continue;}switch(E.name){case"parameter":switch(E.value){case"mandatory":this._bRequired=true;break;case"optional":this._bRequired=false;break;default:throw"Invalid annotation value for parameter property";}break;case"label":this._sLabelText=E.value;break;case"text":this._oTextProperty=e.findPropertyByName(E.value);break;case"upper-boundary":this._bIntervalBoundaryParameter=true;this._oUpperIntervalBoundaryParameterProperty=e.findPropertyByName(E.value);break;case"lower-boundary":this._bIntervalBoundaryParameter=true;this._oLowerIntervalBoundaryParameterProperty=e.findPropertyByName(E.value);break;}}}if(!this._sLabelText){this._sLabelText="";}},setValueSetEntity:function(e,E){this._oValueSetEntityType=e;this._oValueSetEntitySet=E;},getTextProperty:function(){return this._oTextProperty;},getLabelText:function(){if(!this._sLabelText&&this._oQueryResult._oModel._oActivatedWorkarounds.CreateLabelsFromTechnicalNames){this._sLabelText=sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.helper.tokenizeNametoLabelText(this.getName());}return this._sLabelText;},isOptional:function(){return(!this._bRequired);},isIntervalBoundary:function(){return this._bIntervalBoundaryParameter;},isLowerIntervalBoundary:function(){return(!!this._oUpperIntervalBoundaryParameterProperty);},getPeerIntervalBoundaryParameter:function(){var p=null;if(this._oLowerIntervalBoundaryParameterProperty){p=this._oLowerIntervalBoundaryParameterProperty.name;}else{p=this._oUpperIntervalBoundaryParameterProperty.name;}if(!p){throw"Parameter is not an interval boundary";}return this._oParameterization.findParameterByName(p);},isValueSetAvailable:function(){return(!!this._oValueSetEntityType);},getName:function(){return this._oProperty.name;},getProperty:function(){return this._oProperty;},getContainingParameterization:function(){return this._oParameterization;},getURIToValueEntitySet:function(s){var u=null;u=(s||"")+"/"+this._oValueSetEntitySet.getQName();return u;},_oParameterization:null,_oProperty:null,_sLabelText:null,_oTextProperty:null,_bRequired:false,_bIntervalBoundaryParameter:false,_oLowerIntervalBoundaryParameterProperty:null,_oUpperIntervalBoundaryParameterProperty:null,_oValueSetEntityType:null,_oValueSetEntitySet:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Dimension=function(q,p){this._init(q,p);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Dimension.prototype={_init:function(q,p){this._oQueryResult=q;this._oProperty=p;this._oAttributeSet={};if(p.extensions!=undefined){for(var i=-1,e;e=p.extensions[++i];){if(!e.namespace==sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.constants.SAP_NAMESPACE){continue;}switch(e.name){case"label":this._sLabelText=e.value;break;case"text":this._oTextProperty=q.getEntityType().findPropertyByName(e.value);break;case"super-ordinate":this._sSuperOrdinatePropertyName=e.value;break;}}}if(!this._sLabelText){this._sLabelText="";}},getName:function(){return this._oProperty.name;},getKeyProperty:function(){return this._oProperty;},getTextProperty:function(){return this._oTextProperty;},setTextProperty:function(t){this._oTextProperty=t;},getLabelText:function(){if(!this._sLabelText&&this._oQueryResult._oModel._oActivatedWorkarounds.CreateLabelsFromTechnicalNames){this._sLabelText=sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.helper.tokenizeNametoLabelText(this.getName());}return this._sLabelText;},getSuperOrdinateDimension:function(){if(!this._sSuperOrdinatePropertyName){return null;}return this._oQueryResult.findDimensionByName(this._sSuperOrdinatePropertyName);},getHierarchy:function(){if(!this._oHierarchy){this._oHierarchy=this._oQueryResult.getEntityType().getHierarchy(this._oProperty.name);}return this._oHierarchy;},getAllAttributeNames:function(){if(this._aAttributeNames){return this._aAttributeNames;}this._aAttributeNames=[];for(var n in this._oAttributeSet){this._aAttributeNames.push(this._oAttributeSet[n].getName());}return this._aAttributeNames;},getAllAttributes:function(){return this._oAttributeSet;},findAttributeByName:function(n){return this._oAttributeSet[n];},addAttribute:function(d){this._oAttributeSet[d.getName()]=d;},getContainingQueryResult:function(){return this._oQueryResult;},_oQueryResult:null,_oProperty:null,_oTextProperty:null,_sLabelText:null,_sSuperOrdinatePropertyName:null,_aAttributeNames:null,_oAttributeSet:null,_oHierarchy:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.DimensionAttribute=function(q,p){this._init(q,p);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.DimensionAttribute.prototype={_init:function(q,p){this._oQueryResult=q;this._oProperty=p;if(p.extensions!=undefined){for(var i=-1,e;e=p.extensions[++i];){if(!e.namespace==sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.constants.SAP_NAMESPACE){continue;}switch(e.name){case"attribute-for":this._sDimensionName=e.value;break;case"label":this._sLabelText=e.value;break;case"text":this._oTextProperty=q.getEntityType().findPropertyByName(e.value);break;}}}},getName:function(){return this._oProperty.name;},getKeyProperty:function(){return this._oProperty;},getTextProperty:function(){return this._oTextProperty;},getLabelText:function(){return this._sLabelText;},getDimension:function(){return this._oQueryResult.findDimensionByName(this._sDimensionName);},_oQueryResult:null,_oProperty:null,_oTextProperty:null,_sLabelText:null,_sDimensionName:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Measure=function(q,p){this._init(q,p);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Measure.prototype={_init:function(q,p){this._oQueryResult=q;this._oProperty=p;if(p.extensions!=undefined){for(var i=-1,e;e=p.extensions[++i];){if(!e.namespace==sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.constants.SAP_NAMESPACE){continue;}switch(e.name){case"label":this._sLabelText=e.value;break;case"text":this._oTextProperty=q.getEntityType().findPropertyByName(e.value);break;case"unit":this._oUnitProperty=q.getEntityType().findPropertyByName(e.value);break;}}}if(!this._sLabelText){this._sLabelText="";}},getName:function(){return this._oProperty.name;},getRawValueProperty:function(){return this._oProperty;},getFormattedValueProperty:function(){return this._oTextProperty;},getUnitProperty:function(){return this._oUnitProperty;},getLabelText:function(){return this._sLabelText;},_oQueryResult:null,_oProperty:null,_oTextProperty:null,_sLabelText:null,_oUnitProperty:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.EntitySet=function(m,s,C,e){this._init(m,s,C,e);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.EntitySet.prototype={_init:function(m,s,C,e){this._oEntitySet=e;this._oContainer=C;this._oSchema=s;this._oModel=m;if(s.entityContainer.length>1){this._sQName=C.name+"."+e.name;}else{this._sQName=e.name;}},getQName:function(){return this._sQName;},getSetDescription:function(){return this._oEntitySet;},getSchema:function(){return this._oSchema;},getModel:function(){return this._oModel;},_oEntitySet:null,_oContainer:null,_oSchema:null,_oModel:null,_sQName:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.EntityType=function(m,s,e){this._init(m,s,e);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.EntityType.prototype={_init:function(m,s,e){this._oEntityType=e;this._oSchema=s;this._oModel=m;this._oPropertySet={};this._aFilterablePropertyNames=[];this._aSortablePropertyNames=[];this._aRequiredFilterPropertyNames=[];this._sQName=s.namespace+"."+e.name;var r={};var R=null;for(var i=-1,p;p=e.property[++i];){this._aFilterablePropertyNames.push(p.name);this._aSortablePropertyNames.push(p.name);if(p.extensions==undefined){continue;}for(var j=-1,E;E=p.extensions[++j];){if(!E.namespace==sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.constants.SAP_NAMESPACE){continue;}switch(E.name){case"filterable":if(E.value=="false"){this._aFilterablePropertyNames.pop(p.name);}break;case"sortable":if(E.value=="false"){this._aSortablePropertyNames.pop(p.name);}break;case"required-filter":if(E.value=="true"){this._aRequiredFilterPropertyNames.push(p.name);}break;case"hierarchy-node-for":if(!(R=r[p.name])){R=r[p.name]={};}R.dimensionName=E.value;break;case"hierarchy-parent-node-for":case"hierarchy-parent-nod":if(!(R=r[E.value])){R=r[E.value]={};}R.parentNodeIDProperty=p;break;case"hierarchy-level-for":if(!(R=r[E.value])){R=r[E.value]={};}R.levelProperty=p;break;case"hierarchy-drill-state-for":case"hierarchy-drill-stat":if(!(R=r[E.value])){R=r[E.value]={};}R.drillStateProperty=p;break;}}this._oPropertySet[p.name]=p;}this._oRecursiveHierarchySet={};for(var h in r){var H=r[h];var o=this._oPropertySet[h];var d=this._oPropertySet[H.dimensionName];if(d==null){d=o;}this._oRecursiveHierarchySet[d.name]=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.RecursiveHierarchy(e,o,H.parentNodeIDProperty,H.levelProperty,d);}},findPropertyByName:function(n){return this._oPropertySet[n];},getFilterablePropertyNames:function(){return this._aFilterablePropertyNames;},getSortablePropertyNames:function(){return this._aSortablePropertyNames;},getRequiredFilterPropertyNames:function(){return this._aRequiredFilterPropertyNames;},getAllHierarchyPropertyNames:function(){if(this._aHierarchyPropertyNames){return this._aHierarchyPropertyNames;}this._aHierarchyPropertyNames=[];for(var n in this._oRecursiveHierarchySet){this._aHierarchyPropertyNames.push(this._oRecursiveHierarchySet[n].getNodeValueProperty().name);}return this._aHierarchyPropertyNames;},getHierarchy:function(n){if(this._oRecursiveHierarchySet[n]==undefined){return null;}return this._oRecursiveHierarchySet[n];},getQName:function(){return this._sQName;},getTypeDescription:function(){return this._oEntityType;},getSchema:function(){return this._oSchema;},getModel:function(){return this._oModel;},_oEntityType:null,_oSchema:null,_oModel:null,_sQName:null,_oPropertySet:null,_aFilterablePropertyNames:null,_aRequiredFilterPropertyNames:null,_aHierarchyPropertyNames:null,_oRecursiveHierarchySet:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.RecursiveHierarchy=function(e,n,p,N,o){this._init(e,n,p,N,o);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.RecursiveHierarchy.prototype={_init:function(e,n,p,N,o){this._oEntityType=e;this._oNodeIDProperty=n;this._oParentNodeIDProperty=p;this._oNodeLevelProperty=N;this._oNodeValueProperty=o;},isRecursiveHierarchy:function(){return true;},isLeveledHierarchy:function(){return false;},getNodeIDProperty:function(){return this._oNodeIDProperty;},getParentNodeIDProperty:function(){return this._oParentNodeIDProperty;},getNodeLevelProperty:function(){return this._oNodeLevelProperty;},getNodeValueProperty:function(){return this._oNodeValueProperty;},_oNodeIDProperty:null,_oParentNodeIDProperty:null,_oNodeLevelProperty:null,_oNodeValueProperty:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.FilterExpression=function(m,s,e){this._init(m,s,e);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.FilterExpression.prototype={_init:function(m,s,e){this._oEntityType=e;this._oSchema=s;this._oModel=m;this._aFilterCondition=[];},clear:function(){this._aFilterCondition=[];},addCondition:function(p,o,v,V){var P=this._oEntityType.findPropertyByName(p);if(P==null){throw"Cannot add filter condition for unknown property name "+p;}var f=this._oEntityType.getFilterablePropertyNames();if(f.indexOf(p)===-1){throw"Cannot add filter condition for not filterable property name "+p;}this._aFilterCondition.push({property:P,op:o,val1:v,val2:V});return this._aFilterablePropertyNames;},addSetCondition:function(p,v){var P=this._oEntityType.findPropertyByName(p);if(P==null){throw"Cannot add filter condition for unknown property name "+p;}var f=this._oEntityType.getFilterablePropertyNames();if(f.indexOf(p)===-1){throw"Cannot add filter condition for not filterable property name "+p;}for(var i=-1,V;V=v[++i];){this._aFilterCondition.push({property:P,op:F.EQ,val1:V});}return this._aFilterablePropertyNames;},getExpressionAsUI5FilterArray:function(){var f=[];for(var i=-1,C;C=this._aFilterCondition[++i];){f.push(new c(C.property.name,C.op,C.val1,C.val2));}return f;},getURIFilterOptionValue:function(){if(this._aFilterCondition.length==0){return"";}this._aFilterCondition.sort(function(a,b){if(a.property.name==b.property.name){return 0;}if(a.property.name>b.property.name){return 1;}return-1;});var p=this._aFilterCondition[0].property.name;var o="";var s="";for(var i=-1,C;C=this._aFilterCondition[++i];){if(p!=C.property.name){o+=(o==""?"":" and ")+"("+s+")";s="";p=C.property.name;}switch(C.op){case F.BT:s+=(s==""?"":" or ")+"("+C.property.name+" "+F.GE.toLowerCase()+" "+sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.helper.renderPropertyFilterValue(C.val1,C.property.type)+" and "+C.property.name+" "+F.LE.toLowerCase()+" "+sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.helper.renderPropertyFilterValue(C.val2,C.property.type)+")";break;default:s+=(s==""?"":" or ")+"("+C.property.name+" "+C.op.toLowerCase()+" "+sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.helper.renderPropertyFilterValue(C.val1,C.property.type)+")";}}o+=(o==""?"":" and ")+"("+s+")";return o;},getEntityType:function(){return this._oEntityType;},getSchema:function(){return this._oSchema;},getModel:function(){return this._oModel;},_oEntityType:null,_oSchema:null,_oModel:null,_aFilterCondition:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.SortOrder={Ascending:"asc",Descending:"desc"};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.SortExpression=function(m,s,e){this._init(m,s,e);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.SortExpression.prototype={_init:function(m,s,e){this._oEntityType=e;this._oSchema=s;this._oModel=m;this._aSortCondition=[];},_containsSorter:function(p){var r=null;for(var i=-1,C;C=this._aSortCondition[++i];){if(C.property.name===p){r={sorter:C,index:i};break;}}return r;},_removeFromArray:function(a,f,t){var r=a.slice((t||f)+1||a.length);a.length=f<0?a.length+f:f;return a.push.apply(a,r);},clear:function(){this._aSortCondition=[];},addSorter:function(p,s){var P=this._oEntityType.findPropertyByName(p);if(P==null){throw"Cannot add sort condition for unknown property name "+p;}if(this._containsSorter(p)!=null){throw"Sort condition for this property name is already defined "+p;}var a=this._oEntityType.getSortablePropertyNames();if(a.indexOf(p)===-1){throw"Cannot add sort condition for not sortable property name "+p;}this._aSortCondition.push({property:P,order:s});return this;},removeSorter:function(p){if(!p){return;}var s=this._containsSorter(p);if(s){this._removeFromArray(this._aSortCondition,s.index);}},getExpressionsAsUI5SorterArray:function(){var s=[];for(var i=-1,C;C=this._aSortCondition[++i];){s.push(new S(C.property.name,C.order==sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.SortOrder.Descending));}return s;},getExpressionAsUI5Sorter:function(){var s=this.getExpressionsAsUI5SorterArray();if(s.length==0){return null;}return s[0];},getURIOrderByOptionValue:function(){if(this._aSortCondition.length==0){return"";}var o="";for(var i=-1,C;C=this._aSortCondition[++i];){o+=C.property.name+" "+C.order;if(i<this._aSortCondition.length-1){o+=", ";}}return o;},getEntityType:function(){return this._oEntityType;},getSchema:function(){return this._oSchema;},getModel:function(){return this._oModel;},_oEntityType:null,_oSchema:null,_oModel:null,_aSortCondition:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.ParameterizationRequest=function(p){this._init(p);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.ParameterizationRequest.prototype={_init:function(p){if(!p){throw"No parameterization given";}this._oParameterization=p;this._oParameterValueAssignment=[];},getParameterization:function(){return this._oParameterization;},setParameterValue:function(p,v,t){var P=this._oParameterization.findParameterByName(p);if(!P){throw"Invalid parameter name "+p;}if(t!=null){if(!P.isIntervalBoundary()){throw"Range value cannot be applied to parameter "+p+" accepting only single values";}if(!P.isLowerIntervalBoundary()){throw"Range value given, but parameter "+p+" does not hold the lower boundary";}}if(!P.isIntervalBoundary()){if(v==null){delete this._oParameterValueAssignment[p];}else{this._oParameterValueAssignment[p]=v;}}else{if(v==null&&t!=null){throw"Parameter "+p+": An upper boundary cannot be given without the lower boundary";}if(v==null){delete this._oParameterValueAssignment[p];t=null;}else{this._oParameterValueAssignment[p]=v;}var u=P.getPeerIntervalBoundaryParameter();if(t==null){t=v;}if(v==null){delete this._oParameterValueAssignment[u.getName()];}else{this._oParameterValueAssignment[u.getName()]=t;}}return;},getURIToParameterizationEntitySet:function(s){return(s||"")+"/"+this._oParameterization.getEntitySet().getQName();},getURIToParameterizationEntry:function(s){var d=this._oParameterization.getAllParameters();for(var D in d){if(this._oParameterValueAssignment[D]==undefined){throw"Parameter "+D+" has no value assigned";}}var k="",f=true;for(var p in this._oParameterValueAssignment){k+=(f?"":",")+p+"="+sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.helper.renderPropertyKeyValue(this._oParameterValueAssignment[p],d[p].getProperty().type);f=false;}return(s||"")+"/"+this._oParameterization.getEntitySet().getQName()+"("+k+")";},_oParameterization:null,_oParameterValueAssignment:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.QueryResultRequest=function(q){this._init(q);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.QueryResultRequest.prototype={_init:function(q,p){this._oQueryResult=q;this._oParameterizationRequest=p;this._oAggregationLevel={};this._oMeasures={};this._bIncludeEntityKey=false;this._oFilterExpression=null;},setParameterizationRequest:function(p){this._oParameterizationRequest=p;},getQueryResult:function(){return this._oQueryResult;},setAggregationLevel:function(d){this._oAggregationLevel={};if(!d){d=this._oQueryResult.getAllDimensionNames();}this.addToAggregationLevel(d);},addToAggregationLevel:function(d){if(!d){return;}for(var i=-1,D;D=d[++i];){if(!this._oQueryResult.findDimensionByName(D)){throw D+" is not a valid dimension name";}this._oAggregationLevel[D]={key:true,text:false,attributes:null};}},removeFromAggregationLevel:function(d){if(!d){return;}for(var i=-1,D;D=d[++i];){if(!this._oQueryResult.findDimensionByName(D)){throw D+" is not a valid dimension name";}if(this._oAggregationLevel[D]!=undefined){delete this._oAggregationLevel[D];this.getSortExpression().removeSorter(D);}}},getAggregationLevel:function(){var d=[];for(var D in this._oAggregationLevel){d.push(D);}return d;},getAggregationLevelDetails:function(d){if(this._oAggregationLevel[d]==undefined){throw"Aggregation level does not include dimension "+d;}return this._oAggregationLevel[d];},setMeasures:function(m){if(!m){m=this._oQueryResult.getAllMeasureNames();}this._oMeasures={};for(var i=-1,M;M=m[++i];){if(!this._oQueryResult.findMeasureByName(M)){throw M+" is not a valid measure name";}this._oMeasures[M]={value:true,text:false,unit:false};}},getMeasureNames:function(){var m=[];for(var M in this._oMeasures){m.push(M);}return m;},includeDimensionKeyTextAttributes:function(d,I,b,a){var D=[];if(d){if(this._oAggregationLevel[d]==undefined){throw d+" is not included in the aggregation level";}D.push(d);}else{for(var n in this._oAggregationLevel){D.push(n);}a=null;}for(var i=-1,s;s=D[++i];){if(I!=null){this._oAggregationLevel[s].key=I;}if(b!=null){this._oAggregationLevel[s].text=b;}if(a!=null){this._oAggregationLevel[s].attributes=a;}}},includeMeasureRawFormattedValueUnit:function(m,I,b,a){var M=[];if(m){if(this._oMeasures[m]==undefined){throw m+" is not part of the query result";}M.push(m);}else{for(var n in this._oMeasures){M.push(n);}}for(var i=-1,s;s=M[++i];){if(I!=null){this._oMeasures[s].value=I;}if(b!=null){this._oMeasures[s].text=b;}if(a!=null){this._oMeasures[s].unit=a;}}},getFilterExpression:function(){if(this._oFilterExpression==null){var e=this._oQueryResult.getEntityType();this._oFilterExpression=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.FilterExpression(e.getModel(),e.getSchema(),e);}return this._oFilterExpression;},setFilterExpression:function(f){this._oFilterExpression=f;},getSortExpression:function(){if(this._oSortExpression==null){var e=this._oQueryResult.getEntityType();this._oSortExpression=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.SortExpression(e.getModel(),e.getSchema(),e);}return this._oSortExpression;},setSortExpression:function(s){this._oSortExpression=s;},setRequestOptions:function(i,I){if(i){this._bIncludeEntityKey=i;}if(I){this._bIncludeCount=I;}},setResultPageBoundaries:function(s,e){if(s!=null&&typeof s!=="number"){throw"Start value must be null or numeric";}if(e!==null&&typeof e!=="number"){throw"End value must be null or numeric";}if(s==null){s=1;}if(s<1||s>(e==null?s:e)){throw"Invalid values for requested page boundaries";}this._iSkipRequestOption=(s>1)?s:null;this._iTopRequestOption=(e!=null)?(e-s+1):null;},getResultPageBoundaries:function(){var s,e;if(this._iSkipRequestOption==null){s=1;e=1;}else{s=this._iSkipRequestOption;e=this._iSkipRequestOption+this._iTopRequestOption;}return{start:s,end:(this._iTopRequestOption!=null)?e:null};},getURIToQueryResultEntitySet:function(s){var u=null;if(this._oQueryResult.getParameterization()){if(!this._oParameterizationRequest){throw"Missing parameterization request";}else{u=this._oParameterizationRequest.getURIToParameterizationEntry(s)+"/"+this._oQueryResult.getParameterization().getNavigationPropertyToQueryResult();}}else{u=(s||"")+"/"+this._oQueryResult.getEntitySet().getQName();}return u;},getURIQueryOptionValue:function(q){var Q=null;switch(q){case"$select":{var s="",i;for(var d in this._oAggregationLevel){var D=this._oQueryResult.findDimensionByName(d);var o=this._oAggregationLevel[d];if(o.key==true){s+=(s==""?"":",")+D.getKeyProperty().name;}if(o.text==true&&D.getTextProperty()){s+=(s==""?"":",")+D.getTextProperty().name;}if(o.attributes){var a;for(i=-1;a=o.attributes[++i];){s+=(s==""?"":",")+D.findAttributeByName(a).getName();}}}for(var m in this._oMeasures){var M=this._oQueryResult.findMeasureByName(m);var b=this._oMeasures[m];if(b.value==true){s+=(s==""?"":",")+M.getRawValueProperty().name;}if(b.text==true&&M.getFormattedValueProperty()){s+=(s==""?"":",")+M.getFormattedValueProperty().name;}if(b.unit==true&&M.getUnitProperty()){s+=(s==""?"":",")+M.getUnitProperty().name;}}if(this._bIncludeEntityKey){var k=this._oQueryResult.getEntityType().getTypeDescription().key.propertyRef,K;for(i=-1;K=k[++i];){s+=(s==""?"":",")+K.name;}}Q=(s||null);break;}case"$filter":{var f=null;if(this._oFilterExpression){f=this._oFilterExpression.getURIFilterOptionValue();}Q=(f||null);break;}case"$orderby":{var e=null;if(this._oSortExpression){e=this._oSortExpression.getURIOrderByOptionValue();}Q=(e||null);break;}case"$top":{if(this._iTopRequestOption!==null){Q=this._iTopRequestOption;}break;}case"$skip":{Q=this._iSkipRequestOption;break;}default:break;}return Q;},getURIToQueryResultEntries:function(s){var r=this.getURIToQueryResultEntitySet(s);var a=this.getURIQueryOptionValue("$select");var f=this.getURIQueryOptionValue("$filter");var b=this.getURIQueryOptionValue("$orderby");var t=this.getURIQueryOptionValue("$top");var d=this.getURIQueryOptionValue("$skip");var u=r;var q=false;if(a){u+="?$select="+a;q=true;}if(this._oFilterExpression&&f){if(!q){u+="?";q=true;}else{u+="&";}u+="$filter="+f;}if(this._oSortExpression&&b){if(!q){u+="?";q=true;}else{u+="&";}u+="$orderby="+b;}if(this._iTopRequestOption&&t){if(!q){u+="?";q=true;}else{u+="&";}u+="$top="+t;}if(this._iSkipRequestOption&&d){if(!q){u+="?";q=true;}else{u+="&";}u+="$skip="+d;}if(this._bIncludeCount){if(!q){u+="?";q=true;}else{u+="&";}u+="$inlinecount=allpages";}return u;},_oQueryResult:null,_oParameterizationRequest:null,_oAggregationLevel:null,_oMeasures:null,_bIncludeEntityKey:null,_bIncludeCount:null,_oFilterExpression:null,_oSortExpression:null,_iSkipRequestOption:0,_iTopRequestOption:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.ParameterValueSetRequest=function(p){this._init(p);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.ParameterValueSetRequest.prototype={_init:function(p){this._oParameter=p;this._oValueSetResult={};this._oFilterExpression=null;this._oSortExpression=null;},includeParameterText:function(i){if(i!=null){this._oValueSetResult.text=i;}},getFilterExpression:function(){if(this._oFilterExpression==null){var e=this._oParameter.getContainingParameterization().getEntityType();this._oFilterExpression=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.FilterExpression(e.getModel(),e.getSchema(),e);}return this._oFilterExpression;},setFilterExpression:function(f){this._oFilterExpression=f;},getSortExpression:function(){if(this._oSortExpression==null){var e=this._oQueryResult.getEntityType();this._oSortExpression=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.SortExpression(e.getModel(),e.getSchema(),e);}return this._oSortExpression;},setSortExpression:function(s){this._oSortExpression=s;},getURIQueryOptionValue:function(q){var Q=null;switch(q){case"$select":{var s="";s+=(s==""?"":",")+this._oParameter.getProperty().name;if(this._oValueSetResult.text==true&&this._oParameter.getTextProperty()){s+=(s==""?"":",")+this._oParameter.getTextProperty().name;}Q=(s||null);break;}case"$filter":{var f=null;if(this._oFilterExpression){f=this._oFilterExpression.getURIFilterOptionValue();}Q=(f||null);break;}case"$orderby":{var a=null;if(this._oSortExpression){a=this._oSortExpression.getURIOrderByOptionValue();}Q=(a||null);break;}default:break;}return Q;},getURIToParameterValueSetEntries:function(s){var r=null;r=(s||"")+"/"+this._oParameter.getContainingParameterization().getEntitySet().getQName();var a=this.getURIQueryOptionValue("$select");var f=this.getURIQueryOptionValue("$filter");var b=this.getURIQueryOptionValue("$orderby");var u=r;var q=false;if(a){u+="?$select="+a;q=true;}if(this._oFilterExpression&&f){if(!q){u+="?";q=true;}else{u+="&";}u+="$filter="+f;}if(this._oSortExpression&&b){if(!q){u+="?";q=true;}else{u+="&";}u+="$orderby="+b;}return u;},_oParameter:null,_oFilterExpression:null,_oSortExpression:null,_oValueSetResult:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.DimensionMemberSetRequest=function(d,p){this._init(d,p);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.DimensionMemberSetRequest.prototype={_init:function(d,p){this._oDimension=d;this._oParameterizationRequest=p;this._oValueSetResult={};this._oFilterExpression=null;this._oSortExpression=null;},setParameterizationRequest:function(p){this._oParameterizationRequest=p;},includeDimensionTextAttributes:function(i,a){if(i!=null){this._oValueSetResult.text=i;}if(a!=null){this._oValueSetResult.attributes=a;}},getFilterExpression:function(){if(this._oFilterExpression==null){var e=this._oDimension.getContainingQueryResult().getEntityType();this._oFilterExpression=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.FilterExpression(e.getModel(),e.getSchema(),e);}return this._oFilterExpression;},setFilterExpression:function(f){this._oFilterExpression=f;},getSortExpression:function(){if(this._oSortExpression==null){var e=this._oQueryResult.getEntityType();this._oSortExpression=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.SortExpression(e.getModel(),e.getSchema(),e);}return this._oSortExpression;},setSortExpression:function(s){this._oSortExpression=s;},hasMasterDataAvailable:function(){return false;},getURIQueryOptionValue:function(q){var Q=null;switch(q){case"$select":{var s="";s+=(s==""?"":",")+this._oDimension.getKeyProperty().name;if(this._oValueSetResult.text==true&&this._oDimension.getTextProperty()){s+=(s==""?"":",")+this._oDimension.getTextProperty().name;}if(this._oValueSetResult.attributes){for(var i=-1,a;a=this._oValueSetResult.attributes[++i];){s+=(s==""?"":",")+this._oDimension.findAttributeByName(a).getName();}}Q=(s||null);break;}case"$filter":{var f=null;if(this._oFilterExpression){f=this._oFilterExpression.getURIFilterOptionValue();}Q=(f||null);break;}case"$orderby":{var b=null;if(this._oSortExpression){b=this._oSortExpression.getURIOrderByOptionValue();}Q=(b||null);break;}default:break;}return Q;},getURIToDimensionMemberEntries:function(s){var r=null;if(this._oDimension.getContainingQueryResult().getParameterization()){if(!this._oParameterizationRequest){throw"Missing parameterization request";}else{r=this._oParameterizationRequest.getURIToParameterizationEntry(s)+"/"+this._oDimension.getContainingQueryResult().getParameterization().getNavigationPropertyToQueryResult();}}else{r=(s||"")+"/"+this._oDimension.getContainingQueryResult().getEntitySet().getQName();}var a=this.getURIQueryOptionValue("$select");var f=this.getURIQueryOptionValue("$filter");var b=this.getURIQueryOptionValue("$orderby");var u=r;var q=false;if(a){u+="?$select="+a;q=true;}if(this._oFilterExpression&&f){if(!q){u+="?";q=true;}else{u+="&";}u+="$filter="+f;}if(this._oSortExpression&&b){if(!q){u+="?";q=true;}else{u+="&";}u+="$orderby="+b;}return u;},_oDimension:null,_oParameterizationRequest:null,_oFilterExpression:null,_oSortExpression:null,_oValueSetResult:null};return{};},true);
sap.ui.predefine('sap/ushell/components/tiles/indicatorTileUtils/smartBusinessUtil',["sap/ui/model/FilterOperator","sap/ui/model/analytics/odata4analytics","sap/ui/core/format/NumberFormat","sap/ui/model/odata/ODataModel","sap/base/Log","sap/ui/thirdparty/jquery","sap/base/util/UriParameters"],function(F,o,N,O,L,q,U){"use strict";var P=o.ParameterizationRequest;var Q=o.QueryResultRequest;var R=o.Model.ReferenceByModel;var M=o.Model;sap=sap||{};sap.ushell=sap.ushell||{};sap.ushell.components=sap.ushell.components||{};sap.ushell.components.tiles.indicatorTileUtils=sap.ushell.components.tiles.indicatorTileUtils||{};sap.ushell.components.tiles.indicatorTileUtils.util=sap.ushell.components.tiles.indicatorTileUtils.util||{};sap.ushell.components.tiles.indicatorTileUtils.util=(function(g,$){var c={},t={"ANN":"years","WEE":"weeks","DAY":"days","HUR":"hours","MIN":"minutes"},a={},b={};return{getScheduledJob:function(k){return a[k];},setScheduledJob:function(k,d){a[k]=d;},isCallInProgress:function(k){return b[k];},setUnsetCallInProgress:function(k,v){b[k]=v;},getTimeUnitMap:function(){return t;},getHanaUser:function(){return authObject.userName;},addSystemToServiceUrl:function(u,s){L.info("Hana Adapter --> Add System to Service Url");if(sap.ushell&&sap.ushell.Container){if(s){u=sap.ushell.Container.getService("URLParsing").addSystemToServiceUrl(u,s);}else{u=sap.ushell.Container.getService("URLParsing").addSystemToServiceUrl(u);}}return u;},getODataModelByServiceUri:function(s){s=this.addSystemToServiceUrl(s);if(!c[s]){var m=new O(s,{loadMetadataAsync:true,json:true});c[s]=m;}return c[s];},getEdmType:function(u,p){var d=null;if(u instanceof O){d=u;}else{d=this.getODataModelByServiceUri(u);}if(d&&d.getServiceMetadata()){var s=d.getServiceMetadata();var e=s.dataServices.schema[0].entityType;if(e){for(var i=0;i<e.length;i++){var f=e[i];var h=f.property;for(var j=0;j<h.length;j++){var k=h[j];if(k.name==p){return k.type;}}}}}return null;},getMillisecond:function(d,u){var r;switch(u){case"seconds":r=d*1000;break;case"minutes":r=d*60*1000;break;case"hours":r=d*60*60*1000;break;case"days":r=d*24*60*60*1000;break;case"weeks":r=d*7*24*60*60*1000;break;case"months":r=d*4*7*24*60*60*1000;break;case"years":r=d*12*4*7*24*60*60*1000;break;}return r;},getUTCDate:function(){var n=new Date();return n;},isCacheValid:function(d,e,f,h,i){var j=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(d);if(!j){return false;}else if(!(f&&Number(f))){return true;}var k=this.getMillisecond(f,t[h]),l;if(q.type(j.CachedTime)=="date"){l=j.CachedTime&&j.CachedTime.getTime();}else{l=j.CachedTime&&parseInt(j.CachedTime.substr(6),10);}var m=this.getUTCDate();return(l>=e&&k>=(m-l)&&!i);},getMantissaLength:function(n){var s=n.toString();var i=0;if(n<0){i=1;}if(s.indexOf(".")===-1){return(n<0?s.length-1:s.length);}return s.substring(i,s.indexOf(".")).length;},getLocaleFormattedValue:function(n,s,d,i,e){q.sap.require("sap.ui.core.format.NumberFormat");i=i||false;e=e||null;if(i){return N.getCurrencyInstance({style:"short",showMeasure:false}).format(n,e);}var D=2;var f={style:"short"};var h;if(!(d==-1||d==null)){f.shortDecimals=Number(d);f.minFractionDigits=Number(d);f.maxFractionDigits=Number(d);}var v=N.getInstance(f);if(s==-2){if(n>9999){h="????";}else if((n>-0.001&&n<0)||(n<0.001&&n>0)){h="0";}else{if(n.toString().indexOf(".")!=-1){h=Number(n).toFixed(4-n.toString().indexOf("."));}else{h=Number(n);}h=v.format(h);}}else if(d==-1||d==null){var m=this.getMantissaLength(n);if(!(m%3)){D=1;}if(m%3===1){D=3;}if(m%3===2){D=2;}if(Math.abs(n)%Math.pow(10,m-1)==0){D=0;}else if((Math.abs(n)%Math.pow(10,m-1))<6*Math.pow(10,m-4)){D=0;}v=N.getInstance({style:"short",shortDecimals:D});h=v.format(n);}else{h=v.format(n);}return h;},getPlatform:function(p){return(new U(window.location.href).get("sb_metadata")||p||"HANA").toUpperCase();},getTileTitleSubtitle:function(C){var d={};if(C.bag&&C.bag.getBagIds()&&C.bag.getBagIds().length){d.title=C.bag.getBag("sb_tileProperties").getText("title")||C.bag.getBag("sb_tileProperties").getProperty("title")||C.preview.getTitle();d.subTitle=C.bag.getBag("sb_tileProperties").getText("description")||C.bag.getBag("sb_tileProperties").getProperty("description")||C.preview.getDescription();}else{d.title=C.preview.getTitle();d.subTitle=C.preview.getDescription();}return d;},scheduleFetchDataJob:function(i){var d;if(this.getView().getViewName().indexOf("DualTile")!==-1){d=this.oKpiTileView.oConfig;}else{d=this.oConfig;}var k=d.TILE_PROPERTIES.id+"data";var r=sap.ushell.components.tiles.indicatorTileUtils.util.getScheduledJob(k);if(r){clearTimeout(r);r=undefined;}var t=sap.ushell.components.tiles.indicatorTileUtils.util.getTimeUnitMap(),e=sap.ushell.components.tiles.indicatorTileUtils.util.getCachingTime(d),f=sap.ushell.components.tiles.indicatorTileUtils.util.getCachingTimeUnit(d),h=sap.ushell.components.tiles.indicatorTileUtils.util.getMillisecond(e,t[f]),j;if(q.type(this.cacheTime)=="date"){j=this.cacheTime;}else{j=new Date(parseInt(this.cacheTime.substr(6),10));}var l=h-(sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate()-j);if(l<=0){l=0;}else if(l>2147483646){l=2147483646;}if(!i){l=300000;}if(this.getView().getViewName().indexOf("DualTile")!==-1){r=setTimeout(this.refreshPress.bind(this),l);}else{r=setTimeout(this.refreshHandler.bind(this,false,true),l);sap.ushell.components.tiles.indicatorTileUtils.util.setScheduledJob(k,r);}this.updateDatajobScheduled=true;},scheduleTimeStampJob:function(){var k=this.oConfig.TILE_PROPERTIES.id+"time",r=sap.ushell.components.tiles.indicatorTileUtils.util.getScheduledJob(k),d;if(r){clearTimeout(r);r=undefined;}if(q.type(this.cacheTime)=="date"){d=this.cacheTime;}else{d=new Date(parseInt(this.cacheTime.substr(6),10),13);}var e=sap.ushell.components.tiles.indicatorTileUtils.util.getTimeDifference(sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate()-d);r=setTimeout(this.setTimeStamp.bind(this,this.cacheTime),e.timer);sap.ushell.components.tiles.indicatorTileUtils.util.setScheduledJob(k,r);this.updateTimeStampjobScheduled=true;},getBoolValue:function(v){var r=false;if(typeof v==="boolean"&&v){r=true;}return r;},getSeconds:function(d){return(d/1000);},getMinutes:function(d){return(this.getSeconds(d)/60);},getHours:function(d){return(this.getMinutes(d)/60);},getDays:function(d){return(this.getHours(d)/24);},getWeeks:function(d){return(this.getDays(d)/7);},getMonths:function(d){return(this.getWeeks(d)/4);},getYears:function(d){return(this.getMonths(d)/12);},getTimeDifference:function(d){var r={};if(d){var m=this.getMinutes(d);var h=this.getHours(d);var e=this.getDays(d);if(m<5){r.time=0;r.unit="minutes";r.timer=Math.round(this.getMillisecond(5-m,"minutes"));}else if(m>=5&&m<60){if(m<10){r.time=5;}else{r.time=(m-(m%10));}r.unit="minutes";r.timer=Math.round(this.getMillisecond(10-(m%10),"minutes"));}else if(h>=1&&h<24){r.unit="hours";r.time=(h-(h%1));r.timer=Math.round(this.getMillisecond(1-(h%1),"hours"));}else if(e>=1&&e<2){r.unit="days";r.time=(e-(e%1));r.timer=Math.round(this.getMillisecond(1-(e%1),"days"));}else{r.unit="days";r.time=(e-(e%1));r.timer=this.getMillisecond(2,"days");}}else{r.timer=6000;r.unit="days";r.timer=2000;}return r;},getCachingTime:function(C){return((C.CACHINGTIME&&Number(C.CACHINGTIME))||(C.TILE_PROPERTIES.cachingTime&&Number(C.TILE_PROPERTIES.cachingTime)));},getCachingTimeUnit:function(C){return(C.CACHINGUNIT||C.TILE_PROPERTIES.cachingTimeUnit);},getFrontendCacheQuery:function(d,u,p,T){var e;try{var f=T.url.addSystemToServiceUrl("/sap/opu/odata/SSB/SMART_BUSINESS_RUNTIME_SRV");f=sap.ushell.components.tiles.indicatorTileUtils.util.cacheBustingMechanism(f);e=this.getODataModelByServiceUri(f);f="/CacheParameters(P_CacheType=1)/Results";return{oModel:e,uri:f};}catch(h){L.error("FrontEnd cache Metadata failed");return null;}},isDualTile:function(C){var d=C&&C.TILE_PROPERTIES&&C.TILE_PROPERTIES.tileType;if(d.indexOf("DT-")==-1){return false;}return true;},writeFrontendCacheByChipAndUserId:function(T,d,e,u,f){var s=function(e){L.info("cache write successFully");f(e);};var h=function(){L.error("cache update failed");f(null);};try{var i=T.url.addSystemToServiceUrl("/sap/opu/odata/SSB/SMART_BUSINESS_RUNTIME_SRV/");i=sap.ushell.components.tiles.indicatorTileUtils.util.cacheBustingMechanism(i);var j=this.getODataModelByServiceUri(i);var k="/CacheData";j.create(k,e,{async:true,success:s,error:h});}catch(l){L.error(l);}},getKpiChipsOnPage:function(d,e){var f=[];var l=sap.ushell.Container.getService("LaunchPage");l.getGroups().done(function(G){if(G&&G instanceof Array&&G.length){L.info("Group Chip fetch");}e(d,f);});},getFrontendCache:function(C,T){var d=this;var e=sap.ushell.components.tiles.indicatorTileUtils.cache.getFrontEndCacheDeferredObject(T.url.getApplicationSystem());var f;if(e){f=e;}else{f=q.Deferred();}var h=C&&C.TILE_PROPERTIES&&C.TILE_PROPERTIES.id;var i=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(h);if(i){e.resolve(true);}else if(e){return e.promise();}else{sap.ushell.components.tiles.indicatorTileUtils.cache.setFrontEndCacheDefferedObject(T.url.getApplicationSystem(),f);e=f;this.getKpiChipsOnPage(h,function(h,p){if(p){var j=d.getFrontendCacheQuery(p,sap.ushell.Container.getUser().getId(),p,T);if(j){var k=j.oModel;var l=j.uri;var m=false;k.read(l,null,null,true,function(n){if(n&&n.results&&n.results instanceof Array&&n.results.length){q.each(n.results,function(r,s){sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(s.ChipId,s);});}if(sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(h)){m=true;}e.resolve(m);},function(n){if(n&&n.response){L.error(n.message+" : "+n.request.requestUri);}e.reject();});}else{e.reject();}}else{e.resolve(false);}});}return e.promise();},getModelerRuntimeServiceModel:function(){var u="/sap/hba/r/sb/core/odata/runtime/SMART_BUSINESS.xsodata";u=sap.ushell.components.tiles.indicatorTileUtils.util.cacheBustingMechanism(u);return this.getODataModelByServiceUri(u);},getSapFontErrorCode:function(){return String.fromCharCode(0xe0b1);},getSapFontBusyCode:function(){return String.fromCharCode(0xe1f2);},prepareFilterStructure:function(f,d){var v=[];if(d){f=f.concat(d);}for(var i=0;i<f.length;i++){var p={};p.comparator=f[i].OPERATOR;p.filterPropertyName=f[i].NAME;if(f[i].ID){p.id=f[i].ID;}p.type=f[i].TYPE;p.value=f[i].VALUE_1;p.valueTo=f[i].VALUE_2;v.push(p);}return v;},getODataModelByServiceUriFromChipAPI:function(s,T){s=T.url.addSystemToServiceUrl(s);if(!c[s]){var m=new O(s,true);c[s]=m;}return c[s];},cacheBustingMechanism:function(u){if(window["sap-ushell-config"].cacheBusting.cacheBusterToken){var d=window["sap-ushell-config"].cacheBusting&&window["sap-ushell-config"].cacheBusting.cacheBusterToken;u=u+"?_="+d;}return u;},getRunTimeUri:function(p){var u="/sap/hba/r/sb/core/odata/runtime/SMART_BUSINESS.xsodata";var d="/sap/opu/odata/SSB/SMART_BUSINESS_RUNTIME_SRV";if(p.toUpperCase()=="HANA"){if(window["sap-ushell-config"].cacheBusting){u=sap.ushell.components.tiles.indicatorTileUtils.util.cacheBustingMechanism(u);}return u;}if(window["sap-ushell-config"].cacheBusting){d=sap.ushell.components.tiles.indicatorTileUtils.util.cacheBustingMechanism(d);}return d;},getFilterFromRunTimeService:function(C,T,s,e){var p=C.TILE_PROPERTIES.sb_metadata;var K=this.getODataModelByServiceUriFromChipAPI(this.getRunTimeUri(p),T);var f="ID eq '#EVALUATIONID'".replace("#EVALUATIONID",C.EVALUATION.ID);var k=K.read("/EVALUATION_FILTERS",null,{"$filter":f},true,function(d){var h=[];if(d.results.length){h=d.results;}s.call(this,h);},e);return k;},_getOData4AnalyticsObject:function(u){var m=null;if(u instanceof O){m=u;}else if(typeof u==="string"){m=this.getODataModelByServiceUri(u);}else{throw new Error("Invalid Input to Create ODataModel Object : "+u);}var d=new M(R(m));return d;},findTextPropertyForDimension:function(u,d,f){try{var h=this._getOData4AnalyticsObject(u);var i=h.findQueryResultByName(d);var D=i.findDimensionByName(f);if(D.getTextProperty()){return D.getTextProperty().name;}return f;}catch(e){L.error("Error Fetching Text Property for "+f+" : "+e.toString());}},getEvalValueMeasureName:function(C,d,r){var e=C.EVALUATION_VALUES;for(var i=0;i<e.length;i++){if(e[i].TYPE==d){if(r==="FIXED"){return e[i].FIXED;}return e[i].COLUMN_NAME;}}},getSemanticColorName:function(d){var s="";if(d=="Error"){s="sb.error";}if(d=="Neutral"){s="sb.neutral";}if(d=="Critical"){s="sb.critical";}if(d=="Good"){s="sb.good";}return s;},setTooltipInTile:function(C,d,v){var e="";var r=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle();if(d=="NT"||d=="DT"){if(v.status){e+=r.getText("sb.status")+": "+r.getText(v.status)+"\n";}if(v.actual){e+=r.getText("sb.actual")+": "+v.actual+"\n";}if(v.target){e+=r.getText("sb.target")+": "+v.target+"\n";}if(v.cH){e+=r.getText("sb.ch")+": "+v.cH+"\n";}if(v.wH){e+=r.getText("sb.wh")+": "+v.wH+"\n";}if(v.wL){e+=r.getText("sb.wl")+": "+v.wL+"\n";}if(v.cL){e+=r.getText("sb.cl")+": "+v.cL+"\n";}}if(d=="CONT"||d=="COMP"){if(v.measure&&d=="CONT"){if(v&&v.contributionTile.contributionTile&&v.contributionTile.contributionTile[1]==="asc"){e+=r.getText("sb.bottomn")+": "+v.contributionTile[0]+"\n";}else if(v&&v.contributionTile.contributionTile&&v.contributionTile.contributionTile.length){e+=r.getText("sb.topn")+": "+v.contributionTile[0]+"\n";}}if(v.m1&&((v.v1==undefined||v.v1==null)?false:v.v1.toString())&&v.c1){e+=v.m1+": "+v.v1+" "+r.getText(v.c1)+"\n";}if(v.m2&&((v.v2==undefined||v.v2==null)?false:v.v2.toString())&&v.c2){e+=v.m2+": "+v.v2+" "+r.getText(v.c2)+"\n";}if(v.m3&&((v.v3==undefined||v.v3==null)?false:v.v3.toString())&&v.c3){e+=v.m3+": "+v.v3+" "+r.getText(v.c3)+"\n";}}if(C&&C.setTooltip){C.setTooltip(e);}},_getFormattedTileProperties:function(d){d=d||{};var p=["sb_metadata","sb_navigation","sb_catalog"];var e=false;for(var i=0;!e&&i<p.length;i++){e=e||new U(window.location.href).get(p[i])||d[p[i]];}d.sb_metadata=(new U(window.location.href).get("sb_metadata")||d.sb_metadata||"HANA").toLowerCase();d.sb_navigation=(new U(window.location.href).get("sb_navigation")||d.sb_navigation||"abap").toLowerCase();d.sb_catalog=(new U(window.location.href).get("sb_catalog")||d.sb_catalog||"HANA").toLowerCase();d.isPlatformInfoPresent=e;return d;},getEvaluationDetailsFromRunTimeService:function(e,p,i,d){var K=this.getODataModelByServiceUri(this.getRunTimeUri(p));var f="ID eq '#EVALUATIONID'".replace("#EVALUATIONID",i);K.read(e,null,{"$filter":f},true,function(h){var j=[];if(h.results.length){j=h.results;}d.call(this,j);});},getParsedChip:function(C,i,d){try{var p={};var e=JSON.parse(C);var f=JSON.parse(e.TILE_PROPERTIES).evaluationId||"";if(e.TILE_PROPERTIES){var h=JSON.parse(e.TILE_PROPERTIES);if(h&&(h.instanceId||h.catalogId)){return false;}}var j=this;if(e.blankTile){p.BLANKTILE=e.blankTile;}if(e.cachingTime){p.CACHINGTIME=e.cachingTime;}if(e.cachingTimeUnit){p.CACHINGUNIT=e.cachingTimeUnit;}if(e.TAGS){p.TAGS=JSON.parse(e.TAGS);}if(e.ADDITIONAL_FILTERS){p.ADDITIONAL_FILTERS=JSON.parse(e.ADDITIONAL_FILTERS);}if(e.ADDITIONAL_APP_PARAMETERS){p.ADDITIONAL_APP_PARAMETERS=JSON.parse(e.ADDITIONAL_APP_PARAMETERS);}p.TILE_PROPERTIES=this._getFormattedTileProperties(JSON.parse(e.TILE_PROPERTIES));var s=p.TILE_PROPERTIES.sb_metadata;if(e.EVALUATION_FILTERS){p.EVALUATION_FILTERS=JSON.parse(e.EVALUATION_FILTERS);if(e.EVALUATION_VALUES){p.EVALUATION_VALUES=JSON.parse(e.EVALUATION_VALUES);if(e.EVALUATION){p.EVALUATION=JSON.parse(e.EVALUATION);if(d){d(p);}else{return p;}}else if(!i){j.getEvaluationDetailsFromRunTimeService("/EVALUATIONS",s,f,function(l){p.EVALUATION=l;if(d){d(p);}else{return p;}});}else if(d){d(p);}else{return p;}}else if(!i){j.getEvaluationDetailsFromRunTimeService("/EVALUATION_VALUES",s,f,function(l){p.EVALUATION_VALUES=l;if(e.EVALUATION){p.EVALUATION=JSON.parse(e.EVALUATION);if(d){d(p);}else{return p;}}else{j.getEvaluationDetailsFromRunTimeService("/EVALUATIONS",s,f,function(l){p.EVALUATION=l;if(d){d(p);}else{return p;}});}});}else if(d){d(p);}else{return p;}}else if(i){if(d){d(p);}else{return p;}}else{j.getEvaluationDetailsFromRunTimeService("/EVALUATION_FILTERS",s,f,function(l){p.EVALUATION_FILTERS=l;if(e.EVALUATION_VALUES){p.EVALUATION_VALUES=JSON.parse(e.EVALUATION_VALUES);if(e.EVALUATION){p.EVALUATION=JSON.parse(e.EVALUATION);if(d){d(p);}else{return p;}}else{j.getEvaluationDetailsFromRunTimeService("/EVALUATIONS",s,f,function(l){p.EVALUATION=l;if(d){d(p);}else{return p;}});}}else{j.getEvaluationDetailsFromRunTimeService("/EVALUATION_VALUES",s,f,function(l){p.EVALUATION_VALUES=l;if(e.EVALUATION){p.EVALUATION=JSON.parse(e.EVALUATION);if(d){d(p);}else{return p;}}else{j.getEvaluationDetailsFromRunTimeService("/EVALUATIONS",s,f,function(l){p.EVALUATION=l;if(d){d(p);}else{return p;}});}});}});}}catch(k){return false;}},getNavigationTarget:function(C,s){var f=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService;var d=f&&f("CrossApplicationNavigation");var e;var p={};p.evaluationId=C.EVALUATION.ID;p.chipId=C.TILE_PROPERTIES.id;if(s){p["sap-system"]=s;}p.tileType=C.TILE_PROPERTIES.tileType;if(C.TILE_PROPERTIES.dimension){p.dimension=C.TILE_PROPERTIES.dimension;}if(C.TILE_PROPERTIES.storyId){p.storyId=C.TILE_PROPERTIES.storyId;}if(C.TILE_PROPERTIES.apfConfId){p["sap-apf-configuration-id"]=C.TILE_PROPERTIES.apfConfId;}if(C.TILE_PROPERTIES.isPlatformInfoPresent){p.sb_metadata=C.TILE_PROPERTIES.sb_metadata;p.sb_navigation=C.TILE_PROPERTIES.sb_navigation;p.sb_catalog=C.TILE_PROPERTIES.sb_catalog;}if(C.ADDITIONAL_APP_PARAMETERS){for(e in C.ADDITIONAL_APP_PARAMETERS){if(C.ADDITIONAL_APP_PARAMETERS.hasOwnProperty(e)){if(C.ADDITIONAL_APP_PARAMETERS[e].constructor==Array){var h=C.ADDITIONAL_APP_PARAMETERS[e];for(var i=0;i<h.length;i++){p[e]=h[i];}}else{p[e]=C.ADDITIONAL_APP_PARAMETERS[e];}}}}var k=d&&d.hrefForExternal({target:{semanticObject:C.TILE_PROPERTIES.semanticObject,action:C.TILE_PROPERTIES.semanticAction},params:p})||"";if(C.ADDITIONAL_FILTERS){var l=C.ADDITIONAL_FILTERS;var m="&";for(var j=0;j<l.length;j++){if(l[j].OPERATOR==="EQ"){m=m+"/"+l[j].NAME+"="+l[j].VALUE_1;}}k+=m;}return k;},getChipTitle:function(C){var d="";if(C){var e=C.EVALUATION||{};d=e.INDICATOR_TITLE||"";}return d;},getstringifyTileConfig:function(C){var s={};s.EVALUATION=JSON.stringify(C.EVALUATION);s.EVALUATION_FILTERS=JSON.stringify(C.EVALUATION_FILTERS);s.EVALUATION_VALUES=JSON.stringify(C.EVALUATION_VALUES);s.TILE_PROPERTIES=JSON.stringify(C.TILE_PROPERTIES);return JSON.stringify(s);},getChipSubTitle:function(C){var T="";if(C){var d=C.EVALUATION||{};T=d.TITLE||"";}return T;},getAllMeasures:function(u,d){var m=[];try{var f=this._getOData4AnalyticsObject(u);var h=f.findQueryResultByName(d);m=h.getAllMeasureNames();}catch(e){L.error("Error Fetching All Measures : "+e.toString());}return m;},getFormattingMetadata:function(u,e,p){var f={};f._hasCurrency=false;f._hasSapText=false;var m=null;if(u instanceof O){m=R(u);}else{var d=this.getODataModelByServiceUri(u);m=R(d);}var h=new M(m);var j=h.findQueryResultByName(e);var k=j.getAllMeasures();if(k[p]){var s=(k[p]._oTextProperty&&k[p]._oTextProperty.name)?k[p]._oTextProperty.name:"";if(s!=""){f._hasSapText=true;f._sapTextColumn=s;}else if(k[p].hasOwnProperty("_oUnitProperty")){var l=k[p]._oUnitProperty.extensions;for(var i=0;i<k[p]._oUnitProperty.extensions.length;i++){if(l[i].name==="semantics"&&l[i].value==="currency-code"){f._hasCurrency=true;f._currencyColumn=k[p]._oUnitProperty.name;}}}}return f;},getAllDimensions:function(u,d){function i(m,n){var p=0,r=0;var s=[];while(p<m.length&&r<n.length){if(m[p]<n[r]){p++;}else if(m[p]>n[r]){r++;}else{s.push(m[p]);p++;r++;}}return s;}var f=[];var h=[];try{var j=this._getOData4AnalyticsObject(u);var k=j.findQueryResultByName(d);var l=k.getEntityType();h=l.getFilterablePropertyNames();f=k.getAllDimensionNames();if(h&&h.length){f=i(h.sort(),f.sort());}}catch(e){L.error("Error Fetching All Dimesions : "+e.toString());}return f;},prepareQueryServiceUri:function(u,d,m,f,v,h,n){function _(d1){return d1.replace(/'/g,"''");}var p=null;var r=function(){};var s=function(){};try{var w=null;if(u instanceof O){w=R(u);}else{var x=this.getODataModelByServiceUri(u);w=R(x);}var A=new M(w);var B=A.findQueryResultByName(d);var C=new Q(B);if(m){C.setMeasures(m.split(","));C.includeMeasureRawFormattedValueUnit(null,true,true,true);}if(f){if(typeof f==="string"){p=f;p=p.split(",");}for(var i=0;i<p.length;i++){C.addToAggregationLevel([p[i]]);var D=B.getAllDimensions();if(D[p[i]].getTextProperty()!=null){C.includeDimensionKeyTextAttributes([p[i]],true,true,null);}}}if(v&&v.length){var E=[];var G=[];var l;for(i=0,l=v.length;i<l;i++){var H=v[i];if(H.type==="PA"){G.push(H);}else if(H.type==="FI"){E.push(H);}}r=function(d1){var e1=d1.toJSON();var f1=e1.charAt(e1.length-1).toUpperCase();if(f1.charCodeAt(0)>=65&&f1.charCodeAt(0)<=90){e1=e1.slice(0,-1);}return e1;};s=function(d1){if(d1){try{if(d1==+d1){d1=window.parseInt(d1);}var e1=new Date(d1);var f1=e1.getTime();if(isNaN(f1)){return d1;}return r(e1);}catch(e){}}return d1;};if(E.length){var I=C.getFilterExpression();for(i=0,l=E.length;i<l;i++){H=E[i];if(this.getEdmType(u,H.filterPropertyName)=="Edm.DateTime"){H.value=s(H.value);H.valueTo=s(H.valueTo);}if(H.comparator==F.BT){I.addCondition(H.filterPropertyName,H.comparator,_(H.value),H.valueTo);}else{var J=H.value.split(",");for(var j=0,k=J.length;j<k;j++){I.addCondition(H.filterPropertyName,H.comparator,_(J[j].replace(/\^\|/g,",")),null);}}}}if(G.length){if(B.getParameterization()){var K=new P(B.getParameterization());var S=B.getParameterization();var T,V,W,X,Y;for(var y=0,z=G.length;y<z;y++){T=G[y];V=S.findParameterByName(T.filterPropertyName);if(V.isIntervalBoundary()===true&&V.isLowerIntervalBoundary()===true){Y=V.getPeerIntervalBoundaryParameter();for(i=0,l=G.length;i<l;i++){if(G[i].filterPropertyName===Y.getName()){X=_(G[i].value);break;}}W=_(T.value);if(X){K.setParameterValue(T.filterPropertyName,W,X);}}else if(V.isIntervalBoundary()===true&&V.isLowerIntervalBoundary()===false){L.info("Future development");}else{K.setParameterValue(T.filterPropertyName,_(T.value));}}C.setParameterizationRequest(K);}}}var Z=C.getURIToQueryResultEntries();if(h&&h.length){Z=Z+"&$orderby=";for(y=0,z=h.length;y<z;y++){var a1=h[y].sortOrder||"asc";if(a1){Z+=h[y].element+" "+a1+",";}}Z=Z.slice(0,Z.length-1);}if(n){Z=Z+"&$top="+n;}var b1=B.getAllMeasures();var c1=[];for(i=0;i<m.split(",").length;i++){c1.push(b1[m.split(",")[i]].getUnitProperty());}return{uri:Z,model:A.getODataModel(),unit:c1};}catch(e){L.error("Error Preparing Query Service Uri using OData4Analytics Library : "+e.toString());if(arguments.length){L.error("Arguments Passed to this function");L.error(arguments[0]+","+arguments[1]+","+arguments[2]+","+arguments[3]);}else{L.error("NO Arguments passed to this function");}return null;}},getAllEntitySet:function(u){var d=[];try{var f=this._getOData4AnalyticsObject(u);d=f.getAllQueryResultNames();}catch(e){L.error("Error fetching Enity Set : "+e.toString());}return d;},getAllMeasuresWithLabelText:function(u,d){var m=[];try{var f=this._getOData4AnalyticsObject(u);var h=f.findQueryResultByName(d);var j=h.getAllMeasureNames();for(var i=0;i<j.length;i++){var k=j[i];g.oMeasure=h.findMeasureByName(k);m.push({key:k,value:oMeasure.getLabelText()});}}catch(e){L.error("Error Fetching All Measures : "+e.toString());}return m;},getAllDimensionsWithLabelText:function(u,d){var f=[];try{var h=this._getOData4AnalyticsObject(u);var j=h.findQueryResultByName(d);var k=j.getAllDimensionNames();for(var i=0;i<k.length;i++){var l=k[i];var D=j.findDimensionByName(l);var m=null;if(D.getTextProperty()!=null){m=D.getTextProperty().name;}f.push({key:l,value:D.getLabelText(),textProperty:m});}}catch(e){L.error("Error Fetching All Dimesions : "+e.toString());}return f;},getAllInputParams:function(u,d){var i=[];try{var f=this._getOData4AnalyticsObject(u);var h=f.findQueryResultByName(d);if(h.getParameterization()){var p=h.getParameterization();i=p.getAllParameterNames();}}catch(e){L.error("Error Fetching Input Params : "+e.toString());}return i;},getAllInputParamsWithFlag:function(u,d){var f=[];try{var h=this._getOData4AnalyticsObject(u);var j=h.findQueryResultByName(d);if(j.getParameterization()){var p=j.getParameterization();var k=p.getAllParameterNames();for(var i=0;i<k.length;i++){var l=k[i];var m=p.findParameterByName(l);f.push({name:l,optional:m.isOptional()});}}}catch(e){L.error("Error Fetching Input Params : "+e.toString());}return f;},formatOdataObjectToString:function(v){if(v&&v.constructor==Object){if(v.__edmType=="Edm.Time"){var m=v.ms;var s=Math.floor((m/1000)%60);var d=Math.floor((m/60000)%60);var h=Math.floor((m/3600000)%24);return h+"H"+d+"M"+s+"S";}}return v;},generateCombinations:function(d){function e(h,s){while(s.length<h){s="0"+s;}return s;}var m=Math.pow(2,d.length);var r=[];var f=0;while(m>1){var s=(m-1).toString(2);s=e(d.length,s);r[f]=[];for(var i=0;i<s.length;i++){if(Number(s[i])){r[f].push(d[i]);}}m--;f++;}return r;},logError:function(e,C){if(e=="no data"&&C){var r=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle();C.setFailedText(r.getText("sb.noData"));}L.error(e.toString());},numberOfLeadingZeros:function(n){n=String(n);var d=0;var e=n.indexOf(".");if(e==-1){return 0;}if(Number(n.split(".")[0])!=0){return 0;}var i=e+1;while(n[i++]=="0"){++d;}return d;},formatValue:function(v,s,d){d=d||3;var u={3:"K",6:"M",9:"B",12:"T",0:""};u["-3"]="m";u["-6"]="u";u["-9"]="n";u["-12"]="t";u["-2"]="%";var e,p,f;e=Number(v).toPrecision(d);var z=this.numberOfLeadingZeros(e);if(z>0&&s<0){p=e*Math.pow(10,z+d);f=-(z+d);}else{p=Number(e.split("e")[0]);f=Number(e.split("e")[1])||0;}if(!v&&v!=0){return{value:"",unitPrefix:""};}if(s>=0){if(f%3!=0){if(f%3==2){if(f+1==s){f=f+1;p=p/10;}else{f=f-2;p=p*100;}}else if(f+2==s){f=f+2;p=p/100;}else{f--;p=p*10;}}else if(f==15){p=p*1000;f=12;}}else if(s=="-2"){var x=this.formatValue((v*100),0);}else if(f>=0&&v<10&&s=="-3"){p=v*Math.pow(10,3);f=-3;}else if(f>=0){return this.formatValue(v,0);}else{f=Math.abs(f);s=Math.abs(s);if(s>f){p=p/(Math.pow(10,f%3));f=f-(f%3);}else{var h=f-s;p=p/(Math.pow(10,h));f=f-h;}f=0-f;}p+="";if(s=="-2"){var i=(x.unitPrefix=="")?Number(x.value+"").toFixed(4-(x.value+"").indexOf(".")):Number(x.value+"").toFixed(3-(x.value+"").indexOf("."));return{value:Number(i),unitPrefix:(x.unitPrefix)+u[-2]};}p=Number(p).toFixed(4-p.indexOf("."));return{value:Number(p),unitPrefix:u[f]};},isSmartbusinessChipAndCachable:function(d){var C=this.getParsedChip(d&&d.getConfigurationParameter("tileConfiguration"));return(C&&C.TILE_PROPERTIES&&C.TILE_PROPERTIES.tileType&&this.getCachingTime(C));},getHanaClient:function(){var e;var f=function(d,s,x){e=d.sessionClient;sap.ushell.components.tiles.indicatorTileUtils.cache.setCacheHanaClient(e);sap.ushell.components.tiles.indicatorTileUtils.util.HANA_CLIENT_DEFERRED.resolve(e);};var h=function(d,k,l){L.error(d.responseText);L.error("session client call failed");sap.ushell.components.tiles.indicatorTileUtils.cache.setCacheHanaClient(null);sap.ushell.components.tiles.indicatorTileUtils.util.HANA_CLIENT_DEFERRED.reject();};var i=sap.ushell.components.tiles.indicatorTileUtils.util.HANA_CLIENT_DEFERRED||q.Deferred();var j=sap.ushell.components.tiles.indicatorTileUtils.cache.getCacheHanaClient();if(j!=undefined){e=j;sap.ushell.components.tiles.indicatorTileUtils.util.HANA_CLIENT_DEFERRED.resolve(e);}else if(sap.ushell.components.tiles.indicatorTileUtils.util.HANA_CLIENT_DEFERRED){return sap.ushell.components.tiles.indicatorTileUtils.util.HANA_CLIENT_DEFERRED.promise();}else{sap.ushell.components.tiles.indicatorTileUtils.util.HANA_CLIENT_DEFERRED=i;q.ajax({type:"GET",async:false,dataType:"json",url:"/sap/hba/r/sb/core/logic/GetSessionClient.xsjs",success:f,error:h});}return sap.ushell.components.tiles.indicatorTileUtils.util.HANA_CLIENT_DEFERRED.promise();},abortPendingODataCalls:function(d){try{if(d){d.abort();}}catch(e){this.logError(e);}}};})(window,q);sap.ushell.components.tiles.indicatorTileUtils.cache=(function(){var B={};var K={};var s="HANA_CLIENT";return{getCacheHanaClient:function(){return B[s];},setCacheHanaClient:function(d){B[s]=d;},getEvaluationByChipId:function(k){if(B[k]){return B[k];}return null;},getEvaluationById:function(k){return this.getEvaluationByChipId(k);},setEvaluationById:function(k,d){B[k]=d;},getFrontEndCacheDeferredObject:function(k){if(B[k]){return B[k];}return null;},setFrontEndCacheDefferedObject:function(k,d){B[k]=d;},getKpivalueById:function(k){if(K[k]){return K[k];}return null;},setKpivalueById:function(k,d){K[k]=d;}};})();return{};},true);
sap.ui.predefine('sap/ushell/components/tiles/indicatorcomparison/ComparisonTile.controller',["sap/ushell/components/tiles/generic","sap/m/library","sap/ui/thirdparty/jquery","sap/base/Log"],function(g,m,q,L){"use strict";var D=m.DeviationIndicator;var V=m.ValueColor;var S=m.Size;var a=m.LoadState;var F=m.FrameType;var C=g.extend("sap.ushell.components.tiles.indicatorcomparison.ComparisonTile",{onInit:function(){this.KPI_VALUE_REQUIRED=false;},_processDataForComparisonChart:function(d,b,u){var f=[],e={},i,t,l;var h;var T=[];var j=this;var k=null;for(i=0;i<d.results.length;i++){var n=d.results[i];}T=sap.ushell.components.tiles.indicatorTileUtils.util.getAllMeasuresWithLabelText(this.oTileApi.url.addSystemToServiceUrl(this.oConfig.EVALUATION.ODATA_URL),this.oConfig.EVALUATION.ODATA_ENTITYSET);for(i=0,l=T.length;i<l;i++){t=T[i];e[t.key]=t.value;}var o=j.oConfig.TILE_PROPERTIES.COLUMN_NAMES||j.oConfig.EVALUATION.COLUMN_NAMES;for(i=0;i<o.length;i++){var p={};var r=o[i];p.value=Number(n[r.COLUMN_NAME]);var s=Number(n[r.COLUMN_NAME]);var v=false;var w=0;var x=j._getEvaluationThresholdMeasures();var I=x?Array.prototype.indexOf.call(x,r.COLUMN_NAME):-1;if(I>-1){v=true;w=j.oConfig.EVALUATION.SCALING;}if(j.oConfig.EVALUATION.SCALING==-2&&v){s*=100;}var c=j.isCurrencyMeasure(r.COLUMN_NAME);if(u&&u[i]&&n[u[i].name]){k=n[u[i].name];}h=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(s,w,j.oConfig.EVALUATION.SCALING,j.oConfig.EVALUATION.DECIMAL_PRECISION,c,k);if(j.oConfig.EVALUATION.SCALING==-2&&v){h+=" %";}p.displayValue=h.toString();if(u){if(u[i]&&n[u[i].name]){p.displayValue+=" "+n[u[i].name];}}p.color=r.semanticColor;p.title=e[r.COLUMN_NAME]||r.COLUMN_NAME;p.measure=r.COLUMN_NAME;p.isCurM=c;f.push(p);}return f;},fetchChartData:function(r,b,s,E){function c(z,A){var B=false;if(z&&z.results&&z.results.length){for(var i=0,l=A.length;i<l&&!B;i++){B=z.results[0][A[i].COLUMN_NAME]!==null;}}return B;}var t=this;try{var d=this.oConfig.EVALUATION.ODATA_ENTITYSET;var f=this.oConfig.EVALUATION.COLUMN_NAME;var h=f,j;if(this.oConfig.TILE_PROPERTIES.COLUMN_NAMES){for(j=0;j<this.oConfig.TILE_PROPERTIES.COLUMN_NAMES.length;j++){if(this.oConfig.TILE_PROPERTIES.COLUMN_NAMES[j].COLUMN_NAME!=this.oConfig.EVALUATION.COLUMN_NAME){h=h+","+this.oConfig.TILE_PROPERTIES.COLUMN_NAMES[j].COLUMN_NAME;}}}else{for(j=0;j<this.oConfig.EVALUATION.COLUMN_NAMES.length;j++){if(this.oConfig.EVALUATION.COLUMN_NAMES[j].COLUMN_NAME!=this.oConfig.EVALUATION.COLUMN_NAME){h=h+","+this.oConfig.EVALUATION.COLUMN_NAMES[j].COLUMN_NAME;}}}var k=sap.ushell.components.tiles.indicatorTileUtils.util.getBoolValue(r);var n=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);if(sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){if(n){var o=n.Data&&JSON.parse(n.Data);}}var p=t.oTileApi.configuration.getParameterValueAsString("timeStamp");var u=sap.ushell.components.tiles.indicatorTileUtils.util.isCacheValid(t.oConfig.TILE_PROPERTIES.id,p,t.chipCacheTime,t.chipCacheTimeUnit,t.tilePressed);if((o&&!o.rightData)||!n||(!u&&t.oTileApi.visible.isVisible())||k||(b&&t.oTileApi.visible.isVisible())||t.getView().getViewData().refresh){if(t.kpiValueFetchDeferred){t.kpiValueFetchDeferred=false;var v=sap.ushell.components.tiles.indicatorTileUtils.util.prepareFilterStructure(this.oConfig.EVALUATION_FILTERS,this.oConfig.ADDITIONAL_FILTERS);var w=sap.ushell.components.tiles.indicatorTileUtils.util.prepareQueryServiceUri(t.oRunTimeODataModel,d,h,null,v,3);this.comparisionChartODataRef=w.model.read(w.uri,null,null,true,function(i){t.kpiValueFetchDeferred=true;var l={};if(w.unit){l.unit=w.unit;}if(c(i,t.oConfig.TILE_PROPERTIES.COLUMN_NAMES||t.oConfig.EVALUATION.COLUMN_NAMES)){t.oConfig.TILE_PROPERTIES.FINALVALUE=i;t.oConfig.TILE_PROPERTIES.FINALVALUE=t._processDataForComparisonChart(t.oConfig.TILE_PROPERTIES.FINALVALUE,h.split(",")[0],w.unit);l.data=t.oConfig.TILE_PROPERTIES.FINALVALUE;var z={};t.cacheTime=sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate();z.ChipId=t.oConfig.TILE_PROPERTIES.id;z.Data=JSON.stringify(l);z.CacheMaxAge=Number(t.chipCacheTime);z.CacheMaxAgeUnit=t.chipCacheTimeUnit;z.CacheType=1;var A=t.getLocalCache(z);t.updateDatajobScheduled=false;var B=t.oConfig.TILE_PROPERTIES.id+"data";var G=sap.ushell.components.tiles.indicatorTileUtils.util.getScheduledJob(B);if(G){clearTimeout(G);G=undefined;}if(!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,A);var U=false;if(n){U=true;}if(t.chipCacheTime){sap.ushell.components.tiles.indicatorTileUtils.util.writeFrontendCacheByChipAndUserId(t.oTileApi,t.oConfig.TILE_PROPERTIES.id,z,U,function(i){if(i){t.cacheTime=i&&i.CachedTime;sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,i);t.setTimeStamp();}if(t.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){q.proxy(t.setTimeStamp(t.cacheTime),t);}});}}else{var H=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id),I;if(H){if(!H.CachedTime){H.CachedTime=sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate();}I=H.Data;if(I){I=JSON.parse(I);I.rightData=l;}H.Data=JSON.stringify(I);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,H);}else{I={};I.rightData=l;A.Data=JSON.stringify(I);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,A);}t.cacheWriteData=l;}s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);}else if(i.results.length==0){t.oConfig.TILE_PROPERTIES.FINALVALUE=i;if(sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id)){l=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);l.data=i;}else{l.data=i;}sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,l);s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);t.setNoData();}else{sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,{empty:"empty"});t.setNoData();}},function(i){t.kpiValueFetchDeferred=true;if(i&&i.response){L.error(i.message+" : "+i.request.requestUri);E.call(t,i);}});}}else if(n&&n.Data){var x;var y=t.oConfig&&t.oConfig.TILE_PROPERTIES&&t.oConfig.TILE_PROPERTIES.tileType;if(y.indexOf("DT-")==-1){x=n.Data&&JSON.parse(n.Data);}else{x=n.Data&&JSON.parse(n.Data);x=x.rightData;}t.cacheTime=n.CachedTime;if(t.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){q.proxy(t.setTimeStamp(t.cacheTime),t);}if(x.data&&x.data.length){t.oConfig.TILE_PROPERTIES.FINALVALUE=x.data;s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);}else{t.oConfig.TILE_PROPERTIES.FINALVALUE=x.data;s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);t.setNoData();}}else{t.setNoData();}}catch(e){t.kpiValueFetchDeferred=true;E.call(t,e);}},doProcess:function(r,i){var t=this;this.setTextInTile();this.fetchChartData(r,i,function(k){this.CALCULATED_KPI_VALUE=k;this._updateTileModel({data:this.CALCULATED_KPI_VALUE});if(t.oConfig.TILE_PROPERTIES.frameType==F.TwoByOne){t.oKpiTileView.oGenericTile.setFrameType(F.TwoByOne);t.getView().getViewData().parentController._updateTileModel(this.getTile().getModel().getData());var c={};c.data=this.CALCULATED_KPI_VALUE;t.getView().getViewData().deferredObj.resolve();}else{t.oKpiTileView.oGenericTile.setFrameType(F.OneByOne);t.oKpiTileView.oGenericTile.removeAllTileContent();t.oKpiTileView.oGenericTile.addTileContent(t.oKpiTileView.oNVConfS);this.oKpiTileView.oGenericTile.setState(a.Loaded);}this.setToolTip(null,this.CALCULATED_KPI_VALUE,"COMP");if(this.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(this.oConfig)){sap.ushell.components.tiles.indicatorTileUtils.util.scheduleFetchDataJob.call(this,this.oTileApi.visible.isVisible());}},this.logError);},doDummyProcess:function(){var t=this;this.setTextInTile();t._updateTileModel({value:8888,size:S.Auto,frameType:F.OneByOne,state:a.Loading,valueColor:V.Error,indicator:D.None,title:"Liquidity Structure",footer:"Current Quarter",description:"Apr 1st 2013 (B$)",data:[{title:"Measure 1",value:1.2,color:"Good"},{title:"Measure 2",value:0.78,color:"Good"},{title:"Measure 3",value:1.4,color:"Error"}]});this.oKpiTileView.oGenericTile.setState(a.Loaded);}});return C;});
sap.ui.predefine('sap/ushell/components/tiles/indicatorcomparison/ComparisonTile.view',["sap/ui/core/mvc/JSView","sap/ui/model/analytics/odata4analytics","sap/ushell/components/tiles/indicatorTileUtils/smartBusinessUtil","sap/suite/ui/microchart/ComparisonMicroChartData","sap/suite/ui/microchart/ComparisonMicroChart","sap/m/GenericTile","sap/ui/model/json/JSONModel","sap/m/library"],function(J,o,s,C,a,G,b,M){"use strict";sap.ui.getCore().loadLibrary("sap.suite.ui.microchart");sap.ui.jsview("sap.ushell.components.tiles.indicatorcomparison.ComparisonTile",{getControllerName:function(){return"sap.ushell.components.tiles.indicatorcomparison.ComparisonTile";},createContent:function(){this.setHeight("100%");this.setWidth("100%");var S=M.Size;var t=this;t.oGenericTileData={};t.oCmprsDataTmpl=new C({title:"{title}",value:"{value}",color:"{color}",displayValue:"{displayValue}"});t.oCmprsChrtTmpl=new a({size:S.Responsive,scale:"{/scale}",data:{template:t.oCmprsDataTmpl,path:"/data"}});t.oNVConfS=new sap.ushell.components.tiles.sbtilecontent({unit:"{/unit}",size:"{/size}",footer:"{/footerComp}",content:t.oCmprsChrtTmpl});t.oGenericTile=new G({subheader:"{/subheader}",frameType:"{/frameType}",size:"{/size}",header:"{/header}",tileContent:[t.oNVConfS]});t.oGenericTileModel=new b();t.oGenericTileModel.setData(t.oGenericTileData);t.oGenericTile.setModel(t.oGenericTileModel);return t.oGenericTile;}});},true);
sap.ui.predefine('sap/ushell/components/tiles/indicatorcontribution/ContributionTile.controller',["sap/ushell/components/tiles/generic","sap/m/library","sap/ui/thirdparty/jquery","sap/base/Log"],function(g,m,q,L){"use strict";var D=m.DeviationIndicator;var V=m.ValueColor;var S=m.Size;var a=m.LoadState;var F=m.FrameType;var C=g.extend("sap.ushell.components.tiles.indicatorcontribution.ContributionTile",{onInit:function(){this.KPI_VALUE_REQUIRED=false;},_processDataForComparisonChart:function(d,b,f,u){var s=this.oConfig.TILE_PROPERTIES.semanticColorContribution;var h=[];var t;var j;for(var i=0;i<d.results.length;i++){var k=d.results[i];var l={};try{l.title=k[f].toString();}catch(e){l.title="";}l.value=Number(k[b]);var n=Number(k[b]);if(this.oConfig.EVALUATION.SCALING==-2){n*=100;}var c=this.isCurrencyMeasure(b);j=k[u];t=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(n,this.oConfig.EVALUATION.SCALING,this.oConfig.EVALUATION.DECIMAL_PRECISION,c,j);l.displayValue=t.toString();if(typeof s==="undefined"){l.color="Neutral";}else{l.color=s;}if(l&&u){l[u]=j;}h.push(l);}return h;},fetchChartData:function(r,i,s,E){var t=this;try{var b=this.oConfig.EVALUATION.ODATA_ENTITYSET,c;t.setThresholdValues();if(this.oConfig.TILE_PROPERTIES.semanticMeasure){c=this.oConfig.EVALUATION.COLUMN_NAME+","+this.oConfig.TILE_PROPERTIES.semanticMeasure;}else{c=this.oConfig.EVALUATION.COLUMN_NAME;}var u=null;var d=this.oConfig.TILE_PROPERTIES.dimension;var f=sap.ushell.components.tiles.indicatorTileUtils.util.getBoolValue(r);var h=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);if(sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){if(h){var j=h.Data&&JSON.parse(h.Data);}}var k=t.oTileApi.configuration.getParameterValueAsString("timeStamp");var l=sap.ushell.components.tiles.indicatorTileUtils.util.isCacheValid(t.oConfig.TILE_PROPERTIES.id,k,t.chipCacheTime,t.chipCacheTimeUnit,t.tilePressed);if((j&&!j.rightData)||!h||(!l&&t.oTileApi.visible.isVisible())||f||(i&&t.oTileApi.visible.isVisible())||t.getView().getViewData().refresh){if(t.kpiValueFetchDeferred){t.kpiValueFetchDeferred=false;var v=sap.ushell.components.tiles.indicatorTileUtils.util.prepareFilterStructure(this.oConfig.EVALUATION_FILTERS,this.oConfig.ADDITIONAL_FILTERS);var o={};o["0"]=c+",asc";o["1"]=c+",desc";o["2"]=d+",asc";o["3"]=d+",desc";var n=o[this.oConfig.TILE_PROPERTIES.sortOrder||"0"].split(",");var p=sap.ushell.components.tiles.indicatorTileUtils.util.prepareQueryServiceUri(t.oRunTimeODataModel,b,c,d,v,3);if(this.oConfig.TILE_PROPERTIES.semanticMeasure){p.uri+="&$top=3&$orderby="+n[0]+" "+n[2];}else{p.uri+="&$top=3&$orderby="+n[0]+" "+n[1];}this.comparisionChartODataRef=p.model.read(p.uri,null,null,true,function(y){t.kpiValueFetchDeferred=true;var z={};if(y&&y.results&&y.results.length){if(p.unit[0]){t._updateTileModel({unit:y.results[0][p.unit[0].name]});u=p.unit[0].name;z.unit=p.unit[0];z.unit.name=p.unit[0].name;}d=sap.ushell.components.tiles.indicatorTileUtils.util.findTextPropertyForDimension(t.oRunTimeODataModel,b,d);z.dimension=d;t.oConfig.TILE_PROPERTIES.FINALVALUE=y;t.oConfig.TILE_PROPERTIES.FINALVALUE=t._processDataForComparisonChart(t.oConfig.TILE_PROPERTIES.FINALVALUE,c.split(",")[0],d,u);z.data=t.oConfig.TILE_PROPERTIES.FINALVALUE;z.isCurM=t.isACurrencyMeasure(t.oConfig.EVALUATION.COLUMN_NAME);var A={};t.cacheTime=sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate();A.ChipId=t.oConfig.TILE_PROPERTIES.id;A.Data=JSON.stringify(z);A.CacheMaxAge=Number(t.chipCacheTime);A.CacheMaxAgeUnit=t.chipCacheTimeUnit;A.CacheType=1;var B=t.getLocalCache(A);t.updateDatajobScheduled=false;var G=t.oConfig.TILE_PROPERTIES.id+"data";var H=sap.ushell.components.tiles.indicatorTileUtils.util.getScheduledJob(G);if(H){clearTimeout(H);H=undefined;}if(!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,B);var U=false;if(h){U=true;}if(t.chipCacheTime){sap.ushell.components.tiles.indicatorTileUtils.util.writeFrontendCacheByChipAndUserId(t.oTileApi,t.oConfig.TILE_PROPERTIES.id,A,U,function(y){if(y){t.cacheTime=y&&y.CachedTime;sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,y);}if(t.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){q.proxy(t.setTimeStamp(t.cacheTime),t);}});}}else{var I=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id),J;if(I){if(!I.CachedTime){I.CachedTime=sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate();}J=I.Data;if(J){J=JSON.parse(J);if(t.oKpiTileView.getViewName()=="tiles.indicatornumeric.NumericTile"){J.leftData=z;}else{J.rightData=z;}}I.Data=JSON.stringify(J);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,I);}else{J={};J.rightData=z;B.Data=JSON.stringify(J);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,B);}t.cacheWriteData=z;}s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);}else if(y.results.length==0){t.oConfig.TILE_PROPERTIES.FINALVALUE=y;if(sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id)){z=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);z.data=y;}else{z.data=y;}sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,z);s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);t.setNoData();}else{sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,{empty:"empty"});t.setNoData();}},function(y){t.kpiValueFetchDeferred=true;if(y&&y.response){L.error(y.message+" : "+y.request.requestUri);E.call(t,y);}});}}else if(h&&h.Data){var w;var x=t.oConfig&&t.oConfig.TILE_PROPERTIES&&t.oConfig.TILE_PROPERTIES.tileType;if(x.indexOf("DT-")==-1){w=h.Data&&JSON.parse(h.Data);}else{w=h.Data&&JSON.parse(h.Data);w=w.rightData;}t.cacheTime=h.CachedTime;if(t.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){q.proxy(t.setTimeStamp(t.cacheTime),t);}if(w.data&&w.data.length){if(w.unit){t._updateTileModel({unit:w.data[0][w.unit.name]});}d=w.dimension;t.oConfig.TILE_PROPERTIES.FINALVALUE=w.data;s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);}else if(w&&w.data&&w.data instanceof Array&&w.data.length==0){t.oConfig.TILE_PROPERTIES.FINALVALUE=w.data;s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);t.setNoData();}else{t.setNoData();}}else{t.setNoData();}}catch(e){t.kpiValueFetchDeferred=true;E.call(t,e);}},doProcess:function(r,i){var t=this;this.DEFINITION_DATA=this.oConfig;this._updateTileModel(this.DEFINITION_DATA);this.setTextInTile();this.fetchChartData(r,i,function(k){this.CALCULATED_KPI_VALUE=k;this._updateTileModel({data:this.CALCULATED_KPI_VALUE});if(t.oConfig.TILE_PROPERTIES.frameType==F.TwoByOne){t.oKpiTileView.oGenericTile.setFrameType(F.TwoByOne);t.oKpiTileView.oGenericTile.removeAllTileContent();t.getView().getViewData().parentController._updateTileModel(this.getTile().getModel().getData());t.getView().getViewData().deferredObj.resolve();}else{t.oKpiTileView.oGenericTile.setFrameType(F.OneByOne);t.oKpiTileView.oGenericTile.removeAllTileContent();t.oKpiTileView.oGenericTile.addTileContent(t.oKpiTileView.oNVConfS);this.oKpiTileView.oGenericTile.setState(a.Loaded);}this.setToolTip(null,this.CALCULATED_KPI_VALUE,"CONT");if(this.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(this.oConfig)){sap.ushell.components.tiles.indicatorTileUtils.util.scheduleFetchDataJob.call(this,this.oTileApi.visible.isVisible());}},this.logError);},doDummyProcess:function(){var t=this;t.setTextInTile();t._updateTileModel({value:8888,size:S.Auto,frameType:F.OneByOne,state:a.Loading,valueColor:V.Error,indicator:D.None,title:"US Profit Margin",footer:"Current Quarter",description:"Maximum deviation",data:[{title:"Americas",value:10,color:"Neutral"},{title:"EMEA",value:50,color:"Neutral"},{title:"APAC",value:-20,color:"Neutral"}]});this.oKpiTileView.oGenericTile.setState(a.Loaded);}});return C;});
sap.ui.predefine('sap/ushell/components/tiles/indicatorcontribution/ContributionTile.view',["sap/ui/core/mvc/JSView","sap/ui/model/analytics/odata4analytics","sap/ushell/components/tiles/indicatorTileUtils/smartBusinessUtil","sap/suite/ui/microchart/ComparisonMicroChartData","sap/suite/ui/microchart/ComparisonMicroChart","sap/m/GenericTile","sap/ui/model/json/JSONModel","sap/m/library"],function(J,o,s,C,a,G,b,M){"use strict";sap.ui.getCore().loadLibrary("sap.suite.ui.microchart");sap.ui.jsview("sap.ushell.components.tiles.indicatorcontribution.ContributionTile",{getControllerName:function(){return"sap.ushell.components.tiles.indicatorcontribution.ContributionTile";},createContent:function(){this.setHeight("100%");this.setWidth("100%");var S=M.Size;var t=this;t.oGenericTileData={};t.oCmprsDataTmpl=new C({title:"{title}",value:"{value}",color:"{color}",displayValue:"{displayValue}"});t.oCmprsChrtTmpl=new a({size:S.Responsive,scale:"{/scale}",data:{template:t.oCmprsDataTmpl,path:"/data"}});t.oNVConfS=new sap.ushell.components.tiles.sbtilecontent({unit:"{/unit}",size:"{/size}",footer:"{/footerComp}",content:t.oCmprsChrtTmpl});t.oGenericTile=new G({subheader:"{/subheader}",frameType:"{/frameType}",size:"{/size}",header:"{/header}",tileContent:[t.oNVConfS]});t.oGenericTileModel=new b();t.oGenericTileModel.setData(t.oGenericTileData);t.oGenericTile.setModel(t.oGenericTileModel);return t.oGenericTile;}});},true);
sap.ui.predefine('sap/ushell/components/tiles/indicatordeviation/DeviationTile.controller',["sap/ushell/components/tiles/generic","sap/m/library"],function(g,m){"use strict";var V=m.ValueColor;var L=m.LoadState;var F=m.FrameType;var D=g.extend("sap.ushell.components.tiles.indicatordeviation.DeviationTile",{onInit:function(){this.KPI_VALUE_REQUIRED=true;},doProcess:function(k,t){var a=this;var f,b;f=t.targetValue;var d=Number(k);this.setThresholdValues();if(this.oConfig.EVALUATION.SCALING==-2){d*=100;}var c=this.isCurrencyMeasure(this.oConfig.EVALUATION.COLUMN_NAME);b=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(d),this.oConfig.EVALUATION.SCALING,this.oConfig.EVALUATION.DECIMAL_PRECISION,c,this.CURRENCY_CODE);this.CALCULATED_KPI_VALUE=Number(k);var e={};var h=this.getThresholdsObjAndColor(t).returnColor;var i={value:Number(k),color:h};e.actualValueLabel=b.toString();e.actual=i;e.thresholds=[];e.thresholds=this.getThresholdsObjAndColor(t).arrObj;var j=this.DEFINITION_DATA.EVALUATION_VALUES,l;if(this.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){l=Number(f);if(this.oConfig.EVALUATION.SCALING==-2){l*=100;}c=this.isCurrencyMeasure(this.oConfig.EVALUATION.COLUMN_NAME);f=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(l,this.oConfig.EVALUATION.SCALING,this.oConfig.EVALUATION.DECIMAL_PRECISION,c,this.CURRENCY_CODE);e.targetValue=Number(l);e.targetValueLabel=f.toString();}else{for(var n=0;n<j.length;n++){if(j[n].TYPE==="TA"){l=Number(f);if(this.oConfig.EVALUATION.SCALING==-2){l*=100;}c=this.isCurrencyMeasure(this.oConfig.EVALUATION.COLUMN_NAME);f=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(l,this.oConfig.EVALUATION.SCALING,this.oConfig.EVALUATION.DECIMAL_PRECISION,c,this.CURRENCY_CODE);e.targetValue=Number(l);e.targetValueLabel=f.toString();}}}if(this.oConfig.EVALUATION.SCALING==-2){e.scale="%";}this._updateTileModel(e);if(this.DEFINITION_DATA.TILE_PROPERTIES.frameType==F.TwoByOne){a.getView().getViewData().parentController._updateTileModel(this.getTile().getModel().getData());a.getView().getViewData().deferredObj.resolve();sap.ushell.components.tiles.indicatorTileUtils.util.setUnsetCallInProgress(a.oConfig.TILE_PROPERTIES.id+"defferedRight",false);}else{this.oKpiTileView.oGenericTile.setState(L.Loaded);}this.setToolTip(h,d,"DT");if(!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(this.oConfig)){if(a.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(this.oConfig)){sap.ushell.components.tiles.indicatorTileUtils.util.scheduleFetchDataJob.call(this,this.oTileApi.visible.isVisible());}}},getThresholdsObjAndColor:function(t){try{var T={};T.arrObj=[];T.returnColor=V.Neutral;var i=this.DEFINITION_DATA.EVALUATION.GOAL_TYPE;var w,c,a,b;if(i==="MI"){a=Number(t.criticalHighValue)||0;b=Number(t.warningHighValue)||0;if(a&&b){a=window.parseFloat(a);b=window.parseFloat(b);T.arrObj.push({value:a,color:V.Error});T.arrObj.push({value:b,color:V.Critical});if(this.CALCULATED_KPI_VALUE<b){T.returnColor=V.Good;}else if(this.CALCULATED_KPI_VALUE<=a){T.returnColor=V.Critical;}else{T.returnColor=V.Error;}}}else if(i==="MA"){c=Number(t.criticalLowValue)||0;w=Number(t.warningLowValue)||0;if(c&&w){c=window.parseFloat(c);w=window.parseFloat(w);T.arrObj.push({value:c,color:V.Error});T.arrObj.push({value:w,color:V.Critical});if(this.CALCULATED_KPI_VALUE<c){T.returnColor=V.Error;}else if(this.CALCULATED_KPI_VALUE<=w){T.returnColor=V.Critical;}else{T.returnColor=V.Good;}}}else{a=Number(t.criticalHighValue)||0;b=Number(t.warningHighValue)||0;c=Number(t.criticalLowValue)||0;w=Number(t.warningLowValue)||0;if(w&&b&&c&&c){a=window.parseFloat(a);b=window.parseFloat(b);w=window.parseFloat(w);c=window.parseFloat(c);T.arrObj.push({value:a,color:V.Error});T.arrObj.push({value:b,color:V.Critical});T.arrObj.push({value:w,color:V.Critical});T.arrObj.push({value:c,color:V.Error});if(this.CALCULATED_KPI_VALUE<c||this.CALCULATED_KPI_VALUE>a){T.returnColor=V.Error;}else if((this.CALCULATED_KPI_VALUE>=c&&this.CALCULATED_KPI_VALUE<=w)||(this.CALCULATED_KPI_VALUE>=b&&this.CALCULATED_KPI_VALUE<=a)){T.returnColor=V.Critical;}else{T.returnColor=V.Good;}}}return T;}catch(e){this.logError(e);}},doDummyProcess:function(){var t=this;this.setTextInTile();t._updateTileModel({actual:{value:120,color:V.Good},targetValue:100,thresholds:[{value:0,color:V.Error},{value:50,color:V.Critical},{value:150,color:V.Critical},{value:200,color:V.Error}],showActualValue:true,showTargetValue:true});this.oKpiTileView.oGenericTile.setState(L.Loaded);}});return D;});
sap.ui.predefine('sap/ushell/components/tiles/indicatordeviation/DeviationTile.view',["sap/ui/core/mvc/JSView","sap/ui/model/analytics/odata4analytics","sap/ushell/components/tiles/indicatorTileUtils/smartBusinessUtil","sap/m/library","sap/suite/ui/microchart/BulletMicroChartData","sap/suite/ui/microchart/BulletMicroChart","sap/m/GenericTile","sap/ui/model/json/JSONModel"],function(J,o,s,M,B,a,G,b){"use strict";var S=M.Size;var L=M.LoadState;sap.ui.getCore().loadLibrary("sap.suite.ui.microchart");sap.ui.jsview("sap.ushell.components.tiles.indicatordeviation.DeviationTile",{getControllerName:function(){return"sap.ushell.components.tiles.indicatordeviation.DeviationTile";},createContent:function(){this.setHeight("100%");this.setWidth("100%");var h="Lorem ipsum";var c="Lorem ipsum";var t=sap.ushell.components.tiles.indicatorTileUtils.util.getTileTitleSubtitle(this.getViewData().chip);if(t.title&&t.subTitle){h=t.title;c=t.subTitle;}var d={subheader:c,header:h,footerNum:"",footerComp:"",frameType:"OneByOne",state:L.Loading,scale:""};var e=new B({value:"{value}",color:"{color}"});this.oBCTmpl=new a({size:S.Responsive,scale:"{/scale}",actual:{value:"{/actual/value}",color:"{/actual/color}"},targetValue:"{/targetValue}",actualValueLabel:"{/actualValueLabel}",targetValueLabel:"{/targetValueLabel}",thresholds:{template:e,path:"/thresholds"},state:"{/state}",showActualValue:"{/showActualValue}",showTargetValue:"{/showTargetValue}"});this.oNVConfS=new sap.ushell.components.tiles.sbtilecontent({unit:"{/unit}",size:"{/size}",footer:"{/footerNum}",content:this.oBCTmpl});this.oGenericTile=new G({subheader:"{/subheader}",frameType:"{/frameType}",size:"{/size}",header:"{/header}",tileContent:[this.oNVConfS]});var g=new b();g.setData(d);this.oGenericTile.setModel(g);return this.oGenericTile;}});},true);
sap.ui.predefine('sap/ushell/components/tiles/indicatornumeric/NumericTile.controller',["sap/ushell/components/tiles/generic","sap/m/library"],function(g,m){"use strict";var D=m.DeviationIndicator;var V=m.ValueColor;var L=m.LoadState;var F=m.FrameType;var N=g.extend("sap.ushell.components.tiles.indicatornumeric.NumericTile",{onInit:function(){this.KPI_VALUE_REQUIRED=true;},doProcess:function(k,t){var a=this;this.CALCULATED_KPI_VALUE=k;var b=this.getTrendColor(t);var d=this.getTrendIndicator(t.trendValue);var s="";var e=this.CALCULATED_KPI_VALUE;if(this.oConfig.EVALUATION.SCALING==-2){e*=100;this.getView().oNVConfContS.setFormatterValue(false);}var c=this.isCurrencyMeasure(this.oConfig.EVALUATION.COLUMN_NAME);s=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(e),this.oConfig.EVALUATION.SCALING,this.oConfig.EVALUATION.DECIMAL_PRECISION,c,this.CURRENCY_CODE);if(this.oConfig.EVALUATION.SCALING==-2){this._updateTileModel({scale:"%"});}this._updateTileModel({value:s.toString(),valueColor:b,indicator:d});if(a.oConfig.TILE_PROPERTIES.frameType==F.OneByOne){this.oKpiTileView.oGenericTile.setState(L.Loaded);this.setToolTip(b,e,"NT");}else{a.getView().getViewData().parentController._updateTileModel(this.getTile().getModel().getData());a.getView().getViewData().deferredObj.resolve();sap.ushell.components.tiles.indicatorTileUtils.util.setUnsetCallInProgress(a.oConfig.TILE_PROPERTIES.id+"defferedLeft",false);}this.setToolTip(b,e,"NT");if(!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(this.oConfig)){if(a.chipCacheTime){sap.ushell.components.tiles.indicatorTileUtils.util.scheduleFetchDataJob.call(this,a.oTileApi.visible.isVisible());}}},doDummyProcess:function(){var t=this;this.setTextInTile();if(!(t.oConfig.BLANKTILE||t.oConfig.TILE_PROPERTIES.blankTile)){t._updateTileModel({value:"10.34",scale:"M",valueColor:V.Neutral,indicator:D.None});}else{this.oKpiTileView.oNVConfContS.setIcon("sap-icon://BusinessSuiteInAppSymbols/icon-multiple-charts");}this.oKpiTileView.oGenericTile.setState(L.Loaded);}});return N;});
sap.ui.predefine('sap/ushell/components/tiles/indicatornumeric/NumericTile.view',["sap/ui/core/mvc/JSView","sap/ui/model/analytics/odata4analytics","sap/ushell/components/tiles/indicatorTileUtils/smartBusinessUtil","sap/m/library","sap/m/NumericContent","sap/m/GenericTile","sap/ui/model/json/JSONModel"],function(J,o,s,m,N,G,a){"use strict";var D=m.DeviationIndicator;var V=m.ValueColor;var L=m.LoadState;sap.ui.getCore().loadLibrary("sap.suite.ui.commons");sap.ui.jsview("sap.ushell.components.tiles.indicatornumeric.NumericTile",{getControllerName:function(){return"sap.ushell.components.tiles.indicatornumeric.NumericTile";},createContent:function(){var h="Lorem ipsum";var b="Lorem ipsum";var t=sap.ushell.components.tiles.indicatorTileUtils.util.getTileTitleSubtitle(this.getViewData().chip);if(t.title&&t.subTitle){h=t.title;b=t.subTitle;}var g={subheader:b,header:h,footerNum:"",footerComp:"",scale:"",unit:"",value:"",size:"Auto",frameType:"OneByOne",state:L.Loading,valueColor:V.Neutral,indicator:D.None,title:"",footer:"",description:""};this.oNVConfContS=new N({value:"{/value}",scale:"{/scale}",unit:"{/unit}",indicator:"{/indicator}",valueColor:"{/valueColor}",size:"{/size}",formatterValue:true,truncateValueTo:5,nullifyValue:false});this.oNVConfS=new sap.ushell.components.tiles.sbtilecontent({unit:"{/unit}",size:"{/size}",footer:"{/footerNum}",content:this.oNVConfContS});this.oGenericTile=new G({subheader:"{/subheader}",frameType:"{/frameType}",size:"{/size}",header:"{/header}",tileContent:[this.oNVConfS]});var c=new a();c.setData(g);this.oGenericTile.setModel(c);return this.oGenericTile;}});},true);
sap.ui.predefine('sap/ushell/components/tiles/sbtilecontent',["sap/m/TileContent","sap/m/TileContentRenderer","sap/ui/core/Control"],function(T,R,C){"use strict";var t=C.extend("numeric.TileContent_Timestamp",{ontap:function(e){if(this.getParent().getRefreshOption()){e.preventDefault();e.cancelBubble=true;if(e.stopPropagation){e.stopPropagation();}this.getParent().fireRefresh();}},renderer:function(r,c){r.write("<div");r.writeElementData(c);r.addClass("sapMTileCntFtrTxt");if(c.getParent().getRefreshOption()){r.addClass("sapMLnk");}r.writeClasses();r.addStyle("position","absolute");r.addStyle("z-index","2");r.addStyle(r.getConfiguration().getRTL()?"left":"right","auto");r.writeStyles();r.write(">");var a=c.getParent().getTimestamp();if(a){if(!c.getParent().getRefreshOption()){r.writeEscaped(a);}else if(r.getConfiguration().getRTL()){r.writeEscaped(a+"\u2009");r.writeIcon("sap-icon://refresh","sapMCmpTileUnitInner");}else{r.writeIcon("sap-icon://refresh","sapMCmpTileUnitInner");r.writeEscaped("\u2009"+a);}}r.write("</div>");}});return T.extend("sap.ushell.components.tiles.sbtilecontent",{metadata:{properties:{timestamp:{type:"string"},refreshOption:{type:"boolean"}},events:{refresh:{}}},init:function(){this.addDependent(this._oTimestamp=new t());},getAltText:function(){var a=T.prototype.getAltText.apply(this,arguments);if(this.getTimestamp()){a+=(a===""?"":"\n")+this.getTimestamp();}return a;},renderer:{_renderFooter:function(r,c){R._renderFooter.apply(this,arguments);r.renderControl(c._oTimestamp);}}});},true);
sap.ui.predefine('sap/ushell/components/tiles/utils',["sap/ushell/services/_ClientSideTargetResolution/PrelaunchOperations","sap/ushell/resources","sap/ui/thirdparty/datajs","sap/ui/model/json/JSONModel","sap/ui/core/library","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/core/IconPool","sap/ui/core/Icon","sap/m/SelectDialog","sap/m/StandardListItem","sap/m/Text","sap/ui/core/CustomData","sap/ui/core/Item","sap/m/Label","sap/ui/model/Sorter","sap/ui/thirdparty/jquery","sap/base/Log","sap/ushell/components/tiles/utilsRT"],function(P,r,O,J,c,F,d,I,e,S,f,T,C,g,L,h,q,k,u){"use strict";var M=c.MessageType;var V=c.ValueState;var l=c.mvc.ViewType;var U={};U.isInitial=function(s){return s==="App Launcher – Static"||s==="App Launcher – Dynamic"||s==="Target Mapping";};U.getResourceBundleModel=function(){return r.i18nModel;};U.getEmptyRowObj=function(E){return{name:"",mandatory:false,value:"",isRegularExpression:false,defaultValue:"",valEnabled:false||!E,defValEnabled:true,editable:E};};U.getEmptyTileActionsRowObj=function(E){var R=U.getResourceBundleModel().getResourceBundle();return{menu_title:"",target_type:R.getText("configuration.tile_actions.table.target_type.url"),navigation_target:"",action:"",icon:"",isTargetTypeIntent:false,editable:E};};U.getTileNavigationActionsRows=function(a,E){var b=[],j=[];j=this.getTileNavigationActions(a);if(j.length){for(var i=0;i<j.length;i++){b.push(t(j[i],E));}}else{b=[this.getEmptyTileActionsRowObj(E)];}return b;};U.getTileNavigationActions=function(a){var b=[],s="";var j=a.bag.getBag("tileNavigationActions");if(j.getPropertyNames().indexOf("tile_navigation_actions")>=0){b=JSON.parse(j.getProperty("tile_navigation_actions"));for(var i=0;i<b.length;i++){if(b[i].text){if(j.getTextNames().indexOf("action_tile_"+(i+1))>=0){s=j.getText("action_tile_"+(i+1));}b[i].text=s;}}}return b;};var t=function(a,E){var b={},R=U.getResourceBundleModel().getResourceBundle();b.menu_title=a.text;b.icon=a.icon;if((a.targetURL).charAt(0)==="#"){b.target_type=R.getText("configuration.tile_actions.table.target_type.intent");var N=a.targetURL.split("-");b.navigation_target=N[0].substring(1,N[0].length);b.action=N[1];b.isTargetTypeIntent=true;}else{b.target_type=R.getText("configuration.tile_actions.table.target_type.url");b.navigation_target=a.targetURL;b.action="";b.isTargetTypeIntent=false;}b.editable=E;return b;};U.tileActionsRows2TileActionsArray=function(a){var b=[];for(var i=0;i<a.length;i++){if(a[i].menu_title){b.push(m(a[i]));}}return b;};var m=function(a){var b={};b.text=a.menu_title;b.icon=a.icon;if(a.action){b.targetURL="#"+a.navigation_target+"-"+a.action;}else{b.targetURL=a.navigation_target;}return b;};U.populateTileNavigationActionsBag=function(a,N){a.setProperty("tile_navigation_actions",JSON.stringify(N));for(var i=0;i<N.length;i++){var A=N[i].text;a.setText("action_tile_"+(i+1),A);}};U.getDefaultFormFactors=function(){return{"appDefault":false,"manual":{"desktop":true,"tablet":true,"phone":true},"defaultParam":true};};U.buildFormFactorsObject=function(a){return{"appDefault":a.getProperty("/config/appFormFactor"),"manual":{"desktop":a.getProperty("/config/desktopChecked"),"tablet":a.getProperty("/config/tabletChecked"),"phone":a.getProperty("/config/phoneChecked")}};};U.tableHasDuplicateParameterNames=function(a){var p={};for(var i=0;i<a.length;i++){var b=a[i].name;if(b!==""){if(p[b]){return true;}p[b]=true;}}return false;};U.tableHasInvalidSapPrelaunchOperationValue=function(a){for(var i=0;i<a.length;i++){if(a[i].name==="sap-prelaunch-operations"){if(P.parseAndValidateOperations(a[i].defaultValue)===null){return false;}break;}}return true;};U.getMappingSignatureString=function(a,b){var j="";for(var i=0;i<a.length;i++){if(a[i].name){j+=(n(a[i])+"&");}}return b?j+"*=*":j.substring(0,j.length-1);};var n=function(a){var p="";if(a.mandatory){if(a.isRegularExpression){p="{"+a.name+"="+encodeURIComponent(a.value)+"}";}else{p=a.name+"="+encodeURIComponent(a.value);}}else{p="["+a.name+"="+encodeURIComponent(a.defaultValue)+"]";}return p;};U.getMappingSignatureTableData=function(a,E){var p=[];var b=a.split("&");for(var i=0;i<b.length;i++){var j=b[i];if(j!=="*=*"){p.push(o(b[i],E));}}return p;};var o=function(p,E){var a={};if(p.charAt(0)==="["){a.mandatory=false;a.isRegularExpression=false;a.value="";p=p.substring(1,p.length-1);a.name=p.substring(0,p.indexOf("="));a.defaultValue=decodeURIComponent(p.substring(p.indexOf("=")+1));}else{a.mandatory=true;a.defaultValue="";if(p.charAt(0)==="{"){a.isRegularExpression=true;p=p.substring(1,p.length-1);}else{a.isRegularExpression=false;}a.name=p.substring(0,p.indexOf("="));a.value=decodeURIComponent(p.substring(p.indexOf("=")+1));}a.editable=E;if(E){a.valEnabled=a.mandatory;a.defValEnabled=!a.mandatory;}else{a.valEnabled=true;a.defValEnabled=true;}return a;};U.getAllowUnknownParametersValue=function(a){if(a&&(a.substring(a.length-3,a.length)==="*=*")){return true;}return false;};U.getMappingSignature=function(R,a){var A=a?"allowed":"ignored";var b=new RegExp("%%UserDefault[.].+%%");var i=[];var j={"parameters":{},"additional_parameters":A};R.forEach(function(p){j.parameters[p.name]={"required":p.mandatory,"rename_to":p.rename_to};if(p.defaultValue){i=b.exec(p.defaultValue);if(i){p.defaultValue=i[0];}j.parameters[p.name].defaultValue={"value":p.defaultValue};}if(p.value){i=b.exec(p.value);if(i){p.value=i[0];}j.parameters[p.name].filter={"value":p.value};if(p.isRegularExpression){j.parameters[p.name].filter.format="regexp";}}});return j;};U.getSignatureTableData=function(s,E){var p=[];var R={};var a={};var b=s.parameters;for(var i in b){a=b[i];R={};R.editable=E;R.name=i;R.mandatory=a.required;if(a.rename_to){R.rename_to=a.rename_to;}else{R.rename_to=a.renameTo;}if(E){R.valEnabled=R.mandatory;R.defValEnabled=!R.mandatory;}else{R.valEnabled=true;R.defValEnabled=true;}if(a.filter){R.value=a.filter.value;if(a.filter.format&&a.filter.format==="regexp"){R.isRegularExpression=true;}}if(a.defaultValue){R.defaultValue=a.defaultValue.value;}p.push(R);}return p;};U.getTranslatedTitle=function(a){if(a.bag){var b=a.bag.getBag("tileProperties");if(b.getTextNames().indexOf("display_title_text")>=0){return b.getText("display_title_text");}}if(a.title){return a.title.getTitle();}if(a.preview){return a.preview.getTitle();}return"";};U.getTranslatedSubtitle=function(a,b){if(a.bag){var i=a.bag.getBag("tileProperties");if(i.getTextNames().indexOf("display_subtitle_text")>=0){return i.getText("display_subtitle_text");}}if(typeof b.display_subtitle_text==="string"){return b.display_subtitle_text;}if(a.preview&&a.preview.getDescription&&a.preview.getDescription()){return a.preview.getDescription();}return"";};U.getTranslatedProperty=function(a,b,p){if(a.bag){var i=a.bag.getBag("tileProperties");if(i.getTextNames().indexOf(p)>=0){return i.getText(p);}}return b[p];};U.getActionConfiguration=function(a,A){var s=a.configuration.getParameterValueAsString("tileConfiguration");var b=JSON.parse(s||"{}"),R;if(typeof A==="undefined"){A=a.configurationUi.isEnabled();}if(A){R=U.getResourceBundleModel().getResourceBundle();}b.semantic_object=b.semantic_object||(A?"["+R.getText("configuration.semantic_object")+"]":"");b.semantic_action=b.semantic_action||(A?"["+R.getText("configuration.semantic_action")+"]":"");b.navigation_provider=b.navigation_provider||"";b.navigation_provider_role=b.navigation_provider_role||"";b.navigation_provider_instance=b.navigation_provider_instance||"";b.target_application_id=b.target_application_id||"";b.target_application_alias=b.target_application_alias||"";b.display_info_text=b.display_info_text||"";b.editable=true;if(a.configurationUi&&a.configurationUi.isReadOnly){if(a.configurationUi.isReadOnly()){b.editable=false;}}return b;};U.getConfiguration=function(v){var a=v.getViewData();var b=a.chip;var i=u.getConfiguration(b,true,true);return i;};U.getConfigurationUi=function(v,s){var a,b,R,i,A,j;var p=v.getViewData();var w=U.getConfiguration(v);var x=new J({config:w,tileModel:v.getModel()});a=new sap.ui.view({type:l.XML,viewData:p,viewName:s});a.setModel(x);b=a.byId("navigation_semantic_objectInput")||a.byId("semantic_objectInput");if(b){b.getModel().setProperty("/enabled",w.navigation_use_semantic_object);b.getModel().setProperty("/value",w.semantic_object||w.navigation_semantic_object);}R=a.byId("navigation_provider_roleInput");if(R){R.getModel().setProperty("/value",w.navigation_provider_role);}i=a.byId("navigation_provider_instanceInput");if(i){i.getModel().setProperty("/value",w.navigation_provider_instance);}A=a.byId("target_application_aliasInput");if(A){A.getModel().setProperty("/value",w.target_application_alias);}j=a.byId("targetTypeInput");if(j){if(!a.getModel().getProperty("/config/transaction")){a.getModel().setProperty("/config/transaction",{});}if(!a.getModel().getProperty("/config/web_dynpro")){a.getModel().setProperty("/config/web_dynpro",{});}if(v.getModel().getProperty("/config/navigation_provider")==="LPD"){U.displayLpdCustApplicationTypeFields(a);}else if(v.getModel().getProperty("/config/navigation_provider")==="WCF"){j.setSelectedKey("WCF");U.displayWCFApplicationTypeFields(a);}else if(v.getModel().getProperty("/config/navigation_provider")==="SAPUI5"||v.getModel().getProperty("/config/navigation_provider")===""){j.setSelectedKey("SAPUI5");U.displaySapui5ApplicationTypeFields(a);}else if(v.getModel().getProperty("/config/navigation_provider")==="TR"){U.displayTransactionApplicationTypeFields(a);}else if(v.getModel().getProperty("/config/navigation_provider")==="WDA"){U.displayWebDynproApplicationTypeFields(a);}else if(v.getModel().getProperty("/config/navigation_provider")==="URL"){U.displayURLApplicationTypeFields(a);}else if(v.getModel().getProperty("/config/navigation_provider")==="URLT"){U.displayURLTApplicationTypeFields(a);x.setProperty("/config/editable",false);x.setProperty("/config/manualFormFactor",false);}}return a;};U._updateTilePropertiesTexts=function(v,a){var b=a.getTextNames(),i=v.getModel();b.forEach(function(p){i.setProperty("/data/"+p,a.getText(p));i.setProperty("/config/"+p,a.getText(p));});};U._updateTileConfiguration=function(v,a){var b=v.getModel();q.each(JSON.parse(a),function(p,s){b.setProperty("/data/"+p,s);b.setProperty("/config/"+p,s);if(p==="navigation_target_url"){b.setProperty("/nav/"+p,s);}});};U.aData=[];U.aActionData=[];U.aRoleData=[];U.aAliasData=[];U.objectSelectDoSearch=function(E){var a=[],v=E.getParameter("value"),i,s,b;if(v!==undefined){i=E.getParameter("itemsBinding");s=new F("name",d.Contains,v);b=new F("obj",d.Contains,v);a.push(b);a.push(s);i.filter(new F(a,false));}};U.actionSelectDoSearch=function(E){var a=[],v=E.getParameter("value"),i,s;if(v!==undefined){i=E.getParameter("itemsBinding");s=new F("text",d.Contains,v);a.push(s);i.filter(new F(a,false));}};U.roleSelectDoSearch=function(E){var a=[],v=E.getParameter("value"),i,s,b;if(v!==undefined){i=E.getParameter("itemsBinding");s=new F("role",d.Contains,v);b=new F("instance",d.Contains,v);a.push(s);a.push(b);i.filter(new F(a,false));}};U.instanceSelectDoSearch=function(E){var a=[],v=E.getParameter("value"),b,R,i,s,j;b=E.getSource().getCustomData();R=b[0].getValue();if(v!==undefined){i=E.getParameter("itemsBinding");if(v!==""){j=new F("instance",d.Contains,v);a.push(j);}if(R!==""){s=new F("role",d.EQ,R);a.push(s);}if(a.length>0){i.filter(new F(a,true));}}};U.instanceSuggest=function(a,E){var v=a.getView(),b=[],s=E.getParameter("value"),R,i,j,p,w;R=v.byId("navigation_provider_roleInput");i=R.getValue();s=E.getParameter("suggestValue");if(s!==""){w=new F("instance",d.Contains,s);b.push(w);}if(i!==""){p=new F("role",d.EQ,i);b.push(p);}if(b.length>0){j=E.oSource.getBinding("suggestionItems");j.filter(new F(b,true));}};U.aliasSuggest=function(a,E){var v=a.getView(),b=[],s=E.getParameter("value"),i,j,p,w,x;i=v.byId("navigation_provider_instanceInput");j=i.getValue();s=E.getParameter("suggestValue");if(s!==""){x=new F("alias",d.Contains,s);b.push(x);}if(j!==""){w=new F("instance",d.EQ,j);b.push(w);}if(b.length>0){p=E.oSource.getBinding("suggestionItems");p.filter(new F(b,true));}};U.aliasSelectDoSearch=function(E){var a=[],v=E.getParameter("value"),b,i,j,s,p;b=E.getSource().getCustomData();i=b[0].getValue();if(v!==undefined){j=E.getParameter("itemsBinding");s=new F("instance",d.EQ,i);if(v!==""){p=new F("alias",d.Contains,v);a.push(p);}a.push(s);j.filter(new F(a,true));}};U.objectSelectUpdateDialog=function(s,v){var a=[],i=s.getBinding("items"),b;if(v!==undefined){b=new F("name",d.Contains,v);a.push(b);i.filter(a);}};U.actionSelectUpdateDialog=function(s,v){var a=[],i=s.getBinding("items"),b;if(v!==undefined){b=new F("text",d.Contains,v);a.push(b);i.filter(a);}};U.roleSelectUpdateDialog=function(s,v){var a=[],i=s.getBinding("items"),b;if(v!==undefined){b=new F("role",d.Contains,v);a.push(b);i.filter(a);}};U.instanceSelectUpdateDialog=function(s,v){var a=[],b,i=s.getBinding("items"),j,R,p;b=s.getCustomData();R=b[0].getValue();if(v!==undefined){j=new F("instance",d.Contains,v);a.push(j);}if(R!==""){p=new F("role",d.EQ,R);a.push(p);}if(a.length>0){i.filter(a,true);}};U.aliasSelectUpdateDialog=function(s,v){var a=[],b,i,j=s.getBinding("items"),p,w;b=s.getCustomData();i=b[0].getValue();if(v!==undefined){w=new F("alias",d.Contains,v);a.push(w);}if(i!==""){p=new F("instance",d.EQ,i);a.push(p);}if(a.length>0){j.filter(a,true);}};U.sSelectedColor=(q(".sapMStdTileIconDiv").css("color")||"#007cc0").split(" ").join("");U.sDeselectedColor=(q(".sapMLabel:not(.sapFioriDropZoneText )").css("color")||"#666666").split(" ").join("");U.iconSelect=function(i,s){i.setColor(s?U.sSelectedColor:U.sDeselectedColor);i.setActiveColor(s?U.sDeselectedColor:U.sSelectedColor);};U.onSelectIcon=function(a,i,b,j){var p=a.getView().getModel(),s;if(i){s=p.getProperty("/config/tile_actions_selected_icon");}else{s=p.getProperty("/config/selected_icon");}if(s){U.iconSelect(s,false);}s=j.getSource();U.iconSelect(s,true);p.setProperty("/config/ok.enabled",true);if(i){p.setProperty("/config/tile_actions_selected_icon",s);}else{p.setProperty("/config/selected_icon",s);}a.byId("selectIconDialog").setTitle(s.getSrc());};U.onSelectIconClose=function(v){v.byId("selectIconDialog").close();};U.onSelectIconOk=function(v,a){var s=v.getModel().getProperty("/config/selected_icon");if(!a){v.getModel().setProperty("/config/display_icon_url",s.getSrc());v.byId("iconInput").setValueState(V.None);}else{s=v.getModel().getProperty("/config/tile_actions_selected_icon");if(s){a.setValue(s.getSrc());a.setValueState(V.None);}}U.onSelectIconClose(v);};U.iconSelectOnValueHelpRequest=function(a,E,b){var p=a.getView().getModel();var R=a.getView().byId("icons");var s=I.getIconCollectionNames();var D=a.getView().byId("selectIconDialog");var v=a.getView().byId("ok");var w,x,y,z,i,j,A,B=false;R.destroyContent();if(b){y=sap.ui.getCore().byId(E.getParameter("id"));x=y.getValue();}else{x=p.getProperty("/config/display_icon_url");}v.attachEventOnce("press",function(){U.onSelectIconOk(a.getView(),y);});s.sort();s=q.grep(s,function(G){if(G==="BusinessSuiteInAppSymbols"){B=true;return false;}return true;});if(B){s.push("BusinessSuiteInAppSymbols");}for(i=0;i<s.length;i+=1){z=I.getIconNames(s[i]);z.sort();for(j=0;j<z.length;j+=1){A=I.getIconURI(z[j],s[i]);R.addContent(new e({height:"38px",press:U.onSelectIcon.bind(null,a,b,y),size:"2rem",src:A,tooltip:A,width:"38px"}));}}w=R.getContent();p.setProperty("/config/ok.enabled",false);D.bindProperty("title",{model:"i18n",path:"configuration.select_icon"});for(i=0;i<w.length;i+=1){if(w[i].getSrc()===x){if(b){p.setProperty("/config/tile_actions_selected_icon",w[i]);}else{p.setProperty("/config/selected_icon",w[i]);}U.iconSelect(w[i],true);p.setProperty("/config/ok.enabled",true);D.setTitle(x);}else{U.iconSelect(w[i],false);}}D.open();};U.objectSelectOnValueHelpRequest=function(a,E,i){var v=a.getView(),s=U.getResourceBundleModel().getResourceBundle().getText("configuration.semantic_object"),b,j,p=new J(),w=new S("semantic_object_select_dialog",{title:s,search:U.objectSelectDoSearch,liveChange:U.objectSelectDoSearch}),x=new f({title:"{obj}"});if(i){b=sap.ui.getCore().byId(E.getParameter("id"));}else{b=v.byId("semantic_objectInput")||v.byId("navigation_semantic_objectInput");}j=b.getValue();w.open(j);p.setData(a.aDefaultObjects.concat(U.aData));w.bindAggregation("items","/",x);w.setModel(p);U.objectSelectUpdateDialog(w,j);w.attachCancel(function(y){b.setValue(j);if(!i){b.fireChange();}w.destroy();w=null;});w.attachConfirm(function(y){var z=y.getParameter("selectedItem");if(z){b.setValue(z.getTitle());if(!i){b.fireChange();}}w.destroy();w=null;});};U.actionSelectOnValueHelpRequest=function(a,E,i){var v=a.getView(),s=U.getResourceBundleModel().getResourceBundle().getText("configuration.semantic_action"),A,b,j=new J(),p=new S("semantic_action_select_dialog",{title:s,search:U.actionSelectDoSearch,liveChange:U.actionSelectDoSearch}),w=new f({title:"{text}"});if(i){A=sap.ui.getCore().byId(E.getParameter("id"));}else{A=v.byId("semantic_actionInput")||v.byId("navigation_semantic_actionInput");}b=A.getValue();p.open(b);j.setData(U.aActionData);p.bindAggregation("items","/items",w);p.setModel(j);U.actionSelectUpdateDialog(p,b);p.attachCancel(function(x){A.setValue(b);if(!i){A.fireChange();}p.destroy();p=null;});p.attachConfirm(function(x){var y=x.getParameter("selectedItem");if(y){A.setValue(y.getTitle());if(!i){A.fireChange();A.fireLiveChange({"newValue":y.getTitle()});}}p.destroy();p=null;});};U.roleSelectOnValueHelpRequest=function(a){var v=a.getView(),s=U.getResourceBundleModel().getResourceBundle().getText("configuration.navigation_provider_role"),R,i,b,j=new J(),p=new sap.m.TableSelectDialog("role_select_dialog",{title:s,search:U.roleSelectDoSearch,liveChange:U.roleSelectDoSearch,columns:[new sap.m.Column({header:[new T({text:U.getResourceBundleModel().getResourceBundle().getText("configuration.navigation_provider_role")})]}),new sap.m.Column({header:[new T({text:U.getResourceBundleModel().getResourceBundle().getText("configuration.navigation_provider_instance")})]})]}),w=new sap.m.ColumnListItem({cells:[new T({text:"{role}"}),new T({text:"{instance}"})]});R=v.byId("navigation_provider_roleInput");i=v.byId("navigation_provider_instanceInput");b=R.getValue();p.open(b);j.setData(a.aDefaultObjects.concat(U.aRoleData));p.bindAggregation("items","/",w);p.setModel(j);U.roleSelectUpdateDialog(p,b);p.attachCancel(function(x){R.setValue(b);R.fireChange();p.destroy();p=null;});p.attachConfirm(function(x){var y=x.getParameter("selectedItem");if(y){R.setValue(y.getCells()[0].getText());i.setValue(y.getCells()[1].getText());R.fireChange();i.fireChange();}p.destroy();p=null;});};U.instanceSelectOnValueHelpRequest=function(a){var v=a.getView(),R,s=U.getResourceBundleModel().getResourceBundle().getText("configuration.navigation_provider_instance"),i,b,j=new J(),p=new S("instance_select_dialog",{title:s,search:U.instanceSelectDoSearch,liveChange:U.instanceSelectDoSearch}),w=new f({title:"{instance}"});i=v.byId("navigation_provider_instanceInput");b=i.getValue();R=v.byId("navigation_provider_roleInput").getValue();p.addCustomData(new C({key:"role",value:R}));p.open(b);j.setData(a.aDefaultObjects.concat(U.aRoleData));p.bindAggregation("items","/",w);p.setModel(j);U.instanceSelectUpdateDialog(p,b);p.attachCancel(function(x){i.setValue(b);i.fireChange();p.destroy();p=null;});p.attachConfirm(function(x){var y=x.getParameter("selectedItem");if(y){i.setValue(y.getTitle());i.fireChange();}p.destroy();p=null;});};U.applicationAliasSelectOnValueHelpRequest=function(a){var v=a.getView(),s=U.getResourceBundleModel().getResourceBundle().getText("configuration.target_application_alias"),A,b,i,j=new J(),p=new S("alias_select_dialog",{title:s,search:U.aliasSelectDoSearch,liveChange:U.aliasSelectDoSearch}),w=new f({title:"{alias}"});A=v.byId("target_application_aliasInput");b=A.getValue();i=v.byId("navigation_provider_instanceInput").getValue();p.addCustomData(new C({key:"instance",value:i}));p.open(b);j.setData(a.aDefaultObjects.concat(U.aAliasData));p.bindAggregation("items","/",w);p.setModel(j);U.aliasSelectUpdateDialog(p,b);p.attachCancel(function(x){A.setValue(b);A.fireChange();p.destroy();p=null;});p.attachConfirm(function(x){var y=x.getParameter("selectedItem");if(y){A.setValue(y.getTitle());A.fireChange();}p.destroy();p=null;});};U.onTargetTypeChange=function(a){var i=a.getParameter("id");var p=sap.ui.getCore().byId(i).getParent().getCells();var s=a.getSource().getSelectedKey();if(s==="INT"){p[3].setEnabled(true);p[2].setShowValueHelp(true);p[2].setValue("");}else{p[2].setShowValueHelp(false);p[2].setValue("");p[3].setEnabled(false);p[3].setValue("");}};U.addTileActionsRow=function(a){var b=a.getModel();var i=b.getProperty("/config/tile_actions_rows");var j=this.getEmptyTileActionsRowObj();i.push(j);b.setProperty("/config/tile_actions_rows",i);};U.deleteTileActionsRow=function(j){var p=j.getModel();var s=p.getProperty("/config/tile_actions_rows");var v=j.byId("tileActions");var w=v.getSelectedIndices();var x=w.sort(function(a,b){return b-a;}).slice();for(var i=0;i<x.length;i++){v.removeSelectionInterval(x[i],x[i]);s.splice(x[i],1);}p.setProperty("/config/tile_actions_rows",s);};U.checkInput=function(a,b){var i=U.getResourceBundleModel().getResourceBundle(),j=a.byId("iconInput"),p=a.byId("useLpdCheckbox"),s=a.byId("navigation_semantic_objectInput")||a.byId("semantic_objectInput"),v=a.byId("navigation_semantic_actionInput")||a.byId("semantic_actionInput"),w=V.None,x=null,N=q.trim(b.getParameter("newValue"));switch(b.getSource()){case j:if(N!==""&&N.substring(0,11)!=="sap-icon://"){w=V.Error;x=i.getText("configuration.display_icon_url.warning");}break;case p:if(!p.getSelected()){v.setValueState(V.None);s.setValueState(V.None);}break;case s:if(/[-#&? ]/.test(N)){w=V.Error;x=i.getText("configuration.semantic_object.error_invalid_chars");}else if(N===""){w=V.Error;}break;case v:if(/[-#&? ]/.test(N)){w=V.Error;x=i.getText("configuration.semantic_action.error_invalid_chars");}else if(N===""){w=V.Error;}break;default:break;}if(w){b.getSource().setValueState(w);if(x!==null){b.getSource().setValueStateText(x||"");}}};U.checkInputOnSaveConfig=function(a){var i=a.byId("iconInput");var s=a.byId("navigation_semantic_objectInput");var b=a.byId("navigation_semantic_actionInput");var j=a.byId("useLpdCheckbox");var p=U.getResourceBundleModel().getResourceBundle();var R=false;if(i.getValue()!==""&&!U.isIconURIValid(i.getValue())){i.setValueState(V.Error);i.setValueStateText(p.getText("configuration.display_icon_url.warning"));R=true;}if(j.getSelected()&&/[-#&? ]/.test(s.getValue())){s.setValueState(V.Error);s.setValueStateText(p.getText("configuration.semantic_object.error_invalid_chars"));R=true;}else if(j.getSelected()&&s.getValue()===""){s.setValueState(V.Error);R=true;}if(/[-#&? ]/.test(b.getValue())){b.setValueState(V.Error);b.setValueStateText(p.getText("configuration.semantic_action.error_invalid_chars"));R=true;}else if(j.getSelected()&&b.getValue()===""){b.setValueState(V.Error);R=true;}return R;};U.checkTileActions=function(a){var b=a.getModel().getProperty("/config/tile_actions_rows");var j=U.getResourceBundleModel().getResourceBundle();var R=false;for(var i=0;i<b.length;i++){if(!b[i].menu_title&&(b[i].navigation_target||b.length>1)){b[i].valueState=V.Error;R=true;}else{b[i].valueState=V.None;}if(b[i].icon){if(!U.isIconURIValid(b[i].icon)){b[i].iconValueState=V.Error;b[i].iconValueStateText=j.getText("configuration.display_icon_url.warning");R=true;}}}a.getModel().setProperty("/config/tile_actions_rows",b);return R;};U.isIconURIValid=function(i){var R=[];var s="";var a="";var v="";R=/sap-icon:\/\/(.+)\//.exec(i);if(R){s=R[1];R=/\/\/.+\/(.+)/.exec(i);if(R){a=R[1];}else{a="";}v=I.getIconURI(a,s);if(v!==i){return false;}}else{R=/sap-icon:\/\/(.+)/.exec(i);if(R){a=R[1];if(!I.getIconInfo(a)){return false;}}else{return false;}}return true;};U.checkTMInput=function(a,b){var i=U.getResourceBundleModel().getResourceBundle(),s=a.byId("semantic_objectInput"),j=a.byId("semantic_actionInput"),p=a.byId("target_application_descriptionInput"),v=a.byId("target_application_urlInput"),w=a.byId("target_application_componentInput"),N=a.byId("navigation_provider_roleInput"),x=a.byId("navigation_provider_instanceInput"),y=a.byId("target_application_aliasInput"),z=a.byId("target_application_idInput"),A=q.trim(b.getParameter("newValue")),B=V.None,D=null;switch(b.getSource()){case s:if(/[-#&? ]/.test(A)){B=V.Error;D=i.getText("configuration.semantic_object.error_invalid_chars");}if(j.getValue()===""){j.setValueState(V.Error);}break;case j:if(/[-#&? ]/.test(A)){B=V.Error;D=i.getText("configuration.semantic_action.error_invalid_chars");}else if(A===""){B=V.Error;}break;case p:if(A===""){B=V.Error;}break;case v:if(A!==""&&!(/^[-~+,;:?%&#=/.\w]+$/.test(A))){B=V.Error;D=i.getText("configuration.target_application.url.error_invalid_chars");}break;case w:if(A===""){B=V.Error;}else if(A.substring(0,17)==="SAPUI5.Component="){B=V.Error;D=i.getText("configuration.target_application.component.error_invalid_input");}break;case N:if(A===""){B=V.Error;}else if(!(/^[\w/]+$/.test(A))){B=V.Error;D=i.getText("configuration.target_application.role.error_invalid_chars");}break;case x:if(A===""){B=V.Error;}else if(!(/^[\w/]+$/.test(A))){B=V.Error;D=i.getText("configuration.target_application.instance.error_invalid_chars");}break;case y:if(A===""&&z.getValue()===""){B=V.Error;D=i.getText("configuration.target_application.alias_id.warning");}else if(A!==""&&z.getValue()!==""){B=V.Error;D=i.getText("configuration.target_application.alias_id.warning");z.setValueState(B);z.setValueStateText(D);}else{z.setValueState(V.None);}break;case z:if(A===""&&y.getValue()===""){B=V.Error;D=i.getText("configuration.target_application.alias_id.warning");}else if(A!==""&&y.getValue()!==""){B=V.Error;D=i.getText("configuration.target_application.alias_id.warning");y.setValueState(B);y.setValueStateText(D);}else if(A!==""&&!(/^[A-Fa-f0-9]+$/.test(A))){B=V.Error;D=i.getText("configuration.target_application.alias_id.error_invalid_chars");}else{y.setValueState(V.None);}break;default:break;}if(B){b.getSource().setValueState(B);if(D!==null){b.getSource().setValueStateText(D||"");}}};U.checkTMInputOnSaveConfig=function(a){var b=U.getResourceBundleModel().getResourceBundle();var s=a.byId("semantic_objectInput");var i=a.byId("semantic_actionInput");var j=a.byId("target_application_descriptionInput");var p=a.byId("target_application_urlInput");var v=a.byId("target_application_componentInput");var N=a.byId("navigation_provider_roleInput");var w=a.byId("navigation_provider_instanceInput");var x=a.byId("target_application_aliasInput");var y=a.byId("target_application_idInput");var z=a.byId("targetTypeInput");var A=a.byId("target_transactionInput");var W=a.byId("target_web_dynpro_applicationInput");var B=a.byId("target_wcf_application_idInput");var D=a.byId("desktopCB");var E=a.byId("tabletCB");var G=a.byId("phoneCB");var R=false;s.setValue(s.getValue().trim());if(/[-#&? ]/.test(s.getValue())){s.setValueState(V.Error);s.setValueStateText(b.getText("configuration.semantic_object.error_invalid_chars"));R=true;}i.setValue(i.getValue().trim());if(/[-#&? ]/.test(i.getValue())){i.setValueState(V.Error);i.setValueStateText(b.getText("configuration.semantic_action.error_invalid_chars"));R=true;}else if(i.getValue()===""){i.setValueState(V.Error);R=true;}var H=a.getModel().getProperty("/config/navigation_provider"),K;if(H==="SAPUI5"){if(j.getValue()===""){j.setValueState(V.Error);R=true;}if(p.getValue()!==""&&!(/^[-~+,;:?%&#=/.\w]+$/.test(p.getValue()))){p.setValueState(V.Error);p.setValueStateText(b.getText("configuration.target_application.url.error_invalid_chars"));R=true;}if(v.getValue()===""){v.setValueState(V.Error);R=true;}else if(v.getValue().substring(0,17)==="SAPUI5.Component="){v.setValueState(V.Error);v.setValueStateText(b.getText("configuration.target_application.component.error_invalid_input"));R=true;}}else if(H==="LPD"){if(N.getValue()===""){N.setValueState(V.Error);R=true;}if(!(/^[\w]+$/.test(N.getValue()))){N.setValueState(V.Error);K=b.getText("configuration.target_application.role.error_invalid_chars");N.setValueStateText(K);R=true;}if(w.getValue()===""){w.setValueState(V.Error);R=true;}if(!(/^[\w]+$/.test(w.getValue()))){w.setValueState(V.Error);K=b.getText("configuration.target_application.instance.error_invalid_chars");w.setValueStateText(K);R=true;}if(x.getValue()===""&&y.getValue()===""){K=b.getText("configuration.target_application.alias_id.warning");x.setValueState(V.Error);x.setValueStateText(K);y.setValueState(V.Error);y.setValueStateText(K);R=true;}if(x.getValue()!==""&&y.getValue()!==""){K=b.getText("configuration.target_application.alias_id.warning");x.setValueState(V.Error);x.setValueStateText(K);y.setValueState(V.Error);y.setValueStateText(K);R=true;}if(y.getValue()!==""&&!(/^[A-Fa-f0-9]+$/.test(y.getValue()))){y.setValueState(V.Error);y.setValueStateText(b.getText("configuration.target_application.alias_id.error_invalid_chars"));R=true;}}else if(H==="TR"){if(A.getValue()===""){A.setValueState(V.Error);R=true;}}else if(H==="WDA"){if(W.getValue()===""){W.setValueState(V.Error);R=true;}}else if(H==="WCF"){if(B.getValue()===""){B.setValueState(V.Error);R=true;}}else if(H==="URL"){if(p.getValue()===""){p.setValueState(V.Error);R=true;}else if(!(/^[-~+,;:?%&#=/.\w]+$/.test(p.getValue()))){p.setValueState(V.Error);p.setValueStateText(b.getText("configuration.target_application.url.error_invalid_chars"));R=true;}}else{z.setValueState(V.Error);z.setValueStateText(b.getText("configuration.navigation_provider.error_invalid_provider"));R=true;}if(!D.getSelected()&&!E.getSelected()&&!G.getSelected()){K=b.getText("configuration.form_factor.warning");D.setValueState(V.Error);D.setValueStateText(K);E.setValueState(V.Error);E.setValueStateText(K);G.setValueState(V.Error);G.setValueStateText(K);R=true;}return R;};U.updateTooltipForDisabledProperties=function(a){var b=a.getModel();var i=b.getProperty("/config/isLocaleSuitable");if(!i){var j=U.getResourceBundleModel().getResourceBundle();var p=j.getText("edit_configuration.original_locale_not_fit_tooltip",[b.getProperty("/config/userLocale"),b.getProperty("/config/orgLocale")]);a.byId("titleInput").setTooltip(p);a.byId("subtitleInput").setTooltip(p);a.byId("keywordsInput").setTooltip(p);a.byId("infoInput").setTooltip(p);}};U.updateMessageStripForOriginalLanguage=function(a){var b=a.getModel();if(b.getProperty("/config/isLocaleSuitable")===false){var s=U.getResourceBundleModel().getResourceBundle().getText("edit_configuration.original_locale_not_fit_message",[b.getProperty("/config/orgLocale").toUpperCase(),b.getProperty("/config/userLocale").toUpperCase()]);var i=a.byId("messageStrip");i.setVisible(true);i.setText(s);i.setType(M.Warning);}};U.createSemanticObjectModel=function(a,s,D){var v=a.getView(),b="/sap/opu/odata/UI2/INTEROP/SemanticObjects",j=[{obj:"",name:""},{obj:"*",name:"*"}],p=(D||j).slice(0),w=new J();w.setSizeLimit(999999);w.setProperty("/value","");w.setProperty("/enabled",true);s.bindAggregation("suggestionItems","suggest>/items",new g({text:"{suggest>obj}"}));s.setModel(w,"suggest");if(U.aData.length>0){setTimeout(function(){w.setData({items:p.concat(U.aData)},true);},0);return;}O.read({requestUri:b,headers:{"Accept":"application/json"}},function(x){var y,z,i;for(i=0;i<x.results.length;i=i+1){y=x.results[i].id;z=x.results[i].text;U.aData.push({obj:y,name:z||y});}w.setData({items:p.concat(U.aData)},true);},function(E){var i=E&&E.message?E.message:E;if(E.response){i+=" - "+E.response.statusCode+" "+E.response.statusText;}k.error("Could not fetch data: "+b+": "+i,null,(v.getViewName()||"sap.ushell.components.tiles.utils"));});};U.createRoleModel=function(a,R,b){var v=a.getView(),s="/sap/opu/odata/UI2/INTEROP/GetLPDInstances",j=new J(),p=new J();j.setSizeLimit(999999);p.setSizeLimit(999999);j.setProperty("/value","");j.setProperty("/enabled",true);p.setProperty("/value","");p.setProperty("/enabled",true);var w=new sap.m.ColumnListItem({cells:[new L({text:"{role}"}),new L({text:"{instance}"})]});R.bindAggregation("suggestionRows","/items",w);b.bindAggregation("suggestionItems","/items",new g({text:"{instance}"}));b.setModel(p);R.setModel(j);R.attachSuggestionItemSelected(function(i){b.setValue(i.getParameter("selectedRow").getCells()[1].getText());b.fireChange();});if(U.aRoleData.length>0){j.setData({items:U.aRoleData},false);p.setData({items:U.aRoleData},false);return;}O.read({requestUri:s,headers:{"Accept":"application/json"}},function(D){var x,y,i;for(i=0;i<D.results.length;i=i+1){x=D.results[i].lpdRole;y=D.results[i].instance;U.aRoleData.push({role:x,instance:y});}j.setData({items:U.aRoleData},true);p.setData({items:U.aRoleData},true);},function(E){var i=E&&E.message?E.message:E;if(E.response){i+=" - "+E.response.statusCode+" "+E.response.statusText;}k.error("Could not fetch data: "+s+": "+i,null,(v.getViewName()||"sap.ushell.components.tiles.utils"));});};U.createAliasModel=function(a,A){var v=a.getView(),b,s="/sap/opu/odata/UI2/INTEROP/GetLPDAppAlias",j=new J();j.setSizeLimit(999999);j.setProperty("/value","");j.setProperty("/enabled",true);A.bindAggregation("suggestionItems","/items",new g({text:"{alias}"}));A.setModel(j);b=u.getConfiguration(v.oViewData.chip,true,true);if(b&&b.navigation_provider_role&&b.navigation_provider_instance){if(b.navigation_provider_role!==""&&b.navigation_provider_instance!==""){s=s+"?role='"+b.navigation_provider_role+"'&instance='"+b.navigation_provider_instance+"'";}}O.read({requestUri:s,headers:{"Accept":"application/json"}},function(D){var p,R,w,i,x;U.aAliasData=[];for(i=0;i<D.results.length;i=i+1){p=D.results[i].lpdApplicationAlias;R=D.results[i].lpdRole;w=D.results[i].lpdInstance;U.aAliasData.push({role:R,instance:w,alias:p});}x=j.getData();if(x){x.items=U.aAliasData;}else{x={items:U.aAliasData};}j.setData(x,false);},function(E){var i=E&&E.message?E.message:E;if(E.response){i+=" - "+E.response.statusCode+" "+E.response.statusText;}k.error("Could not fetch data: "+s+": "+i,null,(v.getViewName()||"sap.ushell.components.tiles.utils"));});};U.updateAliasModel=function(v,a){var s,b,R,j=a.getModel();b=v.byId("navigation_provider_instanceInput").getValue();R=v.byId("navigation_provider_roleInput").getValue();s="/sap/opu/odata/UI2/INTEROP/GetLPDAppAlias?role='"+R+"'&instance='"+b+"'";O.read({requestUri:s,headers:{"Accept":"application/json"}},function(D){var A,R,b,i,p;U.aAliasData=[];for(i=0;i<D.results.length;i=i+1){A=D.results[i].lpdApplicationAlias;R=D.results[i].lpdRole;b=D.results[i].lpdInstance;U.aAliasData.push({role:R,instance:b,alias:A});}p=j.getData();if(p){p.items=U.aAliasData;}else{p={items:U.aAliasData};}j.setData(p,false);},function(E){var i=E&&E.message?E.message:E;if(E.response){i+=" - "+E.response.statusCode+" "+E.response.statusText;}k.error("Could not fetch data: "+s+": "+i,null,(v.getViewName()||"sap.ushell.components.tiles.utils"));});};U.createActionModel=function(a,A){var i=new J();var v=a.getView(),b,s;i.setData({"items":[{"text":"display"},{"text":"approve"},{"text":"displayFactSheet"},{"text":"manage"},{"text":"create"},{"text":"monitor"},{"text":"track"},{"text":"change"},{"text":"register"},{"text":"release"},{"text":"analyzeKPIDetails"},{"text":"lookup"},{"text":"manageLineItems"}]});U.aActionData=i.getData();b=u.getConfiguration(v.oViewData.chip,true,true);s=b.navigation_semantic_action||b.semantic_action;if(s){if(!i.getData().items.some(function(j){return j.text===s;})){i.getData().items.push({"text":s});}}A.bindAggregation("suggestionItems","items>/items",new g({text:"{items>text}"}));A.setModel(i,"items");A.getBinding("suggestionItems").sort(new h("text",false));};U.createNavigationProviderModel=function(a,b){var i=new J();var R=U.getResourceBundleModel().getResourceBundle();var j=[{"key":"SAPUI5","text":R.getText("configuration.target_application.sapui5")},{"key":"LPD","text":R.getText("configuration.target_application.lpd_cust")},{"key":"TR","text":R.getText("configuration.target_application.transaction")},{"key":"WDA","text":R.getText("configuration.target_application.web_dynpro")},{"key":"URL","text":R.getText("configuration.target_application.url")}];var N=U.getConfiguration(a.getView()).navigation_provider;if(N==="WCF"){j.push({"key":"WCF","text":R.getText("configuration.target_application.wcf")});}else if(N==="URLT"){j.push({"key":"URLT","text":R.getText("configuration.target_application.urlt")});}i.setData({"items":j});b.bindItems("items>/items",new g({key:"{items>key}",text:"{items>text}"}));b.setModel(i,"items");b.getBinding("items").sort(new h("text",false));};U.displayApplicationTypeFields=function(a,b){switch(a){case"LPD":U.displayLpdCustApplicationTypeFields(b);break;case"SAPUI5":U.displaySapui5ApplicationTypeFields(b);break;case"TR":U.displayTransactionApplicationTypeFields(b);break;case"WDA":U.displayWebDynproApplicationTypeFields(b);break;case"URL":U.displayURLApplicationTypeFields(b);break;case"WCF":U.displayWCFApplicationTypeFields(b);break;case"URLT":U.displayURLTApplicationTypeFields(b);break;}};U.displayWCFApplicationTypeFields=function(a){a.byId("navigation_provider_role").setVisible(false);a.byId("navigation_provider_roleInput").setVisible(false);a.byId("navigation_provider_instance").setVisible(false);a.byId("navigation_provider_instanceInput").setVisible(false);a.byId("target_application_alias").setVisible(false);a.byId("target_application_aliasInput").setVisible(false);a.byId("target_application_id").setVisible(false);a.byId("target_application_idInput").setVisible(false);a.byId("application_description").setVisible(true);a.byId("target_application_descriptionInput").setVisible(true);a.byId("application_url").setVisible(false);a.byId("target_application_urlInput").setVisible(false);a.byId("application_component").setVisible(false);a.byId("target_application_componentInput").setVisible(false);a.byId("target_transaction").setVisible(false);a.byId("target_transactionInput").setVisible(false);a.byId("target_wcf_application_id").setVisible(true);a.byId("target_wcf_application_idInput").setVisible(true);a.byId("target_web_dynpro_application").setVisible(false);a.byId("target_web_dynpro_applicationInput").setVisible(false);a.byId("target_web_dynpro_configuration").setVisible(false);a.byId("target_web_dynpro_configurationInput").setVisible(false);a.byId("target_system_alias").setVisible(true);a.byId("target_system_aliasInput").setVisible(true);a.byId("urlt_application_component").setVisible(false);a.byId("urlt_application_componentInput").setVisible(false);a.byId("target_urlt_system_alias").setVisible(false);a.byId("target_urlt_system_aliasInput").setVisible(false);a.byId("application_type_deprecated").setVisible(false);};U.displaySapui5ApplicationTypeFields=function(a){a.byId("navigation_provider_role").setVisible(false);a.byId("navigation_provider_roleInput").setVisible(false);a.byId("navigation_provider_instance").setVisible(false);a.byId("navigation_provider_instanceInput").setVisible(false);a.byId("target_application_alias").setVisible(false);a.byId("target_application_aliasInput").setVisible(false);a.byId("target_application_id").setVisible(false);a.byId("target_application_idInput").setVisible(false);a.byId("application_description").setVisible(true);a.byId("target_application_descriptionInput").setVisible(true);a.byId("application_url").setVisible(true);a.byId("target_application_urlInput").setVisible(true);a.byId("application_component").setVisible(true);a.byId("target_application_componentInput").setVisible(true);a.byId("target_transaction").setVisible(false);a.byId("target_transactionInput").setVisible(false);a.byId("target_wcf_application_id").setVisible(false);a.byId("target_wcf_application_idInput").setVisible(false);a.byId("target_web_dynpro_application").setVisible(false);a.byId("target_web_dynpro_applicationInput").setVisible(false);a.byId("target_web_dynpro_configuration").setVisible(false);a.byId("target_web_dynpro_configurationInput").setVisible(false);a.byId("target_system_alias").setVisible(false);a.byId("target_system_aliasInput").setVisible(false);a.byId("urlt_application_component").setVisible(false);a.byId("urlt_application_componentInput").setVisible(false);a.byId("target_urlt_system_alias").setVisible(false);a.byId("target_urlt_system_aliasInput").setVisible(false);a.byId("application_type_deprecated").setVisible(false);};U.displayLpdCustApplicationTypeFields=function(a){a.byId("application_description").setVisible(false);a.byId("target_application_descriptionInput").setVisible(false);a.byId("application_url").setVisible(false);a.byId("target_application_urlInput").setVisible(false);a.byId("application_component").setVisible(false);a.byId("target_application_componentInput").setVisible(false);a.byId("navigation_provider_role").setVisible(true);a.byId("navigation_provider_roleInput").setVisible(true);a.byId("navigation_provider_instance").setVisible(true);a.byId("navigation_provider_instanceInput").setVisible(true);a.byId("target_application_alias").setVisible(true);a.byId("target_application_aliasInput").setVisible(true);a.byId("target_application_id").setVisible(true);a.byId("target_application_idInput").setVisible(true);a.byId("target_transaction").setVisible(false);a.byId("target_transactionInput").setVisible(false);a.byId("target_wcf_application_id").setVisible(false);a.byId("target_wcf_application_idInput").setVisible(false);a.byId("target_web_dynpro_application").setVisible(false);a.byId("target_web_dynpro_applicationInput").setVisible(false);a.byId("target_web_dynpro_configuration").setVisible(false);a.byId("target_web_dynpro_configurationInput").setVisible(false);a.byId("target_system_alias").setVisible(false);a.byId("target_system_aliasInput").setVisible(false);a.byId("urlt_application_component").setVisible(false);a.byId("urlt_application_componentInput").setVisible(false);a.byId("target_urlt_system_alias").setVisible(false);a.byId("target_urlt_system_aliasInput").setVisible(false);a.byId("application_type_deprecated").setVisible(true);};U.displayTransactionApplicationTypeFields=function(a){a.byId("application_description").setVisible(true);a.byId("target_application_descriptionInput").setVisible(true);a.byId("application_url").setVisible(false);a.byId("target_application_urlInput").setVisible(false);a.byId("application_component").setVisible(false);a.byId("target_application_componentInput").setVisible(false);a.byId("navigation_provider_role").setVisible(false);a.byId("navigation_provider_roleInput").setVisible(false);a.byId("navigation_provider_instance").setVisible(false);a.byId("navigation_provider_instanceInput").setVisible(false);a.byId("target_application_alias").setVisible(false);a.byId("target_application_aliasInput").setVisible(false);a.byId("target_application_id").setVisible(false);a.byId("target_application_idInput").setVisible(false);a.byId("target_transaction").setVisible(true);a.byId("target_transactionInput").setVisible(true);a.byId("target_wcf_application_id").setVisible(false);a.byId("target_wcf_application_idInput").setVisible(false);a.byId("target_web_dynpro_application").setVisible(false);a.byId("target_web_dynpro_applicationInput").setVisible(false);a.byId("target_web_dynpro_configuration").setVisible(false);a.byId("target_web_dynpro_configurationInput").setVisible(false);a.byId("target_system_alias").setVisible(true);a.byId("target_system_aliasInput").setVisible(true);a.byId("urlt_application_component").setVisible(false);a.byId("urlt_application_componentInput").setVisible(false);a.byId("target_urlt_system_alias").setVisible(false);a.byId("target_urlt_system_aliasInput").setVisible(false);a.byId("application_type_deprecated").setVisible(false);};U.displayWebDynproApplicationTypeFields=function(a){a.byId("application_description").setVisible(true);a.byId("target_application_descriptionInput").setVisible(true);a.byId("application_url").setVisible(false);a.byId("target_application_urlInput").setVisible(false);a.byId("application_component").setVisible(false);a.byId("target_application_componentInput").setVisible(false);a.byId("navigation_provider_role").setVisible(false);a.byId("navigation_provider_roleInput").setVisible(false);a.byId("navigation_provider_instance").setVisible(false);a.byId("navigation_provider_instanceInput").setVisible(false);a.byId("target_application_alias").setVisible(false);a.byId("target_application_aliasInput").setVisible(false);a.byId("target_application_id").setVisible(false);a.byId("target_application_idInput").setVisible(false);a.byId("target_transaction").setVisible(false);a.byId("target_transactionInput").setVisible(false);a.byId("target_wcf_application_id").setVisible(false);a.byId("target_wcf_application_idInput").setVisible(false);a.byId("target_web_dynpro_application").setVisible(true);a.byId("target_web_dynpro_applicationInput").setVisible(true);a.byId("target_web_dynpro_configuration").setVisible(true);a.byId("target_web_dynpro_configurationInput").setVisible(true);a.byId("target_system_alias").setVisible(true);a.byId("target_system_aliasInput").setVisible(true);a.byId("urlt_application_component").setVisible(false);a.byId("urlt_application_componentInput").setVisible(false);a.byId("target_urlt_system_alias").setVisible(false);a.byId("target_urlt_system_aliasInput").setVisible(false);a.byId("application_type_deprecated").setVisible(false);};U.displayURLApplicationTypeFields=function(a){a.byId("navigation_provider_role").setVisible(false);a.byId("navigation_provider_roleInput").setVisible(false);a.byId("navigation_provider_instance").setVisible(false);a.byId("navigation_provider_instanceInput").setVisible(false);a.byId("target_application_alias").setVisible(false);a.byId("target_application_aliasInput").setVisible(false);a.byId("target_application_id").setVisible(false);a.byId("target_application_idInput").setVisible(false);a.byId("application_description").setVisible(true);a.byId("target_application_descriptionInput").setVisible(true);a.byId("application_url").setVisible(true);a.byId("target_application_urlInput").setVisible(true);a.byId("application_component").setVisible(false);a.byId("target_application_componentInput").setVisible(false);a.byId("target_transaction").setVisible(false);a.byId("target_transactionInput").setVisible(false);a.byId("target_wcf_application_id").setVisible(false);a.byId("target_wcf_application_idInput").setVisible(false);a.byId("target_web_dynpro_application").setVisible(false);a.byId("target_web_dynpro_applicationInput").setVisible(false);a.byId("target_web_dynpro_configuration").setVisible(false);a.byId("target_web_dynpro_configurationInput").setVisible(false);a.byId("target_system_alias").setVisible(true);a.byId("target_system_aliasInput").setVisible(true);a.byId("urlt_application_component").setVisible(false);a.byId("urlt_application_componentInput").setVisible(false);a.byId("target_urlt_system_alias").setVisible(false);a.byId("target_urlt_system_aliasInput").setVisible(false);a.byId("application_type_deprecated").setVisible(false);};U.displayURLTApplicationTypeFields=function(a){a.byId("navigation_provider_role").setVisible(false);a.byId("navigation_provider_roleInput").setVisible(false);a.byId("navigation_provider_instance").setVisible(false);a.byId("navigation_provider_instanceInput").setVisible(false);a.byId("target_application_alias").setVisible(false);a.byId("target_application_aliasInput").setVisible(false);a.byId("target_application_id").setVisible(false);a.byId("target_application_idInput").setVisible(false);a.byId("application_description").setVisible(true);a.byId("target_application_descriptionInput").setVisible(true);a.byId("application_url").setVisible(false);a.byId("target_application_urlInput").setVisible(false);a.byId("application_component").setVisible(false);a.byId("target_application_componentInput").setVisible(false);a.byId("target_transaction").setVisible(false);a.byId("target_transactionInput").setVisible(false);a.byId("target_wcf_application_id").setVisible(false);a.byId("target_wcf_application_idInput").setVisible(false);a.byId("target_web_dynpro_application").setVisible(false);a.byId("target_web_dynpro_applicationInput").setVisible(false);a.byId("target_web_dynpro_configuration").setVisible(false);a.byId("target_web_dynpro_configurationInput").setVisible(false);a.byId("target_system_alias").setVisible(false);a.byId("target_system_aliasInput").setVisible(false);a.byId("urlt_application_component").setVisible(true);a.byId("urlt_application_componentInput").setVisible(true);a.byId("target_urlt_system_alias").setVisible(true);a.byId("target_urlt_system_aliasInput").setVisible(true);a.byId("application_type_deprecated").setVisible(false);};return U;},true);
sap.ui.predefine('sap/ushell/components/tiles/utilsRT',["sap/ushell/components/tiles/utils","sap/ui/core/format/NumberFormat","sap/ui/core/library","sap/m/library","sap/base/Log","sap/ui/model/json/JSONModel"],function(u,N,c,m,L,J){"use strict";var V=c.mvc.ViewType;var B=m.ButtonType;var a={};a.getConfiguration=function(t,A,E){var r;var C=t.configuration.getParameterValueAsString("tileConfiguration");try{var o=JSON.parse(C||"{}");}catch(e){L.error("Error while trying to parse tile configuration",e,"sap.ushell.components.tiles.utilsRT");return{};}var U=sap.ui.require("sap/ushell/components/tiles/utils");o.editable=true;if(t.configurationUi&&t.configurationUi.isReadOnly){if(t.configurationUi.isReadOnly()){o.editable=false;}}var T=U.getTranslatedTitle(t);var s=U.getTranslatedSubtitle(t,o);var i=U.getTranslatedProperty(t,o,"display_info_text");var k=U.getTranslatedProperty(t,o,"display_search_keywords");if(A){r=U.getResourceBundleModel().getResourceBundle();if(E&&t.bag){var b=t.bag.getOriginalLanguage();var l=sap.ui.getCore().getConfiguration().getLocale().getSAPLogonLanguage();var d=sap.ui.getCore().getConfiguration().getLanguage();o.isLocaleSuitable=b===""||b.toLowerCase()===l.toLowerCase()||b.toLowerCase()===d.toLowerCase();o.orgLocale=b;o.userLocale=l;}}o.display_icon_url=o.display_icon_url||"";if(i!==undefined){o.display_info_text=i;}else if(o.display_info_text===undefined){if(A&&!E){o.display_info_text="["+r.getText("configuration.display_info_text")+"]";}else{o.display_info_text="";}}o.navigation_semantic_object=o.navigation_semantic_object||"";o.navigation_semantic_action=o.navigation_semantic_action||"";o.navigation_semantic_parameters=o.navigation_semantic_parameters||"";o.display_number_unit=o.display_number_unit||"";o.display_number_factor=o.display_number_factor||"";o.service_refresh_interval=o.service_refresh_interval?parseInt(o.service_refresh_interval,10):0;o.service_url=o.service_url||"";o.navigation_target_url=o.navigation_target_url||"";if(A&&U.isInitial(T)){o.display_title_text=E?"":"["+r.getText("configuration.display_title_text")+"]";o.display_subtitle_text=E?"":"["+r.getText("configuration.display_subtitle_text")+"]";}else{o.display_title_text=T||o.display_title_text||"";if(s!==undefined){o.display_subtitle_text=s;}else if(o.display_subtitle_text===undefined){o.display_subtitle_text="";}}o.navigation_use_semantic_object=(o.navigation_use_semantic_object!==false);o.display_search_keywords=k||o.display_search_keywords||"";if(A){o.display_number_value=o.display_number_value||1234;}o.form_factors=o.form_factors?o.form_factors:U.getDefaultFormFactors();o.desktopChecked=o.form_factors.manual.desktop;o.tabletChecked=o.form_factors.manual.tablet;o.phoneChecked=o.form_factors.manual.phone;o.manualFormFactor=!(o.form_factors.appDefault)&&o.editable;o.appFormFactor=o.form_factors.appDefault;o.formFactorConfigDefault=!!o.form_factors.defaultParam;if(o.signature){o.rows=U.getSignatureTableData(o.signature,E&&o.editable);}else{o.rows=(o.mapping_signature&&o.mapping_signature!=="*=*")?U.getMappingSignatureTableData(o.mapping_signature,E&&o.editable):[U.getEmptyRowObj(o.editable)];}if(o.signature){o.isUnknownAllowed=(o.signature.additional_parameters==="allowed"||o.signature.additionalParameters==="allowed");}else{o.isUnknownAllowed=(o.mapping_signature!==undefined)?U.getAllowUnknownParametersValue(o.mapping_signature):true;}if(A){o.tile_actions_rows=U.getTileNavigationActionsRows(t,o.editable);}else if(!o.actions){o.actions=U.getTileNavigationActions(t);}if(A){var D=t.bag.getBag("deprecationProperties"),f=D.getProperty("deprecation"),g=null;if(f){g=r.getText(f==="D"?"configuration.app_deprecated":"configuration.app_archived",[D.getProperty("successor")]);}o.deprecation_text=g;}return o;};a.getDataToDisplay=function(C,d){var b=0,i,n,o,s,D={display_icon_url:d.icon||C.display_icon_url||"",display_title_text:d.title||C.display_title_text||"",display_number_value:!isNaN(d.number)?d.number:"...",display_number_unit:d.numberUnit||C.display_number_unit||"",display_info_text:d.info||C.display_info_text||"",display_info_state:d.infoState||"Neutral",display_subtitle_text:d.subtitle||C.display_subtitle_text||"",display_state_arrow:d.stateArrow||"None",display_number_state:d.numberState||"None",display_number_digits:d.numberDigits>=0?d.numberDigits:4,display_number_factor:d.numberFactor||"",display_search_keyword:d.keywords||C.display_search_keyword||"",targetParams:[]};if(d.infoStatus){D.display_info_state=d.infoStatus;}if(d.targetParams){D.targetParams.push(d.targetParams);}if(d.results){for(i=0,n=d.results.length;i<n;i=i+1){o=d.results[i].number||0;if(typeof o==="string"){o=parseFloat(o,10);}b=b+o;s=d.results[i].targetParams;if(s){D.targetParams.push(s);}}D.display_number_value=b;}if(!isNaN(d.number)){if(typeof d.number==="string"){d.number=d.number.trim();}if(d.number===""){D.display_number_value="...";}else{var S=this._shouldProcessDigits(d.number,d.numberDigits),e=D.display_icon_url?4:5;if(d.number&&d.number.length>=e||S){var f=this._normalizeNumber(d.number,e,d.numberFactor,d.numberDigits);D.display_number_factor=f.numberFactor;D.display_number_value=f.displayNumber;}else{var g=N.getFloatInstance({maxFractionDigits:e});D.display_number_value=g.format(d.number);}}}if(D&&D.display_number_state){switch(D.display_number_state){case"Positive":D.display_number_state="Good";break;case"Negative":D.display_number_state="Error";break;}}return D;};a.getTileSettingsAction=function(M,s,t){var U=sap.ui.require("sap/ushell/components/tiles/utils");var r=U.getResourceBundleModel().getResourceBundle();return{text:(!t||t==="tile")?r.getText("tileSettingsBtn"):r.getText("linkSettingsBtn"),press:function(){sap.ui.require(["sap/ui/layout/form/SimpleForm","sap/ui/layout/form/SimpleFormLayout","sap/m/Button","sap/m/Dialog"],function(S,b,d,D){var A={showGroupSelection:false,title:M.getProperty("/config/display_title_text"),subtitle:M.getProperty("/config/display_subtitle_text")};if(!t||t==="tile"){A.info=M.getProperty("/config/display_info_text");A.icon=M.getProperty("/config/display_icon_url");A.keywords=M.getProperty("/config/display_search_keywords");}else if(t==="link"){A.showInfo=false;A.showIcon=false;A.showPreview=false;}var o=sap.ui.view({type:V.JS,viewName:"sap.ushell.ui.footerbar.SaveAsTile"});var e=new J(A);o.setModel(e);var f=new S({id:"tileSettings",layout:b.GridLayout,content:[o]}).addStyleClass("sapUshellAddBookmarkForm");var g=new d("bookmarkOkBtn",{text:r.getText("okBtn"),type:B.Emphasized,press:function(){s(o);j.close();},enabled:true}),h=new d("bookmarkCancelBtn",{text:r.getText("cancelBtn"),press:function(){j.close();}});var i=function(k){g.setEnabled(!!k.trim());};o.getTitleInput().attachLiveChange(function(){i(this.getValue());});var j=new D({id:"settingsDialog",title:(!t||t==="tile")?r.getText("tileSettingsDialogTitle"):r.getText("linkSettingsDialogTitle"),contentWidth:"400px",content:f,beginButton:g,endButton:h,horizontalScrolling:false,afterClose:function(){j.destroy();}}).addStyleClass("sapContrastPlus");j.open();});}};};a.getSemanticNavigationUrl=function(C){var U="#"+jQuery.trim(C.navigation_semantic_object);U+="-"+jQuery.trim(C.navigation_semantic_action);if(C.navigation_semantic_parameters&&jQuery.trim(C.navigation_semantic_parameters).length>0){U+="?"+jQuery.trim(C.navigation_semantic_parameters);}return U;};a.addParamsToUrl=function(U,d){var p="",b=U.indexOf("?")!==-1,t=d.targetParams,i;if(t&&t.length>0){for(i=0;i<t.length;i=i+1){p+=t[i];if(i<t.length-1){p+="&";}}}if(p.length>0){if(!b){U+="?";}else{U+="&";}U+=p;}return U;};a._normalizeNumber=function(n,b,d,i){var e;if(isNaN(n)){e=n;}else{var o=N.getFloatInstance({maxFractionDigits:i});if(!d){var f=Math.abs(n);if(f>=1000000000){d="B";n/=1000000000;}else if(f>=1000000){d="M";n/=1000000;}else if(f>=1000){d="K";n/=1000;}}e=o.format(n);}var g=e;var h=g[b-1];b-=(h==="."||h===",")?1:0;g=g.substring(0,b);return{displayNumber:g,numberFactor:d};};a._shouldProcessDigits=function(d,D){var n;d=typeof(d)!=="string"?d.toString():d;if(d.indexOf(".")!==-1){n=d.split(".")[1].length;if(n>D){return true;}}return false;};return a;},true);
sap.ui.predefine('sap/ushell/services/CrossApplicationNavigation',["sap/ushell/services/AppConfiguration","sap/ushell/services/_CrossApplicationNavigation/utils","sap/ushell/utils/type","sap/ushell/TechnicalParameters","sap/ushell/components/applicationIntegration/AppLifeCycle","sap/base/util/isPlainObject","sap/base/util/UriParameters","sap/ui/thirdparty/jquery","sap/base/util/ObjectPath","sap/base/util/merge","sap/ushell/utils","sap/ushell/ApplicationType"],function(a,u,t,T,A,i,U,q,O,m,b,c){"use strict";function C(o,p,s){var d,S;if(s&&s.config){S=s.config;}function g(v,f){var r,h,n,j,k;if(typeof v!=="string"&&!i(v)&&v!==undefined){q.sap.log.error("Unexpected input type",null,"sap.ushell.services.CrossApplicationNavigation");return undefined;}if(v===undefined){return undefined;}r=a.getCurrentApplication();if(f){if(typeof f.getComponentData!=="function"||!i(f.getComponentData())||!f.getComponentData().startupParameters||!i(f.getComponentData().startupParameters)){q.sap.log.error("Cannot call getComponentData on component","the component should be an application root component","sap.ushell.services.CrossApplicationNavigation");}else{k=f.getComponentData().startupParameters;if(k.hasOwnProperty("sap-system")){h=k["sap-system"][0];}if(k.hasOwnProperty("sap-ushell-next-navmode")){n=k["sap-ushell-next-navmode"][0];}}}else{if(r&&r["sap-system"]){h=r["sap-system"];}else if(r&&r.url){h=new U(r.url).get("sap-system");}if(r&&r["sap-ushell-next-navmode"]){n=r["sap-ushell-next-navmode"];}else if(r&&r.url){n=new U(r.url).get("sap-ushell-next-navmode");}}if(r){j=r.contentProviderId;}var I=u._injectParameters({type:t,inject:{"sap-system":h,"sap-ushell-navmode":n,"sap-app-origin-hint":j},injectEmptyString:{"sap-app-origin-hint":true},args:v});return I;}function e(v){var f,h,j;if(localStorage&&localStorage["sap-ushell-enc-test"]==="false"){return v;}if(!S||!S["sap-ushell-enc-test"]){if(localStorage&&localStorage["sap-ushell-enc-test"]!=="true"){return v;}}if(typeof v!=="string"&&!i(v)&&v!==undefined){q.sap.log.error("Unexpected input type",null,"sap.ushell.services.CrossApplicationNavigation");return undefined;}if(v===undefined){return undefined;}if(i(v)){h=q.extend(true,{},v);if(h.target&&h.target.shellHash){if(typeof h.target.shellHash==="string"){if(h.target.shellHash!=="#"&&h.target.shellHash!==""){h.target.shellHash=e(h.target.shellHash);}}return h;}h.params=h.params||{};h.params["sap-ushell-enc-test"]=["A B%20C"];return h;}j=v;if(!/[?&]sap-system=/.test(j)){f=(j.indexOf("?")>-1)?"&":"?";j+=f+"sap-ushell-enc-test="+encodeURIComponent("A B%20C");}return j;}this._extractInnerAppRoute=function(I){var f=this,P,h;if(typeof I==="string"){P=I.split("&/");h=P.shift();return{intent:h,innerAppRoute:P.length>0?"&/"+P.join("&/"):""};}if(Object.prototype.toString.apply(I)==="[object Object]"){var j=O.get("target.shellHash",I);if(typeof j==="string"){var r=f._extractInnerAppRoute(j);I.target.shellHash=r.intent;return{intent:I,innerAppRoute:r.innerAppRoute};}if(I.hasOwnProperty("appSpecificRoute")){var v=I.appSpecificRoute;delete I.appSpecificRoute;var k=typeof v==="string"&&v.indexOf("&/")!==0&&v.length>0;return{innerAppRoute:k?"&/"+v:v,intent:I};}return{intent:I,innerAppRoute:""};}q.sap.log.error("Invalid input parameter","expected string or object","sap.ushell.services.CrossApplicationNavigation");return{intent:I};};this._injectInnerAppRoute=function(I,f){var h,j=this;if(!f){return I;}if(typeof I==="string"){return I+f;}if(Object.prototype.toString.apply(I)==="[object Object]"){h=O.get("target.shellHash",I);if(typeof h==="string"){I.target.shellHash=j._injectInnerAppRoute(h,f);return I;}I.appSpecificRoute=f;}return I;};this.hrefForExternal=function(f,h,j){var k,E,I;if(sap.ushell&&sap.ushell.Container&&typeof sap.ushell.Container.getService==="function"&&sap.ushell.Container.getService("ShellNavigation")){k=m({},f);E=this._extractInnerAppRoute(k);I=E.intent;u.addXAppStateFromParameter(I,"sap-xapp-state-data");k=g(I,h);k=u._injectStickyParameters({args:k,appLifeCycle:A,technicalParameters:T,type:t});k=e(k);k=this._injectInnerAppRoute(k,E.innerAppRoute);return sap.ushell.Container.getService("ShellNavigation").hrefForExternal(k,undefined,h,j);}q.sap.log.debug("Shell not available, no Cross App Navigation");if(j){return(new q.Deferred()).resolve("").promise();}return"";};this.expandCompactHash=function(h){return sap.ushell.Container.getService("NavTargetResolution").expandCompactHash(h);};this.backToPreviousApp=function(){if(this.isInitialNavigation()){this.toExternal({target:{shellHash:"#"},writeHistory:false});return;}this.historyBack();};this.historyBack=function(f){var h=-1;if(f&&typeof f==="number"){if(f<=0){q.sap.log.warning("historyBack called with an argument <= 0 and will result in a forward navigation or refresh","expected was an argument > 0","sap.ushell.services.CrossApplicationNavigation#historyBack");}h=f*-1;}window.history.go(h);};this.isInitialNavigation=function(){var f=sap.ushell&&sap.ushell.Container&&typeof sap.ushell.Container.getService==="function"&&sap.ushell.Container.getService("ShellNavigation");if(!f){q.sap.log.debug("ShellNavigation service not available","This will be treated as the initial navigation","sap.ushell.services.CrossApplicationNavigation");return true;}var I=f.isInitialNavigation();if(typeof I==="undefined"){return true;}return I;};this.toExternal=function(f,h){var j,E,I,w=f.writeHistory;if(sap.ushell&&sap.ushell.Container&&typeof sap.ushell.Container.getService==="function"&&sap.ushell.Container.getService("ShellNavigation")){j=m({},f);this._processShellHashWithParams(j);E=this._extractInnerAppRoute(j);I=E.intent;u.addXAppStateFromParameter(I,"sap-xapp-state-data");j=g(I,h);j=u._injectStickyParameters({args:j,appLifeCycle:A,technicalParameters:T,type:t});j=e(j);delete j.writeHistory;j=this._injectInnerAppRoute(j,E.innerAppRoute);sap.ushell.Container.getService("ShellNavigation").toExternal(j,h,w);return;}q.sap.log.debug("Shell not avialable, no Cross App Navigation");return;};this.hrefForAppSpecificHash=function(f){if(sap.ushell&&sap.ushell.Container&&typeof sap.ushell.Container.getService==="function"&&sap.ushell.Container.getService("ShellNavigation")){return sap.ushell.Container.getService("ShellNavigation").hrefForAppSpecificHash(f);}q.sap.log.debug("Shell not available, no Cross App Navigation; fallback to app-specific part only");return"#"+encodeURI(f);};this.getPrimaryIntent=function(f,P){var Q={},h,r=/^#\w+-displayFactSheet(?:$|\?.)/;Q.tags=["primaryAction"];Q.semanticObject=f;if(P){Q.params=P;}return this.getLinks(Q).then(function(l){if(l.length===0){delete Q.tags;Q.action="displayFactSheet";h=function(L,j){var E;if(L.intent===j.intent){return 0;}E=r.test(L.intent)^r.test(j.intent);if(E){return r.test(L.intent)?-1:1;}return L.intent<j.intent?-1:1;};return this.getLinks(Q);}h=function(L,j){if(L.intent===j.intent){return 0;}return L.intent<j.intent?-1:1;};return l;}.bind(this)).then(function(l){return l.length===0?null:l.sort(h)[0];});};this.getSemanticObjectLinks=function(f,P,I,h,j,k){var l,n,E;l=u._injectStickyParameters({args:{params:P},appLifeCycle:A,technicalParameters:T,type:t});l=g(l,h).params;l=e({params:l}).params;n=sap.ushell.Container.getService("NavTargetResolution");var v;if(Array.isArray(f)){v=[];f.forEach(function(r){v.push([{semanticObject:r[0],params:r[1],ignoreFormFactor:!!r[2],ui5Component:r[3],appStateKey:r[4],compactIntents:!!(r[5])}]);});}else{v={semanticObject:f,params:l,ignoreFormFactor:I,ui5Component:h,appStateKey:j,compactIntents:!!k};}E=b.invokeUnfoldingArrayArguments(n.getLinks.bind(n),[v]);return E;};this.getLinks=function(v){var E;E=b.invokeUnfoldingArrayArguments(this._getLinks.bind(this),[v]);return E;};this._getLinks=function(n){var N,P,f,h=sap.ushell.Container.getService("NavTargetResolution");if(typeof n==="undefined"){n={};}N=q.extend(true,{},n);N.compactIntents=!!N.compactIntents;N.action=N.action||undefined;N.paramsOptions=u.extractGetLinksParameterOptions(N.params);N=u._injectStickyParameters({args:N,appLifeCycle:A,technicalParameters:T,type:t});P=N.params?u.extractGetLinksParameterDefinition(N.params):N.params;f=g({params:P},N.ui5Component).params;f=e({params:f}).params;if(N.appStateKey){f["sap-xapp-state"]=[N.appStateKey];delete N.appStateKey;}N.params=f;return h.getLinks(N);};this.getDistinctSemanticObjects=function(){var f=sap.ushell.Container.getService("NavTargetResolution");return f.getDistinctSemanticObjects();};this.isIntentSupported=function(I,f){var D=new q.Deferred(),h={},j=I.map(function(k){var l=g(k,f);h[l]=k;return l;});sap.ushell.Container.getService("NavTargetResolution").isIntentSupported(j).done(function(k){var l={};Object.keys(k).forEach(function(K){l[h[K]]=k[K];});D.resolve(l);}).fail(D.reject.bind(D));return D.promise();};this.isNavigationSupported=function(I,f){var h=I.map(function(j){return g(j,f);});return sap.ushell.Container.getService("NavTargetResolution").isNavigationSupported(h);};this.isUrlSupported=function(f){var D=new q.Deferred(),h,H;if(typeof f!=="string"){D.reject();return D.promise();}h=sap.ushell.Container.getService("URLParsing");if(h.isIntentUrl(f)){H=h.getHash(f);this.isIntentSupported(["#"+H]).done(function(r){if(r["#"+H]&&r["#"+H].supported){D.resolve();}else{D.reject();}}).fail(function(){D.reject();});}else{D.resolve();}return D.promise();};this.createComponentInstance=function(I,f,h){var D=new q.Deferred(),j=sap.ushell.Container;this.createComponentData(I,f).then(function(r){j.getServiceAsync("Ui5ComponentLoader").then(function(k){if(h){h.runAsOwner(function(){l(r);});}else{l(r);}function l(n){n.loadDefaultDependencies=false;k.instantiateComponent(n).then(function(v){D.resolve(v.componentHandle.getInstance());},function(E){E=E||"";q.sap.log.error("Cannot create UI5 component: "+E,E.stack,"sap.ushell.services.CrossApplicationNavigation");D.reject(E);});}});},function(E){D.reject(E);});return D.promise();};this.createComponentData=function(I,f){return new Promise(function(r,R){var h=sap.ushell.Container,j,k;if(!f){f={};}else{k=Object.keys(f).length;if(k>1||(k===1&&!f.componentData)){R("`oConfig` argument should either be an empty object or contain only the `componentData` property.");return;}}if(f.componentData){delete f.componentData.startupParameters;delete f.componentData.config;delete f.componentData["sap-xapp-state"];}h.getServiceAsync("URLParsing").then(function(l){j=l.constructShellHash(l.parseShellHash(I));if(!j){R("Navigation intent invalid!");return;}h.getServiceAsync("NavTargetResolution").then(function(N){N.resolveHashFragment("#"+j).then(function(n){function v(x){x=q.extend(true,{},x,f);if(!x.ui5ComponentName){if(x.additionalInformation){x.ui5ComponentName=x.additionalInformation.replace(/^SAPUI5\.Component=/,"");}else if(x.name){x.ui5ComponentName=x.name;}}return x;}if(n.applicationType===c.URL.type&&n.appCapabilities&&n.appCapabilities.appFrameworkId==="UI5"&&sap.ushell.Container.inAppRuntime()){sap.ui["require"](["sap/ushell/appRuntime/ui5/services/AppLifeCycleAgent"],function(x){x.getAppInfo(n.appCapabilities.technicalAppComponentId).then(function(y){y=v(y);w({ui5ComponentName:n.appCapabilities.technicalAppComponentId,applicationDependencies:y,url:y.url});});});}else if(n.applicationType!==c.URL.type&&!(/^SAPUI5\.Component=/.test(n.additionalInformation))){R("The resolved target mapping is not of type UI5 component.");}else{w(n);}function w(x){h.getServiceAsync("Ui5ComponentLoader").then(function(y){x=v(x);x.loadDefaultDependencies=false;y.createComponentData(x).then(function(z){r(z);},function(E){E=E||"";q.sap.log.error("Cannot get UI5 component data: "+E,E.stack,"sap.ushell.services.CrossApplicationNavigation");R(E);});});}});});});});};this.createEmptyAppState=function(f,h,P,j){if(!d){d=sap.ushell.Container.getService("AppState");}if(!(f instanceof sap.ui.core.UIComponent)){throw new Error("The passed oAppComponent must be a UI5 Component.");}return d.createEmptyAppState(f,h,P,j);};this.getStartupAppState=function(f){this._checkComponent(f);var h=f.getComponentData()&&f.getComponentData()["sap-xapp-state"]&&f.getComponentData()["sap-xapp-state"][0];return this.getAppState(f,h);};this._checkComponent=function(f){if(!(f instanceof sap.ui.core.UIComponent)){throw new Error("oComponent passed must be a UI5 Component");}};this.getAppState=function(f,h){var j,D=new q.Deferred();this._checkComponent(f);if(!d){d=sap.ushell.Container.getService("AppState");}if(typeof h!=="string"){if(h!==undefined){q.sap.log.error("Illegal Argument sAppStateKey ");}setTimeout(function(){j=d.createEmptyUnmodifiableAppState(f);D.resolve(j);},0);return D.promise();}return d.getAppState(h);};this.getAppStateData=function(f){return b.invokeUnfoldingArrayArguments(this._getAppStateData.bind(this),[f]);};this._getAppStateData=function(f){var D=new q.Deferred();if(!d){d=sap.ushell.Container.getService("AppState");}if(typeof f!=="string"){if(f!==undefined){q.sap.log.error("Illegal Argument sAppStateKey ");}setTimeout(function(){D.resolve(undefined);},0);}else{d.getAppState(f).done(function(h){D.resolve(h.getData());}).fail(D.resolve.bind(D,undefined));}return D.promise();};this.saveMultipleAppStates=function(f){var r=[],D=new q.Deferred();f.forEach(function(h){r.push(h.save());});q.when.apply(this,r).done(function(){D.resolve(r);}).fail(function(){D.reject("save failed");});return D.promise();};this._processShellHashWithParams=function(f){var h,H;if(f&&f.processParams===true&&f.target&&f.target.shellHash&&f.params){h=sap.ushell.Container.getService("URLParsing");H=h.parseShellHash(f.target.shellHash);f.target={semanticObject:H.semanticObject,action:H.action,contextRaw:H.contextRaw};f.appSpecificRoute=H.appSpecificRoute;f.params=Object.assign({},f.params,H.params);}};this.getSupportedAppStatePersistencyMethods=function(){if(!d){d=sap.ushell.Container.getService("AppState");}return d.getSupportedPersistencyMethods();};this.makeStatePersistent=function(k,P,f){if(!d){d=sap.ushell.Container.getService("AppState");}return d.makeStatePersistent(k,P,f);};this.resolveIntent=function(h){var D=new q.Deferred();sap.ushell.Container.getServiceAsync("NavTargetResolution").then(function(N){N.resolveHashFragment(h).then(function(r){D.resolve({url:r.url});}).fail(function(M){D.reject(M);});});return D.promise();};}C.hasNoAdapter=true;return C;},true);
sap.ui.predefine('sap/ushell/services/_CrossApplicationNavigation/utils',["sap/base/util/ObjectPath"],function(O){"use strict";var U={};U.extractGetLinksParameterOptions=function(g){return U.parseGetLinksParameters(g).filter(function(p){return Object.keys(p.options).length>0;}).map(function(p){return{name:p.name,options:p.options};});};U.extractGetLinksParameterDefinition=function(g){return U.parseGetLinksParameters(g).reduce(function(r,p){r[p.name]=p.value;return r;},{});};U.parseGetLinksParameters=function(g){if(Object.prototype.toString.apply(g)!=="[object Object]"){return[];}var p=JSON.parse(JSON.stringify(g));return Object.keys(p).map(function(P){var v=p[P];var o={};if(Object.prototype.toString.apply(v)==="[object Object]"){v=v.value;delete p[P].value;o=p[P];}return{name:P,value:v,options:o};});};U.safeParseToObject=function(o){try{return JSON.parse(o);}catch(e){jQuery.sap.log.error("Cannot parse the given string to object",o,"sap.ushell.services.CrossApplicationNavigation");}return null;};U.createAppStateFromData=function(d){var a=sap.ushell.Container.getService("AppState");var A=a.createEmptyAppState(null);A.setData(d);A.save();return A.getKey();};U.extractParameter=function(i,p){var I,P=null,u;if(typeof i==="string"){if(i.indexOf(p+"=")===-1){return{intent:i,data:null};}u=sap.ushell.Container.getService("URLParsing");var o=u.parseShellHash(i);if(!o){return{intent:i,data:null};}P=o.params[p];delete o.params[p];I=u.constructShellHash(o);return{intent:I,data:P};}if(Object.prototype.toString.apply(i)==="[object Object]"){var s=O.get("target.shellHash",i);if(typeof s==="string"){var r=U.extractParameter(s,p);i.target.shellHash=r.intent;return{intent:i,data:r.data};}var a=i.params;if(a&&a[p]){P=typeof a[p]==="string"?[a[p]]:a[p];delete a[p];}return{intent:i,data:P};}jQuery.sap.log.error("Invalid input parameter","expected string or object","sap.ushell.services.CrossApplicationNavigation");return{intent:i};};U.addXAppStateFromParameter=function(i,s){var I,x,a,X,A;x=U.extractParameter(i,s);I=x.intent;X=x.data&&x.data[0];if(!X){return;}a=U.safeParseToObject(X);if(!a){return;}A=U.createAppStateFromData(a);U.injectParameter(I,"sap-xapp-state",A);};U.injectParameter=function(i,p,P){if(typeof i==="string"){var u=sap.ushell.Container.getService("URLParsing");var o=u.parseShellHash(i);o.params[p]=P;return u.constructShellHash(o);}if(Object.prototype.toString.apply(i)==="[object Object]"){var s=O.get("target.shellHash",i);if(typeof s==="string"){i.target.shellHash=U.injectParameter(s,p,P);return i;}if(!i.params){i.params={};}i.params[p]=P;}return i;};U._injectParameters=function(p){var P=p.inject,i=(p.injectEmptyString||{}),t=p.type,a=p.args;function s(v,I){return(v||(v===""&&I));}if(t.isPlainObject(a)){if(a.target&&a.target.shellHash){if(typeof a.target.shellHash==="string"){a.target.shellHash=U._injectParameters({inject:P,injectEmptyString:i,type:p.type,args:a.target.shellHash});}return a;}var n=Object.keys(P).reduce(function(I,b){var v=P[b],c=(i[b]===true);if(s(v,c)&&typeof I==="string"){var r=new RegExp("[&]"+b);var h=!r.test(I);if(h){var d=I?"&":"";I+=d+b+"="+v;}}else if(s(v,c)&&!I.hasOwnProperty(b)){I[b]=v;}return I;},a.params||{});if(n&&Object.keys(n).length>0){a.params=n;}return a;}var S=a;if(S){Object.keys(P).forEach(function(b){var v=P[b];var I=(i[b]===true);var r=new RegExp("[?&]"+b);var h=!r.test(S);if(s(v,I)&&h){var c=S.indexOf("?")>-1?"&":"?";S+=c+b+"="+v;}});}return S;};U._injectStickyParameters=function(p){var a=sap.ushell.Container.getService("AppLifeCycle");if(!a||Object.keys(a).length<=0){return p.args;}var c=a.getCurrentApplication();if(!c||Object.keys(c).length<=0){return p.args;}var A=p.appLifeCycle;var t=p.technicalParameters;var s=t.getParameters({sticky:true}).reduce(function(S,n){var N=n.name;var C=c.componentInstance;var b=c.applicationType;var d;if(b==="UI5"){d={};}else{d=A.getCurrentApplication().container;}var e=t.getParameterValueSync(N,C,d,b);var f=n.stickyName||N;S[f]=e;return S;},{});var o={type:p.type,inject:s,args:p.args};return U._injectParameters(o);};return U;});
sap.ui.predefine('sap/ushell/utils/DynamicTileRequest',["sap/ushell/utils/HttpClient","sap/ui/thirdparty/URI","sap/base/util/isEmptyObject","sap/base/util/UriParameters","sap/base/Log"],function(H,U,i,a,L){"use strict";function D(u,s,e,c){this.fnSuccess=s;this.fnError=e;this.sUrl=u;this.oPromise=this._resolveDefaults(u,c).then(function(r){if(r){var S=sap.ui.getCore().getConfiguration().getSAPLogonLanguage();var o=new U(r);if(S&&!o.hasQuery("sap-language")){o.addQuery("sap-language",S);}if(o.is("relative")){o=o.absoluteTo(location.href);}this.sBasePath=o.origin()+o.directory()+"/";this.sRequestPath=o.relativeTo(this.sBasePath).query(U.decodeQuery(o.query())).href();var h=this._getHeaders(r);this.oConfig={headers:h};this.oClient=new H(this.sBasePath,this.oConfig);this.refresh();}}.bind(this)).catch(function(E){L.error("Was not able to create a DynamicTileRequest:",E);});}D.prototype._getRequestUrl=function(){return this.sBasePath+this.sRequestPath;};D.prototype.refresh=function(){if(!this.oRequest&&this.oClient){this.oRequest=this.oClient.get(this.sRequestPath).then(this._onSuccess.bind(this)).catch(this._onError.bind(this));}};D.prototype.abort=function(){if(this.oRequest&&this.oClient){this.oClient.abortAll();this.oRequest=null;}};D.prototype._onSuccess=function(r){var R;try{R=JSON.parse(r.responseText);}catch(e){throw new Error("Was not able to parse response of dynamic tile request");}this.oRequest=null;var d;if(typeof R==="object"){var u=new a(this.sRequestPath);if(u.get("$inlinecount")==="allpages"){d={number:R.__count};}else if(u.get("$count")==="true"){d={number:R["@odata.count"]};}else{d=this._extractData(R);}}else if(typeof R==="string"||typeof R==="number"){d={number:R};}this.fnSuccess(d);};D.prototype._onError=function(e){this.oRequest=null;this.fnError(e);};D.prototype._extractData=function(r){var d=r.d?r.d:r;var s=["results","icon","title","number","numberUnit","info","infoState","infoStatus","targetParams","subtitle","stateArrow","numberState","numberDigits","numberFactor"];r=Object.keys(d).reduce(function(A,k){if(s.indexOf(k)>-1){A[k]=d[k];}return A;},{});if(!i(r)){return r;}var f=Object.keys(d)[0];if(f!==undefined&&Object.keys(d).length===1){return Object.keys(d[f]).reduce(function(A,k){if(s.indexOf(k)>-1){A[k]=d[f][k];}return A;},{});}return{};};D.prototype._getHeaders=function(u){var h={"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0","Accept-Language":(sap.ui&&sap.ui.getCore().getConfiguration().getLanguage())||"",Accept:"application/json"};var s=sap.ui.getCore().getConfiguration().getSAPLogonLanguage();if(s){h["sap-language"]=s;}var S=sap.ushell.Container.getLogonSystem()?sap.ushell.Container.getLogonSystem().getClient():"";var o=new U(u);if(S&&!o.protocol()){h["sap-client"]=S;}return h;};D.prototype._resolveDefaults=function(u,c){return sap.ushell.Container.getServiceAsync("ClientSideTargetResolution").then(function(C){return Promise.all([C.getSystemContext(c),sap.ushell.Container.getServiceAsync("ReferenceResolver")]);}).then(function(r){var s=r[0];var R=r[1];return new Promise(function(b,d){R.resolveUserDefaultParameters(u,s).done(b).fail(d);});}).then(function(r){if(r.defaultsWithoutValue&&r.defaultsWithoutValue.length>0){L.error("The service URL contains User Default(s) with no set value: "+r.defaultsWithoutValue.join(", "));return;}if(r.ignoredReferences&&r.ignoredReferences.length>0){L.error("The service URL contains invalid Reference(s): "+r.ignoredReferences.join(", "));return;}return r.url;});};D.prototype.destroy=function(){this.abort();this.fnError=null;this.fnSuccess=null;};return D;});
sap.ui.predefine('sap/ushell/utils/HttpClient',["sap/ui/thirdparty/URI","sap/ushell/utils"],function(U,u){"use strict";var H=function(b,d){this._oOngoingRequests={};this._oCSRFTokens={};this._oDefaultOptions={headers:d&&d.headers||{}};if(typeof b==="string"){this._oBasePath=new U(b);}else{this._oDefaultOptions={headers:b&&b.headers||{}};}};H.prototype.get=function(r,o){return this._executeRequest("GET",r,o);};H.prototype.put=function(r,o){return this._executeRequest("PUT",r,o);};H.prototype.post=function(r,o){return this._executeRequest("POST",r,o);};H.prototype.patch=function(r,o){return this._executeRequest("PATCH",r,o);};H.prototype.delete=function(r,o){return this._executeRequest("DELETE",r,o);};H.prototype.options=function(r,o){return this._executeRequest("OPTIONS",r,o);};H.prototype.abortAll=function(){Object.keys(this._oOngoingRequests).forEach(function(k){this._oOngoingRequests[k].abort();}.bind(this));};H.prototype._executeRequest=function(r,R,d){var i=new Error("The provided resource path is not a valid URL.");try{var c;var o=new U(R);if(!o.is("url")){return Promise.reject(i);}if(this._oBasePath){c=o.absoluteTo(this._oBasePath);}else{c=o;}var x=new XMLHttpRequest();x._sapUshellHttpClientId=u.generateUniqueId(Object.keys(this._oOngoingRequests));this._oOngoingRequests[x._sapUshellHttpClientId]=x;var h=Object.assign({},this._oDefaultOptions.headers,d&&d.headers);return this._getCSRFTokenHeader(r,c).then(function(C){Object.assign(h,C);return new Promise(function(a,b){var s=c.href();x.onload=this._onLoad.bind(this,a,b,{xhr:x,method:r,url:s,data:d});x.onerror=b.bind(this,this._getFormattedResponse(x));x.onabort=b.bind(this,this._getFormattedResponse(x));x.onloadend=function(){delete this._oOngoingRequests[x._sapUshellHttpClientId];}.bind(this);x.open(r,s);Object.keys(h).forEach(function(k){x.setRequestHeader(k,h[k]);});var B=d&&d.data||"";if(typeof B!=="string"){B=JSON.stringify(B);}x.send(B);}.bind(this));}.bind(this));}catch(e){return Promise.reject(i);}};H.prototype._getCSRFTokenHeader=function(r,a){switch(r){case"HEAD":case"GET":case"OPTIONS":return Promise.resolve({"x-csrf-token":"fetch"});case"POST":case"PATCH":case"PUT":case"DELETE":var k=this._getCSRFTokenKey(a);if(this._oCSRFTokens[k]){return Promise.resolve({"x-csrf-token":this._oCSRFTokens[k]});}var R=a.href();if(this._oBasePath){R=this._oBasePath.origin()+this._oBasePath.directory();}return this._executeRequest("OPTIONS",R).then(function(o){var c=this._getCSRFTokenFromHeader(o.responseHeaders);if(!c){throw new Error("CSRF Token couldn't be fetched.");}return{"x-csrf-token":c};}.bind(this));default:return Promise.resolve({});}};H.prototype._onLoad=function(r,R,o){var f=this._getFormattedResponse(o.xhr);var c=this._getCSRFTokenFromHeader(f.responseHeaders);if(c){var k=this._getCSRFTokenKey(new U(o.url));if(c.toLowerCase()==="required"&&f.status===403){delete this._oCSRFTokens[k];return this._executeRequest(o.method,o.url,o.data).then(r).catch(R);}this._oCSRFTokens[k]=c;}if(f.status>=200&&f.status<300){return r(f);}return R(f);};H.prototype._getCSRFTokenKey=function(c){if(this._oBasePath){return this._oBasePath.origin()+this._oBasePath.directory();}return c.origin()+c.directory();};H.prototype._getCSRFTokenFromHeader=function(r){var c=r.filter(function(h){return h.name==="x-csrf-token";})[0];return c&&c.value;};H.prototype._getFormattedResponse=function(x){return{status:x.status,statusText:x.statusText,responseText:x.responseText,responseHeaders:x.getAllResponseHeaders().split(/\r\n/g).filter(function(i){return i.length>0;}).map(function(h){var p=h.split(":");return{name:p[0].trim(),value:p[1].trim()};})};};return H;},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine('sap/ui/model/analytics/AnalyticalVersionInfo',["sap/base/Log"],function(L){"use strict";var A={NONE:null,V1:1,V2:2,getVersion:function(o){var v;var O;if(o&&o.getMetadata){O=o.getMetadata().getName();}switch(O){case"sap.ui.model.odata.ODataModel":v=this.V1;break;case"sap.ui.model.odata.v2.ODataModel":v=this.V2;break;default:v=this.NONE;L.info("AnalyticalVersionInfo.getVersion(...) - The given object is no instance of ODataModel V1 or V2!");break;}return v;}};return A;},true);
sap.ui.predefine('sap/ui/model/analytics/odata4analytics',['sap/ui/model/Filter','sap/ui/model/FilterOperator','sap/ui/model/Sorter','./AnalyticalVersionInfo',"sap/base/security/encodeURL"],function(F,c,S,A,e){"use strict";var o=o||{},d=/^\d+$/;o.constants={};o.constants["SAP_NAMESPACE"]="http://www.sap.com/Protocols/SAPData";o.constants["VERSION"]="0.7";o.helper={deepEqual:function(O,N,f){var a,b,r=0,i,n;if(!O||O.length!==N.length){return 2;}if(O!==N){for(i=0,n=O.length;i<n;i+=1){b=O[i];a=N[i];if(b.grouped!==a.grouped||b.inResult!==a.inResult||b.level!==a.level||b.name!==a.name||b.total!==a.total||b.visible!==a.visible){return 2;}if(b.formatter!==a.formatter){r=1;if(f){f(a);}}}}return r;},tokenizeNametoLabelText:function(n){var l="";l=n.replace(/^P_(.*)/,"$1");l=l.replace(/([^A-Z0-9_]+)([A-Z0-9_])/g,"$1 $2");l=l.replace(/([A-Z0-9_]{2,})([A-Z0-9_])([^A-Z0-9_]+)/g,"$1 $2$3");l=l.replace(/(.*) _E$/,"$1");l=l.replace(/(.*) _(.*)/g,"$1 $2");return l;}};o.Model=function(m,p){this._init(m,p);};o.Model.ReferenceByURI=function(u){return{sServiceURI:u};};o.Model.ReferenceByModel=function(m){return{oModel:m};};o.Model.ReferenceWithWorkaround=function(m,w){return{oModelReference:m,aWorkaroundID:w};};o.Model.prototype={_init:function(m,p){if(typeof p=="string"){throw"Deprecated second argument: Adjust your invocation by passing an object with a property sAnnotationJSONDoc as a second argument instead";}this._mParameter=p;var t=this;this._oActivatedWorkarounds={};if(m&&m.aWorkaroundID){for(var i=-1,I;(I=m.aWorkaroundID[++i])!==undefined;){this._oActivatedWorkarounds[I]=true;}m=m.oModelReference;}if(!m||(!m.sServiceURI&&!m.oModel)){throw"Usage with oModelReference being an instance of Model.ReferenceByURI or Model.ReferenceByModel";}if(m.oModel){this._oModel=m.oModel;this._iVersion=A.getVersion(this._oModel);a();}else if(p&&p.modelVersion===A.V2){var V=sap.ui.requireSync("sap/ui/model/odata/v2/ODataModel");this._oModel=new V(m.sServiceURI);this._iVersion=A.V2;a();}else{var O=sap.ui.requireSync("sap/ui/model/odata/ODataModel");this._oModel=new O(m.sServiceURI);this._iVersion=A.V1;a();}if(this._oModel.getServiceMetadata()&&this._oModel.getServiceMetadata().dataServices==undefined){throw"Model could not be loaded";}function a(){if(!t._oModel.getServiceMetadata()){t._oModel.attachMetadataLoaded(b);}else{b();}}function b(){if(t.bIsInitialized){return;}t.bIsInitialized=true;if(p&&p.sAnnotationJSONDoc){t.mergeV2Annotations(p.sAnnotationJSONDoc);}t._interpreteMetadata(t._oModel.getServiceMetadata().dataServices);}},_interpreteMetadata:function(M){this._oQueryResultSet={};this._oParameterizationSet={};this._oEntityTypeSet={};this._oEntitySetSet={};this._oEntityTypeNameToEntitySetMap={};var a=this._oModel.getServiceMetadata().dataServices.schema[0];for(var j=-1,C;(C=a.entityContainer[++j])!==undefined;){if(C.isDefaultEntityContainer=="true"){this._oDefaultEntityContainer=C;break;}}var E=a.entityType;var q=[],P=[],u=[];for(var k=-1,T;(T=E[++k])!==undefined;){var b=false;if(T.extensions!=undefined){for(var l=-1,f;(f=T.extensions[++l])!==undefined;){if(f.namespace==o.constants.SAP_NAMESPACE&&f.name=="semantics"){b=true;switch(f.value){case"aggregate":q.push(T);break;case"parameters":P.push(T);break;default:u.push(T);}}if(b){continue;}}if(!b){u.push(T);}}else{u.push(T);}}for(var m=-1,g;(g=u[++m])!==undefined;){var h=new o.EntityType(this._oModel.getServiceMetadata(),a,g);this._oEntityTypeSet[h.getQName()]=h;var i=this._getEntitySetsOfType(a,h.getQName());if(i.length==0){throw"Invalid consumption model: No entity set for entity type "+h.getQName()+" found";}if(i.length>1){throw"Unsupported consumption model: More than one entity set for entity type "+h.getQName()+" found";}var v=new o.EntitySet(this._oModel.getServiceMetadata(),a,i[0][0],i[0][1],h);this._oEntitySetSet[v.getQName()]=v;this._oEntityTypeNameToEntitySetMap[h.getQName()]=v;}var w={};for(var n=-1,x;(x=P[++n])!==undefined;){var y=new o.EntityType(this._oModel.getServiceMetadata(),a,x);this._oEntityTypeSet[y.getQName()]=y;var z=this._getEntitySetsOfType(a,y.getQName());if(z.length==0){throw"Invalid consumption model: No entity set for parameter entity type "+y.getQName()+" found";}if(z.length>1){throw"Unsupported consumption model: More than one entity set for parameter entity type "+y.getQName()+" found";}var B=new o.EntitySet(this._oModel.getServiceMetadata(),a,z[0][0],z[0][1],y);this._oEntitySetSet[B.getQName()]=B;this._oEntityTypeNameToEntitySetMap[y.getQName()]=B;var D=new o.Parameterization(y,B);this._oParameterizationSet[D.getName()]=D;w[y.getQName()]=D;var G=y.getQName();if(a.association!=undefined){for(var p=-1,H;(H=a.association[++p])!==undefined;){if(H.referentialConstraint==undefined){continue;}var I=null;if(H.end[0].type==G&&H.end[0].multiplicity=="*"&&H.end[1].multiplicity=="1"){I=H.end[1].type;}else if(H.end[1].type==G&&H.end[1].multiplicity=="*"&&H.end[0].multiplicity=="1"){I=H.end[0].type;}if(!I){continue;}if(H.referentialConstraint.dependent.propertyRef.length!=1){continue;}var J=D.findParameterByName(H.referentialConstraint.dependent.propertyRef[0].name);if(J==null){continue;}var V=this._oEntityTypeSet[I];var K=this._oEntityTypeNameToEntitySetMap[I];J.setValueSetEntity(V,K);}}}for(var r=-1,L;(L=q[++r])!==undefined;){var N=new o.EntityType(this._oModel.getServiceMetadata(),a,L);this._oEntityTypeSet[N.getQName()]=N;var Q=N.getQName();var O=null;var R=null;if(a.association!=undefined){for(var s=-1,U;(U=a.association[++s])!==undefined;){var W=null;if(U.end[0].type==Q){W=U.end[1].type;}else if(U.end[1].type==Q){W=U.end[0].type;}else{continue;}var X=null;X=w[W];if(X!=null){if(O!=null){throw"LIMITATION: Unable to handle multiple parameter entity types of query entity "+N.name;}else{O=X;R=U;}}}}var Y=this._getEntitySetsOfType(a,N.getQName());if(Y.length!=1){throw"Invalid consumption model: There must be exactly one entity set for an entity type annotated with aggregating semantics";}var Z=new o.EntitySet(this._oModel.getServiceMetadata(),a,Y[0][0],Y[0][1],N);this._oEntitySetSet[Z.getQName()]=Z;this._oEntityTypeNameToEntitySetMap[N.getQName()]=Z;var $=new o.QueryResult(this,N,Z,O);this._oQueryResultSet[$.getName()]=$;if(O){O.setTargetQueryResult($,R);}if(a.association!=undefined){for(var t=-1,_;(_=a.association[++t])!==undefined;){if(_.referentialConstraint==undefined){continue;}var a1=null;if(_.end[0].type==Q&&_.end[0].multiplicity=="*"&&_.end[1].multiplicity=="1"){a1=_.end[1].type;}else if(_.end[1].type==Q&&_.end[1].multiplicity=="*"&&_.end[0].multiplicity=="1"){a1=_.end[0].type;}if(!a1){continue;}if(_.referentialConstraint.dependent.propertyRef.length!=1){continue;}var b1=$.findDimensionByName(_.referentialConstraint.dependent.propertyRef[0].name);if(b1==null){continue;}var c1=this._oEntityTypeNameToEntitySetMap[a1];b1.setMembersEntitySet(c1);}}}},oUI5ODataModelAnnotatableObject:{objectName:"schema",keyPropName:"namespace",extensions:true,aSubObject:[{objectName:"entityType",keyPropName:"name",extensions:true,aSubObject:[{objectName:"property",keyPropName:"name",aSubObject:[],extensions:true}]},{objectName:"entityContainer",keyPropName:"name",extensions:false,aSubObject:[{objectName:"entitySet",keyPropName:"name",extensions:true,aSubObject:[]}]}]},mergeV2Annotations:function(a){var b=null;try{b=JSON.parse(a);}catch(f){return;}var m;try{m=this._oModel.getServiceMetadata().dataServices;}catch(f){return;}for(var p in b){if(!(this.oUI5ODataModelAnnotatableObject.objectName==p)){continue;}if(!(b[p]instanceof Array)){continue;}this.mergeV2AnnotationLevel(m[this.oUI5ODataModelAnnotatableObject.objectName],b[this.oUI5ODataModelAnnotatableObject.objectName],this.oUI5ODataModelAnnotatableObject);break;}return;},mergeV2AnnotationLevel:function(M,a,u){for(var i=-1,b;(b=a[++i])!==undefined;){for(var j=-1,f;(f=M[++j])!==undefined;){if(!(b[u.keyPropName]==f[u.keyPropName])){continue;}if(b["extensions"]!=undefined){if(f["extensions"]==undefined){f["extensions"]=[];}for(var l=-1,g;(g=b["extensions"][++l])!==undefined;){var h=false;for(var m=-1,n;(n=f["extensions"][++m])!==undefined;){if(g.name==n.name&&g.namespace==n.namespace){n.value=g.value;h=true;break;}}if(!h){f["extensions"].push(g);}}}for(var k=-1,U;(U=u.aSubObject[++k])!==undefined;){for(var p in b){if(!(U.objectName==p)){continue;}if(!(b[U.objectName]instanceof Array)){continue;}if((f[U.objectName]==undefined)||(!(f[U.objectName]instanceof Array))){continue;}this.mergeV2AnnotationLevel(f[U.objectName],b[U.objectName],U);break;}}}}return;},findQueryResultByName:function(n){var q=this._oQueryResultSet[n];if(!q&&this._oDefaultEntityContainer){var Q=this._oDefaultEntityContainer.name+"."+n;q=this._oQueryResultSet[Q];}return q;},getAllQueryResultNames:function(){if(this._aQueryResultNames){return this._aQueryResultNames;}this._aQueryResultNames=new Array(0);for(var n in this._oQueryResultSet){this._aQueryResultNames.push(this._oQueryResultSet[n].getName());}return this._aQueryResultNames;},getAllQueryResults:function(){return this._oQueryResultSet;},getODataModel:function(){return this._oModel;},_getEntitySetsOfType:function(s,q){var E=[];for(var i=-1,a;(a=s.entityContainer[++i])!==undefined;){for(var j=-1,b;(b=a.entitySet[++j])!==undefined;){if(b.entityType==q){E.push([a,b]);}}}return E;},_mParameter:null,_oModel:null,_oDefaultEntityContainer:null,_aQueryResultNames:null,_oQueryResultSet:null,_oParameterizationSet:null,_oEntityTypeSet:null,_oEntitySetSet:null,_oEntityTypeNameToEntitySetMap:null,_oActivatedWorkarounds:null};o.QueryResult=function(m,E,a,p){this._init(m,E,a,p);};o.QueryResult.prototype={_init:function(m,E,a,p,b){this._oModel=m;this._oEntityType=E;this._oEntitySet=a;this._oParameterization=p;this._oDimensionSet={};this._oMeasureSet={};var P=E.getTypeDescription().property;var f={};for(var i=-1,g;(g=P[++i])!==undefined;){if(g.extensions==undefined){continue;}for(var j=-1,h;(h=g.extensions[++j])!==undefined;){if(!h.namespace==o.constants.SAP_NAMESPACE){continue;}switch(h.name){case"aggregation-role":switch(h.value){case"dimension":{var D=new o.Dimension(this,g);this._oDimensionSet[D.getName()]=D;break;}case"measure":{var M=new o.Measure(this,g);this._oMeasureSet[M.getName()]=M;break;}case"totaled-properties-list":this._oTotaledPropertyListProperty=g;break;default:}break;case"attribute-for":{var k=new o.DimensionAttribute(this,g);var K=k.getKeyProperty();f[K.name]=k;break;}default:}}}for(var s in f){var l=f[s];l.getDimension().addAttribute(l);}if(m._oActivatedWorkarounds.IdentifyTextPropertiesByName){var n=[];for(var q in this._oDimensionSet){var r=this._oDimensionSet[q];if(!r.getTextProperty()){var T=null;T=E.findPropertyByName(q+"Name");if(!T){T=E.findPropertyByName(q+"Text");}if(!T){T=E.findPropertyByName(q+"Desc");}if(!T){T=E.findPropertyByName(q+"Description");}if(T){r.setTextProperty(T);n.push(T.name);}}}for(var t=-1,u;(u=n[++t])!==undefined;){delete this._oDimensionSet[u];}}},getName:function(){return this.getEntitySet().getQName();},getParameterization:function(){return this._oParameterization;},getAllDimensionNames:function(){if(this._aDimensionNames){return this._aDimensionNames;}this._aDimensionNames=[];for(var n in this._oDimensionSet){this._aDimensionNames.push(this._oDimensionSet[n].getName());}return this._aDimensionNames;},getAllDimensions:function(){return this._oDimensionSet;},getAllMeasureNames:function(){if(this._aMeasureNames){return this._aMeasureNames;}this._aMeasureNames=[];for(var n in this._oMeasureSet){this._aMeasureNames.push(this._oMeasureSet[n].getName());}return this._aMeasureNames;},getAllMeasures:function(){return this._oMeasureSet;},findDimensionByName:function(n){return this._oDimensionSet[n];},findDimensionByPropertyName:function(n){if(this._oDimensionSet[n]){return this._oDimensionSet[n];}for(var D in this._oDimensionSet){var a=this._oDimensionSet[D];var t=a.getTextProperty();if(t&&t.name==n){return a;}if(a.findAttributeByName(n)){return a;}}return null;},getTotaledPropertiesListProperty:function(){return this._oTotaledPropertyListProperty;},findMeasureByName:function(n){return this._oMeasureSet[n];},findMeasureByPropertyName:function(n){if(this._oMeasureSet[n]){return this._oMeasureSet[n];}for(var m in this._oMeasureSet){var M=this._oMeasureSet[m];var f=M.getFormattedValueProperty();if(f&&f.name==n){return M;}}return null;},getModel:function(){return this._oModel;},getEntityType:function(){return this._oEntityType;},getEntitySet:function(){return this._oEntitySet;},_oModel:null,_oEntityType:null,_oEntitySet:null,_oParameterization:null,_aDimensionNames:null,_oDimensionSet:null,_aMeasureNames:null,_oMeasureSet:null,_oTotaledPropertyListProperty:null};o.Parameterization=function(E,a){this._init(E,a);};o.Parameterization.prototype={_init:function(E,a){this._oEntityType=E;this._oEntitySet=a;this._oParameterSet={};var p=E.getTypeDescription().property;for(var i=-1,P;(P=p[++i])!==undefined;){if(P.extensions==undefined){continue;}for(var j=-1,b;(b=P.extensions[++j])!==undefined;){if(!b.namespace==o.constants.SAP_NAMESPACE){continue;}switch(b.name){case"parameter":{var f=new o.Parameter(this,P);this._oParameterSet[f.getName()]=f;break;}default:}}}},setTargetQueryResult:function(q,a){this._oQueryResult=q;var Q=this._oEntityType.getSchema().namespace+"."+a.name;var n=this._oEntityType.getTypeDescription().navigationProperty;if(!n){throw"Invalid consumption model: Parameters entity type lacks navigation property for association to query result entity type";}for(var i=-1,N;(N=n[++i])!==undefined;){if(N.relationship==Q){this._oNavPropToQueryResult=N.name;}}if(!this._oNavPropToQueryResult){throw"Invalid consumption model: Parameters entity type lacks navigation property for association to query result entity type";}},getTargetQueryResult:function(){if(!this._oQueryResult){throw"No target query result set";}return this._oQueryResult;},getName:function(){return this.getEntitySet().getQName();},getAllParameterNames:function(){if(this._aParameterNames){return this._aParameterNames;}this._aParameterNames=[];for(var n in this._oParameterSet){this._aParameterNames.push(this._oParameterSet[n].getName());}return this._aParameterNames;},getAllParameters:function(){return this._oParameterSet;},findParameterByName:function(n){return this._oParameterSet[n];},getNavigationPropertyToQueryResult:function(){return this._oNavPropToQueryResult;},getEntityType:function(){return this._oEntityType;},getEntitySet:function(){return this._oEntitySet;},_oEntityType:null,_oEntitySet:null,_oQueryResult:null,_oNavPropToQueryResult:null,_aParameterNames:null,_oParameterSet:null};o.Parameter=function(p,P){this._init(p,P);};o.Parameter.prototype={_init:function(p,P){this._oParameterization=p;this._oProperty=P;var E=p.getEntityType();if(P.extensions!=undefined){for(var i=-1,a;(a=P.extensions[++i])!==undefined;){if(!a.namespace==o.constants.SAP_NAMESPACE){continue;}switch(a.name){case"parameter":switch(a.value){case"mandatory":this._bRequired=true;break;case"optional":this._bRequired=false;break;default:throw"Invalid annotation value for parameter property";}break;case"label":this._sLabelText=a.value;break;case"text":this._oTextProperty=E.findPropertyByName(a.value);break;case"upper-boundary":this._bIntervalBoundaryParameter=true;this._oUpperIntervalBoundaryParameterProperty=E.findPropertyByName(a.value);break;case"lower-boundary":this._bIntervalBoundaryParameter=true;this._oLowerIntervalBoundaryParameterProperty=E.findPropertyByName(a.value);break;default:}}}if(!this._sLabelText){this._sLabelText="";}},setValueSetEntity:function(E,a){this._oValueSetEntityType=E;this._oValueSetEntitySet=a;},getTextProperty:function(){return this._oTextProperty;},getLabelText:function(){if(!this._sLabelText&&this._oParameterization._oQueryResult._oModel._oActivatedWorkarounds.CreateLabelsFromTechnicalNames){this._sLabelText=o.helper.tokenizeNametoLabelText(this.getName());}return this._sLabelText;},isOptional:function(){return(!this._bRequired);},isIntervalBoundary:function(){return this._bIntervalBoundaryParameter;},isLowerIntervalBoundary:function(){return(this._oUpperIntervalBoundaryParameterProperty?true:false);},getPeerIntervalBoundaryParameter:function(){var p=null;if(this._oLowerIntervalBoundaryParameterProperty){p=this._oLowerIntervalBoundaryParameterProperty.name;}else{p=this._oUpperIntervalBoundaryParameterProperty.name;}if(!p){throw"Parameter is not an interval boundary";}return this._oParameterization.findParameterByName(p);},isValueSetAvailable:function(){return(this._oValueSetEntityType?true:false);},getName:function(){return this._oProperty.name;},getProperty:function(){return this._oProperty;},getContainingParameterization:function(){return this._oParameterization;},getURIToValueEntitySet:function(s){var u=null;u=(s?s:"")+"/"+this._oValueSetEntitySet.getQName();return u;},_oParameterization:null,_oProperty:null,_sLabelText:null,_oTextProperty:null,_bRequired:false,_bIntervalBoundaryParameter:false,_oLowerIntervalBoundaryParameterProperty:null,_oUpperIntervalBoundaryParameterProperty:null,_oValueSetEntityType:null,_oValueSetEntitySet:null};o.Dimension=function(q,p){this._init(q,p);};o.Dimension.prototype={_init:function(q,p){this._oQueryResult=q;this._oProperty=p;this._oAttributeSet={};},setMembersEntitySet:function(E){this._oMembersEntitySet=E;},getName:function(){return this._oProperty.name;},getKeyProperty:function(){return this._oProperty;},getTextProperty:function(){if(!this._oTextProperty){this._oTextProperty=this._oQueryResult.getEntityType().getTextPropertyOfProperty(this.getName());}return this._oTextProperty;},setTextProperty:function(t){this._oTextProperty=t;},getLabelText:function(){if(!this._sLabelText){this._sLabelText=this._oQueryResult.getEntityType().getLabelOfProperty(this.getName());}if(!this._sLabelText&&this._oQueryResult._oModel._oActivatedWorkarounds.CreateLabelsFromTechnicalNames){this._sLabelText=o.helper.tokenizeNametoLabelText(this.getName());}return(this._sLabelText==null?"":this._sLabelText);},getSuperOrdinateDimension:function(){if(!this._sSuperOrdinateDimension){var s=this._oQueryResult.getEntityType().getSuperOrdinatePropertyOfProperty(this.getName());if(s){this._sSuperOrdinateDimension=this._oQueryResult.findDimensionByName(s.name);}}return this._sSuperOrdinateDimension;},getHierarchy:function(){if(!this._oHierarchy){this._oHierarchy=this._oQueryResult.getEntityType().getHierarchy(this._oProperty.name);}return this._oHierarchy;},getAllAttributeNames:function(){if(this._aAttributeNames){return this._aAttributeNames;}this._aAttributeNames=[];for(var n in this._oAttributeSet){this._aAttributeNames.push(this._oAttributeSet[n].getName());}return this._aAttributeNames;},getAllAttributes:function(){return this._oAttributeSet;},findAttributeByName:function(n){return this._oAttributeSet[n];},addAttribute:function(D){this._oAttributeSet[D.getName()]=D;},getContainingQueryResult:function(){return this._oQueryResult;},hasMasterData:function(){return this._oMembersEntitySet!=null?true:false;},getMasterDataEntitySet:function(){return this._oMembersEntitySet;},_oQueryResult:null,_oProperty:null,_oTextProperty:null,_sLabelText:null,_sSuperOrdinateDimension:null,_aAttributeNames:null,_oAttributeSet:null,_oMembersEntitySet:null,_oHierarchy:null};o.DimensionAttribute=function(q,p){this._init(q,p);};o.DimensionAttribute.prototype={_init:function(q,p){this._oQueryResult=q;this._oProperty=p;if(p.extensions!=undefined){for(var i=-1,E;(E=p.extensions[++i])!==undefined;){if(!E.namespace==o.constants.SAP_NAMESPACE){continue;}switch(E.name){case"attribute-for":this._sDimensionName=E.value;break;case"label":this._sLabelText=E.value;break;case"text":this._oTextProperty=q.getEntityType().findPropertyByName(E.value);break;default:}}}},getName:function(){return this._oProperty.name;},getKeyProperty:function(){return this._oProperty;},getTextProperty:function(){return this._oTextProperty;},getLabelText:function(){if(!this._sLabelText&&this._oQueryResult._oModel._oActivatedWorkarounds.CreateLabelsFromTechnicalNames){this._sLabelText=o.helper.tokenizeNametoLabelText(this.getName());}return this._sLabelText;},getDimension:function(){return this._oQueryResult.findDimensionByName(this._sDimensionName);},_oQueryResult:null,_oProperty:null,_oTextProperty:null,_sLabelText:null,_sDimensionName:null};o.Measure=function(q,p){this._init(q,p);};o.Measure.prototype={_init:function(q,p){this._oQueryResult=q;this._oProperty=p;if(p.extensions!=undefined){for(var i=-1,E;(E=p.extensions[++i])!==undefined;){if(!E.namespace==o.constants.SAP_NAMESPACE){continue;}switch(E.name){case"label":this._sLabelText=E.value;break;case"text":this._oTextProperty=q.getEntityType().findPropertyByName(E.value);break;case"unit":this._oUnitProperty=q.getEntityType().findPropertyByName(E.value);break;default:}}}if(!this._sLabelText){this._sLabelText="";}},getName:function(){return this._oProperty.name;},getRawValueProperty:function(){return this._oProperty;},getFormattedValueProperty:function(){return this._oTextProperty;},getUnitProperty:function(){return this._oUnitProperty;},getLabelText:function(){if(!this._sLabelText&&this._oQueryResult._oModel._oActivatedWorkarounds.CreateLabelsFromTechnicalNames){this._sLabelText=o.helper.tokenizeNametoLabelText(this.getName());}return this._sLabelText;},isUpdatable:function(){if(this._bIsUpdatable!=null){return this._bIsUpdatable;}var u=this._oQueryResult.getEntitySet().getUpdatablePropertyNameSet();return(u[this.getName()]!=undefined);},_oQueryResult:null,_oProperty:null,_oTextProperty:null,_sLabelText:null,_oUnitProperty:null,_bIsUpdatable:null};o.EntitySet=function(m,s,C,E,a){this._init(m,s,C,E,a);};o.EntitySet.prototype={_init:function(m,s,C,E,a){this._oEntityType=a;this._oEntitySet=E;this._oContainer=C;this._oSchema=s;this._oModel=m;if(s.entityContainer.length>1){this._sQName=C.name+"."+E.name;}else{this._sQName=E.name;}},getQName:function(){return this._sQName;},getSetDescription:function(){return this._oEntitySet;},getEntityType:function(){return this._oEntityType;},getSchema:function(){return this._oSchema;},getModel:function(){return this._oModel;},getUpdatablePropertyNameSet:function(){if(this._oUpdatablePropertyNames){return this._oUpdatablePropertyNames;}this._oUpdatablePropertyNames={};var s=true;if(this._oEntitySet.extensions!=undefined){for(var j=-1,E;(E=this._oEntitySet.extensions[++j])!==undefined;){if(E.namespace==o.constants.SAP_NAMESPACE&&E.name=="updatable"){if(E.value=="false"){s=false;break;}}}}if(!s){return this._oUpdatablePropertyNames;}var p=this._oEntityType.getTypeDescription().property;for(var i=-1,P;(P=p[++i])!==undefined;){var b=true;if(P.extensions==undefined){continue;}for(var k=-1,a;(a=P.extensions[++k])!==undefined;){if(a.namespace!=o.constants.SAP_NAMESPACE){continue;}if(a.name=="updatable"){if(a.value=="false"){b=false;break;}}}if(b){this._oUpdatablePropertyNames[P.name]=true;}}return this._oUpdatablePropertyNames;},_oEntityType:null,_oEntitySet:null,_oContainer:null,_oSchema:null,_oModel:null,_sQName:null,_oUpdatablePropertyNames:null};o.EntityType=function(m,s,E){this._init(m,s,E);};o.EntityType.propertyFilterRestriction={SINGLE_VALUE:"single-value",MULTI_VALUE:"multi-value",INTERVAL:"interval"};o.EntityType.prototype={_init:function(m,s,E){this._oEntityType=E;this._oSchema=s;this._oModel=m;this._aKeyProperties=[];this._oPropertySet={};this._aFilterablePropertyNames=[];this._aSortablePropertyNames=[];this._aRequiredFilterPropertyNames=[];this._oPropertyFilterRestrictionSet={};this._oPropertyHeadingsSet={};this._oPropertyQuickInfosSet={};this._sQName=s.namespace+"."+E.name;var r={};function g(K){var R=r[K];if(!R){R=r[K]={};}return R;}for(var i=-1,p;(p=E.key.propertyRef[++i])!==undefined;){this._aKeyProperties.push(p.name);}for(var k=-1,P;(P=E.property[++k])!==undefined;){this._oPropertySet[P.name]=P;this._aFilterablePropertyNames.push(P.name);this._aSortablePropertyNames.push(P.name);if(P.extensions==undefined){continue;}for(var j=-1,a;(a=P.extensions[++j])!==undefined;){if(a.namespace!==o.constants.SAP_NAMESPACE){continue;}switch(a.name){case"filterable":if(a.value=="false"){this._aFilterablePropertyNames.pop(P.name);}break;case"sortable":if(a.value=="false"){this._aSortablePropertyNames.pop(P.name);}break;case"required-in-filter":if(a.value=="true"){this._aRequiredFilterPropertyNames.push(P.name);}break;case"filter-restriction":if(a.value==o.EntityType.propertyFilterRestriction.SINGLE_VALUE||a.value==o.EntityType.propertyFilterRestriction.MULTI_VALUE||a.value==o.EntityType.propertyFilterRestriction.INTERVAL){this._oPropertyFilterRestrictionSet[P.name]=a.value;}break;case"hierarchy-node-external-key-for":g(a.value).externalKeyProperty=P;break;case"hierarchy-node-for":g(P.name).dimensionName=a.value;break;case"hierarchy-parent-node-for":case"hierarchy-parent-nod":g(a.value).parentNodeIDProperty=P;break;case"hierarchy-level-for":g(a.value).levelProperty=P;break;case"hierarchy-drill-state-for":case"hierarchy-drill-stat":g(a.value).drillStateProperty=P;break;default:}}}this._oRecursiveHierarchySet={};for(var h in r){var H=r[h];var b=this._oPropertySet[h];var D=this._oPropertySet[H.dimensionName];if(D==null){D=b;}this._oRecursiveHierarchySet[D.name]=new o.RecursiveHierarchy(E,b,H.parentNodeIDProperty,H.levelProperty,D,H.externalKeyProperty);}},getProperties:function(){return this._oPropertySet;},findPropertyByName:function(p){return this._oPropertySet[p];},getKeyProperties:function(){return this._aKeyProperties;},getLabelOfProperty:function(p){var P=this._oPropertySet[p];if(P==null){throw"no such property with name "+p;}if(P.extensions!=undefined){for(var i=-1,E;(E=P.extensions[++i])!==undefined;){if(!E.namespace==o.constants.SAP_NAMESPACE){continue;}if(E.name=="label"){return E.value;}}}return null;},getHeadingOfProperty:function(p){var P=this._oPropertySet[p];if(P==null){throw"no such property with name "+p;}var s=null;if(P.extensions!=undefined){for(var i=-1,E;(E=P.extensions[++i])!==undefined;){if(!E.namespace==o.constants.SAP_NAMESPACE){continue;}if(E.name=="heading"){return E.value;}if(E.name=="label"){s=E.value;}}}return s;},getQuickInfoOfProperty:function(p){var P=this._oPropertySet[p];if(P==null){throw"no such property with name "+p;}var s=null;if(P.extensions!=undefined){for(var i=-1,E;(E=P.extensions[++i])!==undefined;){if(!E.namespace==o.constants.SAP_NAMESPACE){continue;}if(E.name=="quickinfo"){return E.value;}if(E.name=="label"){s=E.value;}}}return s;},getTextPropertyOfProperty:function(p){var P=this._oPropertySet[p];if(P==null){throw"no such property with name "+p;}if(P.extensions!=undefined){for(var i=-1,E;(E=P.extensions[++i])!==undefined;){if(E.name=="text"){return this.findPropertyByName(E.value);}}}return null;},getSuperOrdinatePropertyOfProperty:function(p){var P=this._oPropertySet[p];if(P==null){throw"no such property with name "+p;}if(P.extensions!=undefined){for(var i=-1,E;(E=P.extensions[++i])!==undefined;){if(E.name=="super-ordinate"){return this.findPropertyByName(E.value);}}}return null;},getFilterablePropertyNames:function(){return this._aFilterablePropertyNames;},getSortablePropertyNames:function(){return this._aSortablePropertyNames;},getRequiredFilterPropertyNames:function(){return this._aRequiredFilterPropertyNames;},getPropertiesWithFilterRestrictions:function(){return this._oPropertyFilterRestrictionSet;},getAllHierarchyPropertyNames:function(){if(this._aHierarchyPropertyNames){return this._aHierarchyPropertyNames;}this._aHierarchyPropertyNames=[];for(var n in this._oRecursiveHierarchySet){this._aHierarchyPropertyNames.push(this._oRecursiveHierarchySet[n].getNodeValueProperty().name);}return this._aHierarchyPropertyNames;},getHierarchy:function(n){if(this._oRecursiveHierarchySet[n]==undefined){return null;}return this._oRecursiveHierarchySet[n];},getQName:function(){return this._sQName;},getTypeDescription:function(){return this._oEntityType;},getSchema:function(){return this._oSchema;},getModel:function(){return this._oModel;},_oEntityType:null,_oSchema:null,_oModel:null,_sQName:null,_aKeyProperties:null,_oPropertySet:null,_aFilterablePropertyNames:null,_aRequiredFilterPropertyNames:null,_oPropertyFilterRestrictionSet:null,_aHierarchyPropertyNames:null,_oRecursiveHierarchySet:null};o.RecursiveHierarchy=function(E,n,p,N,a,b){this._init(E,n,p,N,a,b);};o.RecursiveHierarchy.prototype={_init:function(E,n,p,N,a,b){this._oEntityType=E;this._oNodeIDProperty=n;this._oParentNodeIDProperty=p;this._oNodeLevelProperty=N;this._oNodeValueProperty=a;this._oNodeExternalKeyProperty=b;},isRecursiveHierarchy:function(){return true;},isLeveledHierarchy:function(){return false;},getNodeExternalKeyProperty:function(){return this._oNodeExternalKeyProperty;},getNodeIDProperty:function(){return this._oNodeIDProperty;},getParentNodeIDProperty:function(){return this._oParentNodeIDProperty;},getNodeLevelProperty:function(){return this._oNodeLevelProperty;},getNodeValueProperty:function(){return this._oNodeValueProperty;},_oEntityType:null,_oNodeIDProperty:null,_oParentNodeIDProperty:null,_oNodeLevelProperty:null,_oNodeValueProperty:null,_oNodeExternalKeyProperty:null};o.FilterExpression=function(m,s,E){this._init(m,s,E);};o.FilterExpression.prototype={_init:function(m,s,E){this._oEntityType=E;this._oSchema=s;this._oModel=m;this._aConditionUI5Filter=[];this._aUI5FilterArray=[];},_renderPropertyFilterValue:function(f,p){if(p==="Edm.Time"&&d.test(f)){f={ms:parseInt(f),__edmType:"Edm.Time"};}return e(this._oModel.getODataModel().formatValue(f,p));},clear:function(){this._aConditionUI5Filter=[];this._aUI5FilterArray=[];},_addCondition:function(p,O,v,V){for(var i=-1,u;(u=this._aConditionUI5Filter[++i])!==undefined;){if(u.sPath==p&&u.sOperator==O&&u.oValue1==v&&u.oValue2==V){return;}}this._aConditionUI5Filter.push(new F(p,O,v,V));},_addUI5FilterArray:function(u){this._aUI5FilterArray.push(u);},addCondition:function(p,O,v,V){var P=this._oEntityType.findPropertyByName(p);if(P==null){throw"Cannot add filter condition for unknown property name "+p;}var f=this._oEntityType.getFilterablePropertyNames();if(((f?Array.prototype.indexOf.call(f,p):-1))===-1){throw"Cannot add filter condition for not filterable property name "+p;}this._addCondition(p,O,v,V);return this;},removeConditions:function(p){var P=this._oEntityType.findPropertyByName(p);if(P==null){throw"Cannot remove filter conditions for unknown property name "+p;}for(var i=0;i<this._aConditionUI5Filter.length;i++){var u=this._aConditionUI5Filter[i];if(u.sPath==p){this._aConditionUI5Filter.splice(i--,1);}}return this;},addSetCondition:function(p,v){var P=this._oEntityType.findPropertyByName(p);if(P==null){throw"Cannot add filter condition for unknown property name "+p;}var f=this._oEntityType.getFilterablePropertyNames();if(((f?Array.prototype.indexOf.call(f,p):-1))===-1){throw"Cannot add filter condition for not filterable property name "+p;}for(var i=-1,V;(V=v[++i])!==undefined;){this._addCondition(p,c.EQ,V);}return this;},addUI5FilterConditions:function(u){if(!Array.isArray(u)){throw"Argument is not an array";}if(u.length==0){return this;}var h=false;for(var i=0;i<u.length;i++){if(u[i].aFilters!=undefined){h=true;break;}}if(h){this._addUI5FilterArray(u);}else{for(var j=0;j<u.length;j++){this.addCondition(u[j].sPath,u[j].sOperator,u[j].oValue1,u[j].oValue2);}}return this;},getExpressionAsUI5FilterArray:function(){var f=this._aConditionUI5Filter.concat([]);for(var i=-1,a;(a=this._aUI5FilterArray[++i])!==undefined;){for(var j=-1,b;(b=a[++j])!==undefined;){f.push(b);}}return f;},getPropertiesReferencedByUI5FilterArray:function(u,r){for(var i=-1,U;(U=u[++i])!==undefined;){if(U.aFilters!=undefined){this.getPropertiesReferencedByUI5FilterArray(U.aFilters,r);}else{if(r[U.sPath]==undefined){r[U.sPath]=[];}r[U.sPath].push(U);}}},getReferencedProperties:function(){var r={};for(var i=-1,u;(u=this._aConditionUI5Filter[++i])!==undefined;){if(r[u.sPath]==undefined){r[u.sPath]=[];}r[u.sPath].push(u);}for(var j=-1,U;(U=this._aUI5FilterArray[++j])!==undefined;){this.getPropertiesReferencedByUI5FilterArray(U,r);}return r;},renderUI5Filter:function(u){var f=null,p=this._oEntityType.findPropertyByName(u.sPath);if(p==null){throw"Cannot add filter condition for unknown property name "+u.sPath;}switch(u.sOperator){case c.BT:f="("+u.sPath+" ge "+this._renderPropertyFilterValue(u.oValue1,p.type)+" and "+u.sPath+" le "+this._renderPropertyFilterValue(u.oValue2,p.type)+")";break;case c.NB:f="("+u.sPath+" lt "+this._renderPropertyFilterValue(u.oValue1,p.type)+" or "+u.sPath+" gt "+this._renderPropertyFilterValue(u.oValue2,p.type)+")";break;case c.Contains:case c.NotContains:f=(u.sOperator[0]==="N"?"not ":"")+"substringof("+this._renderPropertyFilterValue(u.oValue1,"Edm.String")+","+u.sPath+")";break;case c.StartsWith:case c.EndsWith:case c.NotStartsWith:case c.NotEndsWith:f=u.sOperator.toLowerCase().replace("not","not ")+"("+u.sPath+","+this._renderPropertyFilterValue(u.oValue1,"Edm.String")+")";break;default:f=u.sPath+" "+u.sOperator.toLowerCase()+" "+this._renderPropertyFilterValue(u.oValue1,p.type);}return f;},renderUI5MultiFilter:function(u){var U=[];var O="";var l=u.bAnd==true?" and ":" or ";for(var i=-1,a;(a=u.aFilters[++i])!==undefined;){if(a.aFilters!=undefined){U.push(a);continue;}O+=(O==""?"":l)+"("+this.renderUI5Filter(a)+")";}if(U.length>0){for(var j=-1,m;(m=U[++j])!==undefined;){O+=(O==""?"":l)+"("+this.renderUI5MultiFilter(m)+")";}}return O;},renderUI5FilterArray:function(u){if(u.length==0){return"";}var O="";u.sort(function(a,b){if(a.sPath==b.sPath){return 0;}if(a.sPath>b.sPath){return 1;}else{return-1;}});var p=u[0].sPath;var s="";var n=[],U=[];for(var i=-1,f;(f=u[++i])!==undefined;){if(f.aFilters!=undefined){U.push(f);continue;}if(p!=f.sPath){if(s!=""){O+=(O==""?"":" and ")+"("+s+")";}s="";if(n.length>0){for(var j=-1,N;(N=n[++j])!==undefined;){s+=(s==""?"":" and ")+this.renderUI5Filter(N);}O+=(O==""?"":" and ")+"("+s+")";s="";}p=f.sPath;n=[];}if(f.sOperator==c.NE){n.push(f);continue;}s+=(s==""?"":" or ")+this.renderUI5Filter(f);}if(s!=""){O+=(O==""?"":" and ")+"("+s+")";}if(n.length>0){s="";for(var k=-1,g;(g=n[++k])!==undefined;){s+=(s==""?"":" and ")+this.renderUI5Filter(g);}O+=(O==""?"":" and ")+"("+s+")";}if(U.length>0){for(var l=-1,m;(m=U[++l])!==undefined;){O+=(O==""?"":" and ")+"("+this.renderUI5MultiFilter(m)+")";}}return O;},getURIFilterOptionValue:function(){var O=this.renderUI5FilterArray(this._aConditionUI5Filter);for(var i=-1,u;(u=this._aUI5FilterArray[++i])!==undefined;){O+=(O==""?"":" and ")+"("+this.renderUI5FilterArray(u)+")";}return O;},checkValidity:function(){var r=this._oEntityType.getRequiredFilterPropertyNames();var p=this.getReferencedProperties();for(var i=-1,P;(P=r[++i])!==undefined;){if(p[P]==undefined){throw"filter expression does not contain required property "+P;}}var a=this._oEntityType.getPropertiesWithFilterRestrictions();for(var s in a){var f=a[s];if(f==o.EntityType.propertyFilterRestriction.SINGLE_VALUE){if(p[s]!=undefined){if(p[s].length>1){var t=p[s][0].oValue1;for(var j=0;j<p[s].length;j++){if(p[s][j].oValue1!=t||p[s][j].sOperator!=c.EQ){throw"filter expression may use "+s+" only with a single EQ condition";}}}}}}return true;},getEntityType:function(){return this._oEntityType;},getSchema:function(){return this._oSchema;},getModel:function(){return this._oModel;},_oEntityType:null,_oSchema:null,_oModel:null,_aFilterCondition:null};o.SortOrder={Ascending:"asc",Descending:"desc"};o.SortExpression=function(m,s,E){this._init(m,s,E);};o.SortExpression.prototype={_init:function(m,s,E){this._oEntityType=E;this._oSchema=s;this._oModel=m;this._aSortCondition=[];},_containsSorter:function(p){var r=null;for(var i=-1,C;(C=this._aSortCondition[++i])!==undefined;){if(C.property.name===p){r={sorter:C,index:i};break;}}return r;},_removeFromArray:function(a,f,t){var r=a.slice((t||f)+1||a.length);a.length=f<0?a.length+f:f;return a.push.apply(a,r);},clear:function(){this._aSortCondition=[];},addSorter:function(p,s){var P=this._oEntityType.findPropertyByName(p);if(P==null){throw"Cannot add sort condition for unknown property name "+p;}var E=this._containsSorter(p);if(E!=null){E.sorter.order=s;return this;}var a=this._oEntityType.getSortablePropertyNames();if(((a?Array.prototype.indexOf.call(a,p):-1))===-1){throw"Cannot add sort condition for not sortable property name "+p;}this._aSortCondition.push({property:P,order:s});return this;},removeSorter:function(p){if(!p){return;}var s=this._containsSorter(p);if(s){this._removeFromArray(this._aSortCondition,s.index);}},getExpressionsAsUI5SorterArray:function(){var s=[];for(var i=-1,C;(C=this._aSortCondition[++i])!==undefined;){s.push(new S(C.property.name,C.order==o.SortOrder.Descending));}return s;},getExpressionAsUI5Sorter:function(){var s=this.getExpressionsAsUI5SorterArray();if(s.length==0){return null;}else{return s[0];}},getURIOrderByOptionValue:function(s){if(this._aSortCondition.length==0){return"";}var O="";for(var i=-1,C;(C=this._aSortCondition[++i])!==undefined;){if(!s[C.property.name]){continue;}O+=(O==""?"":",")+C.property.name+" "+C.order;}return O;},getEntityType:function(){return this._oEntityType;},getSchema:function(){return this._oSchema;},getModel:function(){return this._oModel;},_oEntityType:null,_oSchema:null,_oModel:null,_aSortCondition:null};o.ParameterizationRequest=function(p){this._init(p);};o.ParameterizationRequest.prototype={_init:function(p){if(!p){throw"No parameterization given";}this._oParameterization=p;this._oParameterValueAssignment=[];},_renderParameterKeyValue:function(k,p){return e(this._oParameterization.getTargetQueryResult().getModel().getODataModel().formatValue(k,p));},getParameterization:function(){return this._oParameterization;},setParameterValue:function(p,v,t){var P=this._oParameterization.findParameterByName(p);if(!P){throw"Invalid parameter name "+p;}if(t!=null){if(!P.isIntervalBoundary()){throw"Range value cannot be applied to parameter "+p+" accepting only single values";}if(!P.isLowerIntervalBoundary()){throw"Range value given, but parameter "+p+" does not hold the lower boundary";}}if(!P.isIntervalBoundary()){if(v==null){delete this._oParameterValueAssignment[p];}else{this._oParameterValueAssignment[p]=v;}}else{if(v==null&&t!=null){throw"Parameter "+p+": An upper boundary cannot be given without the lower boundary";}if(v==null){delete this._oParameterValueAssignment[p];t=null;}else{this._oParameterValueAssignment[p]=v;}var u=P.getPeerIntervalBoundaryParameter();if(t==null){t=v;}if(v==null){delete this._oParameterValueAssignment[u.getName()];}else{this._oParameterValueAssignment[u.getName()]=t;}}return;},getURIToParameterizationEntitySet:function(s){return(s?s:"")+"/"+this._oParameterization.getEntitySet().getQName();},getURIToParameterizationEntry:function(s){var D=this._oParameterization.getAllParameters();for(var a in D){if(this._oParameterValueAssignment[a]==undefined){throw"Parameter "+a+" has no value assigned";}}var k="",f=true;for(var p in this._oParameterValueAssignment){k+=(f?"":",")+p+"="+this._renderParameterKeyValue(this._oParameterValueAssignment[p],D[p].getProperty().type);f=false;}return(s?s:"")+"/"+this._oParameterization.getEntitySet().getQName()+"("+k+")";},_oParameterization:null,_oParameterValueAssignment:null};o.QueryResultRequest=function(q,p){this._init(q,p);};o.QueryResultRequest.prototype={_init:function(q,p){this._oQueryResult=q;this._oParameterizationRequest=p;this._oAggregationLevel={};this._oDimensionHierarchies={};this._oMeasures={};this._bIncludeEntityKey=false;this._oFilterExpression=null;this._oSortExpression=null;this._oSelectedPropertyNames=null;},addRecursiveHierarchy:function(h,i,I){var D;if(!h){return;}D=this._oQueryResult.findDimensionByName(h);if(!D){throw new Error("'"+h+"' is not a dimension property");}if(!D.getHierarchy()){throw new Error("Dimension '"+h+"' does not have a hierarchy");}this._oSelectedPropertyNames=null;this._oDimensionHierarchies[h]={externalKey:i,id:true,text:I};},setParameterizationRequest:function(p){this._oParameterizationRequest=p;},setResourcePath:function(r){this._sResourcePath=r;if(this._sResourcePath.indexOf("/")!=0){throw"Missing leading / (slash) for resource path";}if(this._oQueryResult.getParameterization()){var l=r.lastIndexOf("/");if(l==-1){throw"Missing navigation from parameter entity set to query result in resource path";}var n=r.substring(l+1);if(n!=this._oQueryResult.getParameterization().getNavigationPropertyToQueryResult()){throw"Invalid navigation property from parameter entity set to query result in resource path";}}},getParameterizationRequest:function(){return this._oParameterizationRequest;},getQueryResult:function(){return this._oQueryResult;},setAggregationLevel:function(D){this._oAggregationLevel={};if(!D){D=this._oQueryResult.getAllDimensionNames();}this.addToAggregationLevel(D);this._oSelectedPropertyNames=null;},addToAggregationLevel:function(D){if(!D){return;}this._oSelectedPropertyNames=null;for(var i=-1,s;(s=D[++i])!==undefined;){if(!this._oQueryResult.findDimensionByName(s)){throw s+" is not a valid dimension name";}this._oAggregationLevel[s]={key:true,text:false,attributes:null};}},removeFromAggregationLevel:function(D){if(!D){return;}this._oSelectedPropertyNames=null;for(var i=-1,s;(s=D[++i])!==undefined;){if(!this._oQueryResult.findDimensionByName(s)){throw s+" is not a valid dimension name";}if(this._oAggregationLevel[s]!=undefined){delete this._oAggregationLevel[s];this.getSortExpression().removeSorter(s);}}},getAggregationLevel:function(){var D=[];for(var s in this._oAggregationLevel){D.push(s);}return D;},getAggregationLevelDetails:function(D){if(this._oAggregationLevel[D]==undefined){throw"Aggregation level does not include dimension "+D;}return this._oAggregationLevel[D];},setMeasures:function(m){if(!m){m=this._oQueryResult.getAllMeasureNames();}this._oSelectedPropertyNames=null;this._oMeasures={};for(var i=-1,M;(M=m[++i])!==undefined;){if(!this._oQueryResult.findMeasureByName(M)){throw M+" is not a valid measure name";}this._oMeasures[M]={value:true,text:false,unit:false};}},getMeasureNames:function(){var m=[];for(var M in this._oMeasures){m.push(M);}return m;},includeDimensionKeyTextAttributes:function(D,I,b,a){this._oSelectedPropertyNames=null;var f=[];if(D){if(this._oAggregationLevel[D]==undefined){throw D+" is not included in the aggregation level";}f.push(D);}else{for(var n in this._oAggregationLevel){f.push(n);}a=null;}for(var i=-1,s;(s=f[++i])!==undefined;){if(I!=null){this._oAggregationLevel[s].key=I;}if(b!=null){this._oAggregationLevel[s].text=b;}if(a!=null){this._oAggregationLevel[s].attributes=a;}}},includeMeasureRawFormattedValueUnit:function(m,I,b,a){this._oSelectedPropertyNames=null;var M=[];if(m){if(this._oMeasures[m]==undefined){throw m+" is not part of the query result";}M.push(m);}else{for(var n in this._oMeasures){M.push(n);}}for(var i=-1,s;(s=M[++i])!==undefined;){if(I!=null){this._oMeasures[s].value=I;}if(b!=null){this._oMeasures[s].text=b;}if(a!=null){this._oMeasures[s].unit=a;}}},getFilterExpression:function(){if(this._oFilterExpression==null){var E=this._oQueryResult.getEntityType();this._oFilterExpression=new o.FilterExpression(this._oQueryResult.getModel(),E.getSchema(),E);}return this._oFilterExpression;},setFilterExpression:function(f){this._oFilterExpression=f;},getSortExpression:function(){if(this._oSortExpression==null){var E=this._oQueryResult.getEntityType();this._oSortExpression=new o.SortExpression(E.getModel(),E.getSchema(),E);}return this._oSortExpression;},setSortExpression:function(s){this._oSortExpression=s;},setRequestOptions:function(i,I,r){if(i!=null){this._bIncludeEntityKey=i;}if(I!=null){this._bIncludeCount=I;}if(r!=null){this._bReturnNoEntities=r;}},setResultPageBoundaries:function(s,a){if(s!=null&&typeof s!=="number"){throw"Start value must be null or numeric";}if(a!==null&&typeof a!=="number"){throw"End value must be null or numeric";}if(s==null){s=1;}if(s<1||s>(a==null?s:a)){throw"Invalid values for requested page boundaries";}this._iSkipRequestOption=(s>1)?s-1:null;this._iTopRequestOption=(a!=null)?(a-s+1):null;},getResultPageBoundaries:function(){var E=null;if(this._iTopRequestOption!=null){if(this._iSkipRequestOption==null){E=1;}else{E=this._iSkipRequestOption+this._iTopRequestOption;}}return{start:(this._iSkipRequestOption==null)?1:this._iSkipRequestOption,end:E};},getURIToQueryResultEntitySet:function(s){var u=null;if(this._sResourcePath!=null){u=(s?s:"")+this._sResourcePath;}else if(this._oQueryResult.getParameterization()){if(!this._oParameterizationRequest){throw"Missing parameterization request";}else{u=this._oParameterizationRequest.getURIToParameterizationEntry(s)+"/"+this._oQueryResult.getParameterization().getNavigationPropertyToQueryResult();}}else{u=(s?s:"")+"/"+this._oQueryResult.getEntitySet().getQName();}return u;},getURIOrderByOptionValue:function(){var a,C,O=null,s=this._oSortExpression?this._oSortExpression._aSortCondition:[],i,n=s.length;if(n){a=this._oQueryResult.getAllMeasureNames();for(i=0;i<n;i+=1){C=s[i];if(!this._oSelectedPropertyNames[C.property.name]&&a.indexOf(C.property.name)<0){continue;}O=(O?O+",":"")+C.property.name+" "+C.order;}}return O;},getURIQueryOptionValue:function(q){var n,Q=null,s,t=this;function a(p){var P;if(!p){return;}P=typeof p==="string"?p:p.name;if(!t._oSelectedPropertyNames[P]){s+=(s==""?"":",")+P;t._oSelectedPropertyNames[P]=true;}}switch(q){case"$select":{s="";this._oSelectedPropertyNames={};for(n in this._oAggregationLevel){var D=this._oQueryResult.findDimensionByName(n);var b=this._oAggregationLevel[n];if(b.key==true){a(D.getKeyProperty());}if(b.text==true){a(D.getTextProperty());}if(b.attributes){for(var i=-1,f;(f=b.attributes[++i])!==undefined;){a(D.findAttributeByName(f).getName());}}}for(n in this._oMeasures){var m=this._oQueryResult.findMeasureByName(n);var M=this._oMeasures[n];if(M.value==true){a(m.getRawValueProperty());}if(M.text==true){a(m.getFormattedValueProperty());}if(M.unit==true){a(m.getUnitProperty());}}for(n in this._oDimensionHierarchies){var h=this._oQueryResult.findDimensionByName(n).getHierarchy();var H=this._oDimensionHierarchies[n];if(H.id){a(h.getNodeIDProperty());}if(H.externalKey){a(h.getNodeExternalKeyProperty());}if(H.text){a(this._oQueryResult.getEntityType().getTextPropertyOfProperty(h.getNodeIDProperty().name));}}if(this._bIncludeEntityKey){var k=this._oQueryResult.getEntityType().getTypeDescription().key.propertyRef;for(var j=-1,K;(K=k[++j])!==undefined;){s+=(s==""?"":",")+K.name;}}Q=(s?s:null);break;}case"$filter":{var g=null;if(this._oFilterExpression){g=this._oFilterExpression.getURIFilterOptionValue();}Q=(g?g:null);break;}case"$orderby":{Q=this.getURIOrderByOptionValue();break;}case"$top":{Q=null;if(this._bReturnNoEntities){Q=0;}else if(this._iTopRequestOption!==null){Q=this._iTopRequestOption;}break;}case"$skip":{Q=null;if(!this._bReturnNoEntities){Q=this._iSkipRequestOption;}break;}case"$inlinecount":{Q=(this._bIncludeCount==true?"allpages":null);break;}default:break;}return Q;},getURIToQueryResultEntries:function(s,r){if(!r){r=this.getURIToQueryResultEntitySet(s);}this.getFilterExpression().checkValidity();var a=this.getURIQueryOptionValue("$select");var f=this.getURIQueryOptionValue("$filter");var b=this.getURIQueryOptionValue("$orderby");var t=this.getURIQueryOptionValue("$top");var g=this.getURIQueryOptionValue("$skip");var i=this.getURIQueryOptionValue("$inlinecount");var u=r;var q=false;if(a!==null){u+="?$select="+a;q=true;}if(this._oFilterExpression&&f!==null){if(!q){u+="?";q=true;}else{u+="&";}u+="$filter="+f;}if(this._oSortExpression&&b!==null){if(!q){u+="?";q=true;}else{u+="&";}u+="$orderby="+b;}if((this._iTopRequestOption||this._bReturnNoEntities)&&t!==null){if(!q){u+="?";q=true;}else{u+="&";}u+="$top="+t;}if(this._iSkipRequestOption&&g!==null){if(!q){u+="?";q=true;}else{u+="&";}u+="$skip="+g;}if(this._bIncludeCount&&i!==null){if(!q){u+="?";q=true;}else{u+="&";}u+="$inlinecount="+i;}return u;},_oQueryResult:null,_oParameterizationRequest:null,_sResourcePath:null,_oAggregationLevel:null,_oDimensionHierarchies:null,_oMeasures:null,_bIncludeEntityKey:null,_bIncludeCount:null,_bReturnNoEntities:null,_oFilterExpression:null,_oSortExpression:null,_iSkipRequestOption:null,_iTopRequestOption:null};o.ParameterValueSetRequest=function(p){this._init(p);};o.ParameterValueSetRequest.prototype={_init:function(p){this._oParameter=p;this._oValueSetResult={};this._oFilterExpression=null;this._oSortExpression=null;},includeParameterText:function(i){if(i!=null){this._oValueSetResult.text=i;}},getFilterExpression:function(){if(this._oFilterExpression==null){var E=this._oParameter.getContainingParameterization().getEntityType();var m=this._oParameter.getContainingParameterization().getTargetQueryResult().getModel();this._oFilterExpression=new o.FilterExpression(m,E.getSchema(),E);}return this._oFilterExpression;},setFilterExpression:function(f){this._oFilterExpression=f;},getSortExpression:function(){if(this._oSortExpression==null){var E=this._oParameter.getContainingParameterization().getEntityType();this._oSortExpression=new o.SortExpression(E.getModel(),E.getSchema(),E);}return this._oSortExpression;},setSortExpression:function(s){this._oSortExpression=s;},getURIQueryOptionValue:function(q){var Q=null;switch(q){case"$select":{var s="";s+=(s==""?"":",")+this._oParameter.getProperty().name;if(this._oValueSetResult.text==true&&this._oParameter.getTextProperty()){s+=(s==""?"":",")+this._oParameter.getTextProperty().name;}Q=(s?s:null);break;}case"$filter":{var f=null;if(this._oFilterExpression){f=this._oFilterExpression.getURIFilterOptionValue();}Q=(f?f:null);break;}case"$orderby":{var a=null;if(this._oSortExpression){a=this._oSortExpression.getURIOrderByOptionValue();}Q=(a?a:null);break;}default:break;}return Q;},getURIToParameterValueSetEntries:function(s){var r=null;r=(s?s:"")+"/"+this._oParameter.getContainingParameterization().getEntitySet().getQName();this.getFilterExpression().checkValidity();var a=this.getURIQueryOptionValue("$select");var f=this.getURIQueryOptionValue("$filter");var b=this.getURIQueryOptionValue("$orderby");var u=r;var q=false;if(a){u+="?$select="+a;q=true;}if(this._oFilterExpression&&f){if(!q){u+="?";q=true;}else{u+="&";}u+="$filter="+f;}if(this._oSortExpression&&b){if(!q){u+="?";q=true;}else{u+="&";}u+="$orderby="+b;}return u;},_oParameter:null,_oFilterExpression:null,_oSortExpression:null,_oValueSetResult:null};o.DimensionMemberSetRequest=function(D,p,u){this._init(D,p,u);};o.DimensionMemberSetRequest.prototype={_init:function(D,p,u){this._oDimension=D;this._oParameterizationRequest=p;this._bUseMasterData=u;this._oValueSetResult={};this._oFilterExpression=null;this._oSortExpression=null;if(this._oParameterizationRequest!=null&&this._bUseMasterData==true){throw"LIMITATION: parameterized master data entity sets are not yet implemented";}if(this._bUseMasterData){this._oEntitySet=this._oDimension.getMasterDataEntitySet();}else{this._oEntitySet=this._oDimension.getContainingQueryResult().getEntitySet();if(this._oDimension.getContainingQueryResult().getParameterization()&&!this._oParameterizationRequest){throw"Missing parameterization request";}}},setParameterizationRequest:function(p){this._oParameterizationRequest=p;},includeDimensionTextAttributes:function(i,I){this._oValueSetResult.text={text:false,attributes:false};if(i==true){this._oValueSetResult.text=true;}if(I==true){this._oValueSetResult.attributes=true;}},getFilterExpression:function(){if(this._oFilterExpression==null){var E=this._oEntitySet.getEntityType();var m=this._oDimension.getContainingQueryResult().getModel();this._oFilterExpression=new o.FilterExpression(m,E.getSchema(),E);}return this._oFilterExpression;},setFilterExpression:function(f){this._oFilterExpression=f;},getSortExpression:function(){if(this._oSortExpression==null){this._oSortExpression=new o.SortExpression(this._oEntityType.getModel(),this._oEntityType.getSchema(),this._oEntityType);}return this._oSortExpression;},setSortExpression:function(s){this._oSortExpression=s;},setRequestOptions:function(i){if(i!=null){this._bIncludeCount=i;}},setResultPageBoundaries:function(s,a){if(s!=null&&typeof s!=="number"){throw"Start value must be null or numeric";}if(a!==null&&typeof a!=="number"){throw"End value must be null or numeric";}if(s==null){s=1;}if(s<1||s>(a==null?s:a)){throw"Invalid values for requested page boundaries";}this._iSkipRequestOption=(s>1)?s-1:null;this._iTopRequestOption=(a!=null)?(a-s+1):null;},getResultPageBoundaries:function(){var E=null;if(this._iTopRequestOption!=null){if(this._iSkipRequestOption==null){E=1;}else{E=this._iSkipRequestOption+this._iTopRequestOption;}}return{start:(this._iSkipRequestOption==null)?1:this._iSkipRequestOption,end:E};},getURIQueryOptionValue:function(q){var Q=null;switch(q){case"$select":{var s="";var E=this._oEntitySet.getEntityType();var K=E.getKeyProperties();var a=[];if(this._bUseMasterData){for(var i=-1,b;(b=K[++i])!==undefined;){s+=(s==""?"":",")+b;var f=E.getTextPropertyOfProperty(b);if(f){if(this._oValueSetResult.text==true){s+=","+f.name;}a.push(f.name);}}}else{s+=(s==""?"":",")+this._oDimension.getKeyProperty().name;if(this._oValueSetResult.text==true&&this._oDimension.getTextProperty()){s+=(s==""?"":",")+this._oDimension.getTextProperty().name;}}if(this._oValueSetResult.attributes){if(this._bUseMasterData){var g=E.getProperties();for(var p in g){var I=false;for(var j=-1,h;(h=K[++j])!==undefined;){if(p==h){I=true;break;}}if(I){continue;}for(var k=-1,m;(m=a[++k])!==undefined;){if(p==m){I=true;break;}}if(!I){s+=","+p;}}}else{var n=this._oDimension.getAllAttributeNames();for(var l=-1,r;(r=n[++l])!==undefined;){s+=(s==""?"":",")+this._oDimension.findAttributeByName(r).getName();}}}Q=(s?s:null);break;}case"$filter":{var t=null;if(this._oFilterExpression){t=this._oFilterExpression.getURIFilterOptionValue();}Q=(t?t:null);break;}case"$orderby":{var u=null;if(this._oSortExpression){u=this._oSortExpression.getURIOrderByOptionValue();}Q=(u?u:null);break;}case"$top":{if(this._iTopRequestOption!==null){Q=this._iTopRequestOption;}break;}case"$skip":{Q=this._iSkipRequestOption;break;}case"$inlinecount":{Q=(this._bIncludeCount==true?"allpages":null);break;}default:break;}return Q;},getURIToDimensionMemberEntitySet:function(s){var r=null;if(!this._bUseMasterData&&this._oParameterizationRequest){r=this._oParameterizationRequest.getURIToParameterizationEntry(s)+"/"+this._oDimension.getContainingQueryResult().getParameterization().getNavigationPropertyToQueryResult();}else{r=(s?s:"")+"/"+this._oEntitySet.getQName();}return r;},getURIToDimensionMemberEntries:function(s){var r=this.getURIToDimensionMemberEntitySet(s);this.getFilterExpression().checkValidity();var a=this.getURIQueryOptionValue("$select");var f=this.getURIQueryOptionValue("$filter");var b=this.getURIQueryOptionValue("$orderby");var t=this.getURIQueryOptionValue("$top");var g=this.getURIQueryOptionValue("$skip");var i=this.getURIQueryOptionValue("$inlinecount");var u=r;var q=false;if(a){u+="?$select="+a;q=true;}if(this._oFilterExpression&&f){if(!q){u+="?";q=true;}else{u+="&";}u+="$filter="+f;}if(this._oSortExpression&&b){if(!q){u+="?";q=true;}else{u+="&";}u+="$orderby="+b;}if(this._iTopRequestOption&&t){if(!q){u+="?";q=true;}else{u+="&";}u+="$top="+t;}if(this._iSkipRequestOption&&g){if(!q){u+="?";q=true;}else{u+="&";}u+="$skip="+g;}if(this._bIncludeCount&&i){if(!q){u+="?";q=true;}else{u+="&";}u+="$inlinecount="+i;}return u;},_oDimension:null,_oParameterizationRequest:null,_oEntitySet:null,_bUseMasterData:false,_oFilterExpression:null,_oSortExpression:null,_oValueSetResult:null,_bIncludeCount:null,_iSkipRequestOption:0,_iTopRequestOption:null};return o;},true);
sap.ui.predefine('sap/ui/model/odata/ODataContextBinding',['sap/ui/model/ContextBinding','sap/ui/model/ChangeReason'],function(C,a){"use strict";var O=C.extend("sap.ui.model.odata.ODataContextBinding",{constructor:function(m,p,c,P,e){C.call(this,m,p,c,P,e);}});O.prototype.initialize=function(){var t=this,r=this.oModel.resolve(this.sPath,this.oContext),d=this.oModel._getObject(this.sPath,this.oContext),R=this.oModel._isReloadNeeded(r,d,this.mParameters);if(this.oModel.oMetadata.isLoaded()){if(r&&R){this.fireDataRequested();}this.oModel.createBindingContext(this.sPath,this.oContext,this.mParameters,function(c){t.oElementContext=c;t._fireChange({reason:a.Context});if(r&&R){t.fireDataReceived();}},R);}};O.prototype.refresh=function(f,c){var t=this,k,s,b=false,r=this.oModel.resolve(this.sPath,this.oContext);if(c){s=this.oModel._getObject(this.sPath,this.oContext);if(s){k=this.oModel._getKey(s);if(k in c){b=true;}}}else{b=true;}if(f||b){if(r){this.fireDataRequested();}this.oModel.createBindingContext(this.sPath,this.oContext,this.mParameters,function(o){if(t.oElementContext===o){if(f){t._fireChange({reason:a.Context});}}else{t.oElementContext=o;t._fireChange({reason:a.Context});}if(r){t.fireDataReceived();}},true);}};O.prototype.setContext=function(c){var t=this,r,d,R;if(this.oContext!==c&&this.isRelative()){this.oContext=c;r=this.oModel.resolve(this.sPath,this.oContext);d=this.oModel._getObject(this.sPath,this.oContext);R=this.oModel._isReloadNeeded(r,d,this.mParameters);if(r&&R){this.fireDataRequested();}this.oModel.createBindingContext(this.sPath,this.oContext,this.mParameters,function(c){t.oElementContext=c;t._fireChange({reason:a.Context});if(r&&R){t.fireDataReceived();}},R);}};return O;});
sap.ui.predefine('sap/ui/model/odata/ODataListBinding',['sap/ui/model/ChangeReason','sap/ui/model/Filter','sap/ui/model/odata/Filter','sap/ui/model/FilterType','sap/ui/model/FilterProcessor','sap/ui/model/ListBinding','sap/ui/model/Sorter','./ODataUtils','./CountMode','sap/base/util/deepEqual','sap/base/util/merge','sap/base/Log','sap/base/assert','sap/ui/thirdparty/jquery'],function(C,F,O,a,b,L,S,c,d,e,m,f,g,q){"use strict";var h=L.extend("sap.ui.model.odata.ODataListBinding",{constructor:function(M,p,o,s,i,P){L.apply(this,arguments);this.sFilterParams=null;this.sSortParams=null;this.sRangeParams=null;this.sCustomParams=this.oModel.createCustomParams(this.mParameters);this.iStartIndex=0;this.bPendingChange=false;this.aKeys=[];this.bInitial=true;this.sCountMode=(P&&P.countMode)||this.oModel.sDefaultCountMode;this.bRefresh=false;this.bNeedsUpdate=false;this.bDataAvailable=false;this.bIgnoreSuspend=false;this.oCombinedFilter=null;this.oModel.checkFilterOperation(this.aApplicationFilters);if(!this.oModel.getServiceMetadata()){var t=this,j=function(E){t.bInitial=false;t._initSortersFilters();t.oModel.detachMetadataLoaded(j);};this.oModel.attachMetadataLoaded(this,j);}else{this.bInitial=false;this._initSortersFilters();}var r=this.oModel._getObject(this.sPath,this.oContext);this.aExpandRefs=r;if(Array.isArray(r)&&!s&&!i){this.aKeys=r;this.iLength=r.length;this.bLengthFinal=true;this.bDataAvailable=true;}else if(r===null&&this.oModel.resolve(this.sPath,this.oContext)){this.aKeys=[];this.iLength=0;this.bLengthFinal=true;this.bDataAvailable=true;}else{if(this.oModel.getServiceMetadata()){this.resetData();}}}});h.prototype.getContexts=function(s,l,t){if(this.bInitial){return[];}this.iLastLength=l;this.iLastStartIndex=s;this.iLastThreshold=t;if(!s){s=0;}if(!l){l=this.oModel.iSizeLimit;if(this.bLengthFinal&&this.iLength<l){l=this.iLength;}}if(!t){t=0;}var j=true,k=this._getContexts(s,l),o={},n;n=this.calculateSection(s,l,t,k);j=k.length!=l&&!(this.bLengthFinal&&k.length>=this.iLength-s);if(this.oModel.getServiceMetadata()){if(!this.bPendingRequest&&n.length>0&&(j||l<n.length)){this.loadData(n.startIndex,n.length);k.dataRequested=true;}}if(this.bRefresh){if(this.bLengthFinal&&this.iLength==0){this.loadData(n.startIndex,n.length,true);k.dataRequested=true;}this.bRefresh=false;}else{for(var i=0;i<k.length;i++){o[k[i].getPath()]=k[i].getObject();}if(this.bUseExtendedChangeDetection){if(this.aLastContexts&&s<this.iLastEndIndex){var p=this;var D=q.sap.arrayDiff(this.aLastContexts,k,function(r,N){return e(r&&p.oLastContextData&&p.oLastContextData[r.getPath()],N&&o&&o[N.getPath()]);},true);k.diff=D;}}this.iLastEndIndex=s+l;this.aLastContexts=k.slice(0);this.oLastContextData=m({},o);}return k;};h.prototype.getCurrentContexts=function(){return this.aLastContexts||[];};h.prototype._getContexts=function(s,l){var j=[],o,k;if(!s){s=0;}if(!l){l=this.oModel.iSizeLimit;if(this.bLengthFinal&&this.iLength<l){l=this.iLength;}}for(var i=s;i<s+l;i++){k=this.aKeys[i];if(!k){break;}o=this.oModel.getContext('/'+k);j.push(o);}return j;};h.prototype.calculateSection=function(s,l,t,k){var n,o,p,P,r,u={},K;o=s;n=0;for(var i=s;i>=Math.max(s-t,0);i--){K=this.aKeys[i];if(!K){P=i+1;break;}}for(var j=s+l;j<s+l+t;j++){K=this.aKeys[j];if(!K){p=j;break;}}r=s-P;if(P&&s>t&&r<t){if(k.length!=l){o=s-t;}else{o=P-t;}n=t;}o=Math.max(o,0);if(o==s){o+=k.length;}if(k.length!=l){n+=l-k.length;}r=p-s-l;if(r==0){n+=t;}if(p&&r<t&&r>0){if(o>s){o=p;n+=t;}}if(this.bLengthFinal&&this.iLength<(n+o)){n=this.iLength-o;}u.startIndex=o;u.length=n;return u;};h.prototype.setContext=function(o){if(this.oContext!=o){this.oContext=o;if(this.isRelative()){this._initSortersFilters();if(!this.bInitial){var r=this.oModel._getObject(this.sPath,this.oContext);this.aExpandRefs=r;if(Array.isArray(r)&&!this.aSorters.length>0&&!this.aFilters.length>0){this.aKeys=r;this.iLength=r.length;this.bLengthFinal=true;this._fireChange({reason:C.Context});}else if(!this.oModel.resolve(this.sPath,this.oContext)||r===null){this.aKeys=[];this.iLength=0;this.bLengthFinal=true;this._fireChange({reason:C.Context});}else{this.refresh();}}}}};h.prototype.getDownloadUrl=function(s){var p=[],P;if(s){p.push("$format="+encodeURIComponent(s));}if(this.sSortParams){p.push(this.sSortParams);}if(this.sFilterParams){p.push(this.sFilterParams);}if(this.sCustomParams){p.push(this.sCustomParams);}P=this.oModel.resolve(this.sPath,this.oContext);if(P){return this.oModel._createRequestUrl(P,null,p);}};h.prototype.loadData=function(s,l,p){var t=this,I=false;if(s||l){this.sRangeParams="$skip="+s+"&$top="+l;this.iStartIndex=s;}else{s=this.iStartIndex;}var P=[];if(this.sRangeParams){P.push(this.sRangeParams);}if(this.sSortParams){P.push(this.sSortParams);}if(this.sFilterParams){P.push(this.sFilterParams);}if(this.sCustomParams){P.push(this.sCustomParams);}if(!this.bLengthFinal&&(this.sCountMode==d.Inline||this.sCountMode==d.Both)){P.push("$inlinecount=allpages");I=true;}function j(D){q.each(D.results,function(i,r){t.aKeys[s+i]=t.oModel._getKey(r);});if(I&&D.__count){t.iLength=parseInt(D.__count);t.bLengthFinal=true;}if(t.iLength<s+D.results.length){t.iLength=s+D.results.length;t.bLengthFinal=false;}if(D.results.length<l||l===undefined){t.iLength=s+D.results.length;t.bLengthFinal=true;}if(s==0&&D.results.length==0){t.iLength=0;t.bLengthFinal=true;}t.oRequestHandle=null;t.bPendingRequest=false;t.bNeedsUpdate=true;t.bIgnoreSuspend=true;}function k(D){t.fireDataReceived({data:D});}function E(i,A){t.oRequestHandle=null;t.bPendingRequest=false;if(!A){t.aKeys=[];t.iLength=0;t.bLengthFinal=true;t.bDataAvailable=true;t._fireChange({reason:C.Change});}t.fireDataReceived();}function u(H){t.oRequestHandle=H;}var n=this.sPath,o=this.oContext;if(this.isRelative()){n=this.oModel.resolve(n,o);}if(n){if(p){var U=this.oModel._createRequestUrl(n,null,P);this.fireDataRequested();this.oModel.fireRequestSent({url:U,method:"GET",async:true});setTimeout(function(){t.bNeedsUpdate=true;t.checkUpdate();t.oModel.fireRequestCompleted({url:U,method:"GET",async:true,success:true});t.fireDataReceived({data:{}});},0);}else{this.bPendingRequest=true;this.fireDataRequested();this.oModel._loadData(n,P,j,E,false,u,k);}}};h.prototype.getLength=function(){if(this.bLengthFinal||this.iLength==0){return this.iLength;}else{var A=this.iLastThreshold||this.iLastLength||10;return this.iLength+A;}};h.prototype.isLengthFinal=function(){return this.bLengthFinal;};h.prototype._getLength=function(){var t=this;var p=[];if(this.sFilterParams){p.push(this.sFilterParams);}if(this.mParameters&&this.mParameters.custom){var o={custom:{}};q.each(this.mParameters.custom,function(s,v){o.custom[s]=v;});p.push(this.oModel.createCustomParams(o));}function _(D){t.iLength=parseInt(D);t.bLengthFinal=true;}function i(E){var s="Request for $count failed: "+E.message;if(E.response){s+=", "+E.response.statusCode+", "+E.response.statusText+", "+E.response.body;}f.warning(s);}var P=this.oModel.resolve(this.sPath,this.oContext);if(P){var u=this.oModel._createRequestUrl(P+"/$count",null,p);var r=this.oModel._createRequest(u,"GET",false);r.headers["Accept"]="text/plain, */*;q=0.5";this.oModel._request(r,_,i,undefined,undefined,this.oModel.getServiceMetadata());}};h.prototype.refresh=function(j,k,E){var l=false;if(!j){if(E){var r=this.oModel.resolve(this.sPath,this.oContext);var o=this.oModel.oMetadata._getEntityTypeByPath(r);if(o&&(o.entityType in E)){l=true;}}if(k&&!l){q.each(this.aKeys,function(i,K){if(K in k){l=true;return false;}});}if(!k&&!E){l=true;}}if(j||l){this.abortPendingRequest();this.resetData();this._fireRefresh({reason:C.Refresh});}};h.prototype._fireRefresh=function(p){if(this.oModel.resolve(this.sPath,this.oContext)){this.bRefresh=true;this.fireEvent("refresh",p);}};h.prototype.initialize=function(){if(this.oModel.oMetadata.isLoaded()){if(this.bDataAvailable){this._fireChange({reason:C.Change});}else{this._fireRefresh({reason:C.Refresh});}}};h.prototype.checkUpdate=function(j,k){var l=this.sChangeReason?this.sChangeReason:C.Change,n=false,o,p,t=this,r,R;if(this.bSuspended&&!this.bIgnoreSuspend){return;}if(!j&&!this.bNeedsUpdate){r=this.oModel._getObject(this.sPath,this.oContext);R=Array.isArray(r)&&!e(r,this.aExpandRefs);this.aExpandRefs=r;if(R){if(this.aSorters.length>0||this.aFilters.length>0){this.refresh();return;}else{this.aKeys=r;this.iLength=r.length;this.bLengthFinal=true;n=true;}}else if(k){q.each(this.aKeys,function(i,K){if(K in k){n=true;return false;}});}else{n=true;}if(n&&this.aLastContexts){n=false;var s=this._getContexts(this.iLastStartIndex,this.iLastLength,this.iLastThreshold);if(this.aLastContexts.length!=s.length){n=true;}else{q.each(this.aLastContexts,function(i,u){o=t.oLastContextData[u.getPath()];p=s[i].getObject();if(!e(o,p,true)){n=true;return false;}});}}}if(j||n||this.bNeedsUpdate){this.bNeedsUpdate=false;this._fireChange({reason:l});}this.sChangeReason=undefined;this.bIgnoreSuspend=false;};h.prototype.resetData=function(){this.aKeys=[];this.iLength=0;this.bLengthFinal=false;this.sChangeReason=undefined;this.bDataAvailable=false;if(this.oModel.isCountSupported()&&(this.sCountMode==d.Request||this.sCountMode==d.Both)){this._getLength();}};h.prototype.abortPendingRequest=function(){if(this.oRequestHandle){this.oRequestHandle.abort();this.oRequestHandle=null;this.bPendingRequest=false;}};h.prototype.sort=function(s,r){var i=false;if(!s){s=[];}if(s instanceof S){s=[s];}this.aSorters=s;this.createSortParams(s);if(!this.bInitial){this.aKeys=[];this.abortPendingRequest();this.sChangeReason=C.Sort;this._fireRefresh({reason:this.sChangeReason});this._fireSort({sorter:s});i=true;}if(r){return i;}else{return this;}};h.prototype.createSortParams=function(s){this.sSortParams=c.createSortParams(s);};h.prototype.filter=function(i,s,r){var j=false;if(!i){i=[];}if(i instanceof F){i=[i];}this.oModel.checkFilterOperation(i);if(s==a.Application){this.aApplicationFilters=i;}else{this.aFilters=i;}if(!i||!Array.isArray(i)||i.length==0){this.aFilters=[];}if(!this.aApplicationFilters||!Array.isArray(this.aApplicationFilters)||this.aApplicationFilters.length===0){this.aApplicationFilters=[];}this.convertFilters();this.oCombinedFilter=b.combineFilters(this.aFilters,this.aApplicationFilters);this.createFilterParams(this.oCombinedFilter);if(!this.bInitial){this.resetData();this.abortPendingRequest();this.sChangeReason=C.Filter;this._fireRefresh({reason:this.sChangeReason});if(s==a.Application){this._fireFilter({filters:this.aApplicationFilters});}else{this._fireFilter({filters:this.aFilters});}j=true;}if(r){return j;}else{return this;}};h.prototype.convertFilters=function(){this.aFilters=this.aFilters.map(function(o){return o instanceof O?o.convert():o;});this.aApplicationFilters=this.aApplicationFilters.map(function(o){return o instanceof O?o.convert():o;});};h.prototype.createFilterParams=function(o){this.sFilterParams=c.createFilterParams(o,this.oModel.oMetadata,this.oEntityType);};h.prototype._initSortersFilters=function(){var r=this.oModel.resolve(this.sPath,this.oContext);if(!r){return;}this.oEntityType=this._getEntityType();this.convertFilters();this.oCombinedFilter=b.combineFilters(this.aFilters,this.aApplicationFilters);this.createSortParams(this.aSorters);this.createFilterParams(this.oCombinedFilter);};h.prototype._getEntityType=function(){var r=this.oModel.resolve(this.sPath,this.oContext);if(r){var E=this.oModel.oMetadata._getEntityTypeByPath(r);g(E,"EntityType for path "+r+" could not be found!");return E;}return undefined;};h.prototype.resume=function(){this.bIgnoreSuspend=false;L.prototype.resume.apply(this,arguments);};return h;});
sap.ui.predefine('sap/ui/model/odata/ODataModel',['sap/ui/model/BindingMode','sap/ui/model/Context','sap/ui/model/Model','./ODataUtils','./CountMode','./ODataContextBinding','./ODataListBinding','./ODataMetadata','./ODataPropertyBinding','./ODataTreeBinding','sap/ui/model/FilterProcessor','sap/ui/model/odata/ODataMetaModel','sap/ui/thirdparty/URI','sap/ui/thirdparty/datajs',"sap/base/util/isEmptyObject","sap/base/util/uid","sap/base/util/merge","sap/base/Log","sap/base/assert","sap/base/security/encodeURL","sap/ui/thirdparty/jquery","sap/base/util/isPlainObject"],function(B,C,M,O,a,b,c,d,e,f,F,g,U,h,m,u,n,L,o,p,q,r){"use strict";var s=M.extend("sap.ui.model.odata.ODataModel",{constructor:function(S,j,i,P,H,t,w,l){M.apply(this,arguments);var k,R,v,A=null,x,y,D,z,E,G,I=this;if(typeof(S)==="object"){j=S;S=j.serviceUrl;}if(typeof j==="object"){i=j.user;P=j.password;H=j.headers;t=j.tokenHandling;l=j.loadMetadataAsync;w=j.withCredentials;v=j.maxDataServiceVersion;k=j.useBatch;R=j.refreshAfterChange;A=j.annotationURI;x=j.loadAnnotationsJoined;D=j.defaultCountMode;y=j.metadataNamespaces;z=j.serviceUrlParams;E=j.metadataUrlParams;G=j.skipMetadataAnnotationParsing;j=j.json;}this.oServiceData={};this.sDefaultBindingMode=B.OneWay;this.mSupportedBindingModes={"OneWay":true,"OneTime":true,"TwoWay":true};this.mUnsupportedFilterOperators={"Any":true,"All":true};this.bCountSupported=true;this.bJSON=j;this.bCache=true;this.aPendingRequestHandles=[];this.oRequestQueue={};this.aBatchOperations=[];this.oHandler;this.bTokenHandling=t!==false;this.bWithCredentials=w===true;this.bUseBatch=k===true;this.bRefreshAfterChange=R!==false;this.sMaxDataServiceVersion=v;this.bLoadMetadataAsync=!!l;this.bLoadAnnotationsJoined=x===undefined?true:x;this.sAnnotationURI=A;this.sDefaultCountMode=D||a.Both;this.oMetadataLoadEvent=null;this.oMetadataFailedEvent=null;this.bSkipMetadataAnnotationParsing=G;this.oHeaders={};this.setHeaders(H);this.oData={};this.oMetadata=null;this.oAnnotations=null;this.aUrlParams=[];if(S.indexOf("?")==-1){this.sServiceUrl=S;}else{var J=S.split("?");this.sServiceUrl=J[0];if(J[1]){this.aUrlParams.push(J[1]);}}if(sap.ui.getCore().getConfiguration().getStatistics()){this.aUrlParams.push("sap-statistics=true");}this.sServiceUrl=this.sServiceUrl.replace(/\/$/,"");var K=this._createRequestUrl("$metadata",undefined,E);if(!s.mServiceData[K]){s.mServiceData[K]={};}this.oServiceData=s.mServiceData[K];if(this.bTokenHandling&&this.oServiceData.securityToken){this.oHeaders["x-csrf-token"]=this.oServiceData.securityToken;}this.sUser=i;this.sPassword=P;this.oHeaders["Accept-Language"]=sap.ui.getCore().getConfiguration().getLanguageTag();if(!this.oServiceData.oMetadata){this.oServiceData.oMetadata=new d(K,{async:this.bLoadMetadataAsync,user:this.sUser,password:this.sPassword,headers:this.mCustomHeaders,namespaces:y,withCredentials:this.bWithCredentials});}this.oMetadata=this.oServiceData.oMetadata;this.pAnnotationsLoaded=this.oMetadata.loaded();if(this.sAnnotationURI||!this.bSkipMetadataAnnotationParsing){var N=this._getAnnotationParser();if(!this.bSkipMetadataAnnotationParsing){if(!this.bLoadMetadataAsync){this.addAnnotationXML(this.oMetadata.sMetadataBody,!!this.sAnnotationURI);}else{this.pAnnotationsLoaded=this.oMetadata.loaded().then(function(Q,T){if(this.bDestroyed){return Promise.reject();}return this.addAnnotationXML(T["metadataString"],Q);}.bind(this,!!this.sAnnotationURI));}}if(this.sAnnotationURI){if(this.bLoadMetadataAsync){this.pAnnotationsLoaded=this.pAnnotationsLoaded.then(N.addUrl.bind(N,this.sAnnotationURI));}else{this.pAnnotationsLoaded=Promise.all([this.pAnnotationsLoaded,N.addUrl(this.sAnnotationURI)]);}}}if(z){this.aUrlParams=this.aUrlParams.concat(O._createUrlParamsArray(z));}this.onMetadataLoaded=function(Q){I._initializeMetadata();I.initialize();};this.onMetadataFailed=function(Q){I.fireMetadataFailed(Q.getParameters());};if(!this.oMetadata.isLoaded()){this.oMetadata.attachLoaded(this.onMetadataLoaded);this.oMetadata.attachFailed(this.onMetadataFailed);}if(this.oMetadata.isFailed()){this.refreshMetadata();}if(this.oMetadata.isLoaded()){this._initializeMetadata(true);}if(this.bJSON){if(this.sMaxDataServiceVersion==="3.0"){this.oHeaders["Accept"]="application/json;odata=fullmetadata";}else{this.oHeaders["Accept"]="application/json";}this.oHandler=h.jsonHandler;}else{this.oHeaders["Accept"]="application/atom+xml,application/atomsvc+xml,application/xml";this.oHandler=h.atomHandler;}this.oHeaders["MaxDataServiceVersion"]="2.0";if(this.sMaxDataServiceVersion){this.oHeaders["MaxDataServiceVersion"]=this.sMaxDataServiceVersion;}this.oHeaders["DataServiceVersion"]="2.0";},metadata:{publicMethods:["create","remove","update","submitChanges","getServiceMetadata","read","hasPendingChanges","refresh","refreshMetadata","resetChanges","isCountSupported","setCountSupported","setDefaultCountMode","getDefaultCountMode","forceNoCache","setProperty","getSecurityToken","refreshSecurityToken","setHeaders","getHeaders","setUseBatch"]}});s.M_EVENTS={RejectChange:"rejectChange",MetadataLoaded:"metadataLoaded",MetadataFailed:"metadataFailed",AnnotationsLoaded:"annotationsLoaded",AnnotationsFailed:"annotationsFailed"};s.mServiceData={};s.prototype.fireRejectChange=function(P){this.fireEvent("rejectChange",P);return this;};s.prototype.attachRejectChange=function(D,i,l){this.attachEvent("rejectChange",D,i,l);return this;};s.prototype.detachRejectChange=function(i,l){this.detachEvent("rejectChange",i,l);return this;};s.prototype._initializeMetadata=function(D){var t=this;this.bUseBatch=this.bUseBatch||this.oMetadata.getUseBatch();var i=function(j){if(!!j){t.metadataLoadEvent=setTimeout(i.bind(t),0);}else{if(t.oMetadata){t.fireMetadataLoaded({metadata:t.oMetadata});L.debug("ODataModel fired metadataloaded");}}};if(this.sAnnotationURI&&this.bLoadAnnotationsJoined){if(this.oAnnotations&&(this.oAnnotations.bInitialized||this.oAnnotations.isFailed())){i(!this.bLoadMetadataAsync);}else{this.oAnnotations.attachEventOnce("loaded",function(){i(true);});}}else{i(D);}};s.prototype.fireAnnotationsLoaded=function(P){if(!this.bLoadMetadataAsync){setTimeout(this.fireEvent.bind(this,"annotationsLoaded",P),0);}else{this.fireEvent("annotationsLoaded",P);}return this;};s.prototype.attachAnnotationsLoaded=function(D,i,l){this.attachEvent("annotationsLoaded",D,i,l);return this;};s.prototype.detachAnnotationsLoaded=function(i,l){this.detachEvent("annotationsLoaded",i,l);return this;};s.prototype.fireAnnotationsFailed=function(P){if(!this.bLoadMetadataAsync){setTimeout(this.fireEvent.bind(this,"annotationsFailed",P),0);}else{this.fireEvent("annotationsFailed",P);}L.debug("ODataModel fired annotationsFailed");return this;};s.prototype.attachAnnotationsFailed=function(D,i,l){this.attachEvent("annotationsFailed",D,i,l);return this;};s.prototype.detachAnnotationsFailed=function(i,l){this.detachEvent("annotationsFailed",i,l);return this;};s.prototype.fireMetadataLoaded=function(P){this.fireEvent("metadataLoaded",P);return this;};s.prototype.attachMetadataLoaded=function(D,i,l){this.attachEvent("metadataLoaded",D,i,l);return this;};s.prototype.detachMetadataLoaded=function(i,l){this.detachEvent("metadataLoaded",i,l);return this;};s.prototype.fireMetadataFailed=function(P){this.fireEvent("metadataFailed",P);return this;};s.prototype.attachMetadataFailed=function(D,i,l){this.attachEvent("metadataFailed",D,i,l);return this;};s.prototype.detachMetadataFailed=function(i,l){this.detachEvent("metadataFailed",i,l);return this;};s.prototype.refreshMetadata=function(){if(this.oMetadata&&this.oMetadata.refresh){this.oMetadata.refresh();}};s.prototype._createRequestUrl=function(P,i,j,k,l){var t,R,v,w="";if(P&&P.indexOf('?')!=-1){v=P.substr(P.indexOf('?')+1);P=P.substr(0,P.indexOf('?'));}R=this._normalizePath(P,i);if(!k){w=this.sServiceUrl+R;}else{w=R.substr(R.indexOf('/')+1);}t=O._createUrlParamsArray(j);if(this.aUrlParams){t=t.concat(this.aUrlParams);}if(v){t.push(v);}if(t.length>0){w+="?"+t.join("&");}if(l===undefined){l=true;}if(l===false){var x=q.now();var y=w.replace(/([?&])_=[^&]*/,"$1_="+x);w=y+((y===w)?(/\?/.test(w)?"&":"?")+"_="+x:"");}return w;};s.prototype._loadData=function(P,i,S,E,j,H,k){var R,l,t=this;function _(D,z){var A=D,G={};if(z.statusCode==204){if(S){S(null);}if(k){k(null);}t.fireRequestCompleted({url:l.requestUri,type:"GET",async:l.async,info:"Accept headers:"+t.oHeaders["Accept"],infoObject:{acceptHeaders:t.oHeaders["Accept"]},success:true});return;}if(!A){L.fatal("The following problem occurred: No data was retrieved by service: "+z.requestUri);t.fireRequestCompleted({url:l.requestUri,type:"GET",async:l.async,info:"Accept headers:"+t.oHeaders["Accept"],infoObject:{acceptHeaders:t.oHeaders["Accept"]},success:false});return false;}if(t.bUseBatch){var I=t._getBatchErrors(D);if(I.length>0){v(I[0]);return false;}if(A.__batchResponses&&A.__batchResponses.length>0){A=A.__batchResponses[0].data;}else{L.fatal("The following problem occurred: No data was retrieved by service: "+z.requestUri);}}x=x.concat(A.results);if(A.__next){var J=new U(A.__next);l.requestUri=J.absoluteTo(z.requestUri).toString();w(l);}else{if(A.results){var V,K;for(K in x){V=x[K];if(x===V){continue;}A.results[K]=V;}}if(A.results&&!Array.isArray(A.results)){A=A.results;}t._importData(A,G);if(t.sChangeKey&&G){var N=t.sChangeKey.substr(t.sChangeKey.lastIndexOf('/')+1);if(G[N]){delete t.oRequestQueue[t.sChangeKey];t.sChangeKey=null;}}if(S){S(A);}t.checkUpdate(false,false,G);if(k){k(A);}t.fireRequestCompleted({url:l.requestUri,type:"GET",async:l.async,info:"Accept headers:"+t.oHeaders["Accept"],infoObject:{acceptHeaders:t.oHeaders["Accept"]},success:true});}}function v(z){if(t.bTokenHandling&&z.response){var T=t._getHeader("x-csrf-token",z.response.headers);if(!l.bTokenReset&&z.response.statusCode=='403'&&T&&T.toLowerCase()=="required"){t.resetSecurityToken();l.bTokenReset=true;w();return;}}var A=t._handleError(z);if(E){E(z,R&&R.bAborted);}t.fireRequestCompleted({url:l.requestUri,type:"GET",async:l.async,info:"Accept headers:"+t.oHeaders["Accept"],infoObject:{acceptHeaders:t.oHeaders["Accept"]},success:false,errorobject:A});if(!R||!R.bAborted){A.url=l.requestUri;t.fireRequestFailed(A);}}function w(){if(t.bUseBatch){t.updateSecurityToken();var z=U.parse(l.requestUri).query;var A=t._createRequestUrl(P,null,z,t.bUseBatch);l=t._createRequest(A,"GET",true);if(t.bTokenHandling){delete l.headers["x-csrf-token"];}var D=t._createBatchRequest([l],true);R=t._request(D,_,v,h.batchHandler,undefined,t.getServiceMetadata());}else{R=t._request(l,_,v,t.oHandler,undefined,t.getServiceMetadata());}if(H){var W={abort:function(){R.bAborted=true;R.abort();}};H(W);}}var x=[];var y=this._createRequestUrl(P,null,i,null,j||this.bCache);l=this._createRequest(y,"GET",true);if(t.bTokenHandling){delete l.headers["x-csrf-token"];}this.fireRequestSent({url:l.requestUri,type:"GET",async:l.async,info:"Accept headers:"+this.oHeaders["Accept"],infoObject:{acceptHeaders:this.oHeaders["Accept"]}});w();};s.prototype._importData=function(D,k){var t=this,l,K,R,E;if(D.results){l=[];q.each(D.results,function(i,j){l.push(t._importData(j,k));});return l;}else{K=this._getKey(D);E=this.oData[K];if(!E){E=D;this.oData[K]=E;}q.each(D,function(N,P){if(P&&(P.__metadata&&P.__metadata.uri||P.results)&&!P.__deferred){R=t._importData(P,k);if(Array.isArray(R)){E[N]={__list:R};}else{E[N]={__ref:R};}}else if(!P||!P.__deferred){E[N]=P;}});k[K]=true;return K;}};s.prototype._removeReferences=function(D){var t=this,l;if(D.results){l=[];q.each(D.results,function(i,j){l.push(t._removeReferences(j));});return l;}else{q.each(D,function(P,i){if(i){if(i["__ref"]||i["__list"]){delete D[P];}}});return D;}};s.prototype._restoreReferences=function(D){var t=this,l,R=[];if(D.results){l=[];q.each(D.results,function(i,j){l.push(t._restoreReferences(j));});return l;}else{q.each(D,function(P,i){if(i&&i["__ref"]){var k=t._getObject("/"+i["__ref"]);o(k,"ODataModel inconsistent: "+i["__ref"]+" not found!");if(k){delete i["__ref"];D[P]=k;t._restoreReferences(k);}}else if(i&&i["__list"]){q.each(i["__list"],function(j,E){var k=t._getObject("/"+i["__list"][j]);o(k,"ODataModel inconsistent: "+i["__list"][j]+" not found!");if(k){R.push(k);t._restoreReferences(k);}});delete i["__list"];i.results=R;R=[];}});return D;}};s.prototype.removeData=function(){this.oData={};};s.prototype.initialize=function(){var i=this.getBindings();q.each(i,function(I,j){j.initialize();});};s.prototype.refresh=function(i,R){if(R){this.removeData();}this._refresh(i);};s.prototype._refresh=function(i,j,E){var k=this.getBindings();q.each(k,function(I,l){l.refresh(i,j,E);});};s.prototype.checkUpdate=function(i,A,j,k){if(A){if(!this.sUpdateTimer){this.sUpdateTimer=setTimeout(function(){this.checkUpdate(i,false,j);}.bind(this),0);}return;}if(this.sUpdateTimer){clearTimeout(this.sUpdateTimer);this.sUpdateTimer=null;}var l=this.getBindings();q.each(l,function(I,t){if(!k||this.isMetaModelPath(t.getPath())){t.checkUpdate(i,j);}}.bind(this));};s.prototype.bindProperty=function(P,i,j){var k=new e(this,P,i,j);return k;};s.prototype.bindList=function(P,i,S,j,k){var l=new c(this,P,i,S,j,k);return l;};s.prototype.bindTree=function(P,i,j,k){var l=new f(this,P,i,j,k);return l;};s.prototype.createBindingContext=function(P,i,j,k,R){var R=!!R,l=this.resolve(P,i);if(typeof i=="function"){k=i;i=null;}if(typeof j=="function"){k=j;j=null;}if(!l){if(k){k(null);}return null;}var D=this._getObject(P,i),K,N,t=this;if(!R){R=this._isReloadNeeded(l,D,j);}if(!R){K=this._getKey(D);N=this.getContext('/'+K);if(k){k(N);}return N;}if(k){var I=!P.startsWith("/");if(l){var v=[],w=this.createCustomParams(j);if(w){v.push(w);}this._loadData(l,v,function(D){K=D?t._getKey(D):undefined;if(K&&i&&I){var x=i.getPath();x=x.substr(1);if(t.oData[x]){t.oData[x][P]={__ref:K};}}N=t.getContext('/'+K);k(N);},function(){k(null);});}else{k(null);}}};s.prototype._isReloadNeeded=function(j,D,P){var N,k=[],S,l=[];if(!j){return false;}if(!D){return true;}if(P&&P["expand"]){N=P["expand"].replace(/\s/g,"");k=N.split(',');}if(k){for(var i=0;i<k.length;i++){var t=k[i].indexOf("/");if(t!==-1){var v=k[i].slice(0,t);var w=k[i].slice(t+1);k[i]=[v,w];}}}for(var i=0;i<k.length;i++){var x=k[i];if(Array.isArray(x)){var y=D[x[0]];var z=x[1];if(!y||(y&&y.__deferred)){return true;}else{if(y){if(y.__list&&y.__list.length>0){for(var A=0;A<y.__list.length;A++){var E="/"+y.__list[A];var G=this.getObject(E);var R=this._isReloadNeeded(E,G,{expand:z});if(R){return true;}}}else if(y.__ref){var E="/"+y.__ref;var G=this.getObject(E);var R=this._isReloadNeeded(E,G,{expand:z});if(R){return true;}}}}}else{if(D[x]===undefined||(D[x]&&D[x].__deferred)){return true;}}}if(P&&P["select"]){S=P["select"].replace(/\s/g,"");l=S.split(',');}for(var i=0;i<l.length;i++){if(D[l[i]]===undefined){return true;}}if(l.length==0){var H=this.oMetadata._getEntityTypeByPath(j);if(!H){return false;}else{for(var i=0;i<H.property.length;i++){if(D[H.property[i].name]===undefined){return true;}}}}return false;};s.prototype.destroyBindingContext=function(i){};s.prototype.createCustomParams=function(P){var i=[],j,S={expand:true,select:true};for(var N in P){if(N in S){i.push("$"+N+"="+p(P[N]));}if(N=="custom"){j=P[N];for(var N in j){if(N.indexOf("$")==0){L.warning("Trying to set OData parameter "+N+" as custom query option!");}else{i.push(N+"="+p(j[N]));}}}}return i.join("&");};s.prototype.bindContext=function(P,i,j){var k=new b(this,P,i,j);return k;};s.prototype.setCountSupported=function(i){this.bCountSupported=i;};s.prototype.isCountSupported=function(){return this.bCountSupported;};s.prototype.setDefaultCountMode=function(i){this.sDefaultCountMode=i;};s.prototype.getDefaultCountMode=function(){return this.sDefaultCountMode;};s.prototype._getKey=function(i,D){var k,j;if(i instanceof C){k=i.getPath().substr(1);}else if(i&&i.__metadata&&i.__metadata.uri){j=i.__metadata.uri;k=j.substr(j.lastIndexOf("/")+1);}if(D){k=decodeURIComponent(k);}return k;};s.prototype.getKey=function(i,D){return this._getKey(i,D);};s.prototype.createKey=function(j,k,D){var E=this.oMetadata._getEntityTypeByPath(j),K=j,t=this,N,v,P;o(E,"Could not find entity type of collection \""+j+"\" in service metadata!");K+="(";if(E.key.propertyRef.length==1){N=E.key.propertyRef[0].name;o(N in k,"Key property \""+N+"\" is missing in object!");P=this.oMetadata._getPropertyMetadata(E,N);v=O.formatValue(k[N],P.type);K+=D?v:encodeURIComponent(v);}else{q.each(E.key.propertyRef,function(i,l){if(i>0){K+=",";}N=l.name;o(N in k,"Key property \""+N+"\" is missing in object!");P=t.oMetadata._getPropertyMetadata(E,N);v=O.formatValue(k[N],P.type);K+=N;K+="=";K+=D?v:encodeURIComponent(v);});}K+=")";return K;};s.prototype.getProperty=function(P,i,I){var v=this._getObject(P,i);if(I==null||I==undefined){return v;}if(!r(v)){return v;}v=n({},v);if(I==true){return this._restoreReferences(v);}else{return this._removeReferences(v);}};s.prototype._getObject=function(P,i){var N=this.isLegacySyntax()?this.oData:null,R=this.resolve(P,i),S,D,j,k,K,l;if(this.oMetadata&&R&&R.indexOf('/#')>-1){if(this.isMetaModelPath(R)){S=R.indexOf('/##');l=this.getMetaModel();if(!this.bMetaModelLoaded){return null;}D=R.substr(0,S);j=R.substr(S+3);k=l.getMetaContext(D);N=l.getProperty(j,k);}else{N=this.oMetadata._getAnnotation(R);}}else{if(i){K=i.getPath();K=K.substr(1);N=this.oData[K];}if(!P){return N;}var t=P.split("/"),I=0;if(!t[0]){N=this.oData;I++;}while(N&&t[I]){N=N[t[I]];if(N){if(N.__ref){N=this.oData[N.__ref];}else if(N.__list){N=N.__list;}else if(N.__deferred){N=undefined;}}I++;}}return N;};s.prototype.updateSecurityToken=function(){if(this.bTokenHandling){if(!this.oServiceData.securityToken){this.refreshSecurityToken();}if(this.bTokenHandling){this.oHeaders["x-csrf-token"]=this.oServiceData.securityToken;}}};s.prototype.resetSecurityToken=function(){delete this.oServiceData.securityToken;delete this.oHeaders["x-csrf-token"];};s.prototype.getSecurityToken=function(){var t=this.oServiceData.securityToken;if(!t){this.refreshSecurityToken();t=this.oServiceData.securityToken;}return t;};s.prototype.refreshSecurityToken=function(S,E,A){var t=this,i,T;A=A===true;i=this._createRequestUrl("/");var R=this._createRequest(i,"GET",A);R.headers["x-csrf-token"]="Fetch";function _(D,k){if(k){T=t._getHeader("x-csrf-token",k.headers);if(T){t.oServiceData.securityToken=T;t.oHeaders["x-csrf-token"]=T;}else{t.resetSecurityToken();t.bTokenHandling=false;}}if(S){S(D,k);}}function j(k){t.resetSecurityToken();t.bTokenHandling=false;t._handleError(k);if(E){E(k);}}return this._request(R,_,j,undefined,undefined,this.getServiceMetadata());};s.prototype._submitRequest=function(R,i,S,E,H,I){var t=this,j,k={};function _(D,w){if(i&&H){var x=t._getBatchErrors(D);if(x.length>0){l(x[0]);return false;}if(D.__batchResponses&&D.__batchResponses.length>0){j=D.__batchResponses[0].data;if(!j&&D.__batchResponses[0].__changeResponses){j=D.__batchResponses[0].__changeResponses[0].data;}}D=j;}if(I){if(D&&D.__batchResponses){q.each(D.__batchResponses,function(y,w){if(w&&w.data){t._importData(w.data,k);}});}}t._handleETag(R,w,i);t._updateRequestQueue(R,i);if(t._isRefreshNeeded(R,w)){t._refresh(false,R.keys,R.entityTypes);}if(S){S(D,w);}}function l(w){if(t.bTokenHandling&&w.response){var T=t._getHeader("x-csrf-token",w.response.headers);if(!R.bTokenReset&&w.response.statusCode=='403'&&T&&T.toLowerCase()=="required"){t.resetSecurityToken();R.bTokenReset=true;v();return;}}t._handleError(w);if(E){E(w);}}function v(){if(t.bTokenHandling){delete R.headers["x-csrf-token"];}if(t.bTokenHandling&&R.method!=="GET"){t.updateSecurityToken();if(t.bTokenHandling){R.headers["x-csrf-token"]=t.oServiceData.securityToken;}}if(i){return t._request(R,_,l,h.batchHandler,undefined,t.getServiceMetadata());}else{return t._request(R,_,l,t.oHandler,undefined,t.getServiceMetadata());}}return v();};s.prototype._createBatchRequest=function(t,A){var v,R,w={},P={},K={},E={};P.__batchRequests=t;v=this.sServiceUrl+"/$batch";if(this.aUrlParams.length>0){v+="?"+this.aUrlParams.join("&");}q.extend(w,this.mCustomHeaders,this.oHeaders);delete w["Content-Type"];R={headers:w,requestUri:v,method:"POST",data:P,user:this.sUser,password:this.sPassword,async:A};if(A){R.withCredentials=this.bWithCredentials;}q.each(t,function(i,x){if(x["__changeRequests"]){q.each(x["__changeRequests"],function(j,y){if(y.keys&&y.method!="POST"){q.each(y.keys,function(k,l){K[k]=l;});}else if(y.entityTypes&&y.method=="POST"){q.each(y.entityTypes,function(l,k){E[l]=k;});}});}});R.keys=K;R.entityTypes=E;return R;};s.prototype._handleETag=function(R,k,l){var t,E,v,w,x,y;if(l){x=R.data.__batchRequests;y=k.data.__batchResponses;if(y&&x){for(var i=0;i<x.length;i++){v=x[i].__changeRequests;if(y[i]){w=y[i].__changeResponses;if(v&&w){for(var j=0;j<v.length;j++){if(v[j].method=="MERGE"||v[j].method=="PUT"){t=v[j].requestUri.replace(this.sServiceUrl+'/','');if(!t.startsWith("/")){t="/"+t;}E=this._getObject(t);if(E&&E.__metadata&&w[j].headers&&w[j].headers.ETag){E.__metadata.etag=w[j].headers.ETag;}}}}}else{L.warning("could not update ETags for batch request: corresponding response for request missing");}}}else{L.warning("could not update ETags for batch request: no batch responses/requests available");}}else{t=R.requestUri.replace(this.sServiceUrl+'/','');if(!t.startsWith("/")){t="/"+t;}E=this._getObject(t);if(E&&E.__metadata&&k.headers.ETag){E.__metadata.etag=k.headers.ETag;}}};s.prototype._handleBatchErrors=function(R,D){this._getBatchErrors(D);this._handleETag();};s.prototype._getBatchErrors=function(D){var E=[],i;q.each(D.__batchResponses,function(I,j){if(j.message){i="The following problem occurred: "+j.message;if(j.response){i+=j.response.statusCode+","+j.response.statusText+","+j.response.body;}E.push(j);L.fatal(i);}if(j.__changeResponses){q.each(j.__changeResponses,function(I,k){if(k.message){i="The following problem occurred: "+k.message;if(k.response){i+=k.response.statusCode+","+k.response.statusText+","+k.response.body;}E.push(k);L.fatal(i);}});}});return E;};s.prototype._handleError=function(E){var P={},t;var i="The following problem occurred: "+E.message;P.message=E.message;if(E.response){if(this.bTokenHandling){t=this._getHeader("x-csrf-token",E.response.headers);if(E.response.statusCode=='403'&&t&&t.toLowerCase()=="required"){this.resetSecurityToken();}}i+=E.response.statusCode+","+E.response.statusText+","+E.response.body;P.statusCode=E.response.statusCode;P.statusText=E.response.statusText;P.responseText=E.response.body;}L.fatal(i);return P;};s.prototype.getData=function(P,i,I){return this.getProperty(P,i,I);};s.prototype._getETag=function(P,i,E){var j,k,I;if(E){j=E;}else{if(i&&i.__metadata){j=i.__metadata.etag;}else if(P){k=P.replace(this.sServiceUrl+'/','');I=k.indexOf("?");if(I>-1){k=k.substr(0,I);}if(this.oData.hasOwnProperty(k)){j=this.getProperty('/'+k+'/__metadata/etag');}}}return j;};s.prototype._createRequest=function(i,j,A,P,E){var k={},l;q.extend(k,this.mCustomHeaders,this.oHeaders);l=this._getETag(i,P,E);if(l&&j!="GET"){k["If-Match"]=l;}if(this.bJSON&&j!="DELETE"&&this.sMaxDataServiceVersion==="2.0"){k["Content-Type"]="application/json";}if(j=="MERGE"&&!this.bUseBatch){k["x-http-method"]="MERGE";j="POST";}var R={headers:k,requestUri:i,method:j,user:this.sUser,password:this.sPassword,async:A};if(P){R.data=P;}if(A){R.withCredentials=this.bWithCredentials;}return R;};s.prototype._isRefreshNeeded=function(R,i){var j=false,E,k=[],t=this;if(!this.bRefreshAfterChange){return j;}if(R.data&&Array.isArray(R.data.__batchRequests)){if(i){k=t._getBatchErrors(i.data);q.each(k,function(I,l){if(l.response&&l.response.statusCode=="412"){E=l.response.statusCode;return false;}});if(!!E){return false;}}q.each(R.data.__batchRequests,function(I,l){if(Array.isArray(l.__changeRequests)){q.each(l.__changeRequests,function(I,v){j=j||t._isRefreshNeeded(v);return!j;});}return!j;});}else{if(R.method==="GET"){return false;}else{if(i&&i.statusCode=="412"){j=false;}else{j=true;}}}return j;};s.prototype.update=function(P,D,i){var S,E,j,R,k,l,t,v,w,x,K,y,A=false;if(i instanceof C||arguments.length>3){l=i;S=arguments[3];E=arguments[4];j=arguments[5];}else{l=i.context||i.oContext;S=i.success||i.fnSuccess;E=i.error||i.fnError;t=i.eTag||i.sETag;j=typeof(i.merge)=="undefined"?i.bMerge===true:i.merge===true;A=typeof(i.async)=="undefined"?i.bAsync===true:i.async===true;y=i.urlParameters;}k=this._createRequestUrl(P,l,y,this.bUseBatch);if(j){R=this._createRequest(k,"MERGE",A,D,t);}else{R=this._createRequest(k,"PUT",A,D,t);}P=this._normalizePath(P,l);x=this._getObject(P);R.keys={};if(x){K=this._getKey(x);R.keys[K]=true;}if(this.bUseBatch){w=this._createBatchRequest([{__changeRequests:[R]}],A);v=this._submitRequest(w,this.bUseBatch,S,E,true);}else{v=this._submitRequest(R,this.bUseBatch,S,E);}return v;};s.prototype.create=function(P,D,i){var R,j,k,l,E,t,S,v,A=false,w;if(i&&typeof(i)=="object"&&!(i instanceof C)){t=i.context;S=i.success;w=i.urlParameters;v=i.error;A=i.async===true;}else{t=i;S=arguments[3];v=arguments[4];}k=this._createRequestUrl(P,t,w,this.bUseBatch);R=this._createRequest(k,"POST",A,D);P=this._normalizePath(P,t);E=this.oMetadata._getEntityTypeByPath(P);R.entityTypes={};if(E){R.entityTypes[E.entityType]=true;}if(this.bUseBatch){j=this._createBatchRequest([{__changeRequests:[R]}],A);l=this._submitRequest(j,this.bUseBatch,S,v,true);}else{l=this._submitRequest(R,this.bUseBatch,S,v);}return l;};s.prototype.remove=function(P,i){var j,E,S,k,l,R,t,v,K,w,_,x,y,z,A=false,D=this;if((i instanceof C)||arguments[2]){j=i;k=arguments[2];l=arguments[3];}else if(i){j=i.context||i.oContext;k=i.success||i.fnSuccess;l=i.error||i.fnError;v=i.eTag||i.sETag;w=i.payload||i.oPayload;A=typeof(i.async)=="undefined"?i.bAsync===true:i.async===true;z=i.urlParameters;}_=function(G,H){E=t.substr(t.lastIndexOf('/')+1);if(E.indexOf('?')!=-1){E=E.substr(0,E.indexOf('?'));}delete D.oData[E];delete D.mContexts["/"+E];if(k){k(G,H);}};t=this._createRequestUrl(P,j,z,this.bUseBatch);R=this._createRequest(t,"DELETE",A,w,v);P=this._normalizePath(P,j);S=this._getObject(P);R.keys={};if(S){K=this._getKey(S);R.keys[K]=true;}if(this.bUseBatch){x=this._createBatchRequest([{__changeRequests:[R]}],A);y=this._submitRequest(x,this.bUseBatch,_,l,true);}else{y=this._submitRequest(R,this.bUseBatch,_,l);}return y;};s.prototype.callFunction=function(i,P){var R,j,k,l,t,v,w,S,E,A,x="GET",y={},z=this;if(P&&typeof(P)=="object"){x=P.method?P.method:x;v=P.urlParameters;w=P.context;S=P.success;E=P.error;A=P.async===true;}else{x=P;v=arguments[2];w=arguments[3];S=arguments[4];E=arguments[5];A=arguments[6]===true;}t=this.oMetadata._getFunctionImportMetadata(i,x);o(t,"Function "+i+" not found in the metadata !");if(t){k=this._createRequestUrl(i,w,null,this.bUseBatch);var D=U(k);if(t.parameter!=null){q.each(v,function(G,H){var I=t.parameter.filter(function(K){return K.name==G&&K.mode=="In";});if(I.length>0){var J=I[0];y[G]=O.formatValue(H,J.type);}else{L.warning("Parameter "+G+" is not defined for function call "+i+"!");}});}if(x==="GET"){return z.read(i,w,y,true,S,E);}else{q.each(y,function(G,H){D.addQuery(G,H);});R=this._createRequest(D.toString(),x,A);if(this.bUseBatch){j=this._createBatchRequest([{__changeRequests:[R]}],A);l=this._submitRequest(j,this.bUseBatch,S,E,true);}else{l=this._submitRequest(R,this.bUseBatch,S,E);}return l;}}};s.prototype.read=function(P,i){var R,j,k,l,t,v,A,S,E,w,x,y,z,D,G,H,I;if(i&&typeof(i)=="object"&&!(i instanceof C)){t=i.context;v=i.urlParameters;A=i.async!==false;S=i.success;E=i.error;w=i.filters;x=i.sorters;}else{t=i;v=arguments[2];A=arguments[3]!==false;S=arguments[4];E=arguments[5];}A=A!==false;I=O._createUrlParamsArray(v);z=O.createSortParams(x);if(z){I.push(z);}if(w&&!this.oMetadata){L.fatal("Tried to use filters in read method before metadata is available.");}else{H=this._normalizePath(P,t);G=this.oMetadata&&this.oMetadata._getEntityTypeByPath(H);D=F.groupFilters(w);y=O.createFilterParams(D,this.oMetadata,G);if(y){I.push(y);}}j=this._createRequestUrl(P,t,I,this.bUseBatch);R=this._createRequest(j,"GET",A);if(this.bUseBatch){l=this._createBatchRequest([R],A);k=this._submitRequest(l,this.bUseBatch,S,E,true);}else{k=this._submitRequest(R,this.bUseBatch,S,E);}return k;};s.prototype.createBatchOperation=function(P,i,D,j){var k={},E,S,K,l;q.extend(k,this.mCustomHeaders,this.oHeaders);if(P.startsWith("/")){P=P.substr(1);}if(j){E=j.sETag;}if(i!="GET"){E=this._getETag(P,D,E);if(E){k["If-Match"]=E;}}if(this.bJSON){if(i!="DELETE"&&i!="GET"&&this.sMaxDataServiceVersion==="2.0"){k["Content-Type"]="application/json";}}else{k["Content-Type"]="application/atom+xml";}var R={requestUri:P,method:i.toUpperCase(),headers:k};if(D){R.data=D;}if(i!="GET"&&i!="POST"){if(P&&P.indexOf("/")!=0){P='/'+P;}S=this._getObject(P);if(S){K=this._getKey(S);R.keys={};R.keys[K]=true;}}else if(i=="POST"){var N=P;if(P.indexOf('?')!=-1){N=P.substr(0,P.indexOf('?'));}l=this.oMetadata._getEntityTypeByPath(N);if(l){R.entityTypes={};R.entityTypes[l.entityType]=true;}}return R;};s.prototype.addBatchReadOperations=function(R){if(!Array.isArray(R)||R.length<=0){L.warning("No array with batch operations provided!");return false;}var t=this;q.each(R,function(i,j){if(j.method!="GET"){L.warning("Batch operation should be a GET operation!");return false;}t.aBatchOperations.push(j);});};s.prototype.addBatchChangeOperations=function(i){if(!Array.isArray(i)||i.length<=0){return false;}q.each(i,function(I,j){if(j.method!="POST"&&j.method!="PUT"&&j.method!="MERGE"&&j.method!="DELETE"){L.warning("Batch operation should be a POST/PUT/MERGE/DELETE operation!");return false;}});this.aBatchOperations.push({__changeRequests:i});};s.prototype.clearBatch=function(){this.aBatchOperations=[];};s.prototype.submitBatch=function(S,E,A,i){var R,j,t=this;function _(D,v){if(S){S(D,v,t._getBatchErrors(D));}}if(!(typeof(S)=="function")){var k=A;var l=E;A=S;S=l;E=k;}A=A!==false;if(this.aBatchOperations.length<=0){L.warning("No batch operations in batch. No request will be triggered!");return false;}R=this._createBatchRequest(this.aBatchOperations,A);j=this._submitRequest(R,true,_,E,false,i);this.clearBatch();return j;};s.prototype.getServiceMetadata=function(){if(this.oMetadata&&this.oMetadata.isLoaded()){return this.oMetadata.getServiceMetadata();}};s.prototype.getServiceAnnotations=function(){if(this.oAnnotations&&this.oAnnotations.getAnnotationsData){return this.oAnnotations.getAnnotationsData();}};s.prototype.submitChanges=function(S,E,P){var R,i,t=this,j,k,T,l,v,K;if(this.sChangeKey){j=this.sChangeKey.replace(this.sServiceUrl,'');v=this._getObject(j);i=v;if(r(v)){i=n({},v);if(i.__metadata){T=i.__metadata.type;l=i.__metadata.etag;delete i.__metadata;if(T||l){i.__metadata={};}if(T){i.__metadata.type=T;}if(!!l){i.__metadata.etag=l;}}q.each(i,function(y,z){if(z&&z.__deferred){delete i[y];}});var w=this.oMetadata._getEntityTypeByPath(j);if(w){var N=this.oMetadata._getNavigationPropertyNames(w);q.each(N,function(I,y){delete i[y];});}i=this._removeReferences(i);}if(P&&P.sETag){k=P.sETag;}R=this._createRequest(this.sChangeKey,"MERGE",true,i,k);if(this.sUrlParams){R.requestUri+="?"+this.sUrlParams;}R.keys={};if(v){K=this._getKey(v);R.keys[K]=true;}this.oRequestQueue[this.sChangeKey]=R;}if(m(this.oRequestQueue)){return undefined;}if(this.bUseBatch){var x=[];q.each(this.oRequestQueue,function(K,y){delete y._oRef;var z=n({},y);y._oRef=z;z.requestUri=z.requestUri.replace(t.sServiceUrl+'/','');z.data._bCreate?delete z.data._bCreate:false;x.push(z);});R=this._createBatchRequest([{__changeRequests:x}],true);this._submitRequest(R,this.bUseBatch,S,E,true);}else{q.each(this.oRequestQueue,function(K,y){delete y._oRef;var z=n({},y);y._oRef=z;if(z.data&&z.data._bCreate){delete z.data._bCreate;}t._submitRequest(z,this.bUseBatch,S,E,true);});}return undefined;};s.prototype._updateRequestQueue=function(R,k){var l,t,v,w=this;if(k){l=R.data.__batchRequests;if(l){for(var i=0;i<l.length;i++){t=l[i].__changeRequests;if(t){for(var j=0;j<t.length;j++){v=t[j];q.each(this.oRequestQueue,function(K,x){if(x._oRef===v&&K!==w.sChangeKey){delete w.oRequestQueue[K];delete w.oData[K];delete w.mContexts["/"+K];}else if(w.sChangeKey&&K===w.sChangeKey){delete w.oRequestQueue[K];w.sChangeKey=null;}});}}}}}else{q.each(this.oRequestQueue,function(K,x){if(x._oRef===R&&K!==w.sChangeKey){delete w.oRequestQueue[K];delete w.oData[K];delete w.mContexts["/"+K];}else if(w.sChangeKey&&K===w.sChangeKey){delete w.oRequestQueue[K];w.sChangeKey=null;}});}};s.prototype.resetChanges=function(S,E){var P;if(this.sChangeKey){P=this.sChangeKey.replace(this.sServiceUrl,'');this._loadData(P,null,S,E);}};s.prototype.setProperty=function(P,v,j,A){var k,E={},D={},l=this._createRequestUrl(P,j),t=P.substring(0,P.lastIndexOf("/")),K,w,x={},y=false;if(!this.resolve(P,j)){return false;}l=l.replace(this.sServiceUrl+'/','');l=l.substring(0,l.indexOf("/"));l=this.sServiceUrl+'/'+l;k=P.substr(P.lastIndexOf("/")+1);D=this._getObject(t,j);if(!D){return false;}w=t.split("/");for(var i=w.length-1;i>=0;i--){E=this._getObject(w.join("/"),j);if(E){K=this._getKey(E);if(K){break;}}w.splice(i-1,1);}if(!K){K=this._getKey(j);}if(K){x[K]=true;}if(D._bCreate){D[k]=v;y=true;this.checkUpdate(false,A,x);}else{if(!this.sChangeKey){this.sChangeKey=l;}if(this.sChangeKey==l){D[k]=v;y=true;this.checkUpdate(false,A,x);}else{this.fireRejectChange({rejectedValue:v,oldValue:D[k]});}}return y;};s.prototype._isHeaderPrivate=function(H){switch(H.toLowerCase()){case"accept":case"accept-language":case"maxdataserviceversion":case"dataserviceversion":return true;case"x-csrf-token":return this.bTokenHandling;default:return false;}};s.prototype.setHeaders=function(H){var i={},t=this;if(H){q.each(H,function(j,k){if(t._isHeaderPrivate(j)){L.warning("Not allowed to modify private header: "+j);}else{i[j]=k;}});this.mCustomHeaders=i;}else{this.mCustomHeaders={};}if(this.oAnnotations){this.oAnnotations.setHeaders(this.mCustomHeaders);}};s.prototype.getHeaders=function(){return q.extend({},this.mCustomHeaders,this.oHeaders);};s.prototype._getHeader=function(i,H){var j;for(j in H){if(j.toLowerCase()===i.toLowerCase()){return H[j];}}return null;};s.prototype.hasPendingChanges=function(){return this.sChangeKey!=null;};s.prototype.updateBindings=function(i){this.checkUpdate(i);};s.prototype.forceNoCache=function(i){this.bCache=!i;};s.prototype.setTokenHandlingEnabled=function(t){this.bTokenHandling=t;};s.prototype.setUseBatch=function(i){this.bUseBatch=i;};s.prototype.formatValue=function(v,t){return O.formatValue(v,t);};s.prototype.deleteCreatedEntry=function(i){if(i){var P=i.getPath();delete this.mContexts[P];if(P.startsWith("/")){P=P.substr(1);}delete this.oRequestQueue[P];delete this.oData[P];}};s.prototype.createEntry=function(P,v){var E={},k,j,R;if(!P.startsWith("/")){P="/"+P;}var l=this.oMetadata._getEntityTypeByPath(P);if(!l){o(l,"No Metadata for collection "+P+" found");return undefined;}if(typeof v==="object"&&!Array.isArray(v)){E=v;}else{for(var i=0;i<l.property.length;i++){var t=l.property[i];var w=v&&v.indexOf(t.name)>-1;if(!v||w){E[t.name]=this._createPropertyValue(t.type);if(w){v.splice(v.indexOf(t.name),1);}}}if(v){o(v.length===0,"No metadata for the following properties found: "+v.join(","));}}E._bCreate=true;k=P.substring(1)+"('"+u()+"')";this.oData[k]=E;E.__metadata={type:""+l.entityType};j=this._createRequestUrl(P);R=this._createRequest(j,"POST",true,E);R.entityTypes={};R.entityTypes[l.entityType]=true;this.oRequestQueue[k]=R;return this.getContext("/"+k);};s.prototype._createPropertyValue=function(t){var T=this.oMetadata._splitName(t);var N=T.namespace;var j=T.name;if(N.toUpperCase()!=='EDM'){var k={};var l=this.oMetadata._getObjectMetadata("complexType",j,N);o(l,"Complex type "+t+" not found in the metadata !");for(var i=0;i<l.property.length;i++){var P=l.property[i];k[P.name]=this._createPropertyValue(P.type);}return k;}else{return this._getDefaultPropertyValue(j,N);}};s.prototype._getDefaultPropertyValue=function(t,N){return undefined;};s.prototype._normalizePath=function(P,i){if(P&&P.indexOf('?')!=-1){P=P.substr(0,P.indexOf('?'));}if(!i&&!P.startsWith("/")){P='/'+P;L.warning(this+" path "+P+" should be absolute if no Context is set");}return this.resolve(P,i);};s.prototype.setRefreshAfterChange=function(R){this.bRefreshAfterChange=R;};s.prototype.isList=function(P,i){var P=this.resolve(P,i);return P&&P.substr(P.lastIndexOf("/")).indexOf("(")===-1;};s.prototype.isMetaModelPath=function(P){return P.indexOf("##")==0||P.indexOf("/##")>-1;};s.prototype._request=function(R,S,E,H,i,j){if(this.bDestroyed){return{abort:function(){}};}var t=this;function w(l){return function(){if(t.aPendingRequestHandles){var I=t.aPendingRequestHandles.indexOf(k);if(I>-1){t.aPendingRequestHandles.splice(I,1);}}if(!(k&&k.bSuppressErrorHandlerCall)){l.apply(this,arguments);}};}var k=h.request(R,w(S||h.defaultSuccess),w(E||h.defaultError),H,i,j);if(R.async!==false){this.aPendingRequestHandles.push(k);}return k;};s.prototype.destroy=function(){this.bDestroyed=true;if(this.aPendingRequestHandles){for(var i=this.aPendingRequestHandles.length-1;i>=0;i--){var R=this.aPendingRequestHandles[i];if(R&&R.abort){R.bSuppressErrorHandlerCall=true;R.abort();}}delete this.aPendingRequestHandles;}if(!!this.oMetadataLoadEvent){clearTimeout(this.oMetadataLoadEvent);}if(!!this.oMetadataFailedEvent){clearTimeout(this.oMetadataFailedEvent);}if(this.oMetadata){this.oMetadata.detachLoaded(this.onMetadataLoaded);this.oMetadata.detachFailed(this.onMetadataFailed);if(!this.oMetadata.isLoaded()&&!this.oMetadata.hasListeners("loaded")){this.oMetadata.destroy();delete this.oServiceData.oMetadata;}delete this.oMetadata;}if(this.oAnnotations){this.oAnnotations.detachFailed(this.onAnnotationsFailed);this.oAnnotations.detachLoaded(this.onAnnotationsLoaded);this.oAnnotations.destroy();delete this.oAnnotations;delete this.pAnnotationsLoaded;}M.prototype.destroy.apply(this,arguments);};s.prototype._getAnnotationParser=function(A){if(!this.oAnnotations){var i=sap.ui.requireSync("sap/ui/model/odata/ODataAnnotations");this.oAnnotations=new i({annotationData:A,url:null,metadata:this.oMetadata,async:this.bLoadMetadataAsync,headers:this.mCustomHeaders});this.oAnnotations.attachFailed(this.onAnnotationsFailed,this);this.oAnnotations.attachLoaded(this.onAnnotationsLoaded,this);}return this.oAnnotations;};s.prototype.onAnnotationsFailed=function(E){this.fireAnnotationsFailed(E.getParameters());};s.prototype.onAnnotationsLoaded=function(E){this.fireAnnotationsLoaded(E.getParameters());};s.prototype.addAnnotationUrl=function(v){var j=[].concat(v),k=[],A=[],E=[],t=this;q.each(j,function(i,l){var I=l.indexOf("$metadata");if(I>=0){if(I==0){l=t.sServiceUrl+'/'+l;}k.push(l);}else{A.push(l);}});return this.oMetadata._addUrl(k).then(function(P){return Promise.all(q.map(P,function(i){E=E.concat(i.entitySets);return t.addAnnotationXML(i["metadataString"]);}));}).then(function(){return t._getAnnotationParser().addUrl(A);}).then(function(P){return{annotations:P.annotations,entitySets:E};});};s.prototype.addAnnotationXML=function(x,S){return new Promise(function(i,j){this._getAnnotationParser().setXML(null,x,{success:i,error:j,fireEvents:!S});}.bind(this));};s.prototype.getMetaModel=function(){var t=this;if(!this.oMetaModel){this.oMetaModel=new g(this.oMetadata,this.oAnnotations,this);this.oMetaModel.loaded().then(function(){t.bMetaModelLoaded=true;t.checkUpdate(false,false,null,true);});}return this.oMetaModel;};s.prototype.annotationsLoaded=function(){return this.oMetadata.isLoaded()&&(!this.oAnnotations||this.oAnnotations.isLoaded())?null:this.pAnnotationsLoaded;};return s;});
sap.ui.predefine('sap/ui/model/odata/ODataTreeBinding',['sap/ui/model/TreeBinding','./CountMode',"sap/base/Log","sap/ui/thirdparty/jquery"],function(T,C,L,q){"use strict";var O=T.extend("sap.ui.model.odata.ODataTreeBinding",{constructor:function(m,p,c,f,P){T.apply(this,arguments);this.bPendingRequest=false;this.oFinalLengths={};this.oLengths={};this.oKeys={};this.bNeedsUpdate=false;this.bHasTreeAnnotations=this._hasTreeAnnotations();this.oRootContext=null;this.iNumberOfExpandedLevels=P&&P.numberOfExpandedLevels;this.sCountMode=(P&&P.countMode)||this.oModel.sDefaultCountMode;if(!this.bHasTreeAnnotations){if(!P||!P.navigation){L.error("A navigation paths parameter object has to be defined");this.oNavigationPaths={};}else{this.oNavigationPaths=P.navigation;}}else{L.warning("Tree hierarchy annotations are deprecated and may not work correctly with the sap.ui.model.odata.ODataModel."+" Please use the sap.ui.model.odata.v2.ODataModel (since version 1.28) instead which fully supports hierarchy annotations.");}}});O.prototype.getRootContexts=function(s,l,t){var n=null,r={numberOfExpandedLevels:this.iNumberOfExpandedLevels},R=[],b=true,a=this;if(this.bHasTreeAnnotations){r.level=0;if(!this.bDisplayRootNode){r.level=1;}}else{n=this.oModel.resolve(this.getPath(),this.getContext());r.navPath=this._getNavPath(this.getPath());if(r.numberOfExpandedLevels>0){var A=n;for(var i=0;i<r.numberOfExpandedLevels;i++){var N=this._getNavPath(A);r.navPath+="/"+N;A+="/"+N;}}var I=this.oModel.isList(this.sPath,this.getContext());if(I){this.bDisplayRootNode=true;}else{b=false;this.oModel.createBindingContext(n,null,{expand:r.navPath},function(o){R=[o];if(a.oRootContext!==o){a.oRootContext=o;a._processODataObject(o.getObject(),n,r.navPath);a.bNeedsUpdate=true;}},this.bRefresh);this.bRefresh=false;}}if(b){if(!this.bDisplayRootNode){R=this._getContextsForNodeId(n,0,1,0,r);}else{R=this._getContextsForNodeId(n,s,l,t,r);}}if(!this.bDisplayRootNode&&R.length>0){this.oRootContext=R[0];R=this.getNodeContexts(R[0],s,l,t);}return R;};O.prototype.getNodeContexts=function(c,s,l,t){var n,r={};if(this.bHasTreeAnnotations){var d=c.getProperty(this.oTreeProperties["hierarchy-drill-state-for"]);if(d=="leaf"){return[];}n=c.getProperty(this.oTreeProperties["hierarchy-node-for"]);r.level=parseInt(c.getProperty(this.oTreeProperties["hierarchy-level-for"]))+1;}else{var N=this._getNavPath(c.getPath());if(!N){return[];}n=this.oModel.resolve(N,c);r.navPath=this.oNavigationPaths[N];}return this._getContextsForNodeId(n,s,l,t,r);};O.prototype.hasChildren=function(c){if(!c){return false;}if(this.bHasTreeAnnotations){var d=c.getProperty(this.oTreeProperties["hierarchy-drill-state-for"]);return d==="expanded"||d==="collapsed";}else{var n=this._getNavPath(c.getPath());var p=c.getPath()+"/"+n;return n&&this.oLengths[p]>0;}};O.prototype.getChildCount=function(c){if(this.bHasTreeAnnotations){var h;if(!c){if(this.oRootContext){h=this.oRootContext.getProperty(this.oTreeProperties["hierarchy-node-for"]);}else{h="000000";}}else{h=c.getProperty(this.oTreeProperties["hierarchy-node-for"]);}return this.oLengths[h];}else{if(!c){return this.oLengths[this.getPath()];}return this.oLengths[c.getPath()+"/"+this._getNavPath(c.getPath())];}};O.prototype._getContextsForNodeId=function(n,s,l,t,p){var c=[],b,k;if(!s){s=0;}if(!l){l=this.oModel.iSizeLimit;}if(!t){t=0;}if(this.bHasTreeAnnotations){if(n==null){n="000000";}if(p.level==0){p.level++;}}if(this.oFinalLengths[n]&&this.oLengths[n]<l){l=this.oLengths[n];}if(this.oKeys[n]){for(var i=s;i<s+l;i++){k=this.oKeys[n][i];if(!k){break;}c.push(this.oModel.getContext('/'+k));}}b=c.length!=l&&!(this.oFinalLengths[n]&&c.length>=this.oLengths[n]);if(this.oModel.getServiceMetadata()){if(!this.bPendingRequest&&b){var P=[];if(this.bHasTreeAnnotations){if(p.numberOfExpandedLevels>0){var a=p.level+p.numberOfExpandedLevels;P.push("$filter="+this.oTreeProperties["hierarchy-level-for"]+" le '0"+a+"'");}else{P.push("$filter="+this.oTreeProperties["hierarchy-level-for"]+" eq '0"+p.level+"' and "+this.oTreeProperties["hierarchy-parent-node-for"]+" eq '"+n+"'");}}else{if(p.navPath){P.push("$expand="+p.navPath);}}this._loadSubNodes(n,s,l,t,P,p);}}return c;};O.prototype._getCountForNodeId=function(n,s,l,t,p){var a=this;var P=[];function _(d){a.oFinalLengths[n]=true;a.oLengths[n]=parseInt(d);}function b(e){var E="Request for $count failed: "+e.message;if(e.response){E+=", "+e.response.statusCode+", "+e.response.statusText+", "+e.response.body;}L.warning(E);}var c;if(this.bHasTreeAnnotations){c=this.oModel.resolve(this.getPath(),this.getContext());P.push("$filter="+this.oTreeProperties["hierarchy-parent-node-for"]+" eq '"+n+"'");}else{c=n;}if(c){var u=this.oModel._createRequestUrl(c+"/$count",null,P);var r=this.oModel._createRequest(u,"GET",false);r.headers["Accept"]="text/plain, */*;q=0.5";this.oModel._request(r,_,b,undefined,undefined,this.oModel.getServiceMetadata());}};O.prototype._loadSubNodes=function(n,s,l,t,p,P){var a=this,I=false;if(s||l){p.push("$skip="+s+"&$top="+l);}if(!a.bHasTreeAnnotations&&!this.oFinalLengths[n]&&(this.sCountMode==C.Inline||this.sCountMode==C.Both)){p.push("$inlinecount=allpages");I=true;}function S(d){if(d.results){if(!a.bHasTreeAnnotations){if(I&&d.__count){a.oLengths[n]=parseInt(d.__count);a.oFinalLengths[n]=true;}else{if(a.oModel.isCountSupported()){a._getCountForNodeId(n);}}a.oKeys[n]=[];for(var i=0;i<d.results.length;i++){var E=d.results[i];var k=a.oModel._getKey(E);a._processODataObject(E,"/"+k,P.navPath);a.oKeys[n][i+s]=k;}}else{var m={};for(var i=0;i<d.results.length;i++){var E=d.results[i];n=E[a.oTreeProperties["hierarchy-parent-node-for"]];if(i==0){m[n]=s;}else if(m[n]==undefined){m[n]=0;}if(!(n in a.oKeys)){a.oKeys[n]=[];a._getCountForNodeId(n);}a.oKeys[n][m[n]]=a.oModel._getKey(E);m[n]++;}}}else{a.oKeys[null]=a.oModel._getKey(d);if(!a.bHasTreeAnnotations){a._processODataObject(d,n,P.navPath);}}a.oRequestHandle=null;a.bPendingRequest=false;a.bNeedsUpdate=true;}function c(){a.fireDataReceived();}function e(d){a.oRequestHandle=null;a.bPendingRequest=false;a.fireDataReceived();}function u(h){a.oRequestHandle=h;}if(n){if(!this.oFinalLengths[n]){this.bPendingRequest=true;this.fireDataRequested();var A;if(this.bHasTreeAnnotations){A=this.oModel.resolve(this.getPath(),this.getContext());}else{A=n;}this.oModel._loadData(A,p,S,e,false,u,c);}}};O.prototype.resetData=function(c){if(c){var p=c.getPath();delete this.oKeys[p];delete this.oLengths[p];delete this.oFinalLengths[p];}else{this.oKeys={};this.oLengths={};this.oFinalLengths={};this.oRootContext=null;}};O.prototype.refresh=function(f,c,e){var b=false;if(!f){if(e){var r=this.oModel.resolve(this.sPath,this.oContext);var E=this.oModel.oMetadata._getEntityTypeByPath(r);if(E&&(E.entityType in e)){b=true;}}if(c&&!b){q.each(this.oKeys,function(i,n){q.each(n,function(i,k){if(k in c){b=true;return false;}});if(b){return false;}});}if(!c&&!e){b=true;}}if(f||b){this.resetData();this.bNeedsUpdate=false;this.bRefresh=true;this._fireChange();}};O.prototype.filter=function(f){L.warning("Filtering is currently not possible in the ODataTreeBinding");return this;};O.prototype.checkUpdate=function(f,c){var b=false;if(!f){if(this.bNeedsUpdate||!c){b=true;}else{q.each(this.oKeys,function(i,n){q.each(n,function(i,k){if(k in c){b=true;return false;}});if(b){return false;}});}}if(f||b){this.bNeedsUpdate=false;this._fireChange();}};O.prototype._getNavPath=function(p){var a=this.oModel.resolve(p,this.getContext());if(!a){return;}var P=a.split("/"),e=P[P.length-1],n;var c=e.split("(")[0];if(c&&this.oNavigationPaths[c]){n=this.oNavigationPaths[c];}return n;};O.prototype._processODataObject=function(o,p,n){var N=[],t=this;if(n&&n.indexOf("/")>-1){N=n.split("/");n=N[0];N.splice(0,1);}var r=this.oModel._getObject(p);if(Array.isArray(r)){this.oKeys[p]=r;this.oLengths[p]=r.length;this.oFinalLengths[p]=true;}if(n&&o[n]){if(Array.isArray(r)){r.forEach(function(R){var o=t.getModel().getData("/"+R);t._processODataObject(o,"/"+R+"/"+n,N.join("/"));});}else if(typeof r==="object"){t._processODataObject(o,p+"/"+n,N.join("/"));}}};O.prototype._hasTreeAnnotations=function(){var m=this.oModel,M=m.oMetadata,a=m.resolve(this.getPath(),this.getContext()),e=M._getEntityTypeByPath(a),t=M.mNamespaces["sap"],b=this;this.oTreeProperties={"hierarchy-level-for":false,"hierarchy-parent-node-for":false,"hierarchy-node-for":false,"hierarchy-drill-state-for":false};if(!e){L.fatal("EntityType for path "+a+" could not be found.");return false;}q.each(e.property,function(i,p){if(!p.extensions){return true;}q.each(p.extensions,function(i,E){var n=E.name;if(E.namespace===t&&n in b.oTreeProperties&&!b.oTreeProperties[n]){b.oTreeProperties[n]=p.name;}});});var c=false;q.each(this.oTreeProperties,function(i,o){if(!o){c=true;return false;}});return!c;};return O;});
/*!
 * SAPUI5

(c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.predefine('sap/suite/ui/microchart/AreaMicroChart',["sap/ui/thirdparty/jquery","./library","sap/ui/core/Control","sap/ui/Device","sap/m/FlexBox","sap/suite/ui/microchart/MicroChartUtils","sap/base/Log","sap/ui/events/KeyCodes","sap/ui/core/theming/Parameters","sap/m/library","sap/ui/core/ResizeHandler","./AreaMicroChartRenderer"],function(q,l,C,D,F,M,L,K,P,b,R){"use strict";var V=b.ValueColor;var S=b.Size;var A=l.AreaMicroChartViewType;var c=C.extend("sap.suite.ui.microchart.AreaMicroChart",{metadata:{library:"sap.suite.ui.microchart",properties:{size:{type:"sap.m.Size",group:"Misc",defaultValue:"Auto"},width:{type:"sap.ui.core.CSSSize",group:"Misc"},height:{type:"sap.ui.core.CSSSize",group:"Misc"},maxXValue:{type:"float",group:"Misc",defaultValue:null},minXValue:{type:"float",group:"Misc",defaultValue:null},maxYValue:{type:"float",group:"Misc",defaultValue:null},minYValue:{type:"float",group:"Misc",defaultValue:null},view:{type:"sap.suite.ui.microchart.AreaMicroChartViewType",group:"Appearance",defaultValue:"Normal"},colorPalette:{type:"string[]",group:"Appearance",defaultValue:[]},showLabel:{type:"boolean",group:"Misc",defaultValue:true},isResponsive:{type:"boolean",group:"Appearance",defaultValue:false},hideOnNoData:{type:"boolean",group:"Appearance",defaultValue:false}},associations:{ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{press:{}},defaultAggregation:"lines",aggregations:{chart:{multiple:false,type:"sap.suite.ui.microchart.AreaMicroChartItem",bindable:"bindable"},maxThreshold:{multiple:false,type:"sap.suite.ui.microchart.AreaMicroChartItem"},innerMaxThreshold:{multiple:false,type:"sap.suite.ui.microchart.AreaMicroChartItem"},innerMinThreshold:{multiple:false,type:"sap.suite.ui.microchart.AreaMicroChartItem"},minThreshold:{multiple:false,type:"sap.suite.ui.microchart.AreaMicroChartItem"},target:{multiple:false,type:"sap.suite.ui.microchart.AreaMicroChartItem",bindable:"bindable"},firstXLabel:{multiple:false,type:"sap.suite.ui.microchart.AreaMicroChartLabel"},firstYLabel:{multiple:false,type:"sap.suite.ui.microchart.AreaMicroChartLabel"},lastXLabel:{multiple:false,type:"sap.suite.ui.microchart.AreaMicroChartLabel"},lastYLabel:{multiple:false,type:"sap.suite.ui.microchart.AreaMicroChartLabel"},maxLabel:{multiple:false,type:"sap.suite.ui.microchart.AreaMicroChartLabel"},minLabel:{multiple:false,type:"sap.suite.ui.microchart.AreaMicroChartLabel"},lines:{multiple:true,type:"sap.suite.ui.microchart.AreaMicroChartItem",bindable:"bindable"}}}});c.THRESHOLD_LOOK_XS=1.125;c.THRESHOLD_LOOK_S=3.5;c.THRESHOLD_LOOK_M=4.5;c.THRESHOLD_LOOK_L=5.875;c.THRESHOLD_WIDTH_NO_LABEL=6;c.THRESHOLD_WIDE_HEIGHT_NO_LABEL=2.25;c.ITEM_NEUTRAL_COLOR="sapSuiteAMCSemanticColorNeutral";c.ITEM_NEUTRAL_NOTHRESHOLD_CSSCLASS="sapSuiteAMCNeutralNoThreshold";c._CHARTITEM_AGGREGATIONS=["chart","target","minThreshold","maxThreshold","innerMinThreshold","innerMaxThreshold"];c.prototype.init=function(){this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.microchart");this.setAggregation("tooltip","((AltText))",true);this._bThemeApplied=true;if(!sap.ui.getCore().isInitialized()){this._bThemeApplied=false;sap.ui.getCore().attachInit(this._handleCoreInitialized.bind(this));}else{this._handleCoreInitialized();}};c.prototype._handleCoreInitialized=function(){this._bThemeApplied=sap.ui.getCore().isThemeApplied();sap.ui.getCore().attachThemeChanged(this._handleThemeApplied,this);sap.ui.getCore().attachLocalizationChanged(this._handleThemeApplied,this);};c.prototype._handleThemeApplied=function(){this._bThemeApplied=true;this.invalidate();};c.prototype._getCssValues=function(){this._$CssHelper.className=Array.prototype.slice.call(arguments).join(" ");var s=window.getComputedStyle(this._$CssHelper);if(!s.backgroundColor){s.backgroundColor=s["background-color"];}if(!s.outlineStyle){s.outlineStyle=s["outline-style"];}if(!s.outlineWidth){s.outlineWidth=s["outline-width"];}return s;};c.prototype.__fillThresholdArea=function(a,p,d,e){a.beginPath();a.moveTo(p[0].x,p[0].y);for(var i=1,f=p.length;i<f;i++){a.lineTo(p[i].x,p[i].y);}for(var j=d.length-1;j>=0;j--){a.lineTo(d[j].x,d[j].y);}a.closePath();a.fillStyle="white";a.fill();a.fillStyle=e;a.fill();a.lineWidth=1;a.strokeStyle="white";a.stroke();a.strokeStyle=e;a.stroke();};c.prototype._renderDashedLine=function(a,p,d){if(a.setLineDash){a.setLineDash(d);this._renderLine(a,p);a.setLineDash([]);}else{a.beginPath();for(var i=0,e=p.length-1;i<e;i++){a._dashedLine(p[i].x,p[i].y,p[i+1].x,p[i+1].y,d);}a.stroke();}};c.prototype._renderLine=function(a,p){a.beginPath();a.moveTo(p[0].x,p[0].y);for(var i=1,d=p.length;i<d;i++){a.lineTo(p[i].x,p[i].y);}a.stroke();};c.prototype._getItemColor=function(a,t){var i;if(t&&this.getTarget()){i="sapSuiteAMCSemanticColor"+this.getTarget().getColor();}else if(!t&&this.getChart()){i="sapSuiteAMCSemanticColor"+this.getChart().getColor();}if((i===c.ITEM_NEUTRAL_COLOR)&&!this._isThresholdPresent(a)){return c.ITEM_NEUTRAL_NOTHRESHOLD_CSSCLASS;}else{return i;}};c.prototype._isThresholdPresent=function(a){var t=[a.minThreshold.length,a.maxThreshold.length,a.innerMinThreshold.length,a.innerMaxThreshold.length];for(var i=0;i<t.length;i++){if(t[i]>1){return true;}}return false;};c.prototype._renderTarget=function(a,d){if(d.target.length>1){var s=this._getItemColor(d,true);var o=this._getCssValues("sapSuiteAMCTarget",s);a.strokeStyle=o.color;a.lineWidth=parseFloat(o.width);if(o.outlineStyle=="dotted"){this._renderDashedLine(a,d.target,[parseFloat(o.outlineWidth),3]);}else{this._renderLine(a,d.target,d);}}else if(d.target.length==1){L.warning("Target is not rendered because only 1 point was given");}};c.prototype._renderThresholdLine=function(a,p){if(p&&p.length){var s=this._getCssValues("sapSuiteAMCThreshold");a.strokeStyle=s.color;a.lineWidth=s.width;this._renderLine(a,p);}};c.prototype._fillMaxThreshold=function(a,d){if(d.maxThreshold.length>1){var s=this._getCssValues("sapSuiteAMCThreshold","sapSuiteAMCSemanticColor"+this.getMaxThreshold().getColor());this.__fillThresholdArea(a,d.maxThreshold,[{x:d.maxThreshold[0].x,y:d.minY},{x:d.maxThreshold[d.maxThreshold.length-1].x,y:d.minY}],s.backgroundColor);this._renderThresholdLine(a,d.maxThreshold,d);}else if(d.maxThreshold.length==1){L.warning("Max Threshold is not rendered because only 1 point was given");}};c.prototype._fillMinThreshold=function(a,d){if(d.minThreshold.length>1){var s=this._getCssValues("sapSuiteAMCThreshold","sapSuiteAMCSemanticColor"+this.getMinThreshold().getColor());this.__fillThresholdArea(a,d.minThreshold,[{x:d.minThreshold[0].x,y:d.maxY},{x:d.minThreshold[d.minThreshold.length-1].x,y:d.maxY}],s.backgroundColor);}else if(d.minThreshold.length==1){L.warning("Min Threshold is not rendered because only 1 point was given");}};c.prototype._fillThresholdArea=function(a,d){if(d.minThreshold.length>1&&d.maxThreshold.length>1){var s=this._getCssValues("sapSuiteAMCThreshold","sapSuiteAMCSemanticColorCritical");this.__fillThresholdArea(a,d.maxThreshold,d.minThreshold,s.backgroundColor);}};c.prototype._fillInnerThresholdArea=function(a,d){if(d.innerMinThreshold.length>1&&d.innerMaxThreshold.length>1){var s=this._getCssValues("sapSuiteAMCThreshold","sapSuiteAMCSemanticColor"+this.getInnerMaxThreshold().getColor());this.__fillThresholdArea(a,d.innerMaxThreshold,d.innerMinThreshold,s.backgroundColor);}else if(d.innerMinThreshold.length||d.innerMaxThreshold.length){L.warning("Inner threshold area is not rendered because inner min and max threshold were not correctly set");}};c.prototype._renderChart=function(a,d){if(d.chart.length>1){var s=this._getItemColor(d);var o=this._getCssValues("sapSuiteAMCChart",s);a.strokeStyle=o.color;a.lineWidth=parseFloat(o.width);this._renderLine(a,d.chart,d);}else if(d.chart.length==1){L.warning("Actual values are not rendered because only 1 point was given");}};c.prototype._renderLines=function(a,d){var e=this.getColorPalette().length,f=0,s=this._getCssValues("sapSuiteAMCLine"),g=d.lines.length;var n=function(h){if(e){if(f===e){f=0;}h=this.getColorPalette()[f++].trim();}if(V[h]){s=this._getCssValues("sapSuiteAMCLine","sapSuiteAMCSemanticColor"+h);return s.color;}return P.get(h)||h;}.bind(this);a.lineWidth=parseFloat(s.width);for(var i=0;i<g;i++){if(d.lines[i].length>1){a.strokeStyle=n(this.getLines()[i].getColor());this._renderLine(a,d.lines[i],d);}}};c.prototype._renderCanvas=function(){var o=this.getDomRef("canvas");if(!this._hasData()||!o){return;}this._$CssHelper=this.getDomRef("css-helper");var $=this.$();var a=window.getComputedStyle(o);var w=parseFloat(a.width);o.setAttribute("width",w||360);var h=parseFloat(a.height);o.setAttribute("height",h||242);var r=o.getContext("2d");r.lineJoin="round";r._dashedLine=this._drawDashedLine;var d=this._calculateDimensions(o.width,o.height);if(this._isThresholdPresent(d)){$.find(".sapSuiteAMCCanvasContainer").addClass("sapSuiteAMCWithThreshold");}this._fillMaxThreshold(r,d);this._fillMinThreshold(r,d);this._fillThresholdArea(r,d);this._renderThresholdLine(r,d.minThreshold,d);this._renderThresholdLine(r,d.maxThreshold,d);this._fillInnerThresholdArea(r,d);this._renderThresholdLine(r,d.innerMinThreshold,d);this._renderThresholdLine(r,d.innerMaxThreshold,d);this._renderTarget(r,d);this._renderChart(r,d);this._renderLines(r,d);};c.prototype._drawDashedLine=function(x,y,a,d,e){var f=e.length;this.moveTo(x,y);var g=(a-x),h=(d-y),s=g?h/g:1e15,r=Math.sqrt(g*g+h*h),i=0,j=true;while(r>=0.1){var k=e[i++%f];if(k>r){k=r;}var m=Math.sqrt(k*k/(1+s*s));if(g<0){m=-m;}x+=m;y+=s*m;this[j?"lineTo":"moveTo"](x,y);r-=k;j=!j;}};c.prototype._calculateDimensions=function(w,h){var m,f,d,e;function g(){if(!this._isMinXValue||!this._isMaxXValue||!this._isMinYValue||!this._isMaxYValue){var u=this.getLines();if(this.getMaxThreshold()){u.push(this.getMaxThreshold());}if(this.getMinThreshold()){u.push(this.getMinThreshold());}if(this.getChart()){u.push(this.getChart());}if(this.getTarget()){u.push(this.getTarget());}if(this.getInnerMaxThreshold()){u.push(this.getInnerMaxThreshold());}if(this.getInnerMinThreshold()){u.push(this.getInnerMinThreshold());}for(var i=0,v=u.length;i<v;i++){var x=u[i].getPoints();for(var k=0,a=x.length;k<a;k++){var y=x[k].getXValue();if(y>m||m===undefined){m=y;}if(y<d||d===undefined){d=y;}var z=x[k].getYValue();if(z>f||f===undefined){f=z;}if(z<e||e===undefined){e=z;}}}}if(this._isMinXValue){d=this.getMinXValue();}if(this._isMaxXValue){m=this.getMaxXValue();}if(this._isMinYValue){e=this.getMinYValue();}if(this._isMaxYValue){f=this.getMaxYValue();}}g.call(this);var r={minY:0,minX:0,maxY:h,maxX:w,lines:[]};var j;var n=m-d;if(n>0){j=w/n;}else if(n==0){j=0;r.maxX/=2;}else{L.warning("Min X is greater than max X.");}var o;var p=f-e;if(p>0){o=h/(f-e);}else if(p==0){o=0;r.maxY/=2;}else{L.warning("Min Y is greater than max Y.");}function s(a){var k=sap.ui.getCore().getConfiguration().getRTL();var u=function(N){var x=j*(N-d);if(k){x=r.maxX-x;}return x;};var v=function(x){return r.maxY-o*(x-e);};var y=[];if(a&&j!==undefined&&o!==undefined){var z=a.getPoints();var t=z.length;var B,E,G,H;if(t==1){G=z[0].getXValue();H=z[0].getYValue();if(G==undefined^H==undefined){var I,J;if(G==undefined){J=E=v(H);B=r.minX;I=r.maxX;}else{I=B=u(G);E=r.minY;J=r.maxY;}y.push({x:B,y:E},{x:I,y:J});}else{L.warning("Point with coordinates ["+G+" "+H+"] ignored");}}else{for(var i=0;i<t;i++){G=z[i].getXValue();H=z[i].getYValue();if(G!=undefined&&H!=undefined){B=u(G);E=v(H);y.push({x:B,y:E});}else{L.warning("Point with coordinates ["+G+" "+H+"] ignored");}}}}return y;}r.maxThreshold=s(this.getMaxThreshold());r.minThreshold=s(this.getMinThreshold());r.chart=s(this.getChart());r.target=s(this.getTarget());r.innerMaxThreshold=s(this.getInnerMaxThreshold());r.innerMinThreshold=s(this.getInnerMinThreshold());var t=this.getLines().length;for(var i=0;i<t;i++){r.lines.push(s(this.getLines()[i]));}return r;};c.prototype.setMinXValue=function(v,s){this._isMinXValue=this._isNumber(v);return this.setProperty("minXValue",this._isMinXValue?v:NaN,s);};c.prototype.setMaxXValue=function(v,s){this._isMaxXValue=this._isNumber(v);return this.setProperty("maxXValue",this._isMaxXValue?v:NaN,s);};c.prototype.setMinYValue=function(v,s){this._isMinYValue=this._isNumber(v);return this.setProperty("minYValue",this._isMinYValue?v:NaN,s);};c.prototype.setMaxYValue=function(v,s){this._isMaxYValue=this._isNumber(v);return this.setProperty("maxYValue",this._isMaxYValue?v:NaN,s);};c.prototype._isNumber=function(n){return typeof n==="number"&&!isNaN(n)&&isFinite(n);};c.prototype.onBeforeRendering=function(){if(this._bUseIndex){this._indexChartItems();}if(this._sChartResizeHandlerId){R.deregister(this._sChartResizeHandlerId);}this._unbindMouseEnterLeaveHandler();};c.prototype.onAfterRendering=function(){l._checkControlIsVisible(this,this._onControlIsVisible);this._bindMouseEnterLeaveHandler();};c.prototype.setSize=function(s){if(this.getSize()!==s){if(s===S.Responsive){this.setProperty("isResponsive",true);}else{this.setProperty("isResponsive",false);}this.setProperty("size",s);}return this;};c.prototype.setIsResponsive=function(i){var s,a=this.getSize();this.setProperty("isResponsive",i);if(i){s=S.Responsive;}else{s=a===S.Responsive?S.Auto:a;}this.setProperty("size",s);return this;};c.prototype._onControlIsVisible=function(){this._onResize();this._sChartResizeHandlerId=R.register(this,this._onResize.bind(this));};c.prototype._indexChartItems=function(){var o,n=c._CHARTITEM_AGGREGATIONS.length;for(var i=0;i<n;i++){o=this.getAggregation(c._CHARTITEM_AGGREGATIONS[i]);if(o){this._indexChartItemPoints(o);}}};c.prototype._indexChartItemPoints=function(a){var p=a.getPoints();for(var i=0;i<p.length;i++){p[i].setProperty("x",i,true);}};c.prototype.enableXIndexing=function(u){this._bUseIndex=u;};c.prototype._onResize=function(){var $=this.$(),i=parseInt($.width()),a=parseInt($.height()),m=$.find(".sapSuiteAMCPositionCenter"),t=$.find(".sapSuiteAMCPositionTop .sapSuiteAMCPositionLeft, .sapSuiteAMCPositionTop .sapSuiteAMCPositionRight,"+".sapSuiteAMCSideLabels .sapSuiteAMCLbl:first-child");$.removeClass("sapSuiteAMCNoLabels sapSuiteAMCLookM sapSuiteAMCLookS sapSuiteAMCLookXS sapSuiteAMCNoMinMaxLabels sapSuiteAMCNoTopLabels");if(i<=this.convertRemToPixels(c.THRESHOLD_WIDTH_NO_LABEL)){$.addClass("sapSuiteAMCNoLabels");}if(a<this.convertRemToPixels(c.THRESHOLD_WIDE_HEIGHT_NO_LABEL)){$.addClass("sapSuiteAMCLookXS");}else if(a<this.convertRemToPixels(c.THRESHOLD_LOOK_S)&&this.getView()===A.Normal){$.addClass("sapSuiteAMCLookXS");}else if(a<this.convertRemToPixels(c.THRESHOLD_LOOK_M)){$.addClass("sapSuiteAMCLookS");}else if(a<this.convertRemToPixels(c.THRESHOLD_LOOK_L)){$.addClass("sapSuiteAMCLookM");}if(this._isAnyLabelTruncated(t)||this._isAnyLabelVerticallyTruncated(t)){$.addClass("sapSuiteAMCNoMinMaxLabels");if(this._isAnyLabelTruncated(t)){$.removeClass("sapSuiteAMCNoMinMaxLabels");$.addClass("sapSuiteAMCNoTopLabels");}}if(this._isAnyLabelTruncated(m)){$.addClass("sapSuiteAMCNoMinMaxLabels");}this._renderCanvas();};c.prototype._isLabelTruncated=function(a){var s;if(D.browser.msie||D.browser.edge){s=1;}else{s=0;}return a.offsetWidth<a.scrollWidth-s;};c.prototype.ontap=function(e){if(D.browser.msie){this.$().trigger("focus");}this.firePress();};c.prototype.onkeydown=function(e){if(e.which==K.SPACE){e.preventDefault();}};c.prototype.onkeyup=function(e){if(e.which==K.ENTER||e.which==K.SPACE){this.firePress();e.preventDefault();}};c.prototype.attachEvent=function(){C.prototype.attachEvent.apply(this,arguments);if(this.hasListeners("press")){this.$().attr("tabindex",0).addClass("sapSuiteUiMicroChartPointer");}return this;};c.prototype.detachEvent=function(){C.prototype.detachEvent.apply(this,arguments);if(!this.hasListeners("press")){this.$().removeAttr("tabindex").removeClass("sapSuiteUiMicroChartPointer");}return this;};c.prototype._getLocalizedColorMeaning=function(a){return V[a]?this._oRb.getText(("SEMANTIC_COLOR_"+a).toUpperCase()):"";};c.prototype._getAltHeaderText=function(I){var a=this._oRb.getText("AREAMICROCHART");if(I){a+=" "+this._oRb.getText("IS_ACTIVE");}if(!this._hasData()){a+="\n"+this._oRb.getText("NO_DATA");return a;}var f=this.getFirstXLabel();var o=this.getFirstYLabel();var d=this.getLastXLabel();var e=this.getLastYLabel();var m=this.getMinLabel();var g=this.getMaxLabel();var h=this.getChart();var t=this.getTarget();if(f&&f.getLabel()||o&&o.getLabel()){a+="\n"+this._oRb.getText(("AREAMICROCHART_START"))+": "+(f?f.getLabel():"")+" "+(o?o.getLabel()+" "+this._getLocalizedColorMeaning(o.getColor()):"");}if(d&&d.getLabel()||e&&e.getLabel()){a+="\n"+this._oRb.getText(("AREAMICROCHART_END"))+": "+(d?d.getLabel():"")+" "+(e?e.getLabel()+" "+this._getLocalizedColorMeaning(e.getColor()):"");}if(m&&m.getLabel()){a+="\n"+this._oRb.getText(("AREAMICROCHART_MINIMAL_VALUE"))+": "+m.getLabel()+" "+this._getLocalizedColorMeaning(m.getColor());}if(g&&g.getLabel()){a+="\n"+this._oRb.getText(("AREAMICROCHART_MAXIMAL_VALUE"))+": "+g.getLabel()+" "+this._getLocalizedColorMeaning(g.getColor());}if(h&&h.getPoints()&&h.getPoints().length>0){a+="\n"+this._oRb.getText(("AREAMICROCHART_ACTUAL_VALUES"))+":";var k=h.getPoints();for(var i=0;i<k.length;i++){a+=" "+k[i].getY();}}if(t&&t.getPoints()&&t.getPoints().length>0){a+="\n"+this._oRb.getText(("AREAMICROCHART_TARGET_VALUES"))+":";var T=t.getPoints();for(var j=0;j<T.length;j++){a+=" "+T[j].getY();}}return a;};c.prototype._getAltSubText=function(i){var a="";for(var k=0;k<this.getLines().length;k++){var o=this.getLines()[k],s=o.getTooltip_AsString(),d="",t="";if(!s){continue;}if(o.getPoints()&&o.getPoints().length>0){t+=(i?"":"\n")+(o.getTitle()?o.getTitle():this._oRb.getText("AREAMICROCHART_LINE",[k+1]))+":";var e=o.getPoints();for(var y=0;y<e.length;y++){d+=" "+e[y].getY();}if(this.getColorPalette().length===0){d+=" "+this._getLocalizedColorMeaning(o.getColor());}}d=s.split("((AltText))").join(d);if(d){a+=t+d;i=false;}}return a;};c.prototype._getAccessibilityControlType=function(){return this._oRb.getText("ACC_CTR_TYPE_AREAMICROCHART");};c.prototype.clone=function(){var o=C.prototype.clone.apply(this,arguments);o._isMinXValue=this._isMinXValue;o._isMaxXValue=this._isMaxXValue;o._isMinYValue=this._isMinYValue;o._isMaxYValue=this._isMaxYValue;return o;};c.prototype.exit=function(){R.deregister(this._sChartResizeHandlerId);sap.ui.getCore().detachThemeChanged(this._handleThemeApplied,this);sap.ui.getCore().detachLocalizationChanged(this._handleThemeApplied,this);};c.prototype._addTitleAttribute=function(){if(!this.$().attr("title")&&this._hasData()){this.$().attr("title",this.getTooltip_AsString());}};c.prototype._removeTitleAttribute=function(){if(this.$().attr("title")){this.$().removeAttr("title");}};c.prototype._bindMouseEnterLeaveHandler=function(){if(!this._oMouseEnterLeaveHandler){this._oMouseEnterLeaveHandler={mouseEnterChart:this._addTitleAttribute.bind(this),mouseLeaveChart:this._removeTitleAttribute.bind(this)};}this.$().on("mouseenter",this._oMouseEnterLeaveHandler.mouseEnterChart);this.$().on("mouseleave",this._oMouseEnterLeaveHandler.mouseLeaveChart);};c.prototype._unbindMouseEnterLeaveHandler=function(){if(this._oMouseEnterLeaveHandler){this.$().off("mouseenter",this._oMouseEnterLeaveHandler.mouseEnterChart);this.$().off("mouseleave",this._oMouseEnterLeaveHandler.mouseLeaveChart);}};c.prototype._hasData=function(){return this.getLines().length>0||!!this.getChart();};c.prototype.firePress=function(){if(this._hasData()){C.prototype.fireEvent.call(this,"press",arguments);}};M.extendMicroChart(c);return c;});
sap.ui.predefine('sap/suite/ui/microchart/AreaMicroChartItem',["./library","sap/ui/core/Element"],function(l,E){"use strict";var A=E.extend("sap.suite.ui.microchart.AreaMicroChartItem",{metadata:{library:"sap.suite.ui.microchart",properties:{color:{group:"Misc",type:"sap.m.ValueCSSColor",defaultValue:"Neutral"},title:{type:"string",group:"Misc",defaultValue:null}},defaultAggregation:"points",aggregations:{"points":{multiple:true,type:"sap.suite.ui.microchart.AreaMicroChartPoint",bindable:"bindable"}}}});A.prototype.init=function(){this.setAggregation("tooltip","((AltText))",true);};return A;});
sap.ui.predefine('sap/suite/ui/microchart/AreaMicroChartLabel',['./library','sap/ui/core/Element'],function(l,E){"use strict";var A=E.extend("sap.suite.ui.microchart.AreaMicroChartLabel",{metadata:{library:"sap.suite.ui.microchart",properties:{color:{group:"Misc",type:"sap.m.ValueCSSColor",defaultValue:"Neutral"},label:{type:"string",group:"Misc",defaultValue:""}}}});return A;});
sap.ui.predefine('sap/suite/ui/microchart/AreaMicroChartPoint',['./library','sap/ui/core/Element'],function(l,E){"use strict";var A=E.extend("sap.suite.ui.microchart.AreaMicroChartPoint",{metadata:{library:"sap.suite.ui.microchart",properties:{x:{type:"float",group:"Misc",defaultValue:null},y:{type:"float",group:"Misc",defaultValue:null}}}});A.prototype.setX=function(v,s){this._isXValue=this._isNumber(v);return this.setProperty("x",this._isXValue?v:NaN,s);};A.prototype.setY=function(v,s){this._isYValue=this._isNumber(v);return this.setProperty("y",this._isYValue?v:NaN,s);};A.prototype.getXValue=function(){return this._isXValue?this.getX():undefined;};A.prototype.getYValue=function(){return this._isYValue?this.getY():undefined;};A.prototype._isNumber=function(n){return typeof n=='number'&&!isNaN(n)&&isFinite(n);};A.prototype.clone=function(i,L,o){var c=E.prototype.clone.apply(this,arguments);c._isXValue=this._isXValue;c._isYValue=this._isYValue;return c;};return A;});
sap.ui.predefine('sap/suite/ui/microchart/AreaMicroChartRenderer',["./library","sap/suite/ui/microchart/MicroChartRenderUtils"],function(l,M){"use strict";var A=l.AreaMicroChartViewType;var a={apiVersion:2};a.render=function(r,c){if(!c._bThemeApplied){return;}if(c._hasData()){var w=c.getView()===A.Wide;var s=c.getShowLabel();var S=(s&&((!w&&(c.getFirstYLabel()||c.getLastYLabel()))||c.getMaxLabel()));var b=(s&&((!w&&(c.getFirstXLabel()||c.getLastXLabel()))||c.getMinLabel()));var d=(s&&w&&(c.getFirstYLabel()||c.getFirstXLabel()));var e=(s&&w&&(c.getLastYLabel()||c.getLastXLabel()));r.openStart("div",c);this._writeMainProperties(r,c);if(w){r.class("sapSuiteAMCWideMode");}r.openEnd();r.openStart("div");r.class("sapSuiteAMCVerticalAlignmentContainer");r.openEnd();if(S){r.openStart("div");r.attr("id",c.getId()+"-top-labels");r.class("sapSuiteAMCLabels");r.class("sapSuiteAMCPositionTop");r.openEnd();if(!w){this._writeLabel(r,c,c.getFirstYLabel(),"-top-left-lbl","sapSuiteAMCPositionLeft");}this._writeLabel(r,c,c.getMaxLabel(),"-top-center-lbl","sapSuiteAMCPositionCenter");if(!w){this._writeLabel(r,c,c.getLastYLabel(),"-top-right-lbl","sapSuiteAMCPositionRight");}r.close("div");}if(w){r.openStart("div");r.class("sapSuiteAMCHorizontalContainer");r.openEnd();}if(d){r.openStart("div");r.attr("id",c.getId()+"-left-labels");r.class("sapSuiteAMCSideLabels");r.class("sapSuiteAMCPositionLeft");r.openEnd();this._writeLabel(r,c,c.getFirstYLabel(),"-top-left-lbl","sapSuiteAMCPositionLeft");this._writeLabel(r,c,c.getFirstXLabel(),"-btm-left-lbl","sapSuiteAMCPositionLeft");r.close("div");}r.openStart("div");r.attr("id",c.getId()+"-canvas-cont");r.class("sapSuiteAMCCanvasContainer");r.openEnd();r.openStart("canvas");r.attr("id",c.getId()+"-canvas");r.class("sapSuiteAMCCanvas");r.openEnd();r.close("canvas");r.close("div");if(e){r.openStart("div");r.attr("id",c.getId()+"-right-labels");r.class("sapSuiteAMCSideLabels");r.class("sapSuiteAMCPositionRight");r.openEnd();this._writeLabel(r,c,c.getLastYLabel(),"-top-right-lbl","sapSuiteAMCPositionRight");this._writeLabel(r,c,c.getLastXLabel(),"-btm-right-lbl","sapSuiteAMCPositionRight");r.close("div");}if(w){r.close("div");}if(b){r.openStart("div");r.attr("id",c.getId()+"-bottom-labels");r.class("sapSuiteAMCLabels");r.class("sapSuiteAMCPositionBtm");r.openEnd();if(!w){this._writeLabel(r,c,c.getFirstXLabel(),"-btm-left-lbl","sapSuiteAMCPositionLeft");}this._writeLabel(r,c,c.getMinLabel(),"-btm-center-lbl","sapSuiteAMCPositionCenter");if(!w){this._writeLabel(r,c,c.getLastXLabel(),"-btm-right-lbl","sapSuiteAMCPositionRight");}r.close("div");}r.openStart("div");r.attr("id",c.getId()+"-css-helper");r.style("display","none");r.openEnd();r.close("div");r.close("div");r.close("div");}else{this._renderNoData(r,c);}};a._writeMainProperties=function(r,c){var i=c.hasListeners("press");this._renderActiveProperties(r,c);var s=c.getTooltip_AsString(i);r.attr("role","figure");if(c.getAriaLabelledBy().length){r.accessibilityState(c);}else{r.attr("aria-label",s);}r.class("sapSuiteAMC");r.class("sapSuiteAMCSize"+c.getSize());r.style("width",c.getWidth());r.style("height",c.getHeight());};a._writeLabel=function(r,c,L,i,C){if(!L){return;}var s=L?L.getLabel():"";r.openStart("div");r.attr("id",c.getId()+i);r.class("sapSuiteAMCSemanticColor"+L.getColor());r.class("sapSuiteAMCLbl");r.class(C);r.openEnd();r.text(s);r.close("div");};M.extendMicroChartRenderer(a);return a;},true);
sap.ui.predefine('sap/suite/ui/microchart/BulletMicroChart',["sap/ui/thirdparty/jquery","./library","sap/m/library","sap/ui/core/Control","sap/m/FlexBox","sap/ui/Device","sap/ui/core/ResizeHandler","sap/ui/events/KeyCodes","sap/m/Size","sap/suite/ui/microchart/MicroChartUtils","./BulletMicroChartRenderer"],function(q,l,M,C,F,D,R,K,S,a){"use strict";var B=C.extend("sap.suite.ui.microchart.BulletMicroChart",{metadata:{library:"sap.suite.ui.microchart",properties:{size:{type:"sap.m.Size",group:"Misc",defaultValue:"Auto"},mode:{type:"sap.suite.ui.microchart.BulletMicroChartModeType",group:"Misc",defaultValue:"Actual"},scale:{type:"string",group:"Misc",defaultValue:""},forecastValue:{type:"float",group:"Misc",defaultValue:null},targetValue:{type:"float",group:"Misc",defaultValue:null},minValue:{type:"float",group:"Misc",defaultValue:null},maxValue:{type:"float",group:"Misc",defaultValue:null},showActualValue:{type:"boolean",group:"Misc",defaultValue:true},showDeltaValue:{type:"boolean",group:"Misc",defaultValue:true},showActualValueInDeltaMode:{type:"boolean",group:"Misc",defaultValue:false},showTargetValue:{type:"boolean",group:"Misc",defaultValue:true},showValueMarker:{type:"boolean",group:"Misc",defaultValue:false},showThresholds:{type:"boolean",group:"Misc",defaultValue:true},actualValueLabel:{type:"string",group:"Misc",defaultValue:""},deltaValueLabel:{type:"string",group:"Misc",defaultValue:""},targetValueLabel:{type:"string",group:"Misc",defaultValue:""},width:{type:"sap.ui.core.CSSSize",group:"Misc"},height:{type:"sap.ui.core.CSSSize",group:"Misc"},scaleColor:{type:"sap.suite.ui.microchart.CommonBackgroundType",group:"Misc",defaultValue:"MediumLight"},isResponsive:{type:"boolean",group:"Appearance",defaultValue:false},hideOnNoData:{type:"boolean",group:"Appearance",defaultValue:false},smallRangeAllowed:{type:"boolean",group:"Appearance",defaultValue:false}},associations:{ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},defaultAggregation:"actual",aggregations:{actual:{type:"sap.suite.ui.microchart.BulletMicroChartData",multiple:false,bindable:"bindable"},thresholds:{type:"sap.suite.ui.microchart.BulletMicroChartData",multiple:true,singularName:"threshold",bindable:"bindable"}},events:{press:{}}}});B.THRESHOLD_SMALL_LABEL=3.5;B.THRESHOLD_BIG_LABEL=4.5;B.THRESHOLD_SMALL_LOOK=3.5;B.THRESHOLD_EXTRASMALL_LOOK=1.3125;B.THRESHOLD_THRESHOLDS=6;B.prototype.init=function(){this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.microchart");this.setAggregation("tooltip","((AltText))",true);this._bThemeApplied=true;if(!sap.ui.getCore().isInitialized()){this._bThemeApplied=false;sap.ui.getCore().attachInit(this._handleCoreInitialized.bind(this));}else{this._handleCoreInitialized();}};B.prototype._handleCoreInitialized=function(){this._bThemeApplied=sap.ui.getCore().isThemeApplied();if(!this._bThemeApplied){sap.ui.getCore().attachThemeChanged(this._handleThemeApplied,this);}};B.prototype._handleThemeApplied=function(){this._bThemeApplied=true;this.invalidate();sap.ui.getCore().detachThemeChanged(this._handleThemeApplied,this);};B.prototype._calculateChartData=function(){var s=98,t=this.getThresholds(),c=[],T=this.getTargetValue(),f=this.getForecastValue(),A=this.getActual()&&this.getActual().getValue()?this.getActual().getValue():0,v=[],L=0,h=0,b=0,i;if(this.getActual()&&this.getActual()._isValueSet){v.push(A);}if(this._isForecastValueSet){v.push(f);}if(this._isTargetValueSet){v.push(T);}if(this._isMinValueSet){v.push(this.getMinValue());}if(this._isMaxValueSet){v.push(this.getMaxValue());}for(i=0;i<t.length;i++){v.push(t[i].getValue());}if(v.length>0){L=h=v[0];for(i=0;i<v.length;i++){if(v[i]<L){L=v[i];}if(v[i]>h){h=v[i];}}if(this.getSmallRangeAllowed()==false){h=(h<0&&h<3*(L-h))?0:h;L=(L>0&&L>3*(h-L))?0:L;}b=h-L;for(i=0;i<t.length;i++){c[i]={color:t[i].getColor(),valuePct:(!t[i]._isValueSet||b===0)?0:((t[i].getValue()-L)*s/b).toFixed(2)};}}var n,d;if(this.getMode()===l.BulletMicroChartModeType.Delta){n=(!this.getActual()||!this.getActual()._isValueSet||b===0)?49:(0.05+(A-L)*s/b).toFixed(2);d=(!this._isTargetValueSet||b===0)?49:((T-L)*s/b).toFixed(2);}else{n=(!this.getActual()||!this.getActual()._isValueSet||b===0||L===0&&this.getActual().getValue()===0)?0:(0.05+(A-L)*s/b).toFixed(2);d=(!this._isTargetValueSet||b===0)?0:((T-L)*s/b).toFixed(2);}return{actualValuePct:n,targetValuePct:d,forecastValuePct:(!this._isForecastValueSet||b===0)?0:((f-L)*s/b).toFixed(2),thresholdsPct:c,fScaleWidthPct:s};};B.prototype._calculateDeltaValue=function(){if(!this.getActual()._isValueSet||!this._isTargetValueSet){return 0;}else{var A=this.getActual().getValue();var t=this.getTargetValue();return Math.abs(A-t).toFixed(Math.max(this._digitsAfterDecimalPoint(A),this._digitsAfterDecimalPoint(t)));}};B.prototype.setMinValue=function(m){this._isMinValueSet=this._fnIsNumber(m);return this.setProperty("minValue",this._isMinValueSet?m:NaN);};B.prototype.setMaxValue=function(m){this._isMaxValueSet=this._fnIsNumber(m);return this.setProperty("maxValue",this._isMaxValueSet?m:NaN);};B.prototype.setTargetValue=function(t){this._isTargetValueSet=this._fnIsNumber(t);return this.setProperty("targetValue",this._isTargetValueSet?t:NaN);};B.prototype.setForecastValue=function(f){this._isForecastValueSet=this._fnIsNumber(f);return this.setProperty("forecastValue",this._isForecastValueSet?f:NaN);};B.prototype.setSize=function(s){if(this.getSize()!==s){if(s===S.Responsive){this.setProperty("isResponsive",true);}else{this.setProperty("isResponsive",false);}this.setProperty("size",s,false);}return this;};B.prototype.setIsResponsive=function(i){var s,c=this.getSize();this.setProperty("isResponsive",i);if(i){s=S.Responsive;}else{s=c===S.Responsive?S.Auto:c;}this.setProperty("size",s);return this;};B.prototype.ontap=function(e){if(D.browser.msie){this.$().trigger("focus");}this.firePress();};B.prototype.onkeydown=function(e){if(e.which===K.SPACE){e.preventDefault();}};B.prototype.onkeyup=function(e){if(e.which===K.ENTER||e.which===K.SPACE){this.firePress();e.preventDefault();}};B.prototype._fnIsNumber=function(v){return typeof v==='number'&&!isNaN(v)&&isFinite(v);};B.prototype.attachEvent=function(e,d,f,L){C.prototype.attachEvent.call(this,e,d,f,L);if(this.hasListeners("press")){this.$().attr("tabindex",0).addClass("sapSuiteUiMicroChartPointer");}return this;};B.prototype.detachEvent=function(e,f,L){C.prototype.detachEvent.call(this,e,f,L);if(!this.hasListeners("press")){this.$().removeAttr("tabindex").removeClass("sapSuiteUiMicroChartPointer");}return this;};B.prototype.onBeforeRendering=function(){if(this._sChartResizeHandlerId){R.deregister(this._sChartResizeHandlerId);}this._unbindMouseEnterLeaveHandler();};B.prototype.onAfterRendering=function(){l._checkControlIsVisible(this,this._onControlIsVisible);this._bindMouseEnterLeaveHandler();};B.prototype._onControlIsVisible=function(){this._onResize();this._sChartResizeHandlerId=R.register(this,this._onResize.bind(this));};B.prototype._onResize=function(){var $=this.$(),c=parseInt($.css("height")),i=parseInt($.css("width"));if(this.getShowValueMarker()){this._adjustValueToMarker();}$.removeClass("sapSuiteBMCSmallFont sapSuiteBMCNoLabels sapSuiteBMCSmallLook sapSuiteBMCExtraSmallLook sapSuiteBMCThresholdHidden");if(c<=this.convertRemToPixels(B.THRESHOLD_EXTRASMALL_LOOK)){$.addClass("sapSuiteBMCExtraSmallLook");}else if(c<=this.convertRemToPixels(B.THRESHOLD_SMALL_LOOK)){$.addClass("sapSuiteBMCSmallLook");}if(c>=this.convertRemToPixels(B.THRESHOLD_SMALL_LABEL)&&c<=this.convertRemToPixels(B.THRESHOLD_BIG_LABEL)){$.addClass("sapSuiteBMCSmallFont");}if(c<this.convertRemToPixels(B.THRESHOLD_SMALL_LABEL)||this._isAnyChartLabelTruncated()){$.addClass("sapSuiteBMCNoLabels");}if(i<this.convertRemToPixels(B.THRESHOLD_THRESHOLDS)){$.addClass("sapSuiteBMCThresholdHidden");}this._adjustLabelsPos();};B.prototype._isAnyChartLabelTruncated=function(){var L=this.$().find(".sapSuiteBMCItemValue, .sapSuiteBMCTargetValue");return this._isAnyLabelTruncated(L);};B.prototype.exit=function(){R.deregister(this._sChartResizeHandlerId);};B.prototype._adjustLabelsPos=function(){var r=sap.ui.getCore().getConfiguration().getRTL();var t=this.$("bc-target-bar-value");var c=this.$("chart-bar");var f=c.width();if(f){var T=0;if(t&&t.offset()){T=t.offset().left-c.offset().left;if(r){T=f-T;}this._adjustLabelPos(this.$("bc-target-value"),f,T,r);}var b=this.$("bc-bar-value");if(b&&b.offset()){var A=b.offset().left+b.width()-c.offset().left;if(r){A=f-(b.offset().left-c.offset().left);}if(this.getMode()===l.BulletMicroChartModeType.Delta){A=b.width();if(!this.getShowActualValueInDeltaMode()){A=A/2;}var s=this.getTargetValue()<this.getActual().getValue()?1:-1;A=t.offset().left-c.offset().left+(A*s);}this._adjustLabelPos(this.$("bc-item-value"),f,A,r);}}};B.prototype._adjustLabelPos=function(L,f,o,r){var d=r?"right":"left";var b=L.width();if(b>f){L.css(d,"0");}else{var c=o-0.5*b;if(c<0){c=0;}if(c+b>f){c=f-b;}L.css(d,c);}};B.prototype._adjustValueToMarker=function(){var v=this.$("bc-bar-value");var m=this.$("bc-bar-value-marker");var c=this.$().find(".sapSuiteBMCVerticalAlignmentContainer");if(v.offset()&&m.offset()){var V=v.width();var f=v.offset().left;var b=m.width();var d=m.offset().left;if(sap.ui.getCore().getConfiguration().getRTL()){if(d<f){m.css("right","");m.offset({left:f});}if(d+b>f+V){m.css("right","");m.offset({left:f+V-b});}}else{if(d<f){m.offset({left:f});}if(d+b>f+V){v.width((d+b-f)/c.width()*100+"%");}}}};B.prototype._getLocalizedColorMeaning=function(c){return this._oRb.getText(("SEMANTIC_COLOR_"+c).toUpperCase());};B.prototype._getAltHeaderText=function(i){var A=this._oRb.getText("BULLETMICROCHART");if(i){A+=" "+this._oRb.getText("IS_ACTIVE");}if(!this._hasData()){A+="\n"+this._oRb.getText("NO_DATA");return A;}var I=this.getActual()&&this.getActual()._isValueSet;var s=this.getScale();var t=this.getTargetValueLabel();var m=!this.getActual()||!this.getActual().getColor()?"":this._getLocalizedColorMeaning(this.getActual().getColor());if(I){var b=this.getActualValueLabel();var c=(b)?b:""+this.getActual().getValue();A+="\n"+this._oRb.getText("BULLETMICROCHART_ACTUAL_TOOLTIP",[c+s,m]);}if(this.getMode()===l.BulletMicroChartModeType.Delta){if(this._isTargetValueSet&&I){var d=this.getDeltaValueLabel();var e=(d)?d:""+this._calculateDeltaValue();A+="\n"+this._oRb.getText("BULLETMICROCHART_DELTA_TOOLTIP",[e+s,m]);}}else if(this._isForecastValueSet){A+=(this._isForecastValueSet)?"\n"+this._oRb.getText("BULLETMICROCHART_FORECAST_TOOLTIP",[this.getForecastValue()+s,m]):"";}if(this._isTargetValueSet){var T=(t)?t:""+this.getTargetValue();A+="\n"+this._oRb.getText("BULLETMICROCHART_TARGET_TOOLTIP",[T+s]);}return A;};B.prototype._getAltSubText=function(I){var A="";var t=this.getThresholds().sort(function(f,o){return f.getValue()-o.getValue();});for(var i=0;i<t.length;i++){var T=t[i],s=T.getTooltip_AsString(),b="";if(!s){continue;}b+=(I?"":"\n")+this._oRb.getText("BULLETMICROCHART_THRESHOLD_TOOLTIP",[T.getValue()+this.getScale(),this._getLocalizedColorMeaning(T.getColor())]);b=s.split("((AltText))").join(b);if(b){A+=b;I=false;}}return A;};B.prototype._getAccessibilityControlType=function(){return this._oRb.getText("ACC_CTR_TYPE_BULLETMICROCHART");};B.prototype.clone=function(i,L,o){var c=C.prototype.clone.apply(this,arguments);c._isMinValueSet=this._isMinValueSet;c._isMaxValueSet=this._isMaxValueSet;c._isForecastValueSet=this._isForecastValueSet;c._isTargetValueSet=this._isTargetValueSet;return c;};B.prototype._addTitleAttribute=function(){if(!this.$().attr("title")&&this._hasData()){this.$().attr("title",this.getTooltip_AsString());}};B.prototype._removeTitleAttribute=function(){if(this.$().attr("title")){this.$().removeAttr("title");}};B.prototype._bindMouseEnterLeaveHandler=function(){if(!this._oMouseEnterLeaveHandler){this._oMouseEnterLeaveHandler={mouseEnterChart:this._addTitleAttribute.bind(this),mouseLeaveChart:this._removeTitleAttribute.bind(this)};}this.$().on("mouseenter",this._oMouseEnterLeaveHandler.mouseEnterChart);this.$().on("mouseleave",this._oMouseEnterLeaveHandler.mouseLeaveChart);};B.prototype._unbindMouseEnterLeaveHandler=function(){if(this._oMouseEnterLeaveHandler){this.$().off("mouseenter",this._oMouseEnterLeaveHandler.mouseEnterChart);this.$().off("mouseleave",this._oMouseEnterLeaveHandler.mouseLeaveChart);}};B.prototype._hasData=function(){return this.getActual();};B.prototype.firePress=function(){if(this._hasData()){C.prototype.fireEvent.call(this,"press",arguments);}};a.extendMicroChart(B);return B;});
sap.ui.predefine('sap/suite/ui/microchart/BulletMicroChartData',['./library','sap/ui/core/Element'],function(l,E){"use strict";var B=E.extend("sap.suite.ui.microchart.BulletMicroChartData",{metadata:{library:"sap.suite.ui.microchart",properties:{value:{type:"float",group:"Misc",defaultValue:"0"},color:{type:"sap.m.ValueColor",group:"Misc",defaultValue:"Neutral"}}}});B.prototype.init=function(){this.setAggregation("tooltip","((AltText))",true);};B.prototype.setValue=function(v){this._isValueSet=this._fnIsNumber(v);return this.setProperty("value",this._isValueSet?v:NaN);};B.prototype._fnIsNumber=function(n){return typeof n=='number'&&!isNaN(n)&&isFinite(n);};B.prototype.clone=function(i,L,o){var c=E.prototype.clone.apply(this,arguments);c._isValueSet=this._isValueSet;return c;};return B;});
sap.ui.predefine('sap/suite/ui/microchart/BulletMicroChartRenderer',['./library','sap/m/library','sap/suite/ui/microchart/MicroChartRenderUtils'],function(l,M,a){"use strict";var B={apiVersion:2};B.render=function(r,c){if(!c._bThemeApplied){return;}if(c._hasData()&&!isNaN(c.getAggregation("actual").getValue())){var C=c._calculateChartData();var f=+C.forecastValuePct;var s;if(c._isResponsive()){s="sapSuiteBMCResponsive";}else{s="sapSuiteBMCSize"+c.getSize();}var S=c.getScale();var d=sap.ui.getCore().getConfiguration().getRTL()?"right":"left";var m="sapSuiteBMCModeType"+c.getMode();var D=c.getMode()===l.BulletMicroChartModeType.Delta?c._calculateDeltaValue():0;var I=c.getActual()&&c.getActual()._isValueSet;var b=c.getShowActualValue()&&c.getSize()!==M.Size.XS&&c.getMode()===l.BulletMicroChartModeType.Actual;var e=c.getShowActualValueInDeltaMode()&&c.getSize()!==M.Size.XS&&c.getMode()===l.BulletMicroChartModeType.Delta;var g=c.getShowDeltaValue()&&c.getSize()!==M.Size.XS&&c.getMode()===l.BulletMicroChartModeType.Delta;var h=c.getShowTargetValue()&&c.getSize()!==M.Size.XS;var j=c.getShowThresholds();var A=c.getActualValueLabel();var k=c.getDeltaValueLabel();var t=c.getTargetValueLabel();var n=c.getThresholds();var o;if(I){o="sapSuiteBMCSemanticColor"+c.getActual().getColor();}r.openStart("div",c);this._writeMainProperties(r,c);r.openEnd();r.openStart("div");r.class("sapSuiteBMCVerticalAlignmentContainer");r.openEnd();r.openStart("div",c.getId()+"-bc-chart");r.class("sapSuiteBMCChart");r.class(s);r.openEnd();if((I&&(b||e))||(I&&c._isTargetValueSet&&g)){var v="";r.openStart("div");r.class("sapSuiteBMCTopLabel");r.openEnd();if(I&&(b||e)){var p=A?A:""+c.getActual().getValue();v=p+S;r.openStart("div",c.getId()+"-bc-item-value");r.class("sapSuiteBMCItemValue");r.class(o);r.class(s);r.openEnd();r.text(v);r.close("div");}else if(I&&c._isTargetValueSet&&g){var q=k?k:""+D;v=q+S;r.openStart("div",c.getId()+"-bc-item-value");r.class("sapSuiteBMCItemValue");r.class(o);r.class(s);r.openEnd();r.text("\u0394");r.text(v);r.close("div");}r.close("div");}r.openStart("div");r.class("sapSuiteBMCChartCanvas");r.openEnd();if(j){for(var i=0;i<C.thresholdsPct.length;i++){if(n[i]._isValueSet){this.renderThreshold(r,c,C.thresholdsPct[i],s);}}}r.openStart("div",c.getId()+"-chart-bar");r.class("sapSuiteBMCBar");r.class(s);r.class("sapSuiteBMCScaleColor"+c.getScaleColor());r.openEnd();r.close("div");if(I){if(c._isForecastValueSet&&c.getMode()===l.BulletMicroChartModeType.Actual){r.openStart("div",c.getId()+"-forecast-bar-value");r.class("sapSuiteBMCForecastBarValue");r.class(o);r.class(s);r.style("width",f+"%");r.openEnd();r.close("div");}r.openStart("div",c.getId()+"-bc-bar-value-marker");r.class("sapSuiteBMCBarValueMarker");r.class(m);if(!c.getShowValueMarker()){r.class("sapSuiteBMCBarValueMarkerHidden");}r.class(o);r.class(s);r.style(d,parseFloat(C.actualValuePct+parseFloat(1)+"%"));if(c.getMode()===l.BulletMicroChartModeType.Delta&&C.actualValuePct<=C.targetValuePct){r.style("margin","0");}r.openEnd();r.close("div");if(c.getMode()===l.BulletMicroChartModeType.Actual&&C.actualValuePct!==0){r.openStart("div",c.getId()+"-bc-bar-value");r.class("sapSuiteBMCBarValue");r.class(o);r.class(s);if(c._isForecastValueSet){r.class("sapSuiteBMCForecast");}r.style("width",C.actualValuePct+"%");r.openEnd();r.close("div");}else if(c._isTargetValueSet&&c.getMode()===l.BulletMicroChartModeType.Delta){r.openStart("div",c.getId()+"-bc-bar-value");r.class("sapSuiteBMCBarValue");r.class(o);r.class(s);r.style("width",Math.abs(C.actualValuePct-C.targetValuePct)+"%");r.style(d,(1+Math.min(C.actualValuePct,C.targetValuePct))+"%");r.openEnd();r.close("div");}}if(c._isTargetValueSet){r.openStart("div",c.getId()+"-bc-target-bar-value");r.class("sapSuiteBMCTargetBarValue");r.class(s);r.style(d,parseFloat(C.targetValuePct).toFixed(2)+"%");r.openEnd();r.close("div");r.close("div");if(h){r.openStart("div");r.class("sapSuiteBMCBottomLabel");r.openEnd();var T=t?t:""+c.getTargetValue();var u=T+S;r.openStart("div",c.getId()+"-bc-target-value");r.class("sapSuiteBMCTargetValue");r.class(s);r.openEnd();r.text(u);r.close("div");r.close("div");}}else{r.close("div");}r.close("div");r.openStart("div",c.getId()+"-info");r.attr("aria-hidden","true");r.style("display","none");r.openEnd();r.close("div");r.close("div");r.close("div");}else{this._renderNoData(r,c);}};B._writeMainProperties=function(r,c){var i=c.hasListeners("press");this._renderActiveProperties(r,c);var A=c.getTooltip_AsString(i);r.attr("role","figure");if(c.getAriaLabelledBy().length){r.accessibilityState(c);}else{r.attr("aria-label",A);}r.class("sapSuiteBMC");r.class("sapSuiteBMCContent");r.class(c._isResponsive()?"sapSuiteBMCResponsive":"sapSuiteBMCSize"+c.getSize());r.style("width",c.getWidth());r.style("height",c.getHeight());};B.renderThreshold=function(r,c,t,s){var d=sap.ui.getCore().getConfiguration().getRTL()?"right":"left",v=0.98*t.valuePct+1,C="sapSuiteBMCSemanticColor"+t.color;if(C==="sapSuiteBMCSemanticColor"+M.ValueColor.Error){r.openStart("div");r.class("sapSuiteBMCDiamond");r.class(s);r.class(C);r.style(d,v+"%");r.openEnd();r.close("div");}r.openStart("div");r.class("sapSuiteBMCThreshold");r.class(s);r.class(C);r.style(d,v+"%");r.openEnd();r.close("div");};a.extendMicroChartRenderer(B);return B;},true);
sap.ui.predefine('sap/suite/ui/microchart/ComparisonMicroChart',["sap/ui/thirdparty/jquery","./library","sap/ui/core/Control","sap/ui/Device","sap/m/FlexBox","sap/suite/ui/microchart/MicroChartUtils","sap/m/library","sap/ui/core/ResizeHandler","./ComparisonMicroChartRenderer"],function(q,l,C,D,F,M,m,R){"use strict";var V=m.ValueColor;var a=l.ComparisonMicroChartViewType;var S=m.Size;var b=C.extend("sap.suite.ui.microchart.ComparisonMicroChart",{metadata:{library:"sap.suite.ui.microchart",properties:{size:{type:"sap.m.Size",group:"Misc",defaultValue:"Auto"},scale:{type:"string",group:"Misc",defaultValue:""},minValue:{type:"float",group:"Appearance",defaultValue:null},maxValue:{type:"float",group:"Appearance",defaultValue:null},view:{type:"sap.suite.ui.microchart.ComparisonMicroChartViewType",group:"Appearance",defaultValue:"Normal"},colorPalette:{type:"string[]",group:"Appearance",defaultValue:[]},shrinkable:{type:"boolean",group:"Misc",defaultValue:false},width:{type:"sap.ui.core.CSSSize",group:"Appearance"},height:{type:"sap.ui.core.CSSSize",group:"Appearance"},isResponsive:{type:"boolean",group:"Appearance",defaultValue:false},hideOnNoData:{type:"boolean",group:"Appearance",defaultValue:false}},associations:{ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},defaultAggregation:"data",aggregations:{data:{type:"sap.suite.ui.microchart.ComparisonMicroChartData",multiple:true,bindable:"bindable"}},events:{press:{}}}});b.THRESHOLD_LOOK_XS=6;b.THRESHOLD_LOOK_S=8.25;b.THRESHOLD_LOOK_M=10.5;b.THRESHOLD_LOOK_L=12;b.prototype.attachEvent=function(e,d,f,L){C.prototype.attachEvent.call(this,e,d,f,L);if(this.hasListeners("press")){this.$().attr("tabindex",0).addClass("sapSuiteUiMicroChartPointer");}return this;};b.prototype.detachEvent=function(e,f,L){C.prototype.detachEvent.call(this,e,f,L);if(!this.hasListeners("press")){this.$().removeAttr("tabindex").removeClass("sapSuiteUiMicroChartPointer");}return this;};b.prototype.ontap=function(e){if(D.browser.edge){this.onclick(e);}};b.prototype.onclick=function(e){if(!this.fireBarPress(e)){this.firePress();if(D.browser.msie||D.browser.edge){this.$().trigger("focus");e.preventDefault();}}};b.prototype.fireBarPress=function(e){var B=q(e.target);if(B&&B.attr("data-bar-index")){var i=parseInt(B.attr("data-bar-index"));var c=this.getData()[i];if(c&&c.hasListeners("press")){c.firePress();e.preventDefault();e.stopImmediatePropagation();if(D.browser.msie){this.$("chart-item-bar-"+i).trigger("focus");}var $=this.$().find(".sapSuiteCpMCChartBar");var d=$.index(this.$().find(".sapSuiteCpMCChartBar[tabindex='0']"));this._switchTabindex(d,i,$);return true;}}return false;};b.prototype.onsaptabprevious=function(){this.$().css("outline-color","");};b.prototype.onsaptabnext=function(){var n=this.$().next();if(n.hasClass("sapSuiteCpMC")&&n.attr("tabindex")){n.css("outline-color","");}};b.prototype.onsapenter=function(e){if(!this.fireBarPress(e)){this.firePress();e.preventDefault();e.stopImmediatePropagation();}};b.prototype.onsapspace=b.prototype.onsapenter;b.prototype.onsapup=function(e){var B=this.$().find(".sapSuiteUiMicroChartPointer");if(B.length>0){var i=B.index(e.target);this._switchTabindex(i,i-1,B);}e.preventDefault();e.stopImmediatePropagation();};b.prototype.onsapdown=function(e){var B=this.$().find(".sapSuiteUiMicroChartPointer");if(B.length>0){var i=B.index(e.target);this._switchTabindex(i,i+1,B);}e.preventDefault();e.stopImmediatePropagation();};b.prototype.onsaphome=function(e){var B=this.$().find(".sapSuiteUiMicroChartPointer");var i=B.index(e.target);if(i!==0&&B.length>0){this._switchTabindex(i,0,B);}e.preventDefault();e.stopImmediatePropagation();};b.prototype.onsapend=function(e){var B=this.$().find(".sapSuiteUiMicroChartPointer");var i=B.index(e.target),L=B.length;if(i!==L-1&&L>0){this._switchTabindex(i,L-1,B);}e.preventDefault();e.stopImmediatePropagation();};b.prototype.onsapleft=b.prototype.onsapup;b.prototype.onsapright=b.prototype.onsapdown;b.prototype.setMinValue=function(f){this._isMinValueSet=q.isNumeric(f);return this.setProperty("minValue",this._isMinValueSet?f:NaN);};b.prototype.setMaxValue=function(f){this._isMaxValueSet=q.isNumeric(f);return this.setProperty("maxValue",this._isMaxValueSet?f:NaN);};b.prototype.setSize=function(s){if(this.getSize()!==s){if(s===S.Responsive){this.setProperty("isResponsive",true);}else{this.setProperty("isResponsive",false);}this.setProperty("size",s,false);}return this;};b.prototype.setIsResponsive=function(i){var s,c=this.getSize();this.setProperty("isResponsive",i);if(i){s=S.Responsive;}else{s=c===S.Responsive?S.Auto:c;}this.setProperty("size",s);return this;};b.prototype.init=function(){this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.microchart");this.setAggregation("tooltip","((AltText))",true);this._isMinValueSet=false;this._isMaxValueSet=false;this._bThemeApplied=true;if(!sap.ui.getCore().isInitialized()){this._bThemeApplied=false;sap.ui.getCore().attachInit(this._handleCoreInitialized.bind(this));}else{this._handleCoreInitialized();}};b.prototype._handleCoreInitialized=function(){this._bThemeApplied=sap.ui.getCore().isThemeApplied();if(!this._bThemeApplied){sap.ui.getCore().attachThemeChanged(this._handleThemeApplied,this);}};b.prototype._handleThemeApplied=function(){this._bThemeApplied=true;this.invalidate();sap.ui.getCore().detachThemeChanged(this._handleThemeApplied,this);};b.prototype.onBeforeRendering=function(){if(this._sChartResizeHandlerId){R.deregister(this._sChartResizeHandlerId);}this._unbindMouseEnterLeaveHandler();};b.prototype.onAfterRendering=function(){l._checkControlIsVisible(this,this._onControlIsVisible);this._bindMouseEnterLeaveHandler();};b.prototype._onControlIsVisible=function(){this._onResize();this._sChartResizeHandlerId=R.register(this,this._onResize.bind(this));};b.prototype.setBarPressable=function(B,p){if(p){var s=this._getBarAltText(B);this.$("chart-item-bar-"+B).addClass("sapSuiteUiMicroChartPointer").attr("tabindex",0).attr("title",s).attr("role","presentation").attr("aria-label",s);}else{this.$("chart-item-bar-"+B).removeAttr("tabindex").removeClass("sapSuiteUiMicroChartPointer").removeAttr("title").removeAttr("role").removeAttr("aria-label");}};b.prototype._getAltHeaderText=function(i){var A=this._oRb.getText("COMPARISONMICROCHART");if(i){A+=" "+this._oRb.getText("IS_ACTIVE");}if(!this._hasData()){A+="\n"+this._oRb.getText("NO_DATA");return A;}return A;};b.prototype._getAltSubText=function(I){var A="";for(var i=0;i<this.getData().length;i++){var B=this.getData()[i],s=this._getBarAltText(i),c=B.getTooltip_AsString(),d="";if(!c){continue;}d=c.split("((AltText))").join(s);if(d){A+=(I?"":"\n")+d;I=false;}}return A;};b.prototype._getAccessibilityControlType=function(){return this._oRb.getText("ACC_CTR_TYPE_COMPARISONMICROCHART");};b.prototype.exit=function(){R.deregister(this._sChartResizeHandlerId);};b.prototype._calculateChartData=function(){var r=[];var d=this.getData();var c=d.length;var e=0;var f=0;var t;var g;var h;var i;for(i=0;i<c;i++){var j=isNaN(d[i].getValue())?0:d[i].getValue();e=Math.max(e,j);f=Math.min(f,j);}if(this._isMinValueSet){f=Math.min(f,this.getMinValue());}if(this._isMaxValueSet){e=Math.max(e,this.getMaxValue());}t=e-f;g=(t==0)?0:Math.round(e*100/t);if(g==0&&e!=0){g=1;}else if(g==100&&f!=0){g=99;}h=100-g;for(i=0;i<c;i++){var I={};var k=isNaN(d[i].getValue())?0:d[i].getValue();I.value=(t==0)?0:Math.round(k*100/t);if(I.value==0&&k!=0){I.value=(k>0)?1:-1;}else if(I.value==100){I.value=g;}else if(I.value==-100){I.value=-h;}if(I.value>=0){I.negativeNoValue=h;I.positiveNoValue=g-I.value;}else{I.value=-I.value;I.negativeNoValue=h-I.value;I.positiveNoValue=g;}r.push(I);}return r;};b.prototype._getLocalizedColorMeaning=function(c){return V[c]?this._oRb.getText(("SEMANTIC_COLOR_"+c).toUpperCase()):"";};b.prototype._getBarAltText=function(B){var o=this.getData()[B],s=C.prototype.getTooltip_AsString.apply(o,arguments),c=this.getColorPalette().length?"":this._getLocalizedColorMeaning(o.getColor()),d=o.getTitle()+" "+(o.getDisplayValue()?o.getDisplayValue():o.getValue())+this.getScale()+" "+c;if(!s){return"";}return s.split("((AltText))").join(d);};b.prototype._onResize=function(){this.$().find(".sapSuiteCpMCChartItem").show();this._resizeHorizontally();this._resizeVertically();};b.prototype._resizeVertically=function(){var I,f,B,c,s,d,e,r,g,h=this.getData(),$=this.$(),j,k=$.find(".sapSuiteCpMCChartItem"),n=$.find(".sapSuiteCpMCChartBar");k.css("margin-bottom","");k.css("height","");n.css("height","");if(h.length>0&&h[0].getDomRef()){I=h[0].getDomRef().getBoundingClientRect().height;f=parseFloat(h[0].$().css("margin-bottom"));B=n.height();d=$.width();e=this._getCurrentBaseWidth();if(e>0){r=e/I;I=d/r;k.css("height",I);r=e/f;f=d/r;k.css("margin-bottom",f);r=e/B;n.css("height",d/r);}c=$.find(".sapSuiteCpMCVerticalAlignmentContainer")[0].getBoundingClientRect().height;s=0;for(var i=0;i<h.length;i++){s+=I;if(s>c){h[i].$().hide();}s+=f;}j=this.$().find(".sapSuiteCpMCVerticalAlignmentContainer .sapSuiteCpMCChartItem:visible:last");if(j.length===1&&!this.getShrinkable()){j.css("margin-bottom","");g=this.getDomRef().getBoundingClientRect().bottom-j[0].getBoundingClientRect().bottom;if(g<f){j.css("margin-bottom",g<0?0:g);}}}};b.prototype._resizeHorizontally=function(){var $=this.$();var f=0;var c=0;var d=this.$().find(".sapSuiteCpMCChartItemTitle");var e=this.$().find(".sapSuiteCpMCChartItemValue");var B;var L;$.removeClass("sapSuiteCpMCLookL sapSuiteCpMCLookM sapSuiteCpMCLookS sapSuiteCpMCLookXS sapSuiteCpMCLookWide");L=this._getCurrentLookClass();$.addClass(L);if(!$.hasClass("sapSuiteCpMCLookXS")){this._hideTruncatedLabels(".sapSuiteCpMCChartItemValue");}d.width("auto");e.width("auto");if($.hasClass("sapSuiteCpMCLookWide")){d.each(function(){B=this.getBoundingClientRect();if(B.width>f){f=Math.ceil(B.width);}});d.width(f);e.each(function(){B=this.getBoundingClientRect();if(B.width>c){c=Math.ceil(B.width);}});e.width(c);}};b.prototype._getCurrentBaseWidth=function(){var $=this.$();var w=parseInt($.width());var B;if(this.getView()===a.Wide||w>this.convertRemToPixels(b.THRESHOLD_LOOK_L)||this.getSize()!==S.Responsive){B=0;}else if(w>this.convertRemToPixels(b.THRESHOLD_LOOK_M)){B=this.convertRemToPixels(b.THRESHOLD_LOOK_L);}else if(w>this.convertRemToPixels(b.THRESHOLD_LOOK_S)){B=this.convertRemToPixels(b.THRESHOLD_LOOK_M);}else if(w>this.convertRemToPixels(b.THRESHOLD_LOOK_XS)){B=this.convertRemToPixels(b.THRESHOLD_LOOK_S);}else{B=0;}return B;};b.prototype._getCurrentLookClass=function(){var $=this.$();var w=parseInt($.width());var L;if(this._shouldUseWideView()){L="sapSuiteCpMCLookWide";}else if(this.getSize()!==S.Responsive){L="sapSuiteCpMCLook"+this._getSize();}else if(w>this.convertRemToPixels(b.THRESHOLD_LOOK_M)){L="sapSuiteCpMCLookL";}else if(w>this.convertRemToPixels(b.THRESHOLD_LOOK_S)){L="sapSuiteCpMCLookM";}else if(w>this.convertRemToPixels(b.THRESHOLD_LOOK_XS)){L="sapSuiteCpMCLookS";}else{L="sapSuiteCpMCLookXS";}return L;};b.prototype._getSize=function(){var s=this.getSize();if(s===S.Auto){if(D.system.phone){s=S.S;}else{s=S.M;}}return s;};b.prototype._shouldUseWideView=function(){var w=parseInt(this.$().width());return this.getView()===a.Wide||(this.getView()===a.Responsive&&w>this.convertRemToPixels(b.THRESHOLD_LOOK_L));};b.prototype._hideTruncatedLabels=function(c){var $=this.$();var L=$.find(c);for(var i=0;i<L.length;i++){q(L[i]).removeClass("sapSuiteCpMCChartItemHiddenLabel");if(this._isLabelTruncated(L[i])){q(L[i]).addClass("sapSuiteCpMCChartItemHiddenLabel");}}};b.prototype._addTitleAttribute=function(){var t=this.getTooltip_AsString();if(!l._isTooltipSuppressed(t)&&this._hasData()){if(this.getIsResponsive()){this.$().find(".sapSuiteCpMCVerticalAlignmentContainer").attr("title",t);}else{this.$().attr("title",t);}}};b.prototype._removeTitleAttribute=function(){if(this.getIsResponsive()){this.$().find(".sapSuiteCpMCVerticalAlignmentContainer").removeAttr("title");}else{this.$().removeAttr("title");}};b.prototype._resolveFocus=function(e){var B=q(e.target);if(B&&B.attr("data-bar-index")){var i=parseInt(B.attr("data-bar-index"));var d=this.getData()[i];if(d&&d.hasListeners("press")){this.$().css("outline-color","transparent");}else{this.$().css("outline-color","");}}else{this.$().css("outline-color","");}};b.prototype._switchTabindex=function(o,n,c){if(o>=0&&o<c.length&&n>=0&&n<c.length){c.eq(o).removeAttr("tabindex");c.eq(n).attr("tabindex","0").trigger("focus");}};b.prototype._bindMouseEnterLeaveHandler=function(){if(!this._oMouseEnterLeaveHandler){this._oMouseEnterLeaveHandler={mouseEnterChart:this._addTitleAttribute.bind(this),mouseLeaveChart:this._removeTitleAttribute.bind(this),mouseDownChart:this._resolveFocus.bind(this)};}this.$().on("mouseenter",this._oMouseEnterLeaveHandler.mouseEnterChart);this.$().on("mouseleave",this._oMouseEnterLeaveHandler.mouseLeaveChart);this.$().on("mousedown",this._oMouseEnterLeaveHandler.mouseDownChart);};b.prototype._unbindMouseEnterLeaveHandler=function(){if(this._oMouseEnterLeaveHandler){this.$().off("mouseenter",this._oMouseEnterLeaveHandler.mouseEnterChart);this.$().off("mouseleave",this._oMouseEnterLeaveHandler.mouseLeaveChart);this.$().off("mousedown",this._oMouseEnterLeaveHandler.mouseDownChart);}};b.prototype._hasData=function(){return this.getData().length>0;};b.prototype.firePress=function(){if(this._hasData()){C.prototype.fireEvent.call(this,"press",arguments);}};M.extendMicroChart(b);return b;});
sap.ui.predefine('sap/suite/ui/microchart/ComparisonMicroChartData',['./library','sap/ui/core/Element','sap/ui/core/Control'],function(l,E,C){"use strict";var a=E.extend("sap.suite.ui.microchart.ComparisonMicroChartData",{metadata:{library:"sap.suite.ui.microchart",properties:{value:{type:"float",group:"Misc",defaultValue:"0"},color:{type:"sap.m.ValueCSSColor",group:"Misc",defaultValue:"Neutral"},title:{type:"string",group:"Misc",defaultValue:""},displayValue:{type:"string",group:"Misc",defaultValue:""}},events:{press:{}}}});a.prototype.init=function(){this.setAggregation("tooltip","((AltText))",true);};a.prototype.setValue=function(v,s){this._isValueSet=this._fnIsNumber(v);return this.setProperty("value",this._isValueSet?v:NaN,s);};a.prototype._fnIsNumber=function(n){return typeof n=='number'&&!isNaN(n)&&isFinite(n);};a.prototype.clone=function(i,L,o){var c=C.prototype.clone.apply(this,arguments);c._isValueSet=this._isValueSet;return c;};a.prototype.attachEvent=function(e,d,f,L){C.prototype.attachEvent.call(this,e,d,f,L);if(this.getParent()){this.getParent().setBarPressable(this.getParent().getData().indexOf(this),true);}return this;};a.prototype.detachEvent=function(e,f,L){C.prototype.detachEvent.call(this,e,f,L);if(this.getParent()){this.getParent().setBarPressable(this.getParent().getData().indexOf(this),false);}return this;};return a;});
sap.ui.predefine('sap/suite/ui/microchart/ComparisonMicroChartRenderer',['./library','sap/suite/ui/microchart/MicroChartRenderUtils','sap/ui/core/theming/Parameters','sap/m/library'],function(l,M,P,m){"use strict";var V=m.ValueColor;var C={apiVersion:2};C.render=function(r,c){if(!c._bThemeApplied){return;}if(c._hasData()){var a=c.getTooltip_AsString(c.hasListeners("press"));r.openStart("div",c);this._writeMainProperties(r,c);if(c.getShrinkable()){r.class("sapSuiteCpMCShrinkable");r.style("height","auto");}r.openEnd();this._renderInnerContent(r,c,a);r.openStart("div");r.attr("id",c.getId()+"-info");r.attr("aria-hidden","true");r.style("display","none");r.openEnd();r.text(a);r.close("div");r.openStart("div");r.attr("id",c.getId()+"-hidden");r.attr("aria-hidden","true");r.attr("focusable","false");r.openEnd();r.close("div");r.close("div");}else{this._renderNoData(r,c);}};C._writeMainProperties=function(r,c){var i=c.hasListeners("press");this._renderActiveProperties(r,c);var a=c.getTooltip_AsString(i);r.attr("role","figure");if(c.getAriaLabelledBy().length){r.accessibilityState(c);}else{r.attr("aria-label",a);}r.class("sapSuiteCpMC");r.class("sapSuiteCpMCChartContent");r.class(c._isResponsive()?"sapSuiteCpMCResponsive":"sapSuiteCpMCSize"+c.getSize());r.class("sapSuiteCpMCViewType"+c.getView());r.style("width",c.getWidth());r.style("height",c.getHeight());};C._renderInnerContent=function(r,c){var a=c.getColorPalette().length,b=0,d=c.getData(),e=c._calculateChartData();var n=function(s){if(a){if(b===a){b=0;}s=c.getColorPalette()[b++].trim();}return P.get(s)||s;};r.openStart("div");r.class("sapSuiteCpMCVerticalAlignmentContainer");r.openEnd();for(var i=0;i<e.length;i++){this._renderChartItem(r,c,e[i],i,n(d[i].getColor()));}r.close("div");};C._renderChartItem=function(r,c,o,i,s){var d=c.getData();r.openStart("div",d[i]);r.class("sapSuiteCpMCChartItem");r.openEnd();this._renderChartTitle(r,c,i);this._renderChartBar(r,c,o,i,s);this._renderChartValue(r,c,i,s);r.close("div");};C._renderChartBar=function(r,c,o,i,s){var d=c.getData()[i];r.openStart("div");r.attr("id",c.getId()+"-chart-item-bar-"+i);r.class("sapSuiteCpMCChartBar");if(c.getData()[i].hasListeners("press")){if(i===0){r.attr("tabindex","0");}r.attr("role","presentation");r.attr("aria-label",c._getBarAltText(i));if(!l._isTooltipSuppressed(c._getBarAltText(i))){r.attr("title",c._getBarAltText(i));}else{r.attr("title","");}r.attr("data-bar-index",i);r.class("sapSuiteUiMicroChartPointer");}r.openEnd();if(o.negativeNoValue>0){r.openStart("div");r.attr("data-bar-index",i);r.class("sapSuiteCpMCChartBarNegNoValue");if(o.value>0||o.positiveNoValue>0){r.class("sapSuiteCpMCNotLastBarPart");}r.style("width",o.negativeNoValue+"%");r.openEnd();r.close("div");}if(o.value>0){r.openStart("div");r.attr("data-bar-index",i);r.class("sapSuiteCpMCChartBarValue");r.class("sapSuiteCpMCSemanticColor"+d.getColor());r.style("background-color",s?s:"");r.style("width",o.value+"%");r.openEnd();r.close("div");}if(o.positiveNoValue>0){r.openStart("div");r.attr("data-bar-index",i);r.class("sapSuiteCpMCChartBarNoValue");if(!!o.negativeNoValue&&!o.value){r.class("sapSuiteCpMCNegPosNoValue");}else if(!!o.negativeNoValue||!!o.value){r.class("sapSuiteCpMCNotFirstBarPart");}r.style("width",o.positiveNoValue+"%");r.openEnd();r.close("div");}r.close("div");};C._renderChartTitle=function(r,c,i){var d=c.getData()[i];r.openStart("div");r.attr("id",c.getId()+"-chart-item-"+i+"-title");r.class("sapSuiteCpMCChartItemTitle");r.openEnd();r.text(d.getTitle());r.close("div");};C._renderChartValue=function(r,c,i,s){var d=c.getData()[i];var S=c.getScale();var D=d.getDisplayValue();var a=D?D:""+d.getValue();var v=a+S;r.openStart("div");r.attr("id",c.getId()+"-chart-item-"+i+"-value");r.class("sapSuiteCpMCChartItemValue");if(V[s]){r.class("sapSuiteCpMCSemanticColor"+d.getColor());}if(d.getTitle()){r.class("sapSuiteCpMCTitle");}r.openEnd();if(!isNaN(d.getValue())){r.text(v);}r.close("div");};M.extendMicroChartRenderer(C);return C;},true);
sap.ui.predefine('sap/suite/ui/microchart/HarveyBallMicroChart',["sap/ui/thirdparty/jquery","./library","sap/m/library","sap/ui/core/Control","sap/ui/Device","sap/ui/events/KeyCodes","sap/suite/ui/microchart/MicroChartUtils","sap/ui/core/ResizeHandler","./HarveyBallMicroChartRenderer"],function(q,l,M,C,D,K,a,R){"use strict";var V=M.ValueColor;var S=M.Size;var H=C.extend("sap.suite.ui.microchart.HarveyBallMicroChart",{metadata:{library:"sap.suite.ui.microchart",properties:{total:{group:"Misc",type:"float",defaultValue:null},totalLabel:{group:"Misc",type:"string"},totalScale:{group:"Misc",type:"string"},formattedLabel:{group:"Misc",type:"boolean",defaultValue:false},showTotal:{group:"Misc",type:"boolean",defaultValue:true},showFractions:{group:"Misc",type:"boolean",defaultValue:true},size:{group:"Misc",type:"sap.m.Size",defaultValue:"Auto"},colorPalette:{type:"string[]",group:"Appearance",defaultValue:[]},width:{type:"sap.ui.core.CSSSize",group:"Misc"},height:{type:"sap.ui.core.CSSSize",group:"Misc"},alignContent:{group:"Misc",type:"sap.suite.ui.microchart.HorizontalAlignmentType",defaultValue:"Left"},isResponsive:{type:"boolean",group:"Appearance",defaultValue:false},hideOnNoData:{type:"boolean",group:"Appearance",defaultValue:false}},associations:{ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},defaultAggregation:"items",aggregations:{items:{multiple:true,type:"sap.suite.ui.microchart.HarveyBallMicroChartItem",bindable:"bindable"}},events:{press:{}}}});H.VALUE_TRUNCATION_DIGITS=5;H.THRESHOLD_LOOK_XS=1.125;H.THRESHOLD_LOOK_S=3.5;H.THRESHOLD_LOOK_M=4.5;H.THRESHOLD_LOOK_L=5.875;H.prototype._getAltHeaderText=function(i){var A=this._oRb.getText("HARVEYBALLMICROCHART");if(i){A+=" "+this._oRb.getText("IS_ACTIVE");}if(!this._hasData()){A+="\n"+this._oRb.getText("NO_DATA");return A;}return A;};H.prototype._getAltSubText=function(i){var A="";var I=this.getItems();I.forEach(function(o){var s=o.getColor(),b=o.getTooltip_AsString(),c="";if(!b){return;}var d=(this.getColorPalette().length===0&&V[s])?this._oRb.getText(("SEMANTIC_COLOR_"+s).toUpperCase()):"";var L=o.getFractionLabel();var e=o.getFractionScale();if(!L&&e){L=o.getFormattedLabel()?o.getFraction():o.getFraction()+o.getFractionScale().substring(0,3);}else if(!o.getFormattedLabel()&&o.getFractionLabel()&&e){L+=o.getFractionScale().substring(0,3);}c+=L+" "+d;c=b.split("((AltText))").join(c);if(c){A+="\n"+c;i=false;}}.bind(this));if(this.getTotal()){var t=this.getTotalLabel();if(!t){t=this.getFormattedLabel()?this.getTotal():this.getTotal()+this.getTotalScale().substring(0,3);}else if(!this.getFormattedLabel()&&this.getTotalScale()){t+=this.getTotalScale().substring(0,3);}A+=(i?"":"\n")+this._oRb.getText("HARVEYBALLMICROCHART_TOTAL_TOOLTIP")+" "+t;}return A;};H.prototype.getTooltip_AsString=function(i){var t=C.prototype.getTooltip_AsString.apply(this,arguments),T=this._getAltHeaderText(i),I=false;if(t){T=t.split("((AltText))").join(T);}if(!t||!T){T="";I=true;}T+=this._getAltSubText(I);return T;};H.prototype._getAccessibilityControlType=function(){return this._oRb.getText("ACC_CTR_TYPE_HARVEYBALLMICROCHART");};H.prototype.init=function(){this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.microchart");this.setAggregation("tooltip","((AltText))",true);D.media.attachHandler(this.rerender,this,D.media.RANGESETS.SAP_STANDARD);this._sChartResizeHandlerId=null;this._bThemeApplied=true;if(!sap.ui.getCore().isInitialized()){this._bThemeApplied=false;sap.ui.getCore().attachInit(this._handleCoreInitialized.bind(this));}else{this._handleCoreInitialized();}};H.prototype.setSize=function(s){if(this.getSize()!==s){if(s===S.Responsive){this.setProperty("isResponsive",true);}else{this.setProperty("isResponsive",false);}this.setProperty("size",s,false);}return this;};H.prototype.setIsResponsive=function(i){var s,c=this.getSize();this.setProperty("isResponsive",i);if(i){s=S.Responsive;}else{s=c===S.Responsive?S.Auto:c;}this.setProperty("size",s);return this;};H.prototype._handleCoreInitialized=function(){this._bThemeApplied=sap.ui.getCore().isThemeApplied();if(!this._bThemeApplied){sap.ui.getCore().attachThemeChanged(this._handleThemeApplied,this);}};H.prototype._handleThemeApplied=function(){this._bThemeApplied=true;this.invalidate();sap.ui.getCore().detachThemeChanged(this._handleThemeApplied,this);};H.prototype.onBeforeRendering=function(){if(this._sChartResizeHandlerId){R.deregister(this._sChartResizeHandlerId);}this._unbindMouseEnterLeaveHandler();};H.prototype.onAfterRendering=function(){l._checkControlIsVisible(this,this._onControlIsVisible);this._bindMouseEnterLeaveHandler();};H.prototype._onControlIsVisible=function(){this._onResize();this._sChartResizeHandlerId=R.register(this,this._onResize.bind(this));};H.prototype._onResize=function(){var c=this.$(),f=c.height(),p=c.find(".sapSuiteHBMCChart").first(),t=c.find(".sapSuiteHBMCTextContainer").first(),b,P;c.removeClass("sapSuiteHBMCLookL sapSuiteHBMCLookM sapSuiteHBMCLookS sapSuiteHBMCLookXS");t.removeClass("sapSuiteHBMCTextContainerHide");p.css("width",p.css("height"));var s=c.find(".sapSuiteHBMCChartSvg")[0];if(s){s.setAttribute("viewBox","0 0 72 72");}if(f<this.convertRemToPixels(H.THRESHOLD_LOOK_S)){c.addClass("sapSuiteHBMCLookXS");if(s){s.setAttribute("viewBox","5 5 62 62");}}else if(f<this.convertRemToPixels(H.THRESHOLD_LOOK_M)){c.addClass("sapSuiteHBMCLookS");}else if(f<this.convertRemToPixels(H.THRESHOLD_LOOK_L)){c.addClass("sapSuiteHBMCLookM");}else{c.addClass("sapSuiteHBMCLookL");}b=c.width();P=p.width()+t.outerWidth();if(b<P){t.addClass("sapSuiteHBMCTextContainerHide");}};H.prototype._parseFormattedValue=function(v){return{scale:v.replace(/.*?([^+-.,\d]*)$/g,"$1").trim(),value:v.replace(/(.*?)[^+-.,\d]*$/g,"$1").trim()};};H.prototype.ontap=function(e){if(D.browser.msie){this.$().trigger("focus");}this.firePress();};H.prototype.onkeydown=function(e){if(e.which==K.SPACE){e.preventDefault();}};H.prototype.onkeyup=function(e){if(e.which===K.ENTER||e.which===K.SPACE){this.firePress();e.preventDefault();}};H.prototype.attachEvent=function(e,d,f,L){C.prototype.attachEvent.call(this,e,d,f,L);if(this.hasListeners("press")){this.$().attr("tabindex",0).addClass("sapSuiteUiMicroChartPointer");}return this;};H.prototype.detachEvent=function(e,f,L){C.prototype.detachEvent.call(this,e,f,L);if(!this.hasListeners("press")){this.$().removeAttr("tabindex").removeClass("sapSuiteUiMicroChartPointer");}return this;};H.prototype.exit=function(e){D.media.detachHandler(this.rerender,this,D.media.RANGESETS.SAP_STANDARD);R.deregister(this._sChartResizeHandlerId);};H.prototype._addTitleAttribute=function(){if(!this.$().attr("title")&&this._hasData()){this.$().attr("title",this.getTooltip_AsString());}};H.prototype._removeTitleAttribute=function(){if(this.$().attr("title")){this.$().removeAttr("title");}};H.prototype._bindMouseEnterLeaveHandler=function(){this.$().on("mouseenter.tooltip",this._addTitleAttribute.bind(this));this.$().on("mouseleave.tooltip",this._removeTitleAttribute.bind(this));};H.prototype._unbindMouseEnterLeaveHandler=function(){this.$().off("mouseenter.tooltip");this.$().off("mouseleave.tooltip");};H._truncateValue=function(v,d){var t=v.replace(String.fromCharCode(8206),"").replace(String.fromCharCode(8207),"");var s=t.replace(/[+-., \d]*(.*)$/g,"$1").trim().replace(/\.$/,"");v=t.replace(/([+-., \d]*).*$/g,"$1").trim();var h=v[d-1]==="."||v[d-1]===",";if(v.length>=d&&h){return v.substring(0,d-1)+s;}else{return v.substring(0,d)+s;}};H.prototype._hasData=function(){return this.getItems().length>0;};H.prototype.firePress=function(){if(this._hasData()){C.prototype.fireEvent.call(this,"press",arguments);}};a.extendMicroChart(H);return H;});
sap.ui.predefine('sap/suite/ui/microchart/HarveyBallMicroChartItem',["./library","sap/ui/core/Element"],function(l,E){"use strict";var H=E.extend("sap.suite.ui.microchart.HarveyBallMicroChartItem",{metadata:{library:"sap.suite.ui.microchart",properties:{color:{group:"Misc",type:"sap.m.ValueCSSColor",defaultValue:"Neutral"},fraction:{group:"Misc",type:"float",defaultValue:0},fractionLabel:{group:"Misc",type:"string"},fractionScale:{group:"Misc",type:"string"},formattedLabel:{group:"Misc",type:"boolean",defaultValue:false}}}});H.prototype.init=function(){this.setAggregation("tooltip","((AltText))",true);};return H;});
sap.ui.predefine('sap/suite/ui/microchart/HarveyBallMicroChartRenderer',["sap/ui/thirdparty/jquery","sap/m/library","sap/ui/Device","./library","sap/base/security/encodeXML","sap/suite/ui/microchart/MicroChartRenderUtils","sap/ui/core/theming/Parameters"],function(q,M,D,l,e,a,P,V,b){"use strict";var V=M.ValueColor;var b=M.ValueCSSColor;var H;var c={apiVersion:2};c._iReferenceControlSize=72;c._iReferenceControlCenter=c._iReferenceControlSize/2;c.render=function(r,C){H=H||sap.ui.require("sap/suite/ui/microchart/HarveyBallMicroChart");if(!C._hasData()){this._renderNoData(r,C);return;}if(!C._bThemeApplied){return;}this._calculatePath(C);var d=C.getColorPalette();var t="";var v="";var s="";var f=false;var g=0;var h="";var G=function(i){if(V[i]){h="sapSuiteHBMCSemanticColor"+e(i);}else if(b.isValid(i)){return P.get(i)||i;}return null;};var i=d.length>0?G(d[0]):null;var j=this._oPath.center;if(C._isThemeHighContrast()){j-=1;}if(C.getItems().length){var p=C.getItems()[0];g=p.getFraction();v=p.getFractionLabel()?p.getFractionLabel():v+p.getFraction();s=p.getFractionScale()?p.getFractionScale().substring(0,3):s;f=p.getFormattedLabel();if(!i&&!h){i=G(p.getColor());}}if(f){var F=C._parseFormattedValue(v);s=F.scale.substring(0,3);v=F.value;}var T=C.getTotal();var k=C.getTotalLabel()?C.getTotalLabel():""+C.getTotal();if(C.getTotalScale()){t=C.getTotalScale().substring(0,3);}if(C.getFormattedLabel()){var o=C._parseFormattedValue(k);t=o.scale.substring(0,3);k=o.value;}if(v){v=H._truncateValue(v,H.VALUE_TRUNCATION_DIGITS);}if(k){k=H._truncateValue(k,H.VALUE_TRUNCATION_DIGITS);}r.openStart("div",C);this._writeMainProperties(r,C);r.openEnd();r.openStart("div");r.class("sapSuiteHBMCAlign"+C.getAlignContent());r.class("sapSuiteHBMCVerticalAlignmentContainer");r.openEnd();r.openStart("div");r.class("sapSuiteHBMCChart");r.openEnd();r.openStart("svg",C.getId()+"-harvey-ball");r.class("sapSuiteHBMCChartSvg");r.attr("viewBox","0 0 72 72");r.attr("focusable",false);r.openEnd();r.openStart("g").openEnd();r.openStart("circle");r.attr("cx",this._oPath.center);r.attr("cy",this._oPath.center);r.attr("r",j);r.class("sapSuiteHBMCBackgroundCircle");r.openEnd();r.close("circle");if(g&&g>=T){r.openStart("circle");r.attr("cx",this._oPath.center);r.attr("cy",this._oPath.center);r.attr("r",j-this._oPath.border);r.class("sapSuiteHBMCSegment");if(i){r.style("fill",i);}else{r.class(h);}r.openEnd();r.close("circle");}else if(g>0){r.openStart("path",C.getId()+"-segment");r.class("sapSuiteHBMCSegment");if(i){r.style("fill",i);}else{r.class(h);}r.attr("d",this._serializePieChart());r.openEnd();r.close("path");}r.close("g");r.close("svg");r.close("div");r.openStart("div");r.class("sapSuiteHBMCTextContainer");r.openEnd();if(C.getShowFractions()){r.openStart("div");r.class("sapSuiteHBMCValueContainer");r.openEnd();this.renderLabel(r,C,[h,"sapSuiteHBMCValue"],v,i,"-fraction");this.renderLabel(r,C,[h,"sapSuiteHBMCValueScale"],s,i,"-fraction-scale");r.close("div");}if(C.getShowTotal()){r.openStart("div");r.class("sapSuiteHBMCTotalContainer");r.openEnd();this.renderLabel(r,C,[h,"sapSuiteHBMCTotal"],k,i,"-total");this.renderLabel(r,C,[h,"sapSuiteHBMCTotalScale"],t,i,"-total-scale");r.close("div");}r.close("div");r.close("div");r.close("div");};c._writeMainProperties=function(r,C){var i=C.hasListeners("press");this._renderActiveProperties(r,C);var A=C.getTooltip_AsString(i);r.attr("role","figure");if(C.getAriaLabelledBy().length){r.accessibilityState(C);}else{r.attr("aria-label",A);}r.class("sapSuiteHBMC");r.class("sapSuiteHBMCSize"+C.getSize());r.style("width",C.getWidth());r.style("height",C.getHeight());};c.renderLabel=function(r,C,d,L,s,I){var u=!(d.indexOf("sapSuiteHBMCTotal")>-1||d.indexOf("sapSuiteHBMCTotalScale")>-1);r.openStart("span",C.getId()+I);for(var i=0;i<d.length;i++){if(!(i===0&&s&&u)){r.class(d[i]);}}r.openEnd();if(L){r.text(L);}r.close("span");};c._calculatePath=function(C){var t=C.getTotal();var f=0;if(C.getItems().length){f=C.getItems()[0].getFraction();}var i=c._iReferenceControlCenter;var B=5;this._oPath={initial:{x:i,y:i},lineTo:{x:i,y:B},arc:{x1:i-B,y1:i-B,largeArc:0,x2:"",y2:""},size:c._iReferenceControlSize,border:B,center:i};var A=f/t*360;var r=Math.PI/180.0;var R=this._oPath.center-this._oPath.border;var d=R*Math.cos((A-90)*r)+this._oPath.center;var g=this._oPath.size-(R*Math.sin((A+90)*r)+this._oPath.center);this._oPath.arc.x2=d.toFixed(2);this._oPath.arc.y2=g.toFixed(2);var L=t/f<2?1:0;this._oPath.arc.largeArc=L;};c._serializePieChart=function(){var p=this._oPath;return["M",p.initial.x,",",p.initial.y," L",p.initial.x,",",p.lineTo.y," A",p.arc.x1,",",p.arc.y1," 0 ",p.arc.largeArc,",1 ",p.arc.x2,",",p.arc.y2," L",p.initial.x,",",p.initial.y," z"].join("");};a.extendMicroChartRenderer(c);return c;},true);
sap.ui.predefine('sap/suite/ui/microchart/MicroChartRenderUtils',[],function(){"use strict";var M={apiVersion:2,extendMicroChartRenderer:function(a){a._renderNoData=function(r,c){if(!c.getHideOnNoData()){r.openStart("div",c);this._writeMainProperties(r,c);r.openEnd();r.openStart("div");r.class("sapSuiteUiMicroChartNoData");r.openEnd();r.openStart("div");r.class("sapSuiteUiMicroChartNoDataTextWrapper");r.openEnd();var R=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.microchart");var t=R.getText("NO_DATA");r.openStart("span").openEnd();r.text(t);r.close("span");r.close("div");r.close("div");r.close("div");}};a._renderActiveProperties=function(r,c){var i=c.hasListeners("press");if(i){if(c._hasData()){r.class("sapSuiteUiMicroChartPointer");}r.attr("tabindex","0");}};}};return M;},true);
sap.ui.predefine('sap/suite/ui/microchart/MicroChartUtils',["sap/ui/core/Control","sap/ui/Device","sap/m/library","sap/ui/thirdparty/jquery"],function(C,D,M,q){"use strict";var S=M.Size;var a={extendMicroChart:function(b){b.prototype._isResponsive=function(){return this.getSize()===S.Responsive;};b.prototype._digitsAfterDecimalPoint=function(v){var A=(""+v).match(/[.,](\d+)/g);return(A)?(""+A).length-1:0;};b.prototype.getAccessibilityInfo=function(){return{type:this._getAccessibilityControlType(),description:this.getTooltip_AsString()};};b.prototype._isThemeHighContrast=function(){return/(hcw|hcb)/g.test(sap.ui.getCore().getConfiguration().getTheme());};b.prototype.convertRemToPixels=function(r){return r*parseFloat(window.getComputedStyle(document.documentElement).fontSize);};b.prototype._isAnyLabelTruncated=function(l){return l.toArray().some(this._isLabelTruncated);};b.prototype._isAnyLabelVerticallyTruncated=function(l){return l.toArray().some(this._isLabelVerticallyTruncated);};b.prototype._isLabelTruncated=function(l){if(D.browser.edge||D.browser.msie){return Math.abs(l.scrollWidth-l.offsetWidth)>1;}else{return l.scrollWidth>l.offsetWidth;}};b.prototype._isLabelVerticallyTruncated=function(l){return Math.abs(l.scrollHeight-l.offsetHeight)>1;};b.prototype._isAnyLabelNumericAndTruncated=function(l){return l.toArray().some(this._isLabelNumericAndTruncated.bind(this));};b.prototype._isLabelNumericAndTruncated=function(l){return(!q.isNumeric(l.textContent))?false:this._isLabelTruncated(l);};b.prototype.isColorCorrect=function(c){return((M.ValueCSSColor.isValid(c)&&c!=="")||(M.ValueCSSColor.isValid(c.below)&&c.below!==""&&M.ValueCSSColor.isValid(c.above)&&c.above!==""));};b.prototype.getTooltip_AsString=function(i){var t=C.prototype.getTooltip_AsString.apply(this,arguments),T=this._getAltHeaderText(i),I=false;if(t){t=t.split("((AltText))").join(T);}if(!t){t="";I=true;}if(this._getAltSubText){t+=this._getAltSubText(I);}return t;};}};return a;},true);
sap.ui.predefine('sap/suite/ui/microchart/library',["sap/ui/thirdparty/jquery","sap/ui/core/library","sap/m/library"],function(q){"use strict";sap.ui.getCore().initLibrary({name:"sap.suite.ui.microchart",version:"1.88.0",dependencies:["sap.ui.core","sap.m"],types:["sap.suite.ui.microchart.AreaMicroChartViewType","sap.suite.ui.microchart.BulletMicroChartModeType","sap.suite.ui.microchart.CommonBackgroundType","sap.suite.ui.microchart.ComparisonMicroChartViewType","sap.suite.ui.microchart.DeltaMicroChartViewType","sap.suite.ui.microchart.HorizontalAlignmentType","sap.suite.ui.microchart.LoadStateType","sap.suite.ui.microchart.LineType"],interfaces:[],controls:["sap.suite.ui.microchart.AreaMicroChart","sap.suite.ui.microchart.BulletMicroChart","sap.suite.ui.microchart.ColumnMicroChart","sap.suite.ui.microchart.ComparisonMicroChart","sap.suite.ui.microchart.DeltaMicroChart","sap.suite.ui.microchart.HarveyBallMicroChart","sap.suite.ui.microchart.LineMicroChart","sap.suite.ui.microchart.InteractiveBarChart","sap.suite.ui.microchart.InteractiveDonutChart","sap.suite.ui.microchart.InteractiveLineChart","sap.suite.ui.microchart.RadialMicroChart","sap.suite.ui.microchart.StackedBarMicroChart"],elements:["sap.suite.ui.microchart.AreaMicroChartPoint","sap.suite.ui.microchart.AreaMicroChartItem","sap.suite.ui.microchart.AreaMicroChartLabel","sap.suite.ui.microchart.BulletMicroChartData","sap.suite.ui.microchart.ColumnMicroChartData","sap.suite.ui.microchart.ColumnMicroChartLabel","sap.suite.ui.microchart.ComparisonMicroChartData","sap.suite.ui.microchart.HarveyBallMicroChartItem","sap.suite.ui.microchart.LineMicroChartPoint","sap.suite.ui.microchart.LineMicroChartEmphasizedPoint","sap.suite.ui.microchart.LineMicroChartLine","sap.suite.ui.microchart.InteractiveBarChartBar","sap.suite.ui.microchart.InteractiveDonutChartSegment","sap.suite.ui.microchart.InteractiveLineChartPoint","sap.suite.ui.microchart.StackedBarMicroChartBar"]});sap.suite.ui.microchart.AreaMicroChartViewType={Normal:"Normal",Wide:"Wide"};sap.suite.ui.microchart.BulletMicroChartModeType={Actual:"Actual",Delta:"Delta"};sap.suite.ui.microchart.CommonBackgroundType={Lightest:"Lightest",ExtraLight:"ExtraLight",Light:"Light",MediumLight:"MediumLight",Medium:"Medium",Dark:"Dark",ExtraDark:"ExtraDark",Darkest:"Darkest",Transparent:"Transparent"};sap.suite.ui.microchart.LineType={Solid:"Solid",Dashed:"Dashed",Dotted:"Dotted"};sap.suite.ui.microchart.HorizontalAlignmentType={Left:"Left",Center:"Center",Right:"Right"};sap.suite.ui.microchart.ComparisonMicroChartViewType={Normal:"Normal",Wide:"Wide",Responsive:"Responsive"};sap.suite.ui.microchart.DeltaMicroChartViewType={Normal:"Normal",Wide:"Wide",Responsive:"Responsive"};sap.suite.ui.microchart.LoadStateType={Loading:"Loading",Loaded:"Loaded",Failed:"Failed",Disabled:"Disabled"};sap.suite.ui.microchart._aStandardMarginClassNames=["sapUiTinyMargin","sapUiSmallMargin","sapUiMediumMargin","sapUiLargeMargin","sapUiTinyMarginBeginEnd","sapUiTinyMarginTopBottom","sapUiSmallMarginBeginEnd","sapUiSmallMarginTopBottom","sapUiMediumMarginBeginEnd","sapUiMediumMarginTopBottom","sapUiLargeMarginBeginEnd","sapUiLargeMarginTopBottom","sapUiTinyMarginTop","sapUiTinyMarginBottom","sapUiTinyMarginBegin","sapUiTinyMarginEnd","sapUiSmallMarginTop","sapUiSmallMarginBottom","sapUiSmallMarginBegin","sapUiSmallMarginEnd","sapUiMediumMarginTop","sapUiMediumMarginBottom","sapUiMediumMarginBegin","sapUiMediumMarginEnd","sapUiLargeMarginTop","sapUiLargeMarginBottom","sapUiLargeMarginBegin","sapUiLargeMarginEnd","sapUiResponsiveMargin","sapUiNoMargin","sapUiNoMarginTop","sapUiNoMarginBottom","sapUiNoMarginBegin","sapUiNoMarginEnd"];sap.suite.ui.microchart._removeStandardMargins=function(c){for(var i=0;i<sap.suite.ui.microchart._aStandardMarginClassNames.length;i++){if(c.hasStyleClass(sap.suite.ui.microchart._aStandardMarginClassNames[i])){c.removeStyleClass(sap.suite.ui.microchart._aStandardMarginClassNames[i]);}}};sap.suite.ui.microchart._passParentContextToChild=function(c,C){if(c.data("_parentRenderingContext")){C.data("_parentRenderingContext",c.data("_parentRenderingContext"));}else if(typeof c.getParent==="function"){C.data("_parentRenderingContext",c.getParent());}};sap.suite.ui.microchart._isTooltipSuppressed=function(t){return t!==null&&t!==undefined&&!t.trim();};sap.suite.ui.microchart._checkControlIsVisible=function(c,a){function i(){return c.getVisible()&&c.getDomRef()&&c.$().is(":visible")&&c.getDomRef().getBoundingClientRect().width!==0;}function d(){if(i()){sap.ui.getCore().detachIntervalTimer(d);a.call(c);}}var o=c.exit;c.exit=function(){sap.ui.getCore().detachIntervalTimer(d);if(o){o.call(c);}};if(i()){a.call(c);}else{sap.ui.getCore().attachIntervalTimer(d);}};return sap.suite.ui.microchart;});
sap.ui.require.preload({
	"sap/ushell/components/tiles/cdm/applauncher/manifest.json":'{"_version":"1.21.0","sap.flp":{"type":"tile","tileSize":"1x1","vizOptions":{"displayFormats":{"supported":["tile","link","flat","flatWide"],"default":"tile"}}},"sap.app":{"id":"sap.ushell.components.tiles.cdm.applauncher","type":"component","applicationVersion":{"version":"1.0.0"},"title":"","tags":{"keywords":[]},"ach":"CA-FE-FLP-COR"},"sap.ui":{"_version":"1.1.0","technology":"UI5","icons":{"icon":""},"deviceTypes":{"desktop":true,"tablet":true,"phone":true},"supportedThemes":["sap_hcb","sap_belize","sap_belize_plus"]},"sap.ui5":{"_version":"1.1.0","componentName":"sap.ushell.components.tiles.cdm.applauncher","dependencies":{"minUI5Version":"1.42","libs":{"sap.m":{}}},"rootView":{"viewName":"sap.ushell.components.tiles.cdm.applauncher.StaticTile","type":"JS"},"handleValidation":false,"contentDensities":{"compact":true,"cozy":true}}}',
	"sap/ushell/components/tiles/cdm/applauncherdynamic/manifest.json":'{"_version":"1.21.0","sap.flp":{"type":"tile","tileSize":"1x1","vizOptions":{"displayFormats":{"supported":["tile","link","flat","flatWide"],"default":"tile"}}},"sap.app":{"id":"sap.ushell.components.tiles.cdm.applauncherdynamic","_version":"1.0.0","type":"component","applicationVersion":{"version":"1.0.0"},"title":"","description":"","tags":{"keywords":[]},"ach":"CA-FLP-FE-COR"},"sap.ui":{"_version":"1.1.0","icons":{"icon":""},"deviceTypes":{"desktop":true,"tablet":true,"phone":true},"supportedThemes":["sap_hcb","sap_belize","sap_belize_plus"]},"sap.ui5":{"_version":"1.1.0","componentName":"sap.ushell.components.tiles.cdm.applauncherdynamic","dependencies":{"minUI5Version":"1.42","libs":{"sap.m":{}}},"rootView":{"viewName":"sap.ushell.components.tiles.cdm.applauncherdynamic.DynamicTile","type":"JS"},"handleValidation":false}}',
	"sap/ushell/components/tiles/indicatorArea/AreaChartTileChip.xml":'<?xml version="1.0" encoding="UTF-8"?>\n<chip xmlns="http://schemas.sap.com/sapui2/services/Chip/1">\n\t<implementation>\n\t\t<sapui5>\n\t\t\t<basePath>../../../../../</basePath>\n\t\t\t<viewName>sap.ushell.components.tiles.indicatorArea.AreaChartTile.view.js</viewName>\n\t\t</sapui5>\n\t</implementation>\n\t<appearance>\n\t\t<title />\n\t\t<description />\n\t</appearance>\n\t<contracts>\n\t\t<consume id="configuration">\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguration" />\n\t\t\t\t<parameter name="isSufficient" />\n\t\t\t\t<parameter name="timeStamp" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id="writeConfiguration">\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguation" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id="visible" />\n\t\t<consume id="url" />\n\t\t<consume id="preview" />\n\t\t<consume id="search" />\n\t\t<consume id="bag" />\n\t</contracts>\n</chip>\n',
	"sap/ushell/components/tiles/indicatorDual/DualTileChip.xml":'<?xml version="1.0" encoding="UTF-8"?>\n<chip xmlns="http://schemas.sap.com/sapui2/services/Chip/1">\n\t<implementation>\n\t\t<sapui5>\n\t\t\t<basePath>../../../../../</basePath>\n\t\t\t<viewName>sap.ushell.components.tiles.indicatorDual.DualTile.view.js</viewName>\n\t\t</sapui5>\n\t</implementation>\n\t<appearance>\n\t\t<title />\n\t\t<description />\n\t</appearance>\n\t<contracts>\n\t\t<consume id="configuration">\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguration" />\n\t\t\t\t<parameter name="isSufficient" />\n\t\t\t\t<parameter name="timeStamp" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t\t<parameter name="row">1</parameter>\n\t\t\t\t<parameter name="col">2</parameter>\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id="writeConfiguration">\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguation" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id="visible" />\n\t\t<consume id="url" />\n\t\t<consume id="preview" />\n\t\t<consume id="search" />\n\t\t<consume id="bag" />\n\t</contracts>\n</chip>\n',
	"sap/ushell/components/tiles/indicatorDualComparison/DualComparisonChip.xml":'<?xml version="1.0" encoding="UTF-8"?>\n<chip xmlns="http://schemas.sap.com/sapui2/services/Chip/1">\n\t<implementation>\n\t\t<sapui5>\n\t\t\t<basePath>../../</basePath>\n\t\t\t<viewName>tiles/indicatorDualComparison.DualComparison.view.js</viewName>\n\t\t</sapui5>\n\t</implementation>\n\t<appearance>\n\t\t<title />\n\t\t<description />\n\t</appearance>\n\t<contracts>\n\t\t<consume id="configuration">\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguration" />\n\t\t\t\t<parameter name="isSufficient" />\n\t\t\t\t<parameter name="timeStamp" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t\t<parameter name="row">1</parameter>\n\t\t\t\t<parameter name="col">2</parameter>\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id="writeConfiguration">\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguation" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id="visible" />\n\t\t<consume id="url" />\n\t\t<consume id="preview" />\n\t\t<consume id="search" />\n\t\t<consume id="bag" />\n\t</contracts>\n</chip>\n',
	"sap/ushell/components/tiles/indicatorDualContribution/DualContributionChip.xml":'<?xml version="1.0" encoding="UTF-8"?>\n<chip xmlns="http://schemas.sap.com/sapui2/services/Chip/1">\n\t<implementation>\n\t\t<sapui5>\n\t\t\t<basePath>../../</basePath>\n\t\t\t<viewName>tiles/indicatorDualComparison.DualComparison.view.js</viewName>\n\t\t</sapui5>\n\t</implementation>\n\t<appearance>\n\t\t<title />\n\t\t<description />\n\t</appearance>\n\t<contracts>\n\t\t<consume id="configuration">\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguration" />\n\t\t\t\t<parameter name="isSufficient" />\n\t\t\t\t<parameter name="timeStamp" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t\t<parameter name="row">1</parameter>\n\t\t\t\t<parameter name="col">2</parameter>\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id="writeConfiguration">\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguation" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id="visible" />\n\t\t<consume id="url" />\n\t\t<consume id="preview" />\n\t\t<consume id="search" />\n\t\t<consume id="bag" />\n\t</contracts>\n</chip>\n',
	"sap/ushell/components/tiles/indicatorDualDeviation/DualDeviationChip.xml":'<?xml version="1.0" encoding="UTF-8"?>\n<chip xmlns="http://schemas.sap.com/sapui2/services/Chip/1">\n\t<implementation>\n\t\t<sapui5>\n\t\t\t<basePath>../../</basePath>\n\t\t\t<viewName>tiles/indicatorDualDeviation.DualDeviation.view.js</viewName>\n\t\t</sapui5>\n\t</implementation>\n\t<appearance>\n\t\t<title />\n\t\t<description />\n\t</appearance>\n\t<contracts>\n\t\t<consume id="configuration">\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguration" />\n\t\t\t\t<parameter name="isSufficient" />\n\t\t\t\t<parameter name="timeStamp" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t\t<parameter name="row">1</parameter>\n\t\t\t\t<parameter name="col">2</parameter>\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id="writeConfiguration">\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguation" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id="visible" />\n\t\t<consume id="url" />\n\t\t<consume id="preview" />\n\t\t<consume id="search" />\n\t\t<consume id="bag" />\n\t</contracts>\n</chip>\n',
	"sap/ushell/components/tiles/indicatorDualTrend/DualTrendChip.xml":'<?xml version="1.0" encoding="UTF-8"?>\n<chip xmlns="http://schemas.sap.com/sapui2/services/Chip/1">\n\t<implementation>\n\t\t<sapui5>\n\t\t\t<basePath>../../</basePath>\n\t\t\t<viewName>tiles/indicatorDualTrend.DualTrend.view.js</viewName>\n\t\t</sapui5>\n\t</implementation>\n\t<appearance>\n\t\t<title />\n\t\t<description />\n\t</appearance>\n\t<contracts>\n\t\t<consume id="configuration">\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguration" />\n\t\t\t\t<parameter name="isSufficient" />\n\t\t\t\t<parameter name="timeStamp" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t\t<parameter name="row">1</parameter>\n\t\t\t\t<parameter name="col">2</parameter>\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id="writeConfiguration">\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguation" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id="visible" />\n\t\t<consume id="url" />\n\t\t<consume id="preview" />\n\t\t<consume id="search" />\n\t</contracts>\n</chip>\n',
	"sap/ushell/components/tiles/indicatorHarveyBall/HarveyBallTileChip.xml":'<?xml version="1.0" encoding="UTF-8"?>\n<chip xmlns="http://schemas.sap.com/sapui2/services/Chip/1">\n\t<implementation>\n\t\t<sapui5>\n\t\t\t<basePath>../../</basePath>\n\t\t\t<viewName>tiles/indicatorHarveyBall.HarveyBallTile.view.js</viewName>\n\t\t</sapui5>\n\t</implementation>\n\t<appearance>\n\t\t<title />\n\t\t<description />\n\t</appearance>\n\t<contracts>\n\t\t<consume id="configuration">\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguration" />\n\t\t\t\t<parameter name="isSufficient" />\n\t\t\t\t<parameter name="timeStamp" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id="writeConfiguration">\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguation" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id="visible" />\n\t\t<consume id="url" />\n\t\t<consume id="preview" />\n\t\t<consume id="search" />\n\t\t<consume id="bag" />\n\t</contracts>\n</chip>\n',
	"sap/ushell/components/tiles/indicatorcomparison/ComparisonTileChip.xml":'<?xml version="1.0" encoding="UTF-8"?>\n<chip xmlns="http://schemas.sap.com/sapui2/services/Chip/1">\n\t<implementation>\n\t\t<sapui5>\n\t\t\t<basePath>../../../../../</basePath>\n\t\t\t<viewName>sap.ushell.components.tiles.indicatorcomparison.ComparisonTile.view.js</viewName>\n\t\t</sapui5>\n\t</implementation>\n\t<appearance>\n\t\t<title />\n\t\t<description />\n\t</appearance>\n\t<contracts>\n\t\t<consume id="configuration">\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguration" />\n\t\t\t\t<parameter name="isSufficient" />\n\t\t\t\t<parameter name="timeStamp" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id="writeConfiguration">\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguation" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id="visible" />\n\t\t<consume id="url" />\n\t\t<consume id="preview" />\n\t\t<consume id="search" />\n\t\t<consume id="bag" />\n\t</contracts>\n</chip>\n',
	"sap/ushell/components/tiles/indicatorcontribution/ContributionTileChip.xml":'<?xml version="1.0" encoding="UTF-8"?>\n<chip xmlns="http://schemas.sap.com/sapui2/services/Chip/1">\n\t<implementation>\n\t\t<sapui5>\n\t\t\t<basePath>../../../../../</basePath>\n\t\t\t<viewName>sap.ushell.components.tiles.indicatorcontribution.ContributionTile.view.js</viewName>\n\t\t</sapui5>\n\t</implementation>\n\t<appearance>\n\t\t<title />\n\t\t<description />\n\t</appearance>\n\t<contracts>\n\t\t<consume id="configuration">\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguration" />\n\t\t\t\t<parameter name="isSufficient" />\n\t\t\t\t<parameter name="timeStamp" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id="writeConfiguration">\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguation" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id="visible" />\n\t\t<consume id="url" />\n\t\t<consume id="preview" />\n\t\t<consume id="search" />\n\t\t<consume id="bag" />\n\t</contracts>\n</chip>\n',
	"sap/ushell/components/tiles/indicatordeviation/DeviationTileChip.xml":'<?xml version="1.0" encoding="UTF-8"?>\n<chip xmlns="http://schemas.sap.com/sapui2/services/Chip/1">\n\t<implementation>\n\t\t<sapui5>\n\t\t\t<basePath>../../../../../</basePath>\n\t\t\t<viewName>sap.ushell.components.tiles.indicatordeviation.DeviationTile.view.js</viewName>\n\t\t</sapui5>\n\t</implementation>\n\t<appearance>\n\t\t<title />\n\t\t<description />\n\t</appearance>\n\t<contracts>\n\t\t<consume id="configuration">\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguration" />\n\t\t\t\t<parameter name="isSufficient" />\n\t\t\t\t<parameter name="timeStamp" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t\t<parameter name="row">1</parameter>\n\t\t\t\t<parameter name="col">1</parameter>\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id="writeConfiguration">\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguation" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id="visible" />\n\t\t<consume id="url" />\n\t\t<consume id="preview" />\n\t\t<consume id="search" />\n\t\t<consume id="bag" />\n\t</contracts>\n</chip>\n',
	"sap/ushell/components/tiles/indicatornumeric/NumericTileChip.xml":'<?xml version="1.0" encoding="UTF-8"?>\n<chip xmlns="http://schemas.sap.com/sapui2/services/Chip/1">\n\t<implementation>\n\t\t<sapui5>\n\t\t\t<basePath>../../../../../</basePath>\n\t\t\t<viewName>sap.ushell.components.tiles.indicatornumeric.NumericTile.view.js</viewName>\n\t\t</sapui5>\n\t</implementation>\n\t<appearance>\n\t\t<title />\n\t\t<description />\n\t</appearance>\n\t<contracts>\n\t\t<consume id="configuration">\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguration" />\n\t\t\t\t<parameter name="isSufficient" />\n\t\t\t\t<parameter name="timeStamp" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id="writeConfiguration">\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguation" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id="visible" />\n\t\t<consume id="url" />\n\t\t<consume id="preview" />\n\t\t<consume id="search" />\n\t\t<consume id="bag" />\n\t</contracts>\n</chip>\n',
/*
 * Copyright (C) 2009-2014 SAP SE or an SAP affiliate company. All rights reserved
 */
	"sap/ca/ui/model/format/FormatHelper.js":function(){jQuery.sap.declare("sap.ca.ui.model.format.FormatHelper");jQuery.sap.require("sap.ui.core.format.NumberFormat");jQuery.sap.require("sap.ui.core.LocaleData");sap.ui.base.Object.extend("sap.ca.ui.model.format.FormatHelper",{});
sap.ca.ui.model.format.FormatHelper.stringToNumeric=function(s){var h=/^\s*[\+-]?0[xX]/;if(h.test(s)){return parseInt(s,16);}else{return parseFloat(s);}};
sap.ca.ui.model.format.FormatHelper.toNumeric=function(o){if((o===null)||(o===undefined)){return NaN;}var t=typeof o;var r;switch(t){case"number":r=o;break;case"string":r=sap.ca.ui.model.format.FormatHelper.stringToNumeric(o);break;case"object":var v=o.valueOf();if(typeof v==="number"){r=v;}else if(Array.isArray(o)){r=NaN;}else{r=sap.ca.ui.model.format.FormatHelper.stringToNumeric(o.toString());}break;default:r=NaN;break;}return r;};
sap.ca.ui.model.format.FormatHelper.isNumeric=function(o){return isFinite(sap.ca.ui.model.format.FormatHelper.toNumeric(o));};
sap.ca.ui.model.format.FormatHelper.getFormatOptions=function(o,l){var f={};f.locale=l;var t=typeof o;switch(t){case"number":f.decimals=o;break;case"object":if(typeof o.locale==="string"){f.locale=new sap.ui.core.Locale(o.locale);}else if(o.locale){f.locale=o.locale;}f.decimals=o.decimals;f.rounding=o.rounding;f.formatStyle=o.formatStyle;f.shortDecimals=o.shortDecimals;f.shortRounding=o.shortRounding;break;}if(!f.locale){if(sap.ui.getCore().getConfiguration().getLanguage()=="ZH"){f.locale=new sap.ui.core.Locale("zh_CN");}else{f.locale=sap.ui.getCore().getConfiguration().getFormatSettings().getFormatLocale();}}return f;};
sap.ca.ui.model.format.FormatHelper.hasRounding=function(o){var r;if(o!==undefined){if(typeof o==="number"){r=true;}else{if(o.formatStyle==="short"){r=(o.shortDecimals!==undefined)||(o.shortRounding!==undefined);}else{r=(o.decimals!==undefined)||(o.rounding!==undefined);}}}else{r=false;}return r;};
sap.ca.ui.model.format.FormatHelper.roundNumber=function(n,o){o=o||{};var r;var R,d;if(o.formatStyle==="short"){R=o.shortRounding;d=o.shortDecimals;}else{R=o.rounding;d=o.decimals;}if(R){r=R(n);}else if(d!==undefined){var a=sap.ca.ui.model.format.FormatHelper._getDecimals(d,n);r=n.toFixed(a);}else{r=n;}return r;};
sap.ca.ui.model.format.FormatHelper._getDecimals=function(d,n){var a;if(typeof d==="function"){a=d(n);}else{a=d;}return a;};
sap.ca.ui.model.format.FormatHelper._getUi5DecimalsFormatOptions=function(f,n,a){var u={};var d=null;if(f.formatStyle==="short"){d=f.shortDecimals;}else if(f.decimals||f.decimals===0){d=f.decimals;}if(d!==null){var D=sap.ca.ui.model.format.FormatHelper._getDecimals(d,n);u.minFractionDigits=D;u.maxFractionDigits=D;}else if(typeof a==="string"){var b=a.indexOf(".");var i=(b>-1)?Math.max(a.length-b-1,0):0;u.minFractionDigits=i;u.maxFractionDigits=i;}return u;};
sap.ca.ui.model.format.FormatHelper.formatNumber=function(n,o){var a=sap.ca.ui.model.format.FormatHelper.toNumeric(n);if(!isFinite(a)){return"";}var f=sap.ca.ui.model.format.FormatHelper.getFormatOptions(o);var u=sap.ca.ui.model.format.FormatHelper._getUi5DecimalsFormatOptions(f,a,n);var b=sap.ui.core.format.NumberFormat.getFloatInstance(u,f.locale);if(sap.ca.ui.model.format.FormatHelper.hasRounding(o)){a=sap.ca.ui.model.format.FormatHelper.roundNumber(a,f);return b.format(a);}else{return b.format(n);}};
sap.ca.ui.model.format.FormatHelper.getMagnitude=function(n){var _=[{value:1e3,suffix:"Kilo"},{value:1e6,suffix:"Mega"},{value:1e9,suffix:"Giga"},{value:1e12,suffix:"Tera"},{value:1e15,suffix:"Peta"},{value:1e18,suffix:"Exa"},{value:1e21,suffix:"Zetta"},{value:1e24,suffix:"Yotta"}];var a=(n>=0?n:-n);for(var i=_.length-1;i>=0;--i){var m=_[i];if(a>=m.value){return m;}}return{value:1,suffix:""};};
},
	"sap/ca/ui/model/format/NumberFormat.js":function(){jQuery.sap.declare("sap.ca.ui.model.format.NumberFormat");jQuery.sap.require("sap.ui.core.LocaleData");jQuery.sap.require("sap.ca.ui.model.format.FormatHelper");jQuery.sap.require("sap.ca.ui.utils.resourcebundle");
sap.ca.ui.model.format.NumberFormat=function(){throw new Error();};
sap.ca.ui.model.format.NumberFormat.oValueInfo={oDefaultFormatOptions:{style:"standard"}};
sap.ca.ui.model.format.NumberFormat.getInstance=function(f,l){return this.createInstance(f,l,this.oValueInfo);};
sap.ca.ui.model.format.NumberFormat.createInstance=function(f,l,i){var F=jQuery.sap.newObject(this.prototype);if(f instanceof sap.ui.core.Locale){l=f;f=undefined;}if(!l){l=sap.ui.getCore().getConfiguration().getFormatSettings().getFormatLocale();}F.oLocale=l;F.oLocaleData=sap.ui.core.LocaleData.getInstance(l);F.oFormatOptions=jQuery.extend(false,{},i.oDefaultFormatOptions,f);F.oFormatOptions.formatStyle="standard";F.init();return F;};
sap.ca.ui.model.format.NumberFormat.prototype.init=function(){};
sap.ca.ui.model.format.NumberFormat.prototype.format=function(v){var r="";var f="format_"+this.oFormatOptions.style;if(this[f]){r=this[f](v);}else{r=this.format_standard(v);}return r;};
sap.ca.ui.model.format.NumberFormat.prototype.format_standard=function(v){var f=sap.ca.ui.model.format.FormatHelper.getFormatOptions(this.oFormatOptions,this.oLocale);return sap.ca.ui.model.format.FormatHelper.formatNumber(v,f);};
sap.ca.ui.model.format.NumberFormat.prototype.format_short=function(v){var f;var s;var a;function g(d){var a;if(!s){s=sap.ui.core.LocaleData.getInstance(f.locale)._get("decimalFormat-short");if(!s){var e=new sap.ui.core.Locale("en");s=sap.ui.core.LocaleData.getInstance(e)._get("decimalFormat-short");}}if(s){var k=1;while(Math.abs(d)>=(k*10)&&k<1e14){k=k*10;}var h=s[k.toString()+"-other"];a={};if(!h||h=="0"){a.magnitude=1;}else{a.formatString=h;var m=h.match(/0+\.*0*/);if(m){a.valueSubString=m[0];var i=a.valueSubString.indexOf(".");if(i==-1){a.decimals=0;a.magnitude=k*Math.pow(10,1-a.valueSubString.length);}else{a.decimals=a.valueSubString.length-i-1;a.magnitude=k*Math.pow(10,1-i);}}else{a.magnitude=1;}}}return a;}var n=sap.ca.ui.model.format.FormatHelper.toNumeric(v);if(!isFinite(n)){return"";}var r="";f=sap.ca.ui.model.format.FormatHelper.getFormatOptions(this.oFormatOptions,this.oLocale);a=g(n);if(!a){return this.format_standard(v);}var b=n/a.magnitude;var c={};c.shortRounding=f.shortRounding;c.rounding=f.rounding;if(a.magnitude==1){c.formatStyle="standard";c.decimals=f.decimals;}else if(f.shortDecimals){c.formatStyle="short";c.shortDecimals=f.shortDecimals;}else{c.formatStyle="short";c.shortDecimals=a.decimals;}b=sap.ca.ui.model.format.FormatHelper.roundNumber(b,c);a=g(b*a.magnitude);if(!a||a.magnitude==1){r=this.format_standard(v);}else{b=sap.ca.ui.model.format.FormatHelper.roundNumber(n/a.magnitude,c);if(!f.shortDecimals){f.shortDecimals=a.decimals;}f.formatStyle="short";r=sap.ca.ui.model.format.FormatHelper.formatNumber(b,f);r=a.formatString.replace(a.valueSubString,r);r=r.replace(/'.'/g,".");}return r;};
sap.ca.ui.model.format.NumberFormat.prototype.parse=function(v){var f=sap.ui.core.format.NumberFormat.getInstance(this.oFormatOptions,this.oLocale);if(f.oFormatOptions.groupingSeparator=="\u00a0"){v=v.replace(/ /g,f.oFormatOptions.groupingSeparator);}return f.parse(v);};
sap.ca.ui.model.format.NumberFormat.prototype.format_percentage=function(v){var r,s;if(this.oFormatOptions.decimals===undefined){this.oFormatOptions.decimals=0;}var n=sap.ca.ui.model.format.FormatHelper.toNumeric(v);n=n*100.0;var f=this.format_standard(n);var p=sap.ui.core.LocaleData.getInstance(this.oLocale)._get("percentFormat");if(!p){s=new sap.ui.core.Locale("en");p=sap.ui.core.LocaleData.getInstance(s)._get("percentFormat");}var a=p["standard"];if(a===undefined||a==""){r=f;jQuery.sap.log.error("no percent format available for the current locale");}else{var b=/[\.0,#]+/;var t=a.replace(b,f);var c=sap.ui.core.LocaleData.getInstance(this.oLocale)._get("symbols-latn-percentSign");if(!c){s=new sap.ui.core.Locale("en");c=sap.ui.core.LocaleData.getInstance(s)._get("symbols-latn-percentSign");}r=t.replace(/\u0025/,c);}return r;};
},
	"sap/ca/ui/utils/resourcebundle.js":function(){jQuery.sap.declare("sap.ca.ui.utils.resourcebundle");jQuery.sap.require("sap.ui.model.resource.ResourceModel");sap.ca.ui.utils.resourcebundle=(function(){var i=new sap.ui.model.resource.ResourceModel({bundleUrl:jQuery.sap.getModulePath("sap.ca.ui.i18n.i18n",".properties"),});sap.ui.getCore().setModel(i,"sap.ca.ui.i18n");return i.getResourceBundle();}());
},
// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
	"sap/ushell/components/tiles/indicatorHarveyBall/HarveyBallTile.view.js":function(){sap.ui.require(["sap/ca/ui/model/format/NumberFormat","sap/ui/model/analytics/odata4analytics","sap/ushell/components/tiles/indicatorTileUtils/smartBusinessUtil","sap/suite/ui/commons/HarveyBallMicroChart","sap/suite/ui/commons/HarveyBallMicroChartItem","sap/suite/ui/commons/TileContent","sap/suite/ui/commons/GenericTile"],function(N,o,s,H,a,T,G){"use strict";sap.ui.getCore().loadLibrary("sap.suite.ui.commons");sap.ui.jsview("tiles.indicatorHarveyBall.HarveyBallTile",{getControllerName:function(){},createContent:function(){var m=new H({total:"{/value}",size:"{/size}",totalLabel:"{/totalLabel}",items:[new a({fraction:"{/fractionValue}",fractionLabel:"{/fractionLabel}",color:"{/color}"})]});var t=new T({size:"{/size}",content:m});this.oTile=new G({subheader:"{/subheader}",frameType:"{/frameType}",size:"{/size}",header:"{/header}",tileContent:[t]});}});});
},
	"sap/ushell/components/tiles/indicatorTileUtils/indicatorTileHelper.js":function(){(function(){"use strict";jQuery.sap.declare("sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper");sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper=function(t){this.tile=t;};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.setErrorState=function(){this.getTile().setState(sap.suite.ui.commons.LoadState.Failed);};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.setLoadingState=function(){this.getTile().setState(sap.suite.ui.commons.LoadState.Loading);};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.setLoadedState=function(){this.getTile().setState(sap.suite.ui.commons.LoadState.Loaded);};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.setTrendDown=function(){this.getTile().setIndicator(sap.suite.ui.commons.DeviationIndicator.Down);};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.setTrendUp=function(){this.getTile().setIndicator(sap.suite.ui.commons.DeviationIndicator.Up);};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.setTrendNeutral=function(){this.getTile().setIndicator(sap.suite.ui.commons.DeviationIndicator.None);};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.setThresholdGood=function(){};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.setThresholdBad=function(){};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.setThresholdCritical=function(){};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.setThresholdNeutral=function(){};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.calculateThreshold=function(){};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.setTile=function(t){this.tile=t;};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.getTile=function(){return this.tile;};}());
}
},"sap/fiori/indicator-tiles"
);
//# sourceMappingURL=indicator-tiles.js.map