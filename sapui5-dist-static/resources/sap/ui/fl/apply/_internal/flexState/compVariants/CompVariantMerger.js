/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/fl/apply/_internal/flexObjects/CompVariant","sap/base/Log"],function(C,L){"use strict";var c={addFavorite:function(v){v.setFavorite(true);},removeFavorite:function(v){v.setFavorite(false);}};function g(m){var d={};m.changes.forEach(function(o){var v=o.getContent().key;if(!d[v]){d[v]=[];}d[v].push(o);});return d;}function l(v,o){L.error("No change handler for change with the ID '"+o.getId()+"' and type '"+o.getChangeType()+"' defined.\n"+"The variant '"+v.getId()+"'was not modified'");}function a(p,v){var V={fileName:v.id||"*standard*",content:v.content||{},texts:{variantName:{value:v.name||""}},selector:{persistencyKey:p}};if(v.favorite!==undefined){V.content.favorite=v.favorite;}if(v.executeOnSelection!==undefined){V.content.executeOnSelection=v.executeOnSelection;}return new C(V);}function b(m,v){var V=v.getId();if(m[V]){m[V].forEach(function(o){var d=c[o.getChangeType()]||l;d(v,o);});}}return{merge:function(p,m,s,v){v=v||[];v=v.map(a.bind(undefined,p));v=v.concat(m.variants);var d=g(m);v.forEach(b.bind(undefined,d));var S;v.forEach(function(V){if(V.getContent().standardvariant){S=V;}});if(!S){s.content=s.content||{};S=a(p,s);b(d,S);}else{v=v.filter(function(V){return!V.getContent().standardvariant;});}S.setFavorite(true);if(m.standardVariant){var e=m.standardVariant.getContent().executeOnSelect;S.setExecuteOnSelection(e);S.getContent().executeOnSelect=e;}return{standardVariant:S,variants:v};}};});
