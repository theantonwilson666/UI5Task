/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['sap/ui/base/Object','sap/ui/mdc/p13n/FlexUtil','sap/ui/mdc/p13n/P13nBuilder','sap/base/util/merge','sap/base/util/deepEqual','sap/ui/model/json/JSONModel'],function(B,F,P,m,d,J){"use strict";var a=B.extend("sap.ui.mdc.p13n.subcontroller.BaseController",{constructor:function(c){B.call(this);this._oAdaptationControl=c;this.oP13nData=null;this._bLiveMode=false;this._bResetEnabled=false;}});a.prototype.getContainerSettings=function(){return{title:"Adaptation Dialog"};};a.prototype.getAdaptationControl=function(){return this._oAdaptationControl;};a.prototype.getLiveMode=function(){return this._bLiveMode;};a.prototype.getChangeOperations=function(){return{add:null,remove:null,move:null};};a.prototype.getResetEnabled=function(){return this._bResetEnabled;};a.prototype.initializeUI=function(){return Promise.resolve();};a.prototype.sanityCheck=function(s){return s;};a.prototype.getAdaptationUI=function(){return"sap/ui/mdc/p13n/panels/SelectionPanel";};a.prototype.getCurrentState=function(){return this._oAdaptationControl.getCurrentState().items;};a.prototype.getDelta=function(p){var s=this._getPresenceAttribute(p.externalAppliance);var n;var f=function(i){return i.hasOwnProperty(s)&&i[s]===false?false:true;};n=p.applyAbsolute?p.changedState.filter(f):this._getFilledArray(p.existingState,p.changedState,s).filter(f);p.changedState=n;if(d(p.existingState,n)){return[];}else{return F.getArrayDeltaChanges(p);}};a.prototype._getPresenceAttribute=function(b){return"visible";};a.prototype.getBeforeApply=function(){return Promise.resolve();};a.prototype.setP13nData=function(p){var i=this.getCurrentState();var I=P.arrayToMap(i);var o=P.prepareAdaptationData(p,function(b,c){var e=I[c.name];b.visible=!!e;b.position=e?e.position:-1;return c.visible;});P.sortP13nData({visible:"visible",position:"position"},o.items);o.items.forEach(function(b){delete b.position;});this.oP13nData=o;};a.prototype.getP13nData=function(){return this._oAdaptationModel.getData();};a.prototype.model2State=false;a.prototype.update=function(){if(this._oAdaptationModel){this._oAdaptationModel.setProperty("/items",this.oP13nData.items);this._oAdaptationModel.setProperty("/itemsGrouped",this.oP13nData.itemsGrouped);}};a.prototype._getFilledArray=function(p,n,r){var N=m([],p);var b=m([],n);var e=P.arrayToMap(p);b.forEach(function(i){var E=e[i.name];if(!i.hasOwnProperty(r)||i[r]){var c=i.position;if(E){c=c>-1?c:E.position;var o=E.position;N.splice(c,0,N.splice(o,1)[0]);}else{c=c>-1?c:N.length;N.splice(c,0,i);}N[c]=i;}else if(E){N[E.position][r]=false;}});return N;};a.prototype.getP13nModel=function(){if(!this._oAdaptationModel&&this.oP13nData){this._oAdaptationModel=new J(this.oP13nData);this._oAdaptationModel.setSizeLimit(10000);}else{this.update();}return this._oAdaptationModel;};a.prototype.destroy=function(){B.prototype.destroy.apply(this,arguments);this._oAdaptationControl=null;this.oP13nData=null;this._bLiveMode=null;this._bResetEnabled=null;this._oAdaptationModel=null;};return a;});
