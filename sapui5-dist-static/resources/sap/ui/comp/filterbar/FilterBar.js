/*
 * ! SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	
 */
sap.ui.define(['sap/ui/core/library','sap/m/Button','sap/m/Label','sap/m/Panel','sap/m/Text','sap/m/Toolbar','sap/m/ToolbarSpacer','sap/ui/Device','sap/ui/comp/state/UIState','./VariantConverterFrom','./VariantConverterTo','sap/ui/comp/smartvariants/PersonalizableInfo','sap/ui/comp/smartvariants/SmartVariantManagementUi2','sap/ui/core/InvisibleText','sap/ui/layout/Grid','sap/ui/layout/GridRenderer','sap/ui/layout/GridData','sap/ui/layout/HorizontalLayout','sap/ui/layout/VerticalLayout','sap/ui/layout/AlignedFlowLayout','sap/m/library','sap/ui/model/json/JSONModel','./FilterGroupItem','sap/base/Log','sap/base/util/merge','sap/ui/core/ShortcutHintsMixin'],function(c,B,L,P,T,a,b,D,U,V,d,e,S,I,G,f,g,H,h,A,m,J,F,k,o,p){"use strict";var q=c.ValueState;var r=c.TextAlign;var s=m.ButtonType;var t=c.aria.HasPopup;var u;var v;var w;var x;var y;var R;var z=G.extend("sap.ui.comp.filterbar.FilterBar",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/filterbar/FilterBar.designtime",properties:{persistencyKey:{type:"string",group:"Misc",defaultValue:""},advancedMode:{type:"boolean",group:"Misc",defaultValue:false},expandAdvancedArea:{type:"boolean",group:"Misc",defaultValue:false,deprecated:true},searchEnabled:{type:"boolean",group:"Misc",defaultValue:true},filterBarExpanded:{type:"boolean",group:"Misc",defaultValue:true},considerGroupTitle:{type:"boolean",group:"Misc",defaultValue:false},showClearButton:{type:"boolean",group:"Misc",defaultValue:false},showRestoreButton:{type:"boolean",group:"Misc",defaultValue:true},showGoOnFB:{type:"boolean",group:"Misc",defaultValue:true},showRestoreOnFB:{type:"boolean",group:"Misc",defaultValue:false},showClearOnFB:{type:"boolean",group:"Misc",defaultValue:false},showGoButton:{type:"boolean",group:"Misc",defaultValue:null,deprecated:true},deltaVariantMode:{type:"boolean",group:"Misc",defaultValue:true},filterContainerWidth:{type:"string",group:"Misc",defaultValue:"12rem"},useToolbar:{type:"boolean",group:"Misc",defaultValue:true},header:{type:"string",group:"Misc",defaultValue:""},showFilterConfiguration:{type:"boolean",group:"Misc",defaultValue:true},useSnapshot:{type:"boolean",group:"Misc"},isRunningInValueHelpDialog:{type:"boolean",group:"Misc",defaultValue:false}},aggregations:{filterItems:{type:"sap.ui.comp.filterbar.FilterItem",multiple:true,singularName:"filterItem"},filterGroupItems:{type:"sap.ui.comp.filterbar.FilterGroupItem",multiple:true,singularName:"filterGroupItem"},_parameters:{type:"sap.ui.comp.filterbar.FilterGroupItem",multiple:true,singularName:"_parameter",visibility:"hidden"}},associations:{basicSearch:{type:"sap.m.SearchField",multiple:false}},events:{cancel:{},reset:{parameters:{selectionSet:{type:"sap.ui.core.Control[]"}}},search:{parameters:{selectionSet:{type:"sap.ui.core.Control[]"}}},beforeVariantSave:{parameters:{context:{type:"string"}}},beforeVariantFetch:{},afterVariantLoad:{parameters:{context:{type:"string"},executeOnSelect:{type:"boolean"}}},filterChange:{added:{type:"sap.ui.core.Control"},deleted:{type:"sap.ui.core.Control"},filterItem:{type:"sap.ui.comp.filterbar.FilterGroupItem"}},clear:{parameters:{selectionSet:{type:"sap.ui.core.Control[]"}}},initialise:{},initialized:{},afterVariantSave:{},filtersDialogClosed:{parameters:{context:{type:"string"}}},filtersDialogBeforeOpen:{},filtersDialogSearch:{},filtersDialogCancel:{},filtersDialogSearchForFilters:{parameters:{newValue:{type:"string"}}},assignedFiltersChanged:{}}},renderer:{apiVersion:2}});z.INTERNAL_GROUP="__$INTERNAL$";z.prototype.init=function(){var i=this.getFilterContainerWidth();G.prototype.init.apply(this,arguments);this._filterGroupItemChange=this._filterGroupItemChange.bind(this);this._filterItemChange=this._filterItemChange.bind(this,null);this._oBasicAreaLayout=null;this._oVariantManagement=null;this._oCollectiveSearch=null;this._aBasicAreaSelection=null;this._mAdvancedAreaFilter=null;this._fRegisteredFetchData=null;this._fRegisteredApplyData=null;this._fRegisterGetFiltersWithValues=null;this._oHideShowButton=null;this._oShowAllFiltersButton=null;this._oSearchButton=null;this._oFiltersButton=null;this._oClearButtonOnFB=null;this._oRestoreButtonOnFB=null;this._bIsInitialized=false;this._aFields=null;this._oBasicSearchField=null;this._oVariant={};this._filterChangeSemaphore=true;this._triggerFilterChangeState=true;this._fRegisteredFilterChangeHandlers=null;this._fInitialiseVariants=null;this._bHostedVariantManagement=false;this._nMaxFiltersByDefault=8;this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");this.setHSpacing(0);this.addStyleClass("sapUiCompFilterBar sapUiCompFilterBarMarginBottom sapUiCompFilterBarPaddingPanel sapContrastPlus");this.addStyleClass(this._isPhone()?"sapUiCompFilterBarPhone":"sapUiCompFilterBarNonPhone");this._oToolbar=this._createToolbar();this.addContent(this._oToolbar);this._bDelayRendering=true;this._bShowAllFilters=false;this._oBasicAreaLayout=new A();this._oBasicAreaLayout.setVisible(false);this._oBasicAreaLayout.setLayoutData(new g({span:"L12 M12 S12"}));this._oBasicAreaLayout.setMinItemWidth(i);this._oBasicAreaLayout.setMaxItemWidth(i);this.addContent(this._oBasicAreaLayout);this._oAdvancedPanel=new P();this._oAdvancedPanel.setLayoutData(new g({span:"L12 M12 S12"}));this._oAdvancedPanel.setVisible(false);this.addContent(this._oAdvancedPanel);this.oModel=new J({});this.setModel(this.oModel,"FilterBar");this._oHintText=new T({text:this._oRb.getText("FILTER_BAR_NO_FILTERS_ON_FB"),textAlign:r.Center});this._oHintText.setVisible(false);this._oHintText.addStyleClass("sapUiCompFilterBarHint");if(this._isTablet()||this._isPhone()){this.setFilterBarExpanded(false);}};z.prototype.onBeforeRendering=function(){if(G.prototype.onBeforeRendering){G.prototype.onBeforeRendering.apply(this,arguments);}if(this.getIsRunningInValueHelpDialog()){if(this._oShowAllFiltersButton===null){this.initShowAllFiltersButton();}if(this._oBasicSearchField&&this._oBasicSearchField.isA("sap.m.SearchField")){this._isPhone()?this._oBasicSearchField.setWidth("100%"):this._oBasicSearchField.setWidth("50%");this._oBasicSearchField.setShowMagnifier(true);this._oBasicSearchField.setShowSearchButton(true);}this._oBasicAreaLayout.setMaxItemWidth(null);this._oAdvancedPanel.setVisible(false);this._rerenderFilters();}else if(this._oShowAllFiltersButton){this._oBasicAreaLayout.removeEndContent(this._oShowAllFiltersButton);this._oShowAllFiltersButton=null;}};z.prototype.getShowAllFiltersButton=function(){return this._oShowAllFiltersButton;};z.prototype.setFilterContainerWidth=function(i){this._oBasicAreaLayout.setMinItemWidth(i);if(this.getUseToolbar()){this._oBasicAreaLayout.setMaxItemWidth(this._oBasicAreaLayout.getMinItemWidth());}else{this._setMaxItemWidth2();}this.setProperty("filterContainerWidth",i);return this;};z.prototype._setMaxItemWidth2=function(){var j,n,l=this._oBasicAreaLayout.getMinItemWidth();["rem","%","px","em"].some(function(O){var i=l.indexOf(O);if(i>0){l=l.substring(0,i);j=O;return true;}return false;});if(j){n=parseInt(l);if(!isNaN(n)){n*=2;this._oBasicAreaLayout.setMaxItemWidth(n+j);}}};z.prototype._hasAnyVisibleFiltersOnFB=function(){var j=this._retrieveVisibleAdvancedItems();for(var i=0;i<j.length;i++){if(j[i].filterItem.getVisibleInFilterBar()){return true;}}return false;};z.prototype._showHintText=function(){var i=0;if(!this._oHintText){return;}if(this._isNewFilterBarDesign()){return;}if(!this.getAdvancedMode()&&!this._isPhone()){var j=!this._hasAnyVisibleFiltersOnFB();if(j){i=this._oAdvancedPanel.indexOfContent(this._oHintText);if(i<0){this._oAdvancedPanel.insertContent(this._oHintText,0);}}this._oHintText.setVisible(j);this._oAdvancedPanel.setVisible(j);if(!this._bDelayRendering){this._oBasicAreaLayout.setVisible(!j&&this.getFilterBarExpanded());}}};z.prototype._hasRelevantFilters=function(){var i,n=null,j;if(!this._mAdvancedAreaFilter||(Object.keys(this._mAdvancedAreaFilter)<1)){return false;}if(this.getAdvancedMode()){for(n in this._mAdvancedAreaFilter){var l=this._mAdvancedAreaFilter[n];if(l&&l.items){for(i=0;i<l.items.length;i++){j=l.items[i];if(j){if(this._determineVisibility(j.filterItem)){return true;}}}}}return false;}return true;};z.prototype._adaptButtonsEnablement=function(){var i=false||!!this._mAdvancedAreaFilter;if(this._oHideShowButton){this._oHideShowButton.setEnabled(i);if(this.getAdvancedMode()&&!this._isPhone()){this._oHideShowButton.setVisible(this._hasRelevantFilters());}}this._oClearButtonOnFB.setEnabled(i);this._oRestoreButtonOnFB.setEnabled(i);this._oFiltersButton.setEnabled(i);var j=true;if(this._isPhone()&&this.getUseToolbar()){j=false;}if(i&&this.getFilterBarExpanded()&&j&&!this.getAdvancedMode()){this._oBasicAreaLayout.setVisible(true);}};z.prototype.getVariantManagement=function(){return this._oVariantManagement;};z.prototype.setShowClearOnFB=function(i){this.setProperty("showClearOnFB",i);this._oClearButtonOnFB.setVisible(i);return this;};z.prototype.setShowRestoreOnFB=function(i){this.setProperty("showRestoreOnFB",i);this._oRestoreButtonOnFB.setVisible(i);return this;};z.prototype.setShowGoOnFB=function(i){this.setProperty("showGoOnFB",i);this._calcVisibilityGoButton();return this;};z.prototype._calcVisibilityGoButton=function(){var i=this.getShowGoOnFB();if(i&&!this._isPhone()&&this.isLiveMode&&this.isLiveMode()){i=false;}this._oSearchButton.setVisible(i);};z.prototype.setShowGoButton=function(i){this.setShowGoOnFB(i);return this;};z.prototype.getShowGoButton=function(){return this.getShowGoOnFB();};z.prototype.hideGoButton=function(){this._oSearchButton.setVisible(false);};z.prototype.restoreGoButton=function(){this._oSearchButton.setVisible(this.getShowGoOnFB());};z.prototype.setShowFilterConfiguration=function(i){this.setProperty("showFilterConfiguration",i);if(this._oFiltersButton){this._oFiltersButton.setVisible(i);}return this;};z.prototype.isCurrentVariantStandard=function(){var i;if(this._oVariantManagement){i=this._oVariantManagement.getCurrentVariantId();if(i===""){return true;}return(i===this._oVariantManagement.getStandardVariantKey());}return undefined;};z.prototype.setCurrentVariantId=function(i,j){if(this._oVariantManagement){this._oVariantManagement.setCurrentVariantId(i,j);}};z.prototype.getCurrentVariantId=function(){var i="";if(this._oVariantManagement){i=this._oVariantManagement.getCurrentVariantId();}return i;};z.prototype.getDataSuiteFormat=function(i){return this._getDataSuiteFormat(i,null);};z.prototype._getDataSuiteFormat=function(i,j){var l=null,n,O,Q,W,X;if(this._oVariantManagement){n=this.getCurrentVariantId();if(this.getFilterDataAsString){Q=this._determineVariantFiltersInfo(i,true);if(this.getFilterContextUrl){X=this.getFilterContextUrl();}if(this.getParameterContextUrl){W=this.getParameterContextUrl();}O=this.getFilterDataAsString(i);if(O){var Y=new d();l=Y.convert(n,Q,O,this,j,W,X);}}}return l;};z.prototype.getBasicSearchName=function(){var i=null;if(this._oBasicSearchField&&this.getEntitySet){i="$"+this.getEntitySet()+".basicSearch";}return i;};z.prototype.getBasicSearchValue=function(){return this._getBasicSearchValue();};z.prototype.setUiStateAsVariant=function(i){var j={replace:true,strictMode:true};this.setUiState(i,j);this.fireAfterVariantLoad("SPV_VARIANT",false);this._applyVisibility(i.getSelectionVariant());};z.prototype._applyVisibility=function(i){var j=function(l){if(l&&l.getVisible()&&!l.getHiddenFilter()){if(!l.getVisibleInFilterBar()){l.setVisibleInFilterBar(true);}if(!l.getPartOfCurrentVariant()){l.setPartOfCurrentVariant(true);}}};if(this._bIsInitialized){for(var n in this._mAdvancedAreaFilter){if(n){this._mAdvancedAreaFilter[n].items.forEach(function(l){if(l&&l.filterItem&&l.filterItem.getMandatory()){j(l.filterItem);}else if(l&&l.filterItem){if(l.filterItem.getVisibleInFilterBar()){l.filterItem.setVisibleInFilterBar(false);}if(l.filterItem.getPartOfCurrentVariant()){if(n===z.INTERNAL_GROUP){l.filterItem.setPartOfCurrentVariant(true);}else{l.filterItem.setPartOfCurrentVariant(false);}}}});}}if(i&&i.Parameters){i.Parameters.forEach(function(l){var O=this.determineFilterItemByName(l.PropertyName);j(O);}.bind(this));}if(i&&i.SelectOptions){i.SelectOptions.forEach(function(l){var O=this.determineFilterItemByName(l.PropertyName);j(O);}.bind(this));}}};z.prototype.getUiState=function(i){var j,l,n=false,O=null,Q,W;if(i){n=(i.allFilters===true);}l=this._getDataSuiteFormat(n,"13.0");j=new U();j.selectionVariant=JSON.parse(l);j.setSelectionVariant(j.selectionVariant);var X=j.getSelectionVariant();if(X){if(this.getModelData&&this.getModelData()){O=this.getModelData();}W=U.calcSemanticDates(X,O);j.setSemanticDates(W);Q=U.calculateValueTexts(X,O);j.setValueTexts(Q);window.sessionStorage.setItem(this.getId(),JSON.stringify(Q));window.sessionStorage.setItem("semanticDates",JSON.stringify(W));}return j;};z.prototype.setUiState=function(i,j){var l,n,O=null,Q=false,W=true,X;if(j&&typeof j.replace==="boolean"){Q=j.replace;}if(j&&typeof j.strictMode==="boolean"){W=j.strictMode;}if(i){O=i.getSelectionVariant();if(O){n=JSON.stringify(O);}l=i.getValueTexts();X=i.getSemanticDates();}if(!l){l=JSON.parse(window.sessionStorage.getItem(this.getId()));}if(!X){X=JSON.parse(window.sessionStorage.getItem("semanticDates"));}this._setDataSuiteFormat(n,Q,W,l,X);this._enhanceFilterItemsWithTextValue(l,O);};z.prototype.getDescriptionForKeys=function(i){};z.prototype._enhanceFilterItemsWithTextValue=function(i,j){var l=U.determineFiltersWithOnlyKeyValues(i,j,[this.getBasicSearchName()]);this.getDescriptionForKeys(l);};z.prototype.setDataSuiteFormat=function(i,j){this._setDataSuiteFormat(i,j,true);};z.prototype._setDataSuiteFormat=function(i,j,l,n,O){var Q,W,X;if(i){Q=new V();W=Q.convert(i,this,l);if(W){this._clearErrorState();if(W.variantId&&this._oVariantManagement){if(this._bIsInitialized){if(this._oVariantManagement.isPageVariant()){this._oVariantManagement._selectVariant(W.variantId,"DATA_SUITE");}else{this._setFilterVisibility(W.variantId);}}this._oVariantManagement.setInitialSelectionKey(W.variantId);}if(W.payload&&(j||(Object.keys(JSON.parse(W.payload)).length>0))&&this.setFilterDataAsString){X=W.payload;if(n){X=U.enrichWithValueTexts(X,n);}if(O){X=U.enrichWithSemanticDates(X,O);}this.setFilterDataAsString(X,j);}if(W.basicSearch&&this._oBasicSearchField&&this._oBasicSearchField.setValue){this._oBasicSearchField.setValue(""||W.basicSearch);this._updateToolbarText();}}}};z.prototype._setFilterVisibility=function(i){if(this._oVariantManagement.getSelectionKey()!==i){this._oVariantManagement.setInitialSelectionKey(i);var j=this._getStandardVariant();if(j){var l=this._oVariantManagement.getVariantContent(this,i);if(l&&l.filterbar){if(l.hasOwnProperty("version")){l=this.mergeVariant(j,l);}this._reapplyVisibility(l.filterbar);}}}};z.prototype.applySettings=function(j){if(this._possibleToChangeVariantManagement()){if(j&&j.customData){for(var i=0;i<j.customData.length;i++){var l=j.customData[i];if(l&&l.mProperties&&l.mProperties.key==="pageVariantPersistencyKey"){this._oVariantManagement.setPersistencyKey(l.mProperties.value);this._oVariantManagement.setVisible(true);this._bHostedVariantManagement=true;}}}}if(j&&j.persistencyKey){this._bHostedVariantManagement=true;}this._applyLayoutDataToToolbarButtons();G.prototype.applySettings.apply(this,arguments);if(!this.getUseToolbar()&&!this.getFilterBarExpanded()){this.setFilterBarExpanded(true);}this._afterVariantsLoad();};z.prototype._applyLayoutDataToToolbarButtons=function(i){if(this._isPhone()||this._isTablet()||this.getAdvancedMode()||!this.getUseToolbar()){return;}if(!u&&!this._bToolbarLayoutDataRequested){u=sap.ui.require("sap/m/ToolbarLayoutData");if(!u){sap.ui.require(["sap/m/ToolbarLayoutData"],_.bind(this));this._bToolbarLayoutDataRequested=true;}}if(!u){return;}this._oHideShowButton.setLayoutData(new u({shrinkable:true}));this._oClearButtonOnFB.setLayoutData(new u({shrinkable:true}));this._oRestoreButtonOnFB.setLayoutData(new u({shrinkable:true}));this._oFiltersButton.setLayoutData(new u({shrinkable:true}));this._oSearchButton.setLayoutData(new u({shrinkable:false}));};function _(i){u=i;this._bToolbarLayoutDataRequested=false;if(!this._bIsBeingDestroyed){this._applyLayoutDataToToolbarButtons();}}z.prototype.setPersistencyKey=function(i){this.setProperty("persistencyKey",i);if(this._possibleToChangeVariantManagement()){this._oVariantManagement.setVisible(true);}return this;};z.prototype._possibleToChangeVariantManagement=function(){if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){return true;}return false;};z.prototype.clearVariantSelection=function(){if(this._oVariantManagement){this._oVariantManagement.clearVariantSelection();}};z.prototype.setSearchEnabled=function(i){this.setProperty("searchEnabled",i);if(this._oSearchButton){this._oSearchButton.setEnabled(i);}return this;};z.prototype.setSearchButtonEmphType=function(i){};z.prototype.setSimplifiedMode=function(i){};z.prototype.getSimplifiedMode=function(){if(this.getAdvancedMode()){return false;}return true;};z.prototype.setExpandAdvancedArea=function(i){this.setFilterBarExpanded(i);return this;};z.prototype.getExpandAdvancedArea=function(){return this.getFilterBarExpanded();};z.prototype.setAdvancedMode=function(i){this.setProperty("advancedMode",i);this.toggleStyleClass("sapContrastPlus",!i);if(i){if(!this._oAdvancedAreaForm){this._oAdvancedAreaForm=this._createAdvancedAreaForm();}if(this._possibleToChangeVariantManagement()){this._oVariantManagement.setVisible(false);}if(this._oToolbar){this._oToolbar.addStyleClass("sapUiCompFilterBarToolbarBasicSearchNoVariant");if(this._oBasicSearchField){if(this._oToolbar.indexOfContent(this._oBasicSearchField)<0){this._oToolbar.insertContent(this._oBasicSearchField,1);}}}}else{if(this.getPersistencyKey()&&this._possibleToChangeVariantManagement()){if(this._oVariantManagement){this._oVariantManagement.setVisible(true);}if(this._oToolbar){this._oToolbar.removeStyleClass("sapUiCompFilterBarToolbarBasicSearchNoVariant");}}}this._oFiltersButton.setVisible(!i);if(this._oHideShowButton){this._oHideShowButton.setVisible((i&&this._isPhone())?false:true);if(this._oHideShowButton.getVisible()){if(this.getFilterBarExpanded()){this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_VH_HIDE_FILTERS"));this._oHideShowButton.setTooltip(this._oRb.getText("FILTER_BAR_VH_HIDE_FILTERS"));}else{this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_VH_SHOW_FILTERS"));this._oHideShowButton.setTooltip(this._oRb.getText("FILTER_BAR_VH_SHOW_FILTERS"));}}}if(!this._bDelayRendering){this._oBasicAreaLayout.setVisible(!i&&this.getFilterBarExpanded());}this._oAdvancedPanel.setVisible(i&&this.getFilterBarExpanded());this._adaptButtonsEnablement();return this;};z.prototype.setUseToolbar=function(i){this.setProperty("useToolbar",i);if(!i){this._adaptNewFilterBarDesign();}else{this._recreateToolbar();}return this;};z.prototype._recreateToolbar=function(){if(!this._oToolbar){this._bButtonaAdded=false;if(this._oButtonsVLayout){this._oBasicAreaLayout.removeContent(this._oButtonsVLayout);this._oButtonsVLayout.destroy();this._oButtonsVLayout=null;}this._oToolbar=this._createToolbar(true);this.insertContent(this._oToolbar,0);if(this._oVariantManagement){if(this._oVariantManagement instanceof S||((this._oVariantManagement.getId()===(this.getId()+"-variant")))){this._oToolbar.insertContent(this._oVariantManagement,0);}}this._adaptButtonsEnablement();if(this._oBasicSearchFieldContainer){this._oBasicAreaLayout.removeContent(this._oBasicSearchFieldContainer);this._cleanBasicSearchContainer();this.setBasicSearch(this._oBasicSearchField);}this._oHintText=new T({text:this._oRb.getText("FILTER_BAR_NO_FILTERS_ON_FB"),textAlign:r.Center});this._oHintText.setVisible(false);this._oHintText.addStyleClass("sapUiCompFilterBarHint");this._oBasicAreaLayout.addContent(this._oHintText);this._oBasicAreaLayout.setMaxItemWidth(this._oBasicAreaLayout.getMinItemWidth());this._updateToolbarText();}};z.prototype._cleanBasicSearchContainer=function(){if(this._oBasicSearchFieldContainer){var j=this._oBasicSearchFieldContainer.removeAllContent();if(j){for(var i=0;i<j.length;i++){if(j[i]!==this._oBasicSearchField){j[i].destroy();}}}this._oBasicSearchFieldContainer.destroy();this._oBasicSearchFieldContainer=null;}};z.prototype.setHeader=function(i){this.setProperty("header",i);if(this.getUseToolbar()){this._addHeaderToToolbar(i);}return this;};z.prototype._addHeaderToToolbar=function(i){if(this._oToolbar){if(i){if(this._oVariantManagement&&(this._oVariantManagement.getVisible()||this._bHostedVariantManagement)&&(this._oToolbar.indexOfContent(this._oVariantManagement)>-1)){if(!this._oSeparator){if(!v&&!this._bToolbarSeparatorRequested){v=sap.ui.require("sap/m/ToolbarSeparator");if(!v){sap.ui.require(["sap/m/ToolbarSeparator"],C.bind(this));this._bToolbarSeparatorRequested=true;}}if(v){this._oSeparator=new v(this.getId()+"-HeadSep");}}this._oToolbar.removeContent(this._oSeparator);this._oToolbar.insertContent(this._oSeparator,0);this._oToolbar.setHeight("3rem");}if(!this._oText){this._oText=new T(this.getId()+"-HeadText");this._oText.addStyleClass("sapMH4Style");this._oText.addStyleClass("sapUiCompSmartChartHeader");}this._oText.setText(i);this._oToolbar.removeContent(this._oText);this._oToolbar.insertContent(this._oText,0);}else{if(this._oSeparator){this._oToolbar.removeContent(this._oSeparator);this._oSeparator.destroy();delete this._oSeparator;this._oToolbar.setHeight();}if(this._oText){this._oToolbar.removeContent(this._oText);this._oText.destroy();delete this._oText;}}}};function C(i){v=i;this._bToolbarSeparatorRequested=false;if(!this._bIsBeingDestroyed){this._addHeaderToToolbar(this.getHeader());}}z.prototype._isNewFilterBarDesign=function(){if(this.getAdvancedMode()){return false;}if(!this.getUseToolbar()){return true;}return false;};z.prototype._adaptNewFilterBarDesign=function(){if(this._isNewFilterBarDesign()){this.setFilterBarExpanded(true);if(!this._bDelayRendering){this._oBasicAreaLayout.setVisible(true&&this.getFilterBarExpanded());}if(this._oToolbar){var j=this._oToolbar.getContent();for(var i=0;i<j.length;i++){this._oToolbar.removeContent(j[i]);if(j[i].isA("sap.m.ToolbarSpacer")){j[i].destroy();}}if(!this.getUseToolbar()){this.removeContent(this._oToolbar);this._oToolbar.destroy();this._oToolbar=null;}}if(this._oHintText){this._oBasicAreaLayout.removeContent(this._oHintText);this._oHintText.destroy();this._oHintText=null;}if(this._oHideShowButton){this._oHideShowButton.destroy();this._oHideShowButton=null;}if(!this._bButtonaAdded){this._bButtonaAdded=true;this._addButtonsToBasicArea();}if(this._oBasicSearchField){this.setBasicSearch(this._oBasicSearchField);}this._oBasicAreaLayout.setMinItemWidth(this.getFilterContainerWidth());this._setMaxItemWidth2();}};z.prototype._addButtonsToBasicArea=function(){var i=new h();if(sap.ui.getCore().getConfiguration().getRTL()){i.addStyleClass("sapUiCompFilterBarFloatLeft");}else{i.addStyleClass("sapUiCompFilterBarFloatRight");}var j=new H();i.addContent(new T());i.addContent(j);j.addContent(this._oSearchButton);this._oSearchButton.addStyleClass("sapUiCompFilterBarPaddingRightBtn");j.addContent(this._oClearButtonOnFB);this._oClearButtonOnFB.addStyleClass("sapUiCompFilterBarPaddingRightBtn");j.addContent(this._oRestoreButtonOnFB);this._oRestoreButtonOnFB.addStyleClass("sapUiCompFilterBarPaddingRightBtn");j.addContent(this._oFiltersButton);this._updateToolbarText();this._oBasicAreaLayout.addEndContent(i);this._oButtonsVLayout=i;};z.prototype._addBasicSearchToBasicArea=function(i){if(this._oBasicSearchFieldContainer){this._cleanBasicSearchContainer();}if(i){var l=new L({text:"\u2008"});l.addStyleClass("sapBasicSearchFilter");var j=this._addControlToBasicAreaContainer(null,i,l);if(j){j.setVisible(true);var n=0;if(this._isPhone()){n=1;}this._oBasicAreaLayout.insertContent(j,n);this._oBasicSearchFieldContainer=j;this._oBasicSearchFieldContainer.setWidth("100%");}}};z.prototype._setCollectiveSearch=function(i){if(this.getAdvancedMode()){if(this._oToolbar){if(this._oVariantManagement){this._oToolbar.removeContent(this._oVariantManagement);this._unregisterVariantManagement(this._oVariantManagement);this._oVariantManagement=null;}if(this._oCollectiveSearch){this._oToolbar.removeContent(this._oCollectiveSearch);}this._oCollectiveSearch=i;this._oToolbar.insertContent(this._oCollectiveSearch,0);this._oToolbar.removeStyleClass("sapUiCompFilterBarToolbarBasicSearchNoVariant");}}};z.prototype.setBasicSearch=function(i){var j=this;this.setAssociation("basicSearch",i,true);if(typeof i==="string"){i=sap.ui.getCore().byId(i);}if(i&&i.getParent()){if(this._isUi2Mode()){i.attachLiveChange(function(l){j.fireFilterChange(l);});}this._oBasicSearchField=i;return;}if(this._oBasicSearchField&&this._oToolbar){this._oToolbar.removeContent(this._oBasicSearchField);}if(i&&this._isNewFilterBarDesign()){this._addBasicSearchToBasicArea(i);}else{if(i&&this._oToolbar&&(!this._isPhone()||this.getAdvancedMode())){var n=this._indexOfSpacerOnToolbar();this._oToolbar.insertContent(i,n);if(this._isUi2Mode()){i.attachLiveChange(function(l){j.fireFilterChange(l);});}}}this._oBasicSearchField=i;return this;};z.prototype._getBasicSearchValue=function(){if(this._oBasicSearchField&&this._oBasicSearchField.getValue){return this._oBasicSearchField.getValue();}return null;};z.prototype._indexOfSpacerOnToolbar=function(){var j=this._oToolbar.getContent(),i;if(j){for(i=0;i<j.length;i++){if(j[i]instanceof b){return i;}}}return 0;};z.prototype.addFilterItem=function(i){var n,j,l,O;if(!i){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterItem()"+" Expected argument 'oFilterItem' may not be null nor empty");}n=i.getName();if(!n){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterItem()"+" Expected argument 'oFilterItem.name' may not be null nor empty");}j=i.getControl();if(!j){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterItem()"+" Expected argument 'oFilterItem.control' may not be null nor empty");}this.addAggregation("filterItems",i,true);if(!this._aBasicAreaSelection){this._aBasicAreaSelection=[];}var Q={control:i.getControl(),filterItem:i};this._aBasicAreaSelection.push(Q);O=i.getId()+"__filterGroupItem";l=sap.ui.getCore().byId(O);if(!l){l=new F(i.getId()+"__filterGroupItem",{label:i.getLabel(),controlTooltip:i.getControlTooltip(),name:i.getName(),mandatory:i.getMandatory(),visible:i.getVisible(),visibleInFilterBar:i.getVisibleInFilterBar(),partOfCurrentVariant:true,control:i.getControl(),groupName:z.INTERNAL_GROUP,groupTitle:"",hiddenFilter:i.getHiddenFilter(),entitySetName:i.getEntitySetName(),entityTypeName:i.getEntityTypeName()});}if(i.data('isCustomField')){l.data('isCustomField',true);}i.attachChange(this._filterItemChange);this.addFilterGroupItem(l);return this;};z.prototype.addFilterGroupItem=function(i){var n,j,O,l;if(!i){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterGroupItem()"+" Expected argument 'oFilterGroupItem' may not be null nor empty");}this.addAggregation("filterGroupItems",i,true);j=i.getGroupName();if(!j){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterGroupItems()"+" GroupName may not be null nor empty");}n=i.getName();if(!n){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterGroupItems()"+" Name may not be null nor empty");}if(!this._mAdvancedAreaFilter){this._mAdvancedAreaFilter={};}if(!this._mAdvancedAreaFilter[j]){this._mAdvancedAreaFilter[j]={};this._mAdvancedAreaFilter[j].filterItem=null;this._mAdvancedAreaFilter[j].items=[];}if(!this._mAdvancedAreaFilter[j].items){this._mAdvancedAreaFilter[j].items=[];}if(!this._mAdvancedAreaFilter[j].filterItem){this._mAdvancedAreaFilter[j].filterItem=i;}O={control:i.getControl(),filterItem:i};if(this.getAdvancedMode()||i.getVisibleInFilterBar()){i.setVisibleInFilterBar(true);}else{i.setVisibleInFilterBar(false);}this._mAdvancedAreaFilter[j].items.push(O);if(!i.getHiddenFilter()){l=this._addControlToBasicAreaFormContainer(i);if(l){O.container=l;l.setVisible(i.getVisible()&&i.getVisibleInFilterBar());if(i.getVisibleInFilterBar()){i.setPartOfCurrentVariant(i.getVisibleInFilterBar());}i.attachChange(this._filterGroupItemChange);}if(this.getAdvancedMode()&&!this.getIsRunningInValueHelpDialog()){this._rerenderAA();}else{this._showHintText();}}this._adaptButtonsEnablement();return this;};z.prototype.removeFilterItem=function(O){var i,j,l,n,Q=this.getFilterItems(),W=this.getFilterGroupItems();if(!Q||!Q.length){return null;}j=this._getRemovedItemAsObject(O,Q);if(!j){return null;}j.detachChange(this._filterItemChange);for(i=0;i<this._aBasicAreaSelection.length;i++){if(this._aBasicAreaSelection[i].filterItem.getId()===j.getId()){this._aBasicAreaSelection.splice(i,1);if(this._aBasicAreaSelection.length===0){this._aBasicAreaSelection=null;}break;}}this.removeAggregation("filterItems",j,true);l=j.getId()+"__filterGroupItem";n=this._getRemovedItemAsObject(l,W);this._removeFilterGroupItem(n);return j;};z.prototype.removeFilterGroupItem=function(O){var i,j=this.getFilterGroupItems();if(!j||!j.length){return null;}i=this._getRemovedItemAsObject(O,j);if(!i){return null;}return this._removeFilterGroupItem(i);};z.prototype._getRemovedItemAsObject=function(O,j){var i,l;if(typeof O==="string"){for(i=0;i<j.length;i++){if(j[i].getId()===O){l=j[i];break;}}}if(typeof O==="number"){if(O<0||O>=j.length){k.warning("sap.ui.comp.filterbar.FilterBar.prototype.removeFilterGroupItems() is called with invalid index "+O);}else{l=j[O];}}if(typeof O==="object"){l=O;}return l;};z.prototype._removeFilterGroupItem=function(j){var i,l,n,O=j.getGroupName();j.detachChange(this._filterGroupItemChange);this.removeAggregation("filterGroupItems",j,true);if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[O]&&this._mAdvancedAreaFilter[O].items){l=this._mAdvancedAreaFilter[O];for(i=0;i<l.items.length;i++){n=l.items[i];if(n.filterItem.getId()===j.getId()){n.container.removeAllContent();n.container.destroy();l.items.splice(i,1);if(l.filterItem.getId()===j.getId()){if(l.items.length){l.filterItem=l.items[0].filterItem;}else{delete this._mAdvancedAreaFilter[O];}}break;}}if(this.getFilterGroupItems().length===0){this._mAdvancedAreaFilter=null;this._adaptButtonsEnablement();}}return j;};z.prototype._addParameter=function(j){var i,O,l,n=false,Q=false,W=z.INTERNAL_GROUP;j._setParameter(true);j.setVisibleInFilterBar(true);j.setPartOfCurrentVariant(true);this.addAggregation("_parameters",j,true);O={control:j.getControl(),filterItem:j};if(!this._mAdvancedAreaFilter){this._mAdvancedAreaFilter={};}if(!this._mAdvancedAreaFilter[W]){this._mAdvancedAreaFilter[W]={};this._mAdvancedAreaFilter[W].filterItem=null;}if(!this._mAdvancedAreaFilter[W].items){this._mAdvancedAreaFilter[W].items=[];}for(i=0;i<this._mAdvancedAreaFilter[W].items.length;i++){var X=this._mAdvancedAreaFilter[W].items[i];if(X.filterItem._isParameter()){continue;}this._mAdvancedAreaFilter[W].items.splice(i,0,O);n=true;break;}if(!n){this._mAdvancedAreaFilter[W].items.push(O);if(Object.keys(this._mAdvancedAreaFilter).length>1){Q=true;}}l=this._addControlToBasicAreaFormContainer(j);if(l){O.container=l;l.setVisible(j.getVisible());j.attachChange(this._filterGroupItemChange.bind(this));}if(n||Q){this._oBasicAreaLayout.removeContent(l);if(j.getVisible()){this._addContainerInOrder(O.filterItem,O.container);}}if(!this.getAdvancedMode()){this._showHintText();}this._adaptButtonsEnablement();return this;};z.prototype._filterItemChange=function(i,j){var l,n,O,Q;if(j&&j.oSource&&(j.oSource.isA("sap.ui.comp.filterbar.FilterItem"))){O=j.getParameter("propertyName");if(O==="visibleInFilterBar"||O==="visible"||O==="label"||O==="labelTooltip"||O==="controlTooltip"||O==="mandatory"){l=this._determineItemByName(j.oSource.getName(),z.INTERNAL_GROUP);if(l&&l.filterItem){if((O==="visible")){n=j.oSource.getVisible();l.filterItem.setVisible(n);}else if(O==="visibleInFilterBar"){n=j.oSource.getVisibleInFilterBar();var W=this._checkChangePossibleVisibleInFilterBar(l.filterItem,n);if(W){l.filterItem.setVisibleInFilterBar(n);}else{j.oSource.setVisibleInFilterBar(true);}}else if(O==="label"){l.filterItem.setLabel(j.oSource.getLabel());}else if(O==="labelTooltip"){l.filterItem.setLabelTooltip(j.oSource.getLabelTooltip());}else if(O==="controlTooltip"){Q=this.determineControlByFilterItem(l.filterItem,true);if(Q&&Q.setTooltip){Q.setTooltip(l.filterItem.getControlTooltip());}}else if(O==="mandatory"){n=j.oSource.getMandatory();l.filterItem.setMandatory(n);}}}}};z.prototype._filterGroupItemChange=function(i){var j;var l;if(i&&i.oSource){l=i.getParameter("propertyName");if(l==="visibleInFilterBar"||l==="visible"){j=this._determineItemByName(i.oSource.getName(),i.oSource.getGroupName());if(j){if(l==="visibleInFilterBar"){var n=i.oSource.getVisibleInFilterBar();var O=n;var Q=this._checkChangePossibleVisibleInFilterBar(i.oSource,n);if(!Q){i.oSource.setVisibleInFilterBar(true);O=true;}if(O){i.oSource.setPartOfCurrentVariant(true);}if(!n&&!this._isFilterItemInBasicGroup(j.filterItem)){i.oSource.setPartOfCurrentVariant(false);}if(!this.getAdvancedMode()&&!this._oAdaptFiltersDialog){this._rerenderItem(j);}}else if(l==="visible"){if(!this._oAdaptFiltersDialog){if(this.getAdvancedMode()&&j.container){j.container.setVisible(true);}else{this._updateToolbarText();this._rerenderItem(j);}}}this._showHintText();}}else if(l==="groupTitle"){if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[i.oSource.getGroupName()]){this._adaptGroupTitle(i.oSource.getGroupName());}}else if(l==="label"){if(!this._oAdaptFiltersDialog){this._adaptGroupTitleForFilter(i.oSource);}}else if(l==="mandatory"){this._mandatoryFilterItemChange(i.oSource);}else if((l==="partOfCurrentVariant")&&this.ensureLoadedValueHelpList){var W=this.determineFilterItemByName(i.oSource.getName());if(W&&W.getPartOfCurrentVariant()){this.ensureLoadedValueHelpList(i.oSource.getName());}}if(this.getAdvancedMode()&&!this.getIsRunningInValueHelpDialog()){this._rerenderAA();}}};z.prototype._addContainer=function(i){if(i&&this._oBasicAreaLayout){if(i.container&&(this._oBasicAreaLayout.indexOfContent(i.container)===-1)){this._addContainerInOrder(i.filterItem,i.container);}}};z.prototype._removeContainer=function(i){if(i&&this._oBasicAreaLayout){if(i.container&&(this._oBasicAreaLayout.indexOfContent(i.container)>-1)){this._oBasicAreaLayout.removeContent(i.container);}}};z.prototype._addContainerInOrder=function(j,l){var n,i,O,Q=this._oBasicAreaLayout.getContent(),W=-1;if(this._isNewFilterBarDesign()){if(this._isPhone()){W++;}if(this._oBasicSearchField){W++;}}if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){var X=this._mAdvancedAreaFilter[n];if(X&&X.items){for(i=0;i<X.items.length;i++){if(!X.items[i].container){continue;}if(X.items[i].container===l){this._oBasicAreaLayout.insertContent(l,W+1);return;}O=Q.indexOf(X.items[i].container);if(O>=0){W=O;}}}}}};z.prototype._checkChangePossibleVisibleInFilterBar=function(i,j){if(i&&i.getMandatory()&&!j){var l=this._hasFilterValue(i);if(!l){i.setVisibleInFilterBar(true);return false;}}return true;};z.prototype._hasFilterValue=function(i){var j;if(!this._getTriggerFilterChangeState()&&this.getAllFiltersWithValues){j=this.getAllFiltersWithValues();}else{j=this._getFiltersWithValues();}return this._checkFilterForValue(j,i);};z.prototype._adaptGroupTitleForFilter=function(i){var l;var j;if(i&&!i.getHiddenFilter()){l=i.getLabel();j=i.getLabelControl(this.getId());if(this.getConsiderGroupTitle()){if(j&&i.getGroupTitle()){j.setText(l+" ("+i.getGroupTitle()+')');}}else{j.setText(l);}}};z.prototype._adaptGroupTitle=function(j){var i;var l;if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[j]&&this._mAdvancedAreaFilter[j].items){for(i=0;i<this._mAdvancedAreaFilter[j].items.length;i++){l=this._mAdvancedAreaFilter[j].items[i];if(l&&l){this._adaptGroupTitleForFilter(l.filterItem);}}}};z.prototype.registerGetFiltersWithValues=function(i){this._fRegisterGetFiltersWithValues=i;return this;};z.prototype.registerFetchData=function(i){this._fRegisteredFetchData=i;return this;};z.prototype.registerApplyData=function(i){this._fRegisteredApplyData=i;return this;};z.prototype._isTINAFScenario=function(){if(this._oVariantManagement){if(!this._isUi2Mode()){return true;}}else{if(this._oCollectiveSearch&&this.getAdvancedMode()){return true;}}return false;};z.prototype.fireInitialise=function(){if(this._isTINAFScenario()){this._createVisibleFilters();if(this.getAdvancedMode()){this._ensureFilterLoaded(null);}this._fireInitialiseEvent();}else{this._initializeVariantManagement();}if(this.getIsRunningInValueHelpDialog()){this._rerenderFilters();}};z.prototype.variantsInitialized=function(){this._afterVariantsLoad();this.fireInitialized();};z.prototype.fireInitialized=function(){this.fireEvent("initialized");};z.prototype._initializeVariantManagement=function(){this._createVisibleFilters();if(this._oVariantManagement&&this.getPersistencyKey()){if(this._isTINAFScenario()){this._oVariantManagement.initialise(this._initialiseVariants,this);}else{this._fInitialiseVariants=this._initialiseVariants.bind(this);this._oVariantManagement.attachInitialise(this._fInitialiseVariants,this);this._oVariantManagement.initialise();}}else{this._fireInitialiseEvent();}};z.prototype._fireInitialiseEvent=function(){try{this.fireEvent("initialise");this._showHintText();}catch(i){k.error("error during initialise event handling - "+i.message);}this._bIsInitialized=true;this._updateToolbarText();};z.prototype._initialiseVariants=function(){this._fireInitialiseEvent();if(this._oVariantManagement){this._oVariantManagement.currentVariantSetModified(false);}};z.prototype.fireAfterVariantLoad=function(i,j){this._rerenderFilters();var l={context:i,executeOnSelect:j};try{this.fireEvent("afterVariantLoad",l);}catch(n){k.error("error during 'afterVariantLoad' event handling - "+n.message);}};z.prototype.fireBeforeVariantSave=function(i){var j={context:i};var l=this._getConsiderFilterChanges();if(i){this._setConsiderFilterChanges(false);}this.fireEvent("beforeVariantSave",j);if(i){this._setConsiderFilterChanges(l);}};z.prototype.destroyFilterGroupItems=function(){var i=this.getFilterGroupItems();this._destroyItems(i);return this;};z.prototype.destroyFilterItems=function(){var i=this.getFilterItems();this._destroyItems(i);return this;};z.prototype.removeAllFilterItems=function(){var i,j=this.getFilterItems();if(j&&j.length){for(i=0;i<j.length;i++){this.removeFilterItem(j[i]);}}return j;};z.prototype.removeAllFilterGroupItems=function(){var i,j=[],l=this.getFilterGroupItems();if(l&&l.length){for(i=0;i<l.length;i++){j.push(l[i]);this.removeFilterGroupItem(l[i]);}}return j;};z.prototype.removeAllFilters=function(){this.removeAllFilterItems();this.removeAllFilterGroupItems();this.removeBasicSearch();};z.prototype.removeBasicSearch=function(){this.setBasicSearch(null);};z.prototype.getAllFilterItems=function(j){var i,n=null;var l=[];var O,Q;if(!j){this._ensureFilterLoaded(null);}if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){O=this._mAdvancedAreaFilter[n];if(O.items){for(i=0;i<O.items.length;i++){Q=O.items[i];if(Q&&Q.filterItem&&Q.filterItem.getVisible()){if(j){if(Q.filterItem.getVisibleInFilterBar()||Q.filterItem.getPartOfCurrentVariant()){l.push(Q.filterItem);}}else{l.push(Q.filterItem);}}}}}}}return l;};z.prototype._clearErrorState=function(){this._resetFiltersInErrorValueState();};z.prototype.getAggregation=function(n){if(n=="filterGroupItems"&&!this.__bDeleteMode){this._ensureFilterLoaded(null);}return G.prototype.getAggregation.apply(this,arguments);};z.prototype._getFilterInformation=function(){return[];};z.prototype._createVisibleFilters=function(){this._getFilters();};z.prototype._getFilters=function(){this._aFields=this._getFilterInformation();var i,j;if(this._aFields&&this._aFields.length>0){if(!this._mAdvancedAreaFilter){this._mAdvancedAreaFilter={};if(!this.getAdvancedMode()){this._mAdvancedAreaFilter[z.INTERNAL_GROUP]={};this._mAdvancedAreaFilter[z.INTERNAL_GROUP].filterItem=null;this._mAdvancedAreaFilter[z.INTERNAL_GROUP].items=null;}}for(i=0;i<this._aFields.length;i++){j=this._aFields[i];if(j.groupName!==z.INTERNAL_GROUP){if(!this._mAdvancedAreaFilter[j.groupName]){this._mAdvancedAreaFilter[j.groupName]={};this._mAdvancedAreaFilter[j.groupName].groupTitle=j.groupTitle;this._mAdvancedAreaFilter[j.groupName].filterItem=null;this._mAdvancedAreaFilter[j.groupName].items=[];}}if(j.visibleInAdvancedArea||(j.groupName===z.INTERNAL_GROUP)){this._instanciateFilterItem(j);}}}this._adaptButtonsEnablement();};z.prototype.isVisibleInFilterBarByName=function(n){var i,j=this._getFilterMetadata(n);if(j&&j.factory){if((j.hasOwnProperty("visibleInAdvancedArea")&&j.visibleInAdvancedArea)||(j.groupName===z.INTERNAL_GROUP)){return true;}}else{i=this.determineFilterItemByName(n);if(i){return i.getVisibleInFilterBar();}}return false;};z.prototype._getFilterMetadata=function(n){if(this._aFields){for(var i=0;i<this._aFields.length;i++){if(this._aFields[i].fieldName===n){return this._aFields[i];}}}return null;};z.prototype.getNonVisibleCustomFilterNames=function(){if(this._aFields.length>0){return this._getLazyNonVisibleCustomFilterNames();}else{return this._getNonVisibleCustomFilterNames();}};z.prototype._getLazyNonVisibleCustomFilterNames=function(){var i=this,j=[];this._aFields.forEach(function(l){if(l.factory){if(l.isCustomFilterField&&!l.visibleInAdvancedArea){j.push(l.fieldName);}}else if(i._isNonVisibleCustomFilterNamesByName(l.fieldName,l.groupName)){j.push(l.fieldName);}});return j;};z.prototype._isNonVisibleCustomFilterNamesByName=function(n,j){var i,l;if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[j]&&this._mAdvancedAreaFilter[j].items){for(i=0;i<this._mAdvancedAreaFilter[j].items.length;i++){l=this._mAdvancedAreaFilter[j].items[i];if(l.filterName&&(l.filterItem.getName()===n)){return this._isNonVisibleCustomFilterNamesByFilter(l.filterItem);}}}return false;};z.prototype._isNonVisibleCustomFilterNamesByFilter=function(i){if(i.data("isCustomField")&&!i.getVisibleInFilterBar()){return true;}return false;};z.prototype._getNonVisibleCustomFilterNames=function(){var i=this,j=[],l=this.getAllFilterItems();if(l){l.forEach(function(n){if(i._isNonVisibleCustomFilterNamesByFilter(n)){j.push(n.getName());}});}return j;};z.prototype._ensureFilterLoaded=function(l){var i,j,n;if(this._aFields&&this._aFields.length>0){for(j=0;j<this._aFields.length;j++){n=this._aFields[j];if(!n.factory){continue;}if(l){for(i=0;i<l.length;i++){if(n.fieldName===l[i].name){if(n.groupName===l[i].group){this._instanciateFilterItem(n);break;}else if(n.groupEntityType===l[i].group){this._instanciateFilterItem(n);}}}}else{this._instanciateFilterItem(n);}}if(!l){this._aFields=[];}}};z.prototype._instanciateFilterItem=function(i){var j=i.factory;if(j){delete i.factory;j.call(i);}};z.prototype._destroyItems=function(j){if(j&&j.length){for(var i=0;i<j.length;i++){j[i].destroy();}}};z.prototype._reapplyVisibility=function(j){var i,n=null;var l;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){var O=this._mAdvancedAreaFilter[n];if(O&&O.items){for(i=0;i<O.items.length;i++){l=O.items[i];if(l&&l.filterItem){this._setPersVisibility(j,l.filterItem);}}}}}}};z.prototype._setPersVisibility=function(i,j){var l,n;if(j&&!j.getHiddenFilter()){l=j.getGroupName();n=this._checkForFilterInfo(i,j);if(this._isTINAFScenario()){if(n){j.setVisibleInFilterBar(n.visibleInFilterBar);j.setPartOfCurrentVariant(n.partOfCurrentVariant);if(n.hasOwnProperty("visible")){j.setVisible(n.visible);}}else{j.setVisibleInFilterBar(false);if((l===z.INTERNAL_GROUP)||j._isParameter()){j.setPartOfCurrentVariant(true);}else{j.setPartOfCurrentVariant(false);}}}else{if(n&&(n.visibleInFilterBar!==undefined)){j.setVisibleInFilterBar((n.visibleInFilterBar));j.setPartOfCurrentVariant((n.partOfCurrentVariant));}else{if((l!==z.INTERNAL_GROUP)&&n&&(n.group===l)){j.setVisibleInFilterBar((n!==null));}}}if(l===z.INTERNAL_GROUP){j.setPartOfCurrentVariant(true);}if(j){var O=this.determineControlByFilterItem(j,true);if(O&&O.getValueState&&(O.getValueState()!==q.None)){O.setValueState(q.None);}}}};z.prototype._checkForFilterInfo=function(l,n){var i,j,O=n.getName(),Q=[n.getGroupName(),n.getEntitySetName(),n.getEntityTypeName()];var W=[];if(l&&l.length){for(i=0;i<l.length;i++){if(l[i].name===O){if(Q.indexOf(l[i].group)>-1){W.push(l[i]);}}}}if(W.length===1){return W[0];}else if(W.length>1){for(j=0;j<Q.length;j++){for(i=0;i<W.length;i++){if(W[i].group===Q[j]){return W[i];}}}}return null;};z.prototype._createVariantManagement=function(){var i=new S(this.getId()+"-variantUi2",{});var j=new e({type:"filterBar",keyName:"persistencyKey"});j.setControl(this);i.addPersonalizableControl(j);i.addStyleClass("sapUiCompFilterBarMarginLeft");return i;};z.prototype.fireAssignedFiltersChanged=function(){this.fireEvent("assignedFiltersChanged");};z.prototype.retrieveFiltersWithValuesAsText=function(){var j,l,n=this.retrieveFiltersWithValues(),O,Q=this.getBasicSearchValue();if(Q&&n){n.splice(0,0,this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_SEARCH_TERM"));}if(!n||(n.length===0)){j=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_ZERO");}else{if(!this._isPhone()){O=Math.min(5,n.length);l="";for(var i=0;i<O;i++){l+=n[i];if(i<(O-1)){l+=', ';}}j=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS",[n.length,l]);if(O<n.length){j+=", ...";}}else{j=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_MOBILE",[n.length]);}}return j;};z.prototype.retrieveFiltersWithValues=function(){var i,j=[];var l=this._getFiltersWithValues();if(l){for(i=0;i<l.length;i++){if(l[i].getVisible()&&l[i].getPartOfCurrentVariant()){j.push(l[i].getLabel());}}}return j;};z.prototype._getFiltersWithValues=function(){if(this._fRegisterGetFiltersWithValues){try{return this._fRegisterGetFiltersWithValues();}catch(i){k.error("callback for obtaining the filter count throws an exception");}}return null;};z.prototype._getFiltersWithValuesCount=function(){var n=0;var i=this.retrieveFiltersWithValues();n=i.length;if(this._oBasicSearchField&&this._oBasicSearchField.getValue&&this._oBasicSearchField.getValue()){n++;}return n;};z.prototype._checkFilterForValue=function(j,l){var i;if(j){for(i=0;i<j.length;i++){if(j[i]===l){return true;}}}return false;};z.prototype._handleVisibilityOfToolbar=function(){if(this.getAdvancedMode()&&this._oToolbar){var j=false;var l=this._oToolbar.getContent();for(var i=0;i<l.length;i++){if(l[i]instanceof b){continue;}if(l[i].getVisible&&l[i].getVisible()){j=true;break;}}this._oToolbar.setVisible(j);}};z.prototype._toggleHideShow=function(){this.setFilterBarExpanded(!this.getFilterBarExpanded());this._bShowAllFilters=false;this._rerenderFilters();};z.prototype._updateToolbarText=function(){var i=this._isNewFilterBarDesign()?"FILTER_BAR_ADAPT_FILTERS":"FILTER_BAR_ACTIVE_FILTERS";var Z=this._isNewFilterBarDesign()?"FILTER_BAR_ADAPT_FILTERS_ZERO":"FILTER_BAR_ACTIVE_FILTERS_ZERO";var n=this._getFiltersWithValuesCount();var j=n?(this._oRb.getText(i,[n])):(this._oRb.getText(Z));this._oFiltersButton.setText(j);this.fireAssignedFiltersChanged();};z.prototype.setFilterBarExpanded=function(i){var j;if(this.getAdvancedMode()){this.setProperty("filterBarExpanded",i);if(this._oHideShowButton){if(i){this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_VH_HIDE_FILTERS"));this._oHideShowButton.setTooltip(this._oRb.getText("FILTER_BAR_VH_HIDE_FILTERS"));}else{this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_VH_SHOW_FILTERS"));this._oHideShowButton.setTooltip(this._oRb.getText("FILTER_BAR_VH_SHOW_FILTERS"));}}this._calcVisibilityGoButton();if(this.getIsRunningInValueHelpDialog()){this._oBasicAreaLayout.setVisible(i);}else{this._oAdvancedPanel.setVisible(i);}}else{if(this._isPhone()&&this.getUseToolbar()){j=false;}else{j=i;}this.setProperty("filterBarExpanded",j);if(this._isNewFilterBarDesign()){return this;}if(this._isPhone()){if(this._oHideShowButton){this._oHideShowButton.setVisible(false);}this._calcVisibilityGoButton();this._oBasicAreaLayout.setVisible(false);}else{if(this._oHideShowButton){if(j){this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_HIDE"));this._oHideShowButton.setTooltip(this._oRb.getText("FILTER_BAR_HIDE"));}else{this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_SHOW"));this._oHideShowButton.setTooltip(this._oRb.getText("FILTER_BAR_SHOW"));}this._oHideShowButton.setVisible(true);}this._calcVisibilityGoButton();if(this._oHideShowButton){if(this._oHideShowButton.getEnabled()){this._oBasicAreaLayout.setVisible(j);}else{this._oBasicAreaLayout.setVisible(false);}}}}this._updateToolbarText();return this;};z.prototype._selectionChangedInFilterDialogByValue=function(i,j){j.setVisibleInFilterBar(i);if(this._getConsiderFilterChanges()&&this._oVariantManagement&&!this._oVariantManagement.getInErrorState()){this._oVariantManagement.currentVariantSetModified(true);}this._bDirtyViaDialog=true;};z.prototype._mandatoryFilterChange=function(i){if(!i){return;}var j=i.getParameters();if(!j||!j.oSource){return;}var l=this._determineByControl(j.oSource);if(l){this._mandatoryFilterItemChange(l.filterItem);}};z.prototype._mandatoryFilterItemChange=function(i){if(i){if(!i.getMandatory()){return;}var j=this._hasFilterValue(i);if(!i.getVisibleInFilterBar()&&!j){i.setVisibleInFilterBar(true);}}};z.prototype._determineNotAssignedFiltersCount=function(j){var n=0,i,l;if(this._mAdvancedAreaFilter[j]&&this._mAdvancedAreaFilter[j].items){for(i=0;i<this._mAdvancedAreaFilter[j].items.length;i++){l=this._mAdvancedAreaFilter[j].items[i].filterItem;if(!l.getVisible()||l.getHiddenFilter()){continue;}if(!l.getPartOfCurrentVariant()&&!l.getVisibleInFilterBar()){n++;}}}return n;};z.prototype._isPhone=function(){return!!(D.system.phone);};z.prototype._isTablet=function(){return!!(D.system.tablet&&!D.system.desktop);};z.prototype.fireSearch=function(i){if(this._bOKFiltersDialogTriggered&&this._oAdaptFiltersDialog){this._oAdaptFiltersDialog.close();}else if(this._oAdaptFiltersDialog){this._bEnterPressedLeadsToSearch=true;}this.fireEvent("search",i);};z.prototype._variantSave=function(i){this._oVariant={};this.fireBeforeVariantSave();};z.prototype._afterVariantSave=function(i){this.fireAfterVariantSave();};z.prototype._filterSetInErrorState=function(i){if(this._oAdaptFiltersDialog&&this._oAdaptFiltersDialog.isOpen()){if(this._getConsiderFilterChanges()&&this._oVariantManagement&&!this._oVariantManagement.getInErrorState()){this._oVariantManagement.currentVariantSetModified(true);}this._bDirtyViaDialog=true;}};z.prototype._cancelFilterDialog=function(i){if(i&&this._oVariantManagement){this._bDirtyViaDialog=this._oVariantManagement._bSaveCanceled;}if(!this.getPersistencyKey()&&(this.getUseSnapshot()===false)){this.fireCancel();return;}if(this._oInitialVariant&&this._oInitialVariant.content&&this._bDirtyViaDialog){this._resetFiltersInErrorValueState();var j=this._retrieveCurrentSelectionSet(false);this._deleteValidatingTokenFlag(j);this.applyVariant(this._oInitialVariant.content,"CANCEL");if(this._oVariantManagement){if(!this._oVariantManagement.isPageVariant()){this._oVariantManagement._setSelectionByKey(this._oInitialVariant.key);}this._oVariantManagement.currentVariantSetModified(this._oInitialVariant.modified);}this.fireCancel();}};z.prototype._resetFiltersInErrorValueState=function(){var n;n=this._retrieveCurrentSelectionSet(true,true);n.forEach(function(O){if(O.control&&O.control.setValueState&&O.control.getValueState){if(O.control.getValueState()===q.Error){if(O.control.setValue){O.control.setValue("");}O.control.setValueState(q.None);}}});};z.prototype.setContentWidth=function(n){if(this._oAdaptFiltersDialog){this._oAdaptFiltersDialog.setContentWidth(n+"px");}};z.prototype.setContentHeight=function(n){if(this._oAdaptFiltersDialog){this._oAdaptFiltersDialog.setContentHeight(n+"px");}};z.prototype.addAdaptFilterDialogCustomContent=function(i){this._mCustomViewInfo={item:i.item,search:i.search,selectionChange:i.selectionChange,content:i.content};};z.prototype._createStructureForAdaptFiltersDialog=function(){var j,l,O={filtersOnFilterBar:{items:[]},allFilters:[]};var Q,W=this.getAllFiltersWithValues?this.getAllFiltersWithValues():this._getFiltersWithValues();if(this._mAdvancedAreaFilter){for(var n in this._mAdvancedAreaFilter){if(n){j=this._mAdvancedAreaFilter[n];if(j.items){for(var i=0;i<j.items.length;i++){l=j.items[i];if(!l.filterItem){continue;}if(l.filterItem.getHiddenFilter()){continue;}Q=this._checkFilterForValue(W,l.filterItem);if(l.filterItem.getVisibleInFilterBar()){O.filtersOnFilterBar.items.push({name:l.filterItem.getName()});}var X=l.filterItem.getGroupName()?l.filterItem.getGroupName():z.INTERNAL_GROUP;var Y=(X===z.INTERNAL_GROUP)?this._oRb.getText("FILTER_BAR_BASIC_GROUP"):l.filterItem.getGroupTitle();var Z=l.filterItem.getControlTooltip()?l.filterItem.getControlTooltip():"";O.allFilters.push({name:l.filterItem.getName(),label:l.filterItem.getLabel(),group:X,groupLabel:Y,tooltip:Z,visibleInDialog:l.filterItem.getVisible(),filterItem:l.filterItem,isFiltered:Q,required:l.filterItem.getMandatory()});}}}}}return O;};z.prototype._restoreControls=function(j){var l,O,Q;if(this._fRegisteredFilterChangeHandlers){this.detachFilterChange(this._fRegisteredFilterChangeHandlers);this._fRegisteredFilterChangeHandlers=null;}if(this._mAdvancedAreaFilter){for(var n in this._mAdvancedAreaFilter){if(n){l=this._mAdvancedAreaFilter[n];if(l.items){for(var i=0;i<l.items.length;i++){O=l.items[i];if(O.filterItem&&!O.filterItem.getHiddenFilter()&&O.control&&O.container){if(O.contentReplaced){O.contentReplaced=undefined;Q=O.container.getContent();O.container.removeContent(Q[1]);Q[1].destroy();O.container.insertContent(O.control,1);}O.filterItem.detachChange(j);}}}}}}this._rerenderFilters();};z.prototype._expandGroup=function(l){if(this._oAdaptFiltersDialog&&this._oAdaptFiltersDialogModel&&this._oAdaptFiltersPanel&&l&&l.filterItem){var n=l.filterItem.getGroupName()?l.filterItem.getGroupName():z.INTERNAL_GROUP;var O=this._oAdaptFiltersDialogModel.getData().itemsGrouped;for(var i=0;i<O.length;i++){if(O[i].group===n){for(var j=0;j<O[i].items.length;j++){if(O[i].items[j].name===l.filterItem.getName()){this._oAdaptFiltersPanel.setGroupExpanded(O[i].items[j].group,true);return;}}return;}}}};var E,K;z.prototype._getEntitiesLazy=function(){if(E&&K){return Promise.resolve();}this.setBusy(true);return sap.ui.getCore().loadLibrary('sap.ui.mdc',{async:true}).then(function(){return new Promise(function(i){sap.ui.require(["sap/ui/mdc/p13n/P13nBuilder","sap/ui/mdc/p13n/panels/AdaptFiltersPanel"],function(j,l){E=j;K=l;i();this.setBusy(false);}.bind(this));}.bind(this));}.bind(this));};z.prototype._filtersButtonPressed=function(){this._oFiltersButton.focus();this.showAdaptFilterDialog();};z.prototype._checkAssignedFilters=function(){if(this._oAdaptFiltersDialog){var j=this.getAllFiltersWithValues?this.getAllFiltersWithValues():this._getFiltersWithValues();var l=this._oAdaptFiltersDialogModel.getData().items;for(var i=0;i<l.length;i++){if(l[i].hasOwnProperty("filterItem")){var n=this._checkFilterForValue(j,l[i].filterItem);if(l[i].isFiltered!==n){l[i].isFiltered=n;}}}}};z.prototype.showAdaptFilterDialogForKeyUser=function(i,j){this._fGetDataForKeyUser=j;this.showAdaptFilterDialog().then(function(){this._oAdaptFiltersDialog.addStyleClass(i);}.bind(this));};z.prototype._createKeyUserChange=function(){var O=[];if(this._bOKFiltersDialogTriggered&&this._oVariantManagement&&this._oVariantManagement.isA("sap.ui.comp.smartvariants.SmartVariantManagement")&&this._oVariantManagement.getVisible()&&this._oVariantManagement._getPersoController()){O=[{selectorControl:this._oVariantManagement._getPersoController(),changeSpecificData:{changeType:"variantContent",content:{key:this._oVariantManagement.getSelectionKey(),persistencyKey:this.getPersistencyKey(),content:this.fetchVariant()}}}];}return O;};z.prototype.showAdaptFilterDialog=function(l){return new Promise(function(n){this._getEntitiesLazy().then(function(){if(!this._oAdaptFiltersDialog){var O=function(d1,e1){for(var i=0;i<d1.length;i++){if(d1[i].group===e1){var Y=d1[i].items;for(var j=0;j<Y.length;j++){if(Y[j].filterItem&&Y[j].filterItem.getVisible()){if(!d1[i].groupVisible){d1[i].groupVisible=true;}return;}}if(d1[i].groupVisible){d1[i].groupVisible=false;}return;}}};var Q=function(j){if(j&&j.oSource&&(j.oSource.isA("sap.ui.comp.filterbar.FilterItem"))){var d1=j.getParameter("propertyName");if(this._oAdaptFiltersDialogModel&&d1){var Y=this._oAdaptFiltersDialogModel.getData().items;for(var i=0;i<Y.length;i++){if(Y[i].hasOwnProperty("filterItem")&&Y[i].filterItem===j.oSource){if(d1==="visible"){var e1=j.oSource.getVisible();if(Y[i].visibleInDialog!=e1){Y[i].visibleInDialog=e1;O(this._oAdaptFiltersDialogModel.getData().itemsGrouped,Y[i].group);this._oAdaptFiltersDialogModel.checkUpdate();break;}}else if(d1==="visibleInFilterBar"){Y[i].selected=j.oSource.getVisibleInFilterBar();this._oAdaptFiltersDialogModel.checkUpdate();break;}}}}}}.bind(this);this._ensureFilterLoaded(null);var W=this._createStructureForAdaptFiltersDialog();var X=E.prepareP13nData(W.filtersOnFilterBar,W.allFilters);this._oAdaptFiltersDialogModel=new J();this._oAdaptFiltersDialogModel.setSizeLimit(1000);this._oAdaptFiltersDialogModel.setData(X);var Y=this._oAdaptFiltersDialogModel.getData().items;for(var i=0;i<Y.length;i++){if(Y[i].hasOwnProperty("filterItem")){Y[i].filterItem.attachChange(Q);}}this._fRegisteredFilterChangeHandlers=function(j){this._mandatoryFilterChange(j);}.bind(this);this.attachFilterChange(this._fRegisteredFilterChangeHandlers);var Z=function(j){var d1=j.getParameter("reason")==="Add";var e1=j.getParameter("item");if(!e1){return;}if(e1.name==="_BASIC_SEARCH_FIELD"){e1.selected=true;return;}var f1=this._determineItemByName(e1.name,e1.group);if(f1&&f1.filterItem){if(f1.filterItem.getMandatory()&&!d1&&!this._hasFilterValue(f1.filterItem)){e1.selected=true;}else{this._selectionChangedInFilterDialogByValue(e1.selected,f1.filterItem);}}}.bind(this);var $=new K({enableReorder:false});$.getView($.GROUP_KEY).getContent().attachChange(Z);$.getView($.LIST_KEY).getContent().attachChange(Z);this._oAdaptFiltersPanel=$;$.setItemFactory(function(j){var d1,e1,f1;f1=j.getObject();if(!f1){return undefined;}e1=this._determineItemByName(f1.name,f1.group);if(!e1||!e1.filterItem||!e1.control){return undefined;}d1=e1.control;if(!e1.contentReplaced&&e1.container&&e1.container.getContent()[1]===d1){e1.contentReplaced=true;e1.container.removeContent(e1.control);e1.container.insertContent(e1.control.clone(),1);}return d1;}.bind(this));this.fireFiltersDialogBeforeOpen({newDialog:true});$.setP13nModel(this._oAdaptFiltersDialogModel);if(this._mCustomViewInfo&&this._mCustomViewInfo.item&&this._mCustomViewInfo.item.getKey()){$.addCustomView(this._mCustomViewInfo);$.switchView(l?l:$.GROUP_KEY);}var a1=function(j){this._dialogCancel(this._oAdaptFiltersDialog);}.bind(this);var b1=function(j){this._bOKFiltersDialogTriggered=true;this._oAdaptFiltersDialog.close();}.bind(this);var c1;if(this.getShowRestoreButton()){c1={onExecute:this._dialogRestore.bind(this),idButton:this.getId()+"-resetBtn"};}E.createP13nDialog($,{id:this.getId()+"-adapt-filters-dialog",title:this._oRb.getText(this._isNewFilterBarDesign()?"FILTER_BAR_ADAPT_FILTERS_DIALOG":"FILTER_BAR_ADV_FILTERS_DIALOG"),reset:c1,verticalScrolling:false,cancel:a1,confirm:{text:this._oRb.getText("FILTER_BAR_OK"),handler:b1}}).then(function(j){this._oAdaptFiltersDialog=j;this._oVariant.content=this.fetchVariant();if(this._oVariantManagement){this._oVariant.key=this._oVariantManagement.getSelectionKey();this._oVariant.modified=this._oVariantManagement.currentVariantGetModified();}this._oInitialVariant={};o(this._oInitialVariant,this._oVariant);this._bOKFiltersDialogTriggered=false;this._oAdaptFiltersDialog.attachBeforeOpen(function(){this._bDirtyViaDialog=false;this._bEnterPressedLeadsToSearch=false;}.bind(this));this._oAdaptFiltersDialog.attachBeforeClose(function(){this._restoreControls(Q);if(!this._bOKFiltersDialogTriggered){this._cancelFilterDialog(false);}if(this._fGetDataForKeyUser){this._fGetDataForKeyUser(this._createKeyUserChange());}}.bind(this));this._oAdaptFiltersDialog.attachAfterClose(function(){this._oBasicAreaLayout.rerender();this._oAdaptFiltersDialogModel=null;this._oAdaptFiltersPanel=null;this._oVariant={};this._oInitialVariant=null;this._oAdaptFiltersDialog.destroy();this._oAdaptFiltersDialog=null;this._fGetDataForKeyUser=null;if(this._bOKFiltersDialogTriggered&&this._bDirtyViaDialog&&!this._bEnterPressedLeadsToSearch){if(!this.isLiveMode||!this.isLiveMode()){this.fireFilterChange();}}this._bEnterPressedLeadsToSearch=false;this.fireFiltersDialogClosed({context:this._bOKFiltersDialogTriggered?"SEARCH":"CANCEL"});}.bind(this));this._oAdaptFiltersDialog.setParent(this);if(this.$().closest(".sapUiSizeCompact").length>0){this._oAdaptFiltersDialog.addStyleClass("sapUiSizeCompact");}this._oAdaptFiltersDialog.isPopupAdaptationAllowed=function(){return false;};this._oAdaptFiltersDialog.open();n();}.bind(this));return;}n();}.bind(this));}.bind(this));};z.prototype.isDialogOpen=function(){return this._oAdaptFiltersDialog?true:false;};z.prototype._dialogCancel=function(i){if(i){this._bOKFiltersDialogTriggered=false;this.fireFiltersDialogCancel();i.close();}};z.prototype._dialogRestore=function(){this.reset();if(this._oVariantManagement&&this._oVariantManagement.getVisible()&&!this._oVariantManagement.getInErrorState()){this._oVariantManagement.currentVariantSetModified(false);}this._bDirtyViaDialog=false;};z.prototype._createButtons=function(i){var j=this;this._oSearchButton=new B(this.getId()+"-btnGo",{visible:this.getShowGoOnFB(),text:this._oRb.getText("FILTER_BAR_GO"),type:s.Emphasized});p.addConfig(this._oSearchButton,{event:"search"},this);this._oSearchButton.attachPress(function(){j._oSearchButton.focus();j.search();});i.addContent(this._oSearchButton);this._oHideShowButton=new B(this.getId()+"-btnShowHide",{text:this._oRb.getText("FILTER_BAR_HIDE"),tooltip:this._oRb.getText("FILTER_BAR_HIDE"),type:s.Transparent,enabled:false});this._oHideShowButton.attachPress(function(){j._toggleHideShow();});i.addContent(this._oHideShowButton);this._oClearButtonOnFB=new B(this.getId()+"-btnClear",{visible:this.getShowClearOnFB(),text:this._oRb.getText("FILTER_BAR_CLEAR"),tooltip:this._oRb.getText("FILTER_BAR_CLEAR"),type:s.Transparent,enabled:false});this._oClearButtonOnFB.attachPress(function(){j.clear();if(j.isLiveMode&&j.isLiveMode()){j.search();}});i.addContent(this._oClearButtonOnFB);this._oRestoreButtonOnFB=new B(this.getId()+"-btnRestore",{visible:this.getShowRestoreOnFB(),text:this._oRb.getText("FILTER_BAR_RESTORE"),tooltip:this._oRb.getText("FILTER_BAR_RESTORE"),type:s.Transparent,enabled:false});this._oRestoreButtonOnFB.attachPress(function(){j.reset();if(j._oVariantManagement){j._oVariantManagement.currentVariantSetModified(false);}});i.addContent(this._oRestoreButtonOnFB);this._oFiltersButton=new B(this.getId()+"-btnFilters",{visible:this.getShowFilterConfiguration(),text:this._oRb.getText("FILTER_BAR_ACTIVE_FILTERS_ZERO"),type:s.Transparent,enabled:false,ariaHasPopup:t.Dialog});this._oFiltersButton.attachPress(function(){this._filtersButtonPressed();}.bind(this));i.addContent(this._oFiltersButton);};z.prototype._toggleAllFilters=function(){this._bShowAllFilters=!this._bShowAllFilters;this._oShowAllFiltersButton.setVisible(!this._bShowAllFilters);this._rerenderFilters();};z.prototype.initShowAllFiltersButton=function(){this._oShowAllFiltersButton=new B(this.getId()+"-btnShowAll",{text:this._oRb.getText("FILTER_BAR_VH_SHOW_ALL"),type:s.Transparent,press:this._toggleAllFilters.bind(this)});this._oBasicAreaLayout.addEndContent(this._oShowAllFiltersButton);};z.prototype._createVariantLayout=function(){this._oVariantManagement=this._createVariantManagement();if(this._possibleToChangeVariantManagement()){this._oVariantManagement.setVisible(false);}this._registerVariantManagement();return this._oVariantManagement;};z.prototype._createToolbar=function(i){var j=new a(this.getId()+"-toolbar");if(!i){var l=this._createVariantLayout();j.addContent(l);}j.addContent(new b());this._createButtons(j);j.addStyleClass("sapUiCompFilterBarToolbar");j.setLayoutData(new g({span:"L12 M12 S12"}));return j;};z.prototype._replaceVariantManagement=function(i){if(this._oVariantManagement){this._unregisterVariantManagement();if(this._oToolbar&&this._oToolbar.getContent(this._oVariantManagement)){this._oToolbar.removeContent(this._oVariantManagement);}this._oVariantManagement.destroy();}this._oVariantManagement=i;this._registerVariantManagement();this._adaptNewFilterBarDesign();};z.prototype._createAdvancedAreaForm=function(){if((!w||!x||!y||!R)&&!this._bAdvancedRequested){w=sap.ui.require("sap/ui/layout/form/Form");x=sap.ui.require("sap/ui/layout/form/FormContainer");y=sap.ui.require("sap/ui/layout/form/FormElement");R=sap.ui.require("sap/ui/layout/form/ResponsiveGridLayout");if(!w||!x||!y||!R){sap.ui.require(["sap/ui/layout/form/Form","sap/ui/layout/form/FormContainer","sap/ui/layout/form/FormElement","sap/ui/layout/form/ResponsiveGridLayout"],M.bind(this));this._bAdvancedRequested=true;}}if(!w||!x||!y||!R){return;}var i=new R(this.getId()+"-AdvancedFormLayout");i.addStyleClass("sapUiCompFilterBarPaddingForm");i.setColumnsL(3);i.setColumnsM(2);var j=new w(this.getId()+"-AdvancedForm",{editable:true});j.setLayout(i);if(!this.oInvisibleFormTitle){this.oInvisibleFormTitle=new I({text:this._oRb.getText("ADVANCED_SEARCH_TEXT")});this.addContent(this.oInvisibleFormTitle);}j.addAriaLabelledBy(this.oInvisibleFormTitle);this._oAdvancedPanel.addContent(j);return j;};function M(i,j,l,n){w=i;x=j;y=l;R=n;this._bAdvancedRequested=false;if(!this._bIsBeingDestroyed){if(!this.getIsRunningInValueHelpDialog()){this._oAdvancedAreaForm=this._createAdvancedAreaForm();this._rerenderAA();}}}z.prototype._addControlToBasicAreaFormContainer=function(i){var j=i.getControl();if(!j){k.error("no Control obtained");return null;}var l=i.getLabelControl(this.getId());if(!l){k.error("no Label obtained");return null;}this._adaptGroupTitleForFilter(i);return this._addControlToBasicAreaContainer(i,j,l);};z.prototype._addControlToBasicAreaContainer=function(i,j,l){var n=new h();if(j.setWidth){j.setWidth("100%");}n.setWidth("100%");if(l){if(!l.hasStyleClass("sapUiCompFilterLabel")){l.addStyleClass("sapUiCompFilterLabel");}n.addContent(l);if(l.setLabelFor){if(i&&j){l.setLabelFor(j);if(j.setTooltip&&i.getControlTooltip()){j.setTooltip(i.getControlTooltip());}}}}n.addContent(j);if((!this.getAdvancedMode()||this.getIsRunningInValueHelpDialog())&&!this._oAdaptFiltersDialog){if(i&&i.getVisible()&&i.getVisibleInFilterBar()){var O=this._oBasicAreaLayout.getContent();if(this._isNewFilterBarDesign()&&!this._isPhone()){this._oBasicAreaLayout.insertContent(n,O.length);}else{this._oBasicAreaLayout.addContent(n);}}}return n;};z.prototype._rerenderAA=function(){if(this._oAdvancedAreaForm){this._oAdvancedAreaForm.removeAllFormContainers();var i=this._flattenMap();this._layOutAA(i);}};z.prototype._groupsWithVisibleFilters=function(){var n,j,l=this._mAdvancedAreaFilter;if(this._mAdvancedAreaFilter&&Object.keys(this._mAdvancedAreaFilter).length>1){l={};for(var O in this._mAdvancedAreaFilter){if(O&&this._mAdvancedAreaFilter[O]&&this._mAdvancedAreaFilter[O].items){n=this._mAdvancedAreaFilter[O].items.length;for(var i=0;i<this._mAdvancedAreaFilter[O].items.length;i++){j=this._mAdvancedAreaFilter[O].items[i].filterItem;if(j&&(j.getHiddenFilter()||!j.getVisible())){n--;}}if(n){l[O]={};}}}}return l;};z.prototype._layOutAA=function(i){var j=this._groupsWithVisibleFilters();if(j&&Object.keys(j).length>1){this._layOutAAMultipleGroup(i);}else{this._layOutAASingleGroup(i);}};z.prototype._layOutAAMultipleGroup=function(l){var i,j,n=0,O=null,W=false;for(i=0;i<l.length;i++){if(l[i].control===null){n++;}}if(this._mAdvancedAreaFilter&&(Object.keys(this._mAdvancedAreaFilter).length===2)&&this._mAdvancedAreaFilter[z.INTERNAL_GROUP]&&this._mAdvancedAreaFilter[z.INTERNAL_GROUP].items&&(this._mAdvancedAreaFilter[z.INTERNAL_GROUP].items.length>0)){W=true;}var Q=this._oAdvancedAreaForm.getLayout();if(Q){if(n>=3){Q.setLabelSpanL(5);Q.setLabelSpanM(5);Q.setColumnsL(3);Q.setColumnsM(2);}else if(n===2){Q.setLabelSpanL(4);Q.setLabelSpanM(5);Q.setColumnsL(2);Q.setColumnsM(2);}else if(n===1){Q.setLabelSpanL(4);Q.setLabelSpanM(5);Q.setColumnsL(2);Q.setColumnsM(2);}}for(i=0;i<l.length;i++){if(l[i].control===null){O=new x();if((Object.keys(this._mAdvancedAreaFilter).length>1)&&!W){if((n>=3)&&(l[i].filterItem.getGroupName()===z.INTERNAL_GROUP)){O.setTitle(this._oRb.getText("FILTER_BAR_BASIC_GROUP"));}else{O.setTitle(l[i].filterItem.getGroupTitle());}}this._oAdvancedAreaForm.addFormContainer(O);j=i+1;while(j<l.length&&(l[j].control)){this._addControlToAdvancedArea(l[j].filterItem,l[j].control,O);j++;}i=j-1;}}if(n===1){this._oAdvancedAreaForm.addFormContainer(new x());}};z.prototype._layOutAASingleGroup=function(j){var i,l,n,O;var Q=j.length-1;var W=Q>2?2:1;if(W>1){n=Math.floor(Q/W);O=((n*W)<Q);for(i=1;i<W;i++){l=i*n;if(O){++l;}if((l+i)<j.length){j.splice(l+i,0,j[0]);}}}this._layOutAAMultipleGroup(j);};z.prototype._flattenMap=function(){var n=null,i,j=[],l;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n].items){l=false;for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){var O=this._mAdvancedAreaFilter[n].items[i];if(O.filterItem&&O.filterItem.getVisibleInFilterBar()&&O.filterItem.getVisible()&&!O.filterItem.getHiddenFilter()){if(!l){l=true;j.push({control:null,filterItem:this._mAdvancedAreaFilter[n].filterItem});}j.push({control:O.control,filterItem:O.filterItem});}}}}}return j;};z.prototype._rerenderItem=function(i,j){var l;if(i){l=i.filterItem.getVisible()&&i.filterItem.getVisibleInFilterBar()&&!i.filterItem.getHiddenFilter();if(j!==undefined){l=l&&!j;}if(i.container){i.container.setVisible(l);if(l){this._addContainer(i);}else{this._removeContainer(i);}}}};z.prototype._rerenderFilters=function(){var i;var n=null;var j=null;var l=[];if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n]&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){j=this._mAdvancedAreaFilter[n].items[i];var O=j.filterItem.getVisible()&&j.filterItem.getVisibleInFilterBar()&&!j.filterItem.getHiddenFilter();l.push({visible:O,item:j});}}}}var Q=this.getIsRunningInValueHelpDialog()&&!this._bShowAllFilters;var W=l.filter(function($){return $.visible;}).length;var X=W>this._nMaxFiltersByDefault?this._nMaxFiltersByDefault-1:this._nMaxFiltersByDefault;for(var Y=0;Y<l.length;Y++){var Z=Q&&Y>=X;this._rerenderItem(l[Y].item,Z);}if(this._oShowAllFiltersButton){if(Q&&W>this._nMaxFiltersByDefault){this._oShowAllFiltersButton.setVisible(true);}else{this._oShowAllFiltersButton.setVisible(false);}}this._updateToolbarText();};z.prototype.rerenderFilters=function(){this._rerenderFilters();};z.prototype._setTriggerFilterChangeState=function(i){this._triggerFilterChangeState=i;};z.prototype._getTriggerFilterChangeState=function(){return this._triggerFilterChangeState;};z.prototype._setConsiderFilterChanges=function(i){this._filterChangeSemaphore=i;};z.prototype._getConsiderFilterChanges=function(){return this._filterChangeSemaphore;};z.prototype.fireFilterChange=function(i){this._updateToolbarText();if(!this._getTriggerFilterChangeState()){return;}if(this._getConsiderFilterChanges()&&this._oVariantManagement&&!this._oVariantManagement.getInErrorState()){this._oVariantManagement.currentVariantSetModified(true);}if(this._oAdaptFiltersDialog&&!(this._oAdaptFiltersDialog.isOpen())){return;}if(this._oAdaptFiltersDialog){this._bDirtyViaDialog=true;this._checkAssignedFilters();}this.fireEvent("filterChange",i);};z.prototype._notifyAboutChangedFilters=function(i,j){var O,l=this._determineByControl(j);if(i){O={"added":j,"filterItem":l};}else{O={"deleted":j,"filterItem":l};}this.fireFilterChange(O);};z.prototype._determineVariantFiltersInfo=function(j,l){var i;var n=null,O,Q;var W=[];if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){if(this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){O=this._mAdvancedAreaFilter[n].items[i];if(j||O.filterItem.getVisible()){Q={group:O.filterItem.getGroupName(),name:O.filterItem.getName(),partOfCurrentVariant:O.filterItem.getPartOfCurrentVariant(),visibleInFilterBar:O.filterItem.getVisibleInFilterBar(),visible:O.filterItem.getVisible()};if(l||this._considerFilter(Q)){W.push(Q);}}}}}}}return W;};z.prototype.mergeVariant=function(i,j){var l={};o(l,j);l.filterbar=[];l.filterBarVariant={};o(l.filterbar,i.filterbar);o(l.filterBarVariant,i.filterBarVariant);if(j&&(j.hasOwnProperty("version"))){l.filterbar=this._mergeVariantFields(l.filterbar,j.filterbar);l.filterBarVariant=j.filterBarVariant;}return l;};z.prototype._mergeVariantFields=function(j,l){var i;l.forEach(function(n){for(i=0;i<j.length;i++){if((j[i].group===n.group)&&(j[i].name===n.name)){j.splice(i,1);break;}}});return j.concat(l);};z.prototype._isUi2Mode=function(){if(this._oVariantManagement instanceof S){return true;}return false;};z.prototype._isDeltaHandling=function(){if(this._isUi2Mode()){return false;}return this.getDeltaVariantMode();};z.prototype._getStandardVariant=function(){return this._oVariantManagement.getStandardVariant(this);};z.prototype._considerFilter=function(j){if(!this._isDeltaHandling()){return true;}var l=null;var n=this._getStandardVariant();if(n&&n.filterbar){for(var i=0;i<n.filterbar.length;i++){if((n.filterbar[i].group===j.group)&&(n.filterbar[i].name===j.name)){l=n.filterbar[i];break;}}}if(!l){if(!j.partOfCurrentVariant){return false;}return true;}if((l.partOfCurrentVariant!==j.partOfCurrentVariant)||(l.visibleInFilterBar!==j.visibleInFilterBar)||(l.visible!==j.visible)){return true;}return false;};z.prototype._addControlToAdvancedArea=function(i,j,l){var n=new y({label:i.getLabelControl(this.getId()),fields:[(j!==null)?j:new T()]});l.addFormElement(n);};z.prototype._determineVisibility=function(i){var j=false;if(i){j=i.getVisible()&&(i.getVisibleInFilterBar()||i.getPartOfCurrentVariant());j=j&&!i.getHiddenFilter();}return j;};z.prototype._retrieveVisibleAdvancedItems=function(){var i,n=null,j;var l=[];if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){if(this._mAdvancedAreaFilter[n]&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){j=this._mAdvancedAreaFilter[n].items[i];if(j){if(this._determineVisibility(j.filterItem)){l.push(j);}}}}}}}return l;};z.prototype._retrieveCurrentSelectionSet=function(W,j){var i,l,O,n=[];var Q=this._retrieveVisibleAdvancedItems();for(i=0;i<Q.length;i++){l=Q[i];if(l.control&&l.filterItem&&(j||!l.filterItem._isParameter())){if(W){O={name:Q[i].filterItem.getName(),control:Q[i].control};}else{O=Q[i].control;}n.push(O);}}return n;};z.prototype.search=function(){this.fireSearch({selectionSet:this._retrieveCurrentSelectionSet(false)});return true;};z.prototype.clear=function(){var i={};i.selectionSet=this._retrieveCurrentSelectionSet(false);this._deleteValidatingTokenFlag(i.selectionSet);this._clearErrorState();this.fireClear(i);this._updateToolbarText();};z.prototype._deleteValidatingTokenFlag=function(i){i.forEach(function(j){if(j.hasOwnProperty("__bValidatingToken")){delete j.__bValidatingToken;}});};z.prototype.reset=function(){var i={};i.selectionSet=this._retrieveCurrentSelectionSet(false);this.fireReset(i);this._resetVariant();};z.prototype._resetVariant=function(){var i=null,j=null;this._resetFiltersInErrorValueState();var l=this._retrieveCurrentSelectionSet(false);this._deleteValidatingTokenFlag(l);if(this._oVariantManagement&&this._oVariantManagement.getVisible()){var n=this._oVariantManagement.getSelectionKey();if(n){i=this._oVariantManagement.getVariantContent(this,n);if(this._oVariant){this._oVariant.content=i;this._oVariant.modified=false;if(this.getPersistencyKey()&&this._oInitialVariant){this._oInitialVariant.content=i;this._oInitialVariant.modified=false;this._oInitialVariant.key=n;}}if(!this.getPersistencyKey()&&(this.getUseSnapshot()===undefined)&&this._oInitialVariant&&this._oInitialVariant.content){j=this._oInitialVariant.content;}if(i||j){this.applyVariant(i||j,"RESET");}}}};z.prototype._applyVariant=function(i,j,l,n){var O,Q=null,W,X=false;if(i){if(l){W=this._getTriggerFilterChangeState();this._setTriggerFilterChangeState(false);}this._setConsiderFilterChanges(false);O=i.filterBarVariant;Q=i.filterbar;this._ensureFilterLoaded(Q);this._applyVariantFields(O,n);this._reapplyVisibility(Q);if(this._oBasicSearchField&&this._oBasicSearchField.setValue){this._oBasicSearchField.setValue(""||i.basicSearch);}if(i.executeOnSelection){X=i.executeOnSelection;}this.fireAfterVariantLoad(j,X);this._setConsiderFilterChanges(true);this._updateToolbarText();if(X||(this.getLiveMode&&this.getLiveMode())){this.search();}else{this._clearErrorState();}if(l){this._setTriggerFilterChangeState(W);}}};z.prototype._fetchVariantFiltersData=function(i){if(this._fRegisteredFetchData){try{return this._fRegisteredFetchData(i);}catch(j){k.error("callback for fetching data throws an exception");}}else{k.warning("no callback for fetch data supplied");}return null;};z.prototype._applyVariantFields=function(j,i){if(this._fRegisteredApplyData){try{return this._fRegisteredApplyData(j,i);}catch(l){k.error("callback for applying data throws an exception");}}else{k.warning("no callback for appy data supplied");}};z.prototype._isStandardVariant=function(){var i=this.getCurrentVariantId();if(!i){return true;}if(this._oVariantManagement){if((i===this._oVariantManagement.getStandardVariantKey())){return true;}if(this._oVariantManagement._oStandardVariant===null){return true;}}return false;};z.prototype.isCurrentVariantExecuteOnSelectEnabled=function(){if(this._oVariantManagement&&!this._oVariantManagement.getInErrorState()){var i=this.getCurrentVariantId();if(!i){return this._oVariantManagement.getExecuteOnSelectForStandardVariant();}var j=this._oVariantManagement.getItemByKey(i);if(j){return j.getExecuteOnSelection();}}return false;};z.prototype.fetchVariant=function(){var i,j={},l;if(this._isDeltaHandling()){if(!this._isStandardVariant()){j.version="V3";}}this.fireBeforeVariantFetch();i=this._determineVariantFiltersInfo(true,!j.version);j.filterbar=(!i)?[]:i;j.filterBarVariant=this._fetchVariantFiltersData(j.version);l=this._getBasicSearchValue();if(l){j.basicSearch=l;}if(this._oVariant&&this._oVariant.content){this._oVariant.content=j;}return j;};z.prototype.applyVariant=function(i,j,l){if(i.hasOwnProperty("version")){i=this.mergeVariant(this._getStandardVariant(),i,j);}this._applyVariant(i,j,l,i.version);};z.prototype._afterVariantsLoad=function(){if(this._bDelayRendering){this._oBasicAreaLayout.setVisible(this.getFilterBarExpanded());}this._bDelayRendering=false;};z.prototype.determineMandatoryFilterItems=function(){var i;var j=[];var l=this._retrieveVisibleAdvancedItems();for(i=0;i<l.length;i++){if(l[i].filterItem.getMandatory()===true){if(l[i].control){j.push(l[i].filterItem);}}}return j;};z.prototype.determineControlByFilterItem=function(j,l){var i,n=null;var O,Q;if(!j||(!l&&j._isParameter())){return null;}if(this._aBasicAreaSelection){for(i=0;i<this._aBasicAreaSelection.length;i++){O=this._aBasicAreaSelection[i];if(j===O.filterItem){return O.control;}}}if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){Q=this._mAdvancedAreaFilter[n];if(Q&&Q.items){for(i=0;i<Q.items.length;i++){O=Q.items[i];if((l||!O.filterItem._isParameter())&&(j===O.filterItem)){return O.control;}}}}}}return null;};z.prototype.determineControlByName=function(n,i){var j=this._determineEnsuredItemByName(n,i);if(j&&j.filterItem&&!j.filterItem._isParameter()){return j.control;}return null;};z.prototype.determineLabelByName=function(n,i){var j=this._determineEnsuredItemByName(n,i);if(j&&j.filterItem){return j.filterItem._oLabel;}return null;};z.prototype._determineEnsuredItemByName=function(n,i){if(!i){i=this._determineGroupNameByName(n);}this._ensureFilterLoaded([{name:n,group:i}]);return this._determineItemByName(n,i);};z.prototype._determineGroupNameByName=function(n){if(this._aFields){for(var i=0;i<this._aFields.length;i++){if(this._aFields[i].fieldName===n){return this._aFields[i].groupName;}}}var j=this._determineFilterItemByName(n);if(j){var l=j.getGroupName();if(l!==z.INTERNAL_GROUP){return l;}}return null;};z.prototype._determineItemByName=function(n,j){var i;var l,O;var Q=j;if(!n){return null;}if(!Q){Q=z.INTERNAL_GROUP;}if(this._mAdvancedAreaFilter){O=this._mAdvancedAreaFilter[Q];if(O&&O.items){for(i=0;i<O.items.length;i++){l=O.items[i];if(l&&l.filterItem&&(l.filterItem.getName()===n)){return l;}}}}return null;};z.prototype.determineFilterItemByName=function(n){var i=this._determineEnsuredItemByName(n);if(i&&i.filterItem){return i.filterItem;}return null;};z.prototype._determineFilterItemByName=function(i){var n,j;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){j=this._determineItemByName(i,n);if(j){return j.filterItem;}}}return null;};z.prototype._determineByControl=function(j){var n=null,i;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){var l=this._mAdvancedAreaFilter[n];if(l&&l.items){for(i=0;i<l.items.length;i++){if(l.items[i]&&l.items[i].control===j){return l.items[i];}}}}}}return null;};z.prototype.onAfterRendering=function(i){if(!(this._isPhone()||this._isTablet())){if(this._oHintText&&this._oHintText.getVisible()){this.setFilterBarExpanded(false);}}};z.prototype._destroyLazyFilterControl=function(){var j,i;if(this._aFields&&(this._aFields.length>0)){if(this._aFields&&this._aFields.length>0){for(j=0;j<this._aFields.length;j++){i=this._aFields[j];if(i.factory){if(i.control){i.control.destroy();}}}}}};z.prototype._destroyNonVisibleFilterControl=function(){var i,n,j;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n]&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){j=this._mAdvancedAreaFilter[n].items[i];if(j&&j.container){if(this._oBasicAreaLayout&&(this._oBasicAreaLayout.indexOfContent(j.container)<0)){if(j.control&&!j.bDestroyed){j.control.destroy();j.bDestroyed=true;}}}}}}}};z.prototype._destroyFilterControls=function(){if(!this.getAdvancedMode()){this._destroyLazyFilterControl();this._destroyNonVisibleFilterControl();}};z.prototype._registerVariantManagement=function(){if(this._oVariantManagement){this._oVariantManagement.attachSave(this._variantSave,this);this._oVariantManagement.attachAfterSave(this._afterVariantSave,this);}};z.prototype._unregisterVariantManagement=function(){if(this._oVariantManagement){if(this._fInitialiseVariants){this._oVariantManagement.detachInitialise(this._fInitialiseVariants);this._fInitialiseVariants=null;}this._oVariantManagement.detachSave(this._variantSave,this);this._oVariantManagement.detachAfterSave(this._afterVariantSave,this);if((!this.getUseToolbar()||this.getAdvancedMode())&&!this._oVariantManagement.getDomRef()){this._oVariantManagement.destroy();}}};z.prototype.showFilterDialog=function(){if(!this._oAdaptFiltersDialog){this.showAdaptFilterDialog();}};z.prototype.addFilterDialogContent=function(i){if(this._oAdaptFiltersDialog){return i;}return null;};z.prototype.getFilterDialogContent=function(){if(this._oAdaptFiltersDialog){return new sap.ui.layout.form.Form();}return null;};z.prototype.setShowOldFilterDialog=function(){};z.prototype._getFilterControlById=function(j){for(var l in this._mAdvancedAreaFilter){var n=this._mAdvancedAreaFilter[l];for(var i=0;i<n.items.length;i++){var O=n.items[i];if(O.control&&O.control.getId()===j){return O.control;}}}return null;};z.prototype._getFilterControlByIndex=function(n){var j=0;for(var l in this._mAdvancedAreaFilter){var O=this._mAdvancedAreaFilter[l];for(var i=0;i<O.items.length;i++){var Q=O.items[i];if(Q.filterItem.getVisibleInFilterBar()){if(j===n){return Q.control;}j++;}}}};function N(i,j){var n=i.filter(function(l){return l.getText()===j;});return n.length>0;}z.prototype._getFilterControlByLabel=function(l){for(var j in this._mAdvancedAreaFilter){var n=this._mAdvancedAreaFilter[j];for(var i=0;i<n.items.length;i++){var O=n.items[i];if(O.control){if(N(O.control.getLabels(),l)){return O.control;}}}}};z.prototype._isFilterItemInBasicGroup=function(i){return i&&!i.getGroupName()||i.getGroupName()===z.INTERNAL_GROUP;};z.prototype.exit=function(){this._unregisterVariantManagement();this._destroyFilterControls();if(this._oHintText&&(this._oAdvancedPanel.indexOfContent(this._oHintText)<0)){this._oHintText.destroy();}window.sessionStorage.removeItem(this.getId());window.sessionStorage.removeItem("semanticDates");G.prototype.exit.apply(this,arguments);if(this._oAdaptFiltersDialog){this._oAdaptFiltersDialog.destroy();this._oAdaptFiltersDialog=null;}if(this._oAdaptFiltersDialogModel){this._oAdaptFiltersDialogModel=null;}if(this._oAdaptFiltersPanel){this._oAdaptFiltersPanel=null;}if(this.oModel){this.oModel.destroy();this.oModel=null;}this._aFields=null;this._oHintText=null;this._aBasicAreaSelection=null;this._mAdvancedAreaFilter=null;this._oBasicAreaLayout=null;this._oVariantManagement=null;this._oCollectiveSearch=null;this._oVariant=null;this._fRegisteredFetchData=null;this._fRegisteredApplyData=null;this._fRegisterGetFiltersWithValues=null;this._fRegisteredFilterChangeHandlers=null;this._oSearchButton=null;this._oFiltersButton=null;this._oHideShowButton=null;this._oClearButtonOnFB=null;this._oRestoreButtonOnFB=null;this._oBasicSearchField=null;this._oBasicSearchFieldContainer=null;this._oButtonsVLayout=null;};return z;});
