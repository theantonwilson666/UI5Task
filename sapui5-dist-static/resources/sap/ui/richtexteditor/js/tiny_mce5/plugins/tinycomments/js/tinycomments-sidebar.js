/* Tiny Comments plugin
*
* Copyright 2010-2020 Tiny Technologies Inc. All rights reserved.
*
* Version: 2.2.0-112
*/
!function(b){"use strict";var _=function(){},d=function(t,r){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t(r.apply(null,n))}},sn=function(n){return function(){return n}},fn=function(n){return n};function g(r){for(var o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=o.concat(n);return r.apply(null,t)}}var n,e,t,r,u=function(n){return function(){throw new Error(n)}},m=sn(!1),i=sn(!0),y=sn("dismiss.popups"),p=sn("reposition.popups"),o=function(){return c},c=(n=function(n){return n.isNone()},r={fold:function(n,e){return n()},is:m,isSome:m,isNone:i,getOr:t=function(n){return n},getOrThunk:e=function(n){return n()},getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:sn(null),getOrUndefined:sn(void 0),or:t,orThunk:e,map:o,each:_,bind:o,exists:m,forall:i,filter:o,equals:n,equals_:n,toArray:function(){return[]},toString:sn("none()")},Object.freeze&&Object.freeze(r),r),a=function(t){var n=sn(t),e=function(){return o},r=function(n){return n(t)},o={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:i,isNone:m,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return a(n(t))},each:function(n){n(t)},bind:r,exists:r,forall:r,filter:function(n){return n(t)?o:c},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(m,function(n){return e(t,n)})}};return o},ln={some:a,none:o,from:function(n){return null==n?c:a(n)}},s=function(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:sn(n)}},w={fromHtml:function(n,e){var t=(e||b.document).createElement("div");if(t.innerHTML=n,!t.hasChildNodes()||1<t.childNodes.length)throw b.console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return s(t.childNodes[0])},fromTag:function(n,e){var t=(e||b.document).createElement(n);return s(t)},fromText:function(n,e){var t=(e||b.document).createTextNode(n);return s(t)},fromDom:s,fromPoint:function(n,e,t){var r=n.dom();return ln.from(r.elementFromPoint(e,t)).map(s)}},f=function(n){var e,t,r,o,i,u,c,a=w.fromDom(n.target),s=function(){n.stopPropagation()},f=function(){n.preventDefault()},l=d(f,s);return e=a,t=n.clientX,r=n.clientY,o=s,i=f,u=l,c=n,{target:sn(e),x:sn(t),y:sn(r),stop:o,prevent:i,kill:u,raw:sn(c)}},l=function(n,e,t,r,o){var i,u,c=(i=t,u=r,function(n){i(n)&&u(f(n))});return n.dom().addEventListener(e,c,o),{unbind:g(v,n,e,c,o)}},v=function(n,e,t,r){n.dom().removeEventListener(e,t,r)},h=sn(!0),x=function(n,e,t){return l(n,e,h,t,!1)},O=function(n,e,t){return l(n,e,h,t,!0)},S=function(e){return function(n){return function(n){if(null===n)return"null";var e=typeof n;return"object"===e&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===e&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":e}(n)===e}},E=S("string"),C=S("object"),k=S("array"),T=S("boolean"),M=S("function"),D=S("number"),N=function(n){if(null===n)return"null";if(void 0===n)return"undefined";var e=typeof n;return"object"===e&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===e&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":e},A=function(n){return{eq:n}},F=A(function(n,e){return n===e}),R=function(o){return A(function(n,e){if(n.length!==e.length)return!1;for(var t=n.length,r=0;r<t;r++)if(!o.eq(n[r],e[r]))return!1;return!0})},B=function(n,r){return t=R(n),o=function(n){return e=n,t=r,Array.prototype.slice.call(e).sort(t);var e,t},A(function(n,e){return t.eq(o(n),o(e))});var t,o},I=A(function(n,e){if(n===e)return!0;var c,t=N(n);return t===N(e)&&(-1!==["undefined","boolean","number","string","function","xml","null"].indexOf(t)?n===e:"array"===t?R(I).eq(n,e):"object"===t&&(c=I,A(function(n,e){var t=Object.keys(n),r=Object.keys(e);if(!B(F).eq(t,r))return!1;for(var o=t.length,i=0;i<o;i++){var u=t[i];if(!c.eq(n[u],e[u]))return!1}return!0})).eq(n,e))}),H=Array.prototype.slice,P=Array.prototype.indexOf,j=Array.prototype.push,L=function(n,e){return t=n,r=e,-1<P.call(t,r);var t,r},V=function(n,e){for(var t=0,r=n.length;t<r;t++){if(e(n[t],t))return!0}return!1},W=function(n,e){for(var t=n.length,r=new Array(t),o=0;o<t;o++){var i=n[o];r[o]=e(i,o)}return r},U=function(n,e){for(var t=0,r=n.length;t<r;t++){e(n[t],t)}},z=function(n,e){for(var t=[],r=0,o=n.length;r<o;r++){var i=n[r];e(i,r)&&t.push(i)}return t},q=function(n,e,t){return function(n,e){for(var t=n.length-1;0<=t;t--)e(n[t],t)}(n,function(n){t=e(t,n)}),t},G=function(n,e,t){return U(n,function(n){t=e(t,n)}),t},Y=function(n,e){for(var t=0,r=n.length;t<r;t++){var o=n[t];if(e(o,t))return ln.some(o)}return ln.none()},K=function(n,e){for(var t=0,r=n.length;t<r;t++){if(e(n[t],t))return ln.some(t)}return ln.none()},X=function(n){for(var e=[],t=0,r=n.length;t<r;++t){if(!k(n[t]))throw new Error("Arr.flatten item "+t+" was not an array, input: "+n);j.apply(e,n[t])}return e},J=function(n,e){return X(W(n,e))},Q=function(n,e){for(var t=0,r=n.length;t<r;++t){if(!0!==e(n[t],t))return!1}return!0},$=function(n){var e=H.call(n,0);return e.reverse(),e},Z=function(n,e){return z(n,function(n){return!L(e,n)})},nn=function(n){return[n]},en=function(n){return 0===n.length?ln.none():ln.some(n[0])},tn=(M(Array.from)&&Array.from,function(n,e){for(var t=0;t<n.length;t++){var r=e(n[t],t);if(r.isSome())return r}return ln.none()}),rn=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(e.length!==t.length)throw new Error('Wrong number of arguments to struct. Expected "['+e.length+']", got '+t.length+" arguments");var r={};return U(e,function(n,e){r[n]=sn(t[e])}),r}},on=Object.keys,un=Object.hasOwnProperty,cn=function(n,e){for(var t=on(n),r=0,o=t.length;r<o;r++){var i=t[r];e(n[i],i)}},an=function(n,t){return dn(n,function(n,e){return{k:e,v:t(n,e)}})},dn=function(n,r){var o={};return cn(n,function(n,e){var t=r(n,e);o[t.k]=t.v}),o},mn=function(n,t){var r=[];return cn(n,function(n,e){r.push(t(n,e))}),r},gn=function(n,e){return pn(n,e)?ln.from(n[e]):ln.none()},pn=function(n,e){return un.call(n,e)},vn=function(n,e){return pn(n,e)&&void 0!==n[e]&&null!==n[e]},hn=function(n){return n.slice(0).sort()},bn=function(e,n){if(!k(n))throw new Error("The "+e+" fields must be an array. Was: "+n+".");U(n,function(n){if(!E(n))throw new Error("The value "+n+" in the "+e+" fields was not a string.")})},yn=function(o,i){var t,u=o.concat(i);if(0===u.length)throw new Error("You must specify at least one required or optional field.");return bn("required",o),bn("optional",i),t=hn(u),Y(t,function(n,e){return e<t.length-1&&n===t[e+1]}).each(function(n){throw new Error("The field: "+n+" occurs more than once in the combined fields: ["+t.join(", ")+"].")}),function(e){var t=on(e);Q(o,function(n){return L(t,n)})||function(n,e){throw new Error("All required keys ("+hn(n).join(", ")+") were not specified. Specified keys were: "+hn(e).join(", ")+".")}(o,t);var n=z(t,function(n){return!L(u,n)});0<n.length&&function(n){throw new Error("Unsupported keys for object: "+hn(n).join(", "))}(n);var r={};return U(o,function(n){r[n]=sn(e[n])}),U(i,function(n){r[n]=sn(Object.prototype.hasOwnProperty.call(e,n)?ln.some(e[n]):ln.none())}),r}},_n=function(n,e,t){return 0!=(n.compareDocumentPosition(e)&t)},wn=function(n,e){return _n(n,e,b.Node.DOCUMENT_POSITION_CONTAINED_BY)},xn=function(){return(xn=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++)for(var o in e=arguments[t])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}).apply(this,arguments)};function On(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(n);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(t[r[o]]=n[r[o]])}return t}function Sn(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;var r=Array(n),o=0;for(e=0;e<t;e++)for(var i=arguments[e],u=0,c=i.length;u<c;u++,o++)r[o]=i[u];return r}var En,Cn,kn=function(n){var e=n,t=function(){return e};return{get:t,set:function(n){e=n},clone:function(){return kn(t())}}},Tn=function(){return Mn(0,0)},Mn=function(n,e){return{major:n,minor:e}},Dn={nu:Mn,detect:function(n,e){var t=String(e).toLowerCase();return 0===n.length?Tn():function(n,e){var t=function(n,e){for(var t=0;t<n.length;t++){var r=n[t];if(r.test(e))return r}}(n,e);if(!t)return{major:0,minor:0};var r=function(n){return Number(e.replace(t,"$"+n))};return Mn(r(1),r(2))}(n,t)},unknown:Tn},Nn="Firefox",An=function(n,e){return function(){return e===n}},Fn=function(n){var e=n.current;return{current:e,version:n.version,isEdge:An("Edge",e),isChrome:An("Chrome",e),isIE:An("IE",e),isOpera:An("Opera",e),isFirefox:An(Nn,e),isSafari:An("Safari",e)}},Rn={unknown:function(){return Fn({current:void 0,version:Dn.unknown()})},nu:Fn,edge:sn("Edge"),chrome:sn("Chrome"),ie:sn("IE"),opera:sn("Opera"),firefox:sn(Nn),safari:sn("Safari")},Bn="Windows",In="Android",Hn="Solaris",Pn="FreeBSD",jn="ChromeOS",Ln=function(n,e){return function(){return e===n}},Vn=function(n){var e=n.current;return{current:e,version:n.version,isWindows:Ln(Bn,e),isiOS:Ln("iOS",e),isAndroid:Ln(In,e),isOSX:Ln("OSX",e),isLinux:Ln("Linux",e),isSolaris:Ln(Hn,e),isFreeBSD:Ln(Pn,e),isChromeOS:Ln(jn,e)}},Wn={unknown:function(){return Vn({current:void 0,version:Dn.unknown()})},nu:Vn,windows:sn(Bn),ios:sn("iOS"),android:sn(In),linux:sn("Linux"),osx:sn("OSX"),solaris:sn(Hn),freebsd:sn(Pn),chromeos:sn(jn)},Un=function(n,e){var t=String(e).toLowerCase();return Y(n,function(n){return n.search(t)})},zn=function(n,t){return Un(n,t).map(function(n){var e=Dn.detect(n.versionRegexes,t);return{current:n.name,version:e}})},qn=function(n,t){return Un(n,t).map(function(n){var e=Dn.detect(n.versionRegexes,t);return{current:n.name,version:e}})},Gn=function(n,e){return-1!==n.indexOf(e)},Yn=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Kn=function(e){return function(n){return Gn(n,e)}},Xn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return Gn(n,"edge/")&&Gn(n,"chrome")&&Gn(n,"safari")&&Gn(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Yn],search:function(n){return Gn(n,"chrome")&&!Gn(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return Gn(n,"msie")||Gn(n,"trident")}},{name:"Opera",versionRegexes:[Yn,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Kn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Kn("firefox")},{name:"Safari",versionRegexes:[Yn,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(Gn(n,"safari")||Gn(n,"mobile/"))&&Gn(n,"applewebkit")}}],Jn=[{name:"Windows",search:Kn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return Gn(n,"iphone")||Gn(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Kn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Kn("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Kn("linux"),versionRegexes:[]},{name:"Solaris",search:Kn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Kn("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Kn("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Qn={browsers:sn(Xn),oses:sn(Jn)},$n=kn(function(n,e){var t,r,o,i,u,c,a,s,f,l,d,m,g=Qn.browsers(),p=Qn.oses(),v=zn(g,n).fold(Rn.unknown,Rn.nu),h=qn(p,n).fold(Wn.unknown,Wn.nu);return{browser:v,os:h,deviceType:(r=v,o=n,i=e,u=(t=h).isiOS()&&!0===/ipad/i.test(o),c=t.isiOS()&&!u,a=t.isiOS()||t.isAndroid(),s=a||i("(pointer:coarse)"),f=u||!c&&a&&i("(min-device-width:768px)"),l=c||a&&!f,d=r.isSafari()&&t.isiOS()&&!1===/safari/i.test(o),m=!l&&!f&&!d,{isiPad:sn(u),isiPhone:sn(c),isTablet:sn(f),isPhone:sn(l),isTouch:sn(s),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:sn(d),isDesktop:sn(m)})}}(b.navigator.userAgent,function(n){return b.window.matchMedia(n).matches})),Zn=function(){return $n.get()},ne=(b.Node.ATTRIBUTE_NODE,b.Node.CDATA_SECTION_NODE,b.Node.COMMENT_NODE,b.Node.DOCUMENT_NODE),ee=(b.Node.DOCUMENT_TYPE_NODE,b.Node.DOCUMENT_FRAGMENT_NODE,b.Node.ELEMENT_NODE),te=b.Node.TEXT_NODE,re=(b.Node.PROCESSING_INSTRUCTION_NODE,b.Node.ENTITY_REFERENCE_NODE,b.Node.ENTITY_NODE,b.Node.NOTATION_NODE,ee),oe=ne,ie=function(n,e){var t=n.dom();if(t.nodeType!==re)return!1;var r=t;if(void 0!==r.matches)return r.matches(e);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(e);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(e);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")},ue=function(n){return n.nodeType!==re&&n.nodeType!==oe||0===n.childElementCount},ce=function(n,e){return n.dom()===e.dom()},ae=(Zn().browser.isIE(),function(n){return w.fromDom(n.dom().ownerDocument)}),se=function(n){return w.fromDom(n.dom().ownerDocument.defaultView)},fe=function(n){return ln.from(n.dom().parentNode).map(w.fromDom)},le=function(n){return W(n.dom().childNodes,w.fromDom)},de=function(n,e){var t=n.dom().childNodes;return ln.from(t[e]).map(w.fromDom)},me=function(n){return de(n,0)},ge=(rn("element","offset"),function(e,t){fe(e).each(function(n){n.dom().insertBefore(t.dom(),e.dom())})}),pe=function(e,t){me(e).fold(function(){ve(e,t)},function(n){e.dom().insertBefore(t.dom(),n.dom())})},ve=function(n,e){n.dom().appendChild(e.dom())};(Cn=En||(En={}))[Cn.Modern=0]="Modern",Cn[Cn.Silver=1]="Silver";var he,be,ye,_e={},we={exports:_e};be=_e,ye=we,he=void 0,function(n){"object"==typeof be&&void 0!==ye?ye.exports=n():"function"==typeof he&&he.amd?he([],n):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=n()}(function(){return function i(u,c,a){function s(e,n){if(!c[e]){if(!u[e]){var t=!1;if(!n&&t)return t(e,!0);if(f)return f(e,!0);var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}var o=c[e]={exports:{}};u[e][0].call(o.exports,function(n){return s(u[e][1][n]||n)},o,o.exports,i,u,c,a)}return c[e].exports}for(var f=!1,n=0;n<a.length;n++)s(a[n]);return s}({1:[function(n,e,t){var r,o,i=e.exports={};function u(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function a(e){if(r===setTimeout)return setTimeout(e,0);if((r===u||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(n){try{return r.call(null,e,0)}catch(n){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:u}catch(n){r=u}try{o="function"==typeof clearTimeout?clearTimeout:c}catch(n){o=c}}();var s,f=[],l=!1,d=-1;function m(){l&&s&&(l=!1,s.length?f=s.concat(f):d=-1,f.length&&g())}function g(){if(!l){var n=a(m);l=!0;for(var e=f.length;e;){for(s=f,f=[];++d<e;)s&&s[d].run();d=-1,e=f.length}s=null,l=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(n){try{return o.call(null,e)}catch(n){return o.call(this,e)}}}(n)}}function p(n,e){this.fun=n,this.array=e}function v(){}i.nextTick=function(n){var e=new Array(arguments.length-1);if(1<arguments.length)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];f.push(new p(n,e)),1!==f.length||l||a(g)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(n){return[]},i.binding=function(n){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(n){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(n,l,e){(function(t){!function(n){var e=setTimeout;function r(){}function i(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(n,this)}function o(t,r){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,i._immediateFn(function(){var n=1===t._state?r.onFulfilled:r.onRejected;if(null!==n){var e;try{e=n(t._value)}catch(n){return void c(r.promise,n)}u(r.promise,e)}else(1===t._state?u:c)(r.promise,t._value)})):t._deferreds.push(r)}function u(e,n){try{if(n===e)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var t=n.then;if(n instanceof i)return e._state=3,e._value=n,void a(e);if("function"==typeof t)return void f((r=t,o=n,function(){r.apply(o,arguments)}),e)}e._state=1,e._value=n,a(e)}catch(n){c(e,n)}var r,o}function c(n,e){n._state=2,n._value=e,a(n)}function a(n){2===n._state&&0===n._deferreds.length&&i._immediateFn(function(){n._handled||i._unhandledRejectionFn(n._value)});for(var e=0,t=n._deferreds.length;e<t;e++)o(n,n._deferreds[e]);n._deferreds=null}function s(n,e,t){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof e?e:null,this.promise=t}function f(n,e){var t=!1;try{n(function(n){t||(t=!0,u(e,n))},function(n){t||(t=!0,c(e,n))})}catch(n){if(t)return;t=!0,c(e,n)}}i.prototype.catch=function(n){return this.then(null,n)},i.prototype.then=function(n,e){var t=new this.constructor(r);return o(this,new s(n,e,t)),t},i.all=function(n){var c=Array.prototype.slice.call(n);return new i(function(r,o){if(0===c.length)return r([]);var i=c.length;function u(e,n){try{if(n&&("object"==typeof n||"function"==typeof n)){var t=n.then;if("function"==typeof t)return void t.call(n,function(n){u(e,n)},o)}c[e]=n,0==--i&&r(c)}catch(n){o(n)}}for(var n=0;n<c.length;n++)u(n,c[n])})},i.resolve=function(e){return e&&"object"==typeof e&&e.constructor===i?e:new i(function(n){n(e)})},i.reject=function(t){return new i(function(n,e){e(t)})},i.race=function(o){return new i(function(n,e){for(var t=0,r=o.length;t<r;t++)o[t].then(n,e)})},i._immediateFn="function"==typeof t?function(n){t(n)}:function(n){e(n,0)},i._unhandledRejectionFn=function(n){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",n)},i._setImmediateFn=function(n){i._immediateFn=n},i._setUnhandledRejectionFn=function(n){i._unhandledRejectionFn=n},void 0!==l&&l.exports?l.exports=i:n.Promise||(n.Promise=i)}(this)}).call(this,n("timers").setImmediate)},{timers:3}],3:[function(a,n,s){(function(n,e){var r=a("process/browser.js").nextTick,t=Function.prototype.apply,o=Array.prototype.slice,i={},u=0;function c(n,e){this._id=n,this._clearFn=e}s.setTimeout=function(){return new c(t.call(setTimeout,window,arguments),clearTimeout)},s.setInterval=function(){return new c(t.call(setInterval,window,arguments),clearInterval)},s.clearTimeout=s.clearInterval=function(n){n.close()},c.prototype.unref=c.prototype.ref=function(){},c.prototype.close=function(){this._clearFn.call(window,this._id)},s.enroll=function(n,e){clearTimeout(n._idleTimeoutId),n._idleTimeout=e},s.unenroll=function(n){clearTimeout(n._idleTimeoutId),n._idleTimeout=-1},s._unrefActive=s.active=function(n){clearTimeout(n._idleTimeoutId);var e=n._idleTimeout;0<=e&&(n._idleTimeoutId=setTimeout(function(){n._onTimeout&&n._onTimeout()},e))},s.setImmediate="function"==typeof n?n:function(n){var e=u++,t=!(arguments.length<2)&&o.call(arguments,1);return i[e]=!0,r(function(){i[e]&&(t?n.apply(null,t):n.call(null),s.clearImmediate(e))}),e},s.clearImmediate="function"==typeof e?e:function(n){delete i[n]}}).call(this,a("timers").setImmediate,a("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(n,e,t){var r=n("promise-polyfill"),o="undefined"!=typeof window?window:Function("return this;")();e.exports={boltExport:o.Promise||r}},{"promise-polyfill":2}]},{},[4])(4)});var xe,Oe,Se=we.exports.boltExport,Ee=function(n){var t=ln.none(),e=[],r=function(n){o()?u(n):e.push(n)},o=function(){return t.isSome()},i=function(n){U(n,u)},u=function(e){t.each(function(n){b.setTimeout(function(){e(n)},0)})};return n(function(n){t=ln.some(n),i(e),e=[]}),{get:r,map:function(t){return Ee(function(e){r(function(n){e(t(n))})})},isReady:o}},Ce={nu:Ee,pure:function(e){return Ee(function(n){n(e)})}},ke=function(n){b.setTimeout(function(){throw n},0)},Te=function(t){var n=function(n){t().then(n,ke)};return{map:function(n){return Te(function(){return t().then(n)})},bind:function(e){return Te(function(){return t().then(function(n){return e(n).toPromise()})})},anonBind:function(n){return Te(function(){return t().then(function(){return n.toPromise()})})},toLazy:function(){return Ce.nu(n)},toCached:function(){var n=null;return Te(function(){return null===n&&(n=t()),n})},toPromise:t,get:n}},Me=function(n){return Te(function(){return new Se(n)})},De=function(n){return Te(function(){return Se.resolve(n)})},Ne=function(t){return{is:function(n){return t===n},isValue:i,isError:m,getOr:sn(t),getOrThunk:sn(t),getOrDie:sn(t),or:function(n){return Ne(t)},orThunk:function(n){return Ne(t)},fold:function(n,e){return e(t)},map:function(n){return Ne(n(t))},mapError:function(n){return Ne(t)},each:function(n){n(t)},bind:function(n){return n(t)},exists:function(n){return n(t)},forall:function(n){return n(t)},toOption:function(){return ln.some(t)}}},Ae=function(t){return{is:m,isValue:m,isError:i,getOr:fn,getOrThunk:function(n){return n()},getOrDie:function(){return u(String(t))()},or:function(n){return n},orThunk:function(n){return n()},fold:function(n,e){return n(t)},map:function(n){return Ae(t)},mapError:function(n){return Ae(n(t))},each:_,bind:function(n){return Ae(t)},exists:m,forall:i,toOption:ln.none}},Fe={value:Ne,error:Ae,fromOption:function(n,e){return n.fold(function(){return Ae(e)},Ne)}},Re=function(i){return xn(xn({},i),{toCached:function(){return Re(i.toCached())},bindFuture:function(e){return Re(i.bind(function(n){return n.fold(function(n){return De(Fe.error(n))},function(n){return e(n)})}))},bindResult:function(e){return Re(i.map(function(n){return n.bind(e)}))},mapResult:function(e){return Re(i.map(function(n){return n.map(e)}))},mapError:function(e){return Re(i.map(function(n){return n.mapError(e)}))},foldResult:function(e,t){return i.map(function(n){return n.fold(e,t)})},withTimeout:function(n,o){return Re(Me(function(e){var t=!1,r=b.setTimeout(function(){t=!0,e(Fe.error(o()))},n);i.get(function(n){t||(b.clearTimeout(r),e(n))})}))}})},Be=function(n){return Re(Me(n))},Ie=function(n){return Re(De(Fe.value(n)))},He={nu:Be,wrap:Re,pure:Ie,value:Ie,error:function(n){return Re(De(Fe.error(n)))},fromResult:function(n){return Re(De(n))},fromFuture:function(n){return Re(n.map(Fe.value))},fromPromise:function(n){return Be(function(e){n.then(function(n){e(Fe.value(n))},function(n){e(Fe.error(n))})})}},Pe=(void 0!==b.window?b.window:Function("return this;")(),function(n){return n.dom().nodeName.toLowerCase()}),je=function(e){return function(n){return n.dom().nodeType===e}},Le=je(ee),Ve=je(te),We=function(n,e,t){if(!(E(t)||T(t)||D(t)))throw b.console.error("Invalid call to Attr.set. Key ",e,":: Value ",t,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,t+"")},Ue=function(n,e,t){We(n.dom(),e,t)},ze=function(n,e){var t=n.dom().getAttribute(e);return null===t?void 0:t},qe=function(n,e){var t=n.dom();return!(!t||!t.hasAttribute)&&t.hasAttribute(e)},Ge=function(n,e){n.dom().removeAttribute(e)},Ye=function(n,e){var t=ze(n,e);return void 0===t||""===t?[]:t.split(" ")},Ke=function(n){return void 0!==n.dom().classList},Xe=function(n,e){return o=e,i=Ye(t=n,r="class").concat([o]),Ue(t,r,i.join(" ")),!0;var t,r,o,i},Je=function(n,e){return o=e,0<(i=z(Ye(t=n,r="class"),function(n){return n!==o})).length?Ue(t,r,i.join(" ")):Ge(t,r),!1;var t,r,o,i},Qe=function(n,e){Ke(n)?n.dom().classList.add(e):Xe(n,e)},$e=function(n){0===(Ke(n)?n.dom().classList:Ye(n,"class")).length&&Ge(n,"class")},Ze=function(n,e){Ke(n)?n.dom().classList.remove(e):Je(n,e);$e(n)},nt=function(n,e){return Ke(n)&&n.dom().classList.contains(e)},et=function(t){var r,o=!1;return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return o||(o=!0,r=t.apply(null,n)),r}},tt=function(n){var e=Ve(n)?n.dom().parentNode:n.dom();return null!=e&&e.ownerDocument.body.contains(e)},rt=function(n,e){return t=e,o=void 0===(r=n)?b.document:r.dom(),ue(o)?[]:W(o.querySelectorAll(t),w.fromDom);var t,r,o},ot=sn("tox-comment--active"),it=(sn("data-mce-annotation-uid"),sn("data-mce-annotation"),sn("tinycomments"));function ut(e,u,o,c){var t=function(n,e){o.notificationManager.open({text:n,type:"error"}),e&&b.console.error(n,e)},r=function(n,e){return{view:{type:"splash"},grabFocus:function(){return 1===n||e}}},i=function(n,i){u.set(n),u.get().fold(function(){return He.pure({response:xe.Change,update:r(i,c.hasFocus())})},function(n){return e.lookup({conversationUid:n}).foldResult(function(n){return Fe.value({response:xe.Change,update:r(i,c.hasFocus())})},function(e){var n,t,r,o=u.get().forall(function(n){return n!==e.conversation.uid});return Fe.value(o?{response:xe.NoChange}:{response:xe.Change,update:(n=i,t=c.hasFocus(),r=e.conversation,{view:{type:"comments",conversation:r},grabFocus:function(){return t||L([1,3,4],n)}})})})}).get(function(n){return n.fold(function(n){t("An error occurred reading the conversation. See the Console for details.",n)},function(n){n.response===xe.Change&&c.update(n.update)})})},a=function(n){var e="."+ot(),t=w.fromDom(n.getBody()),r=rt(t,e);U(r,function(n){Ze(n,ot())})};return{refreshSidebar:i,refreshView:function(n){n.fold(function(){a(o),i(ln.none(),0)},function(n){var e,t=n.uid,r=n.nodes;e=r,a(o),U(e,function(n){Qe(n,ot())}),i(ln.some(t),0)})},setReadonly:function(n){c.setReadonly(n)},showError:t}}(Oe=xe||(xe={}))[Oe.Change=0]="Change",Oe[Oe.NoChange=1]="NoChange";var ct,at,st=function(u){if(!k(u))throw new Error("cases must be an array");if(0===u.length)throw new Error("there must be at least one case");var c=[],t={};return U(u,function(n,r){var e=on(n);if(1!==e.length)throw new Error("one and only one name per case");var o=e[0],i=n[o];if(void 0!==t[o])throw new Error("duplicate key detected:"+o);if("cata"===o)throw new Error("cannot have a case named cata (sorry)");if(!k(i))throw new Error("case arguments must be an array");c.push(o),t[o]=function(){var n=arguments.length;if(n!==i.length)throw new Error("Wrong number of arguments to case "+o+". Expected "+i.length+" ("+i+"), got "+n);for(var t=new Array(n),e=0;e<t.length;e++)t[e]=arguments[e];return{fold:function(){if(arguments.length!==u.length)throw new Error("Wrong number of arguments to fold. Expected "+u.length+", got "+arguments.length);return arguments[r].apply(null,t)},match:function(n){var e=on(n);if(c.length!==e.length)throw new Error("Wrong number of arguments to match. Expected: "+c.join(",")+"\nActual: "+e.join(","));if(!Q(c,function(n){return L(e,n)}))throw new Error("Not all branches were specified when using match. Specified: "+e.join(", ")+"\nRequired: "+c.join(", "));return n[o].apply(null,t)},log:function(n){b.console.log(n,{constructors:c,constructor:o,params:t})}}}}),t},ft=Object.prototype.hasOwnProperty,lt=function(u){return function(){for(var n=new Array(arguments.length),e=0;e<n.length;e++)n[e]=arguments[e];if(0===n.length)throw new Error("Can't merge zero objects");for(var t={},r=0;r<n.length;r++){var o=n[r];for(var i in o)ft.call(o,i)&&(t[i]=u(t[i],o[i]))}return t}},dt=lt(function(n,e){return C(n)&&C(e)?dt(n,e):e}),mt=lt(function(n,e){return e});(at=ct||(ct={}))[at.Error=0]="Error",at[at.Value=1]="Value";var gt,pt=function(n,e,t){return n.stype===ct.Error?e(n.serror):t(n.svalue)},vt=function(n){return{stype:ct.Value,svalue:n}},ht=function(n){return{stype:ct.Error,serror:n}},bt=function(n){return n.fold(ht,vt)},yt=function(n){return pt(n,Fe.error,Fe.value)},_t=vt,wt=function(n){var e=[],t=[];return U(n,function(n){pt(n,function(n){return t.push(n)},function(n){return e.push(n)})}),{values:e,errors:t}},xt=ht,Ot=function(n,e){return n.stype===ct.Value?e(n.svalue):n},St=function(n,e){return n.stype===ct.Error?e(n.serror):n},Et=function(n,e){return n.stype===ct.Value?{stype:ct.Value,svalue:e(n.svalue)}:n},Ct=function(n,e){return n.stype===ct.Error?{stype:ct.Error,serror:e(n.serror)}:n},kt=st([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),Tt=function(n){return kt.defaultedThunk(sn(n))},Mt=kt.strict,Dt=kt.asOption,Nt=kt.defaultedThunk,At=(kt.asDefaultedOptionThunk,kt.mergeWithThunk),Ft=function(n,e){var t;return(t={})[n]=e,t},Rt=(st([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(n,e){return Ft(n,e)}),Bt=function(n){return e={},U(n,function(n){e[n.key]=n.value}),e;var e},It=function(n,e){var t,r,o,i,u,c=(t=[],r=[],U(n,function(n){n.fold(function(n){t.push(n)},function(n){r.push(n)})}),{errors:t,values:r});return 0<c.errors.length?(u=c.errors,Fe.error(X(u))):(i=e,0===(o=c.values).length?Fe.value(i):Fe.value(dt(i,mt.apply(void 0,o))))},Ht=function(n){return d(xt,X)(n)},Pt=function(n,e){var t,r,o=wt(n);return 0<o.errors.length?Ht(o.errors):(t=o.values,r=e,0<t.length?_t(dt(r,mt.apply(void 0,t))):_t(r))},jt=function(n){var e=wt(n);return 0<e.errors.length?Ht(e.errors):_t(e.values)},Lt=function(n){return C(n)&&100<on(n).length?" removed due to size":JSON.stringify(n,null,2)},Vt=function(n,e){return xt([{path:n,getErrorInfo:e}])},Wt=st([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),Ut=function(t,r,o){return gn(r,o).fold(function(){return n=o,e=r,Vt(t,function(){return'Could not find valid *strict* value for "'+n+'" in '+Lt(e)});var n,e},_t)},zt=function(n,e,t){var r=gn(n,e).fold(function(){return t(n)},fn);return _t(r)},qt=function(c,a,n,s){return n.fold(function(o,t,n,r){var i=function(n){var e=r.extract(c.concat([o]),s,n);return Et(e,function(n){return Ft(t,s(n))})},u=function(n){return n.fold(function(){var n=Ft(t,s(ln.none()));return _t(n)},function(n){var e=r.extract(c.concat([o]),s,n);return Et(e,function(n){return Ft(t,s(ln.some(n)))})})};return n.fold(function(){return Ot(Ut(c,a,o),i)},function(n){return Ot(zt(a,o,n),i)},function(){return Ot(_t(gn(a,o)),u)},function(n){return Ot((t=n,r=gn(e=a,o).map(function(n){return!0===n?t(e):n}),_t(r)),u);var e,t,r},function(n){var e=n(a),t=Et(zt(a,o,sn({})),function(n){return dt(e,n)});return Ot(t,i)})},function(n,e){var t=e(a);return _t(Ft(n,s(t)))})},Gt=function(r){return{extract:function(t,n,e){return St(r(e,n),function(n){return e=n,Vt(t,function(){return e});var e})},toString:function(){return"val"}}},Yt=function(n){var a=Kt(n),s=q(n,function(e,n){return n.fold(function(n){return dt(e,Rt(n,!0))},sn(e))},{});return{extract:function(n,e,t){var r,o,i,u=T(t)?[]:(o=on(r=t),z(o,function(n){return vn(r,n)})),c=z(u,function(n){return!vn(s,n)});return 0===c.length?a.extract(n,e,t):(i=c,Vt(n,function(){return"There are unsupported fields: ["+i.join(", ")+"] specified"}))},toString:a.toString}},Kt=function(c){return{extract:function(n,e,t){return r=n,o=t,i=e,u=W(c,function(n){return qt(r,o,n,i)}),Pt(u,{});var r,o,i,u},toString:function(){return"obj{\n"+W(c,function(n){return n.fold(function(n,e,t,r){return n+" -> "+r.toString()},function(n,e){return"state("+n+")"})}).join("\n")+"}"}}},Xt=function(t,i){var u=function(n,e){return(o=Gt(t),{extract:function(t,r,n){var e=W(n,function(n,e){return o.extract(t.concat(["["+e+"]"]),r,n)});return jt(e)},toString:function(){return"array("+o.toString()+")"}}).extract(n,fn,e);var o};return{extract:function(t,r,o){var n=on(o),e=u(t,n);return Ot(e,function(n){var e=W(n,function(n){return Wt.field(n,n,Mt(),i)});return Kt(e).extract(t,r,o)})},toString:function(){return"setOf("+i.toString()+")"}}},Jt=sn(Gt(_t)),Qt=Wt.state,$t=Wt.field,Zt=function(t,e,r,o,i){return gn(o,i).fold(function(){return n=o,e=i,Vt(t,function(){return'The chosen schema: "'+e+'" did not exist in branches: '+Lt(n)});var n,e},function(n){return n.extract(t.concat(["branch: "+i]),e,r)})},nr=function(o,i){return{extract:function(e,t,r){return gn(r,o).fold(function(){return n=o,Vt(e,function(){return'Choice schema did not contain choice key: "'+n+'"'});var n},function(n){return Zt(e,t,r,i,n)})},toString:function(){return"chooseOn("+o+"). Possible values: "+on(i)}}},er=Gt(_t),tr=function(e){return Gt(function(n){return e(n).fold(xt,_t)})},rr=function(e,n){return Xt(function(n){return bt(e(n))},n)},or=function(n,e,t){return yt((r=n,o=fn,i=t,u=e.extract([r],o,i),Ct(u,function(n){return{input:i,errors:n}})));var r,o,i,u},ir=function(n){return n.fold(function(n){throw new Error(cr(n))},fn)},ur=function(n,e,t){return ir(or(n,e,t))},cr=function(n){return"Errors: \n"+(e=n.errors,t=10<e.length?e.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):e,W(t,function(n){return"Failed path: ("+n.path.join(" > ")+")\n"+n.getErrorInfo()})).join("\n")+"\n\nInput object: "+Lt(n.input);var e,t},ar=function(n,e){return nr(n,an(e,Kt))},sr=sn(er),fr=function(t,r){return Gt(function(n){var e=typeof n;return t(n)?_t(n):xt("Expected type: "+r+" but got: "+e)})},lr=fr(T,"boolean"),dr=fr(M,"function"),mr=function(n){return $t(n,n,Mt(),Jt())},gr=function(n,e){return $t(n,n,Mt(),e)},pr=function(n){return gr(n,dr)},vr=function(n,e){return $t(n,n,Mt(),Kt(e))},hr=function(n){return $t(n,n,Dt(),Jt())},br=function(n,e){return $t(n,n,Dt(),e)},yr=function(n,e){return br(n,Kt(e))},_r=function(n,e){return br(n,Yt(e))},wr=function(n,e){return $t(n,n,Tt(e),Jt())},xr=function(n,e,t){return $t(n,n,Tt(e),t)},Or=function(n,e){return Qt(n,e)},Sr={init:function(){return Er({readState:function(){return"No State required"}})}},Er=function(n){return n},Cr=function(n,e,t){return e(n).orThunk(function(){return t(n)?ln.none():function(n,e,t){for(var r=n.dom(),o=M(t)?t:sn(!1);r.parentNode;){r=r.parentNode;var i=w.fromDom(r),u=e(i);if(u.isSome())return u;if(o(i))break}return ln.none()}(n,e,t)})},kr=function(n,e){return ce(n.element(),e.event().target())},Tr=function(n){if(!vn(n,"can")&&!vn(n,"abort")&&!vn(n,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(n,null,2)+" does not have can, abort, or run!");return ur("Extracting event.handler",Yt([wr("can",sn(!0)),wr("abort",sn(!1)),wr("run",_)]),n)},Mr=function(t){var e,r,o,i,n=(e=t,r=function(n){return n.can},function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return G(e,function(n,e){return n&&r(e).apply(void 0,t)},!0)}),u=(o=t,i=function(n){return n.abort},function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return G(o,function(n,e){return n||i(e).apply(void 0,t)},!1)});return Tr({can:n,abort:u,run:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];U(t,function(n){n.run.apply(void 0,e)})}})},Dr=sn("touchstart"),Nr=sn("touchmove"),Ar=sn("touchend"),Fr=sn("mousedown"),Rr=sn("mouseover"),Br=sn("keydown"),Ir=sn("keyup"),Hr=sn("input"),Pr=sn("click"),jr=sn("transitionend"),Lr={tap:sn("alloy.tap")},Vr=sn("alloy.focus"),Wr=sn("alloy.blur.post"),Ur=sn("alloy.paste.post"),zr=sn("alloy.receive"),qr=sn("alloy.execute"),Gr=sn("alloy.focus.item"),Yr=Lr.tap,Kr=sn("alloy.longpress"),Xr=sn("alloy.sandbox.close"),Jr=sn("alloy.system.init"),Qr=sn("alloy.system.attached"),$r=sn("alloy.system.detached"),Zr=sn("alloy.system.dismissRequested"),no=sn("alloy.system.repositionRequested"),eo=sn("alloy.focusmanager.shifted"),to=sn("alloy.highlight"),ro=sn("alloy.dehighlight"),oo=function(n,e){ao(n,n.element(),e,{})},io=function(n,e,t){ao(n,n.element(),e,t)},uo=function(n){oo(n,qr())},co=function(n,e,t){ao(n,e,t,{})},ao=function(n,e,t,r){var o=xn({target:e},r);n.getSystem().triggerEvent(t,e,an(o,sn))},so=function(n){return Bt(n)},fo=function(n,e){return{key:n,value:Tr({run:e})}},lo=function(n){return function(t){return{key:n,value:Tr({run:function(n,e){kr(n,e)&&t(n,e)}})}}},mo=function(n){return fo(n,function(n,e){e.cut()})},go=lo(Qr()),po=lo($r()),vo=lo(Jr()),ho=(gt=qr(),function(n){return fo(gt,n)}),bo=function(n){return W(n,function(n){return r=e="/*",o=(t=n).length-e.length,""!==r&&(t.length<r.length||t.substr(o,o+r.length)!==r)?n:n.substring(0,n.length-"/*".length);var e,t,r,o})},yo=function(n,e){var t=n.toString(),r=t.indexOf(")")+1,o=t.indexOf("("),i=t.substring(o+1,r-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:e,parameters:bo(i)}},n},_o=function(n){return{classes:void 0!==n.classes?n.classes:[],attributes:void 0!==n.attributes?n.attributes:{},styles:void 0!==n.styles?n.styles:{}}},wo=function(t,r,o){return vo(function(n,e){o(n,t,r)})},xo=function(o,i,u){var n,e,t,r,c,a;return n=function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];var r=[t].concat(n);return t.config({name:sn(o)}).fold(function(){throw new Error("We could not find any behaviour configuration for: "+o+". Using API: "+u)},function(n){var e=Array.prototype.slice.call(r,1);return i.apply(void 0,[t,n.config,n.state].concat(e))})},e=u,t=i.toString(),r=t.indexOf(")")+1,c=t.indexOf("("),a=t.substring(c+1,r-1).split(/,\s*/),n.toFunctionAnnotation=function(){return{name:e,parameters:bo(a.slice(0,1).concat(a.slice(3)))}},n},Oo=function(n){return{key:n,value:void 0}},So=function(t,n,r,o,e,i,u){var c=function(n){return vn(n,r)?n[r]():ln.none()},a=an(e,function(n,e){return xo(r,n,e)}),s=an(i,function(n,e){return yo(n,e)}),f=xn(xn(xn({},s),a),{revoke:g(Oo,r),config:function(n){var e=ur(r+"-config",t,n);return{key:r,value:{config:e,me:f,configAsRaw:et(function(){return ur(r+"-config",t,n)}),initialConfig:n,state:u}}},schema:function(){return n},exhibit:function(n,t){return c(n).bind(function(e){return gn(o,"exhibit").map(function(n){return n(t,e.config,e.state)})}).getOr(_o({}))},name:function(){return r},handlers:function(n){return c(n).map(function(n){return gn(o,"events").getOr(function(){return{}})(n.config,n.state)}).getOr({})}});return f},Eo=function(n){return Bt(n)},Co=Yt([mr("fields"),mr("name"),wr("active",{}),wr("apis",{}),wr("state",Sr),wr("extra",{})]),ko=function(n){var e,t,r,o,i,u,c,a,s=ur("Creating behaviour: "+n.name,Co,n);return e=s.fields,t=s.name,r=s.active,o=s.apis,i=s.extra,u=s.state,c=Yt(e),a=yr(t,[_r("config",e)]),So(c,a,t,r,o,i,u)},To=Yt([mr("branchKey"),mr("branches"),mr("name"),wr("active",{}),wr("apis",{}),wr("state",Sr),wr("extra",{})]),Mo=sn(void 0),Do=function(n,e){var t,r;return{key:n,value:{config:{},me:(t=n,r=so(e),ko({fields:[mr("enabled")],name:t,active:{events:sn(r)}})),configAsRaw:sn({}),initialConfig:{},state:Sr}}};function No(n,e,t,r,o){return n(t,r)?ln.some(t):M(o)&&o(t)?ln.none():e(t,r,o)}var Ao,Fo,Ro=function(n,e,t){for(var r=n.dom(),o=M(t)?t:sn(!1);r.parentNode;){r=r.parentNode;var i=w.fromDom(r);if(e(i))return ln.some(i);if(o(i))break}return ln.none()},Bo=function(n,e,t){return No(function(n,e){return e(n)},Ro,n,e,t)},Io=function(n,e,t){return Bo(n,e,t).isSome()},Ho=function(n){n.dom().focus()},Po=function(n){var e=void 0!==n?n.dom():b.document;return ln.from(e.activeElement).map(w.fromDom)},jo=function(e){return Po(ae(e)).filter(function(n){return e.dom().contains(n.dom())})},Lo=function(e,n){U(n,function(n){ve(e,n)})},Vo=function(n){n.dom().textContent="",U(le(n),function(n){Wo(n)})},Wo=function(n){var e=n.dom();null!==e.parentNode&&e.parentNode.removeChild(e)},Uo=function(n){return n.dom().innerHTML},zo=function(n,e){var t,r,o=ae(n).dom(),i=w.fromDom(o.createDocumentFragment()),u=(t=e,(r=(o||b.document).createElement("div")).innerHTML=t,le(w.fromDom(r)));Lo(i,u),Vo(n),ve(n,i)},qo=function(n){return e=n,t=!1,w.fromDom(e.dom().cloneNode(t));var e,t},Go=function(n){var e,t,r,o=qo(n);return e=o,t=w.fromTag("div"),r=w.fromDom(e.dom().cloneNode(!0)),ve(t,r),Uo(t)},Yo=function(n){return Go(n)},Ko="unknown";(Fo=Ao||(Ao={}))[Fo.STOP=0]="STOP",Fo[Fo.NORMAL=1]="NORMAL",Fo[Fo.LOGGING=2]="LOGGING";var Xo=kn({}),Jo=function(e,n,t){var r,o,i,u;switch(gn(Xo.get(),e).orThunk(function(){var n=on(Xo.get());return tn(n,function(n){return-1<e.indexOf(n)?ln.some(Xo.get()[n]):ln.none()})}).getOr(Ao.NORMAL)){case Ao.NORMAL:return t(Zo());case Ao.LOGGING:var c=(r=e,o=n,i=[],u=(new Date).getTime(),{logEventCut:function(n,e,t){i.push({outcome:"cut",target:e,purpose:t})},logEventStopped:function(n,e,t){i.push({outcome:"stopped",target:e,purpose:t})},logNoParent:function(n,e,t){i.push({outcome:"no-parent",target:e,purpose:t})},logEventNoHandlers:function(n,e){i.push({outcome:"no-handlers-left",target:e})},logEventResponse:function(n,e,t){i.push({outcome:"response",purpose:t,target:e})},write:function(){var n=(new Date).getTime();L(["mousemove","mouseover","mouseout",Jr()],r)||b.console.log(r,{event:r,time:n-u,target:o.dom(),sequence:W(i,function(n){return L(["cut","stopped","response"],n.outcome)?"{"+n.purpose+"} "+n.outcome+" at ("+Yo(n.target)+")":n.outcome})})}}),a=t(c);return c.write(),a;case Ao.STOP:return!0}},Qo=["alloy/data/Fields","alloy/debugging/Debugging"],$o=function(n,e,t){return Jo(n,e,t)},Zo=sn({logEventCut:_,logEventStopped:_,logNoParent:_,logEventNoHandlers:_,logEventResponse:_,write:_}),ni=function(n,e){return t=g.apply(void 0,[n.handler].concat(e)),r=n.purpose(),{cHandler:t,purpose:sn(r)};var t,r},ei=function(n){return n.cHandler},ti=function(n,e,t){return Ro(n,function(n){return ie(n,e)},t)},ri=function(n,e){return t=e,o=void 0===(r=n)?b.document:r.dom(),ue(o)?ln.none():ln.from(o.querySelector(t)).map(w.fromDom);var t,r,o},oi=function(n,e,t){return No(ie,ti,n,e,t)};var ii=function(n){var e=n.raw();return void 0===e.touches||1!==e.touches.length?ln.none():ln.some(e.touches[0])},ui=function(t){var r,o,i,u=kn(ln.none()),c=kn(!1),a=(r=function(n){t.triggerEvent(Kr(),n),c.set(!0)},o=400,i=null,{cancel:function(){null!==i&&(b.clearTimeout(i),i=null)},schedule:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];i=b.setTimeout(function(){r.apply(null,n),i=null},o)}}),s=Bt([{key:Dr(),value:function(t){return ii(t).each(function(n){a.cancel();var e={x:sn(n.clientX),y:sn(n.clientY),target:t.target};a.schedule(t),c.set(!1),u.set(ln.some(e))}),ln.none()}},{key:Nr(),value:function(n){return a.cancel(),ii(n).each(function(i){u.get().each(function(n){var e,t,r,o;e=i,t=n,r=Math.abs(e.clientX-t.x()),o=Math.abs(e.clientY-t.y()),(5<r||5<o)&&u.set(ln.none())})}),ln.none()}},{key:Ar(),value:function(e){a.cancel();return u.get().filter(function(n){return ce(n.target(),e.target())}).map(function(n){return c.get()?(e.prevent(),!1):t.triggerEvent(Yr(),e)})}}]);return{fireIfReady:function(e,n){return gn(s,n).bind(function(n){return n(e)})}}},ci=function(n){var e,t;return 8===n.raw().which&&!L(["input","textarea"],Pe(n.target()))&&(e=n.target(),!oi(e,'[contenteditable="true"]',t).isSome())},ai=Zn().browser.isFirefox(),si=Yt([pr("triggerEvent"),wr("stopBackspace",!0)]),fi=function(e,n){var t,r,o,i,u=ur("Getting GUI events settings",si,n),c=ui(u),a=W(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),function(n){return x(e,n,function(e){c.fireIfReady(e,n).each(function(n){n&&e.kill()}),u.triggerEvent(n,e)&&e.kill()})}),s=kn(ln.none()),f=x(e,"paste",function(e){c.fireIfReady(e,"paste").each(function(n){n&&e.kill()}),u.triggerEvent("paste",e)&&e.kill(),s.set(ln.some(b.setTimeout(function(){u.triggerEvent(Ur(),e)},0)))}),l=x(e,"keydown",function(n){u.triggerEvent("keydown",n)?n.kill():!0===u.stopBackspace&&ci(n)&&n.prevent()}),d=(t=e,r=function(n){u.triggerEvent("focusin",n)&&n.kill()},ai?O(t,"focus",r):x(t,"focusin",r)),m=kn(ln.none()),g=(o=e,i=function(n){u.triggerEvent("focusout",n)&&n.kill(),m.set(ln.some(b.setTimeout(function(){u.triggerEvent(Wr(),n)},0)))},ai?O(o,"blur",i):x(o,"focusout",i));return{unbind:function(){U(a,function(n){n.unbind()}),l.unbind(),d.unbind(),g.unbind(),f.unbind(),s.get().each(b.clearTimeout),m.get().each(b.clearTimeout)}}},li=function(n,e){var t=gn(n,"target").map(function(n){return n()}).getOr(e);return kn(t)},di=st([{stopped:[]},{resume:["element"]},{complete:[]}]),mi=function(n,r,e,t,o,i){var u,c,a,s,f=n(r,t),l=(u=e,c=o,a=kn(!1),s=kn(!1),{stop:function(){a.set(!0)},cut:function(){s.set(!0)},isStopped:a.get,isCut:s.get,event:sn(u),setSource:c.set,getSource:c.get});return f.fold(function(){return i.logEventNoHandlers(r,t),di.complete()},function(e){var t=e.descHandler();return ei(t)(l),l.isStopped()?(i.logEventStopped(r,e.element(),t.purpose()),di.stopped()):l.isCut()?(i.logEventCut(r,e.element(),t.purpose()),di.complete()):fe(e.element()).fold(function(){return i.logNoParent(r,e.element(),t.purpose()),di.complete()},function(n){return i.logEventResponse(r,e.element(),t.purpose()),di.resume(n)})})},gi=function(e,t,r,n,o,i){return mi(e,t,r,n,o,i).fold(function(){return!0},function(n){return gi(e,t,r,n,o,i)},function(){return!1})},pi=function(n,e,t){var r,o,i=(r=e,o=kn(!1),{stop:function(){o.set(!0)},cut:_,isStopped:o.get,isCut:sn(!1),event:sn(r),setSource:u("Cannot set source of a broadcasted event"),getSource:u("Cannot get source of a broadcasted event")});return U(n,function(n){var e=n.descHandler();ei(e)(i)}),i.isStopped()},vi=function(n,e,t,r,o){var i=li(t,r);return gi(n,e,t,r,i,o)},hi=0,bi=function(n){var e=(new Date).getTime();return n+"_"+Math.floor(1e9*Math.random())+ ++hi+String(e)},yi=sn("alloy-id-"),_i=sn("data-alloy-id"),wi=yi(),xi=_i(),Oi=function(n,e){Object.defineProperty(n.dom(),xi,{value:e,writable:!0})},Si=function(n){var e=Le(n)?n.dom()[xi]:null;return ln.from(e)},Ei=function(n){return bi(n)},Ci=rn("element","descHandler"),ki=function(n,e){return{id:sn(n),descHandler:sn(e)}};function Ti(){var i={};return{registerId:function(r,o,n){cn(n,function(n,e){var t=void 0!==i[e]?i[e]:{};t[o]=ni(n,r),i[e]=t})},unregisterId:function(t){cn(i,function(n,e){n.hasOwnProperty(t)&&delete n[t]})},filterByType:function(n){return gn(i,n).map(function(n){return mn(n,function(n,e){return ki(e,n)})}).getOr([])},find:function(n,e,t){var o=gn(i,e);return Cr(t,function(n){return t=o,Si(r=n).fold(function(){return ln.none()},function(e){return t.bind(function(n){return gn(n,e)}).map(function(n){return Ci(r,n)})});var t,r},n)}}}function Mi(){var r=Ti(),o={},i=function(r){var n=r.element();return Si(n).fold(function(){return n="uid-",e=r.element(),t=bi(wi+n),Oi(e,t),t;var n,e,t},function(n){return n})},u=function(n){Si(n.element()).each(function(n){delete o[n],r.unregisterId(n)})};return{find:function(n,e,t){return r.find(n,e,t)},filter:function(n){return r.filterByType(n)},register:function(n){var e=i(n);vn(o,e)&&function(n,e){var t=o[e];if(t!==n)throw new Error('The tagId "'+e+'" is already used by: '+Yo(t.element())+"\nCannot use it for: "+Yo(n.element())+"\nThe conflicting element is"+(tt(t.element())?" ":" not ")+"already in the DOM");u(n)}(n,e);var t=[n];r.registerId(t,e,n.events()),o[e]=n},unregister:u,getById:function(n){return gn(o,n)}}}var Di,Ni,Ai=so([(Di=Vr(),Ni=function(n,e){var t,r,o=e.event().originator(),i=e.event().target();return r=i,!(ce(t=o,n.element())&&!ce(t,r))||(b.console.warn(Vr()+" did not get interpreted by the desired target. \nOriginator: "+Yo(o)+"\nTarget: "+Yo(i)+"\nCheck the "+Vr()+" event handlers"),!1)},{key:Di,value:Tr({can:Ni})})]),Fi=Object.freeze({__proto__:null,events:Ai}),Ri=fn,Bi=function(e){var n=function(n){return function(){throw new Error("The component must be in a context to send: "+n+(e?"\n"+Yo(e().element())+" is not in context.":""))}};return{debugInfo:sn("fake"),triggerEvent:n("triggerEvent"),triggerFocus:n("triggerFocus"),triggerEscape:n("triggerEscape"),build:n("build"),addToWorld:n("addToWorld"),removeFromWorld:n("removeFromWorld"),addToGui:n("addToGui"),removeFromGui:n("removeFromGui"),getByUid:n("getByUid"),getByDom:n("getByDom"),broadcast:n("broadcast"),broadcastOn:n("broadcastOn"),broadcastEvent:n("broadcastEvent"),isConnected:sn(!1)}},Ii=Bi(),Hi=bi("alloy-premade"),Pi=function(n){return Rt(Hi,n)},ji=function(r){return n=function(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return r.apply(void 0,[n.getApis()].concat([n].concat(e)))},e=r.toString(),t=e.indexOf(")")+1,o=e.indexOf("("),i=e.substring(o+1,t-1).split(/,\s*/),n.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:bo(i.slice(1))}},n;var n,e,t,o,i},Li=function(n,o){var i={};return cn(n,function(n,r){cn(n,function(n,e){var t=gn(i,e).getOr([]);i[e]=t.concat([o(r,n)])})}),i},Vi=function(u,c,n,a){try{var e=(t=n,r=function(n,e){var t=n[c](),r=e[c](),o=a.indexOf(t),i=a.indexOf(r);if(-1===o)throw new Error("The ordering for "+u+" does not have an entry for "+t+".\nOrder specified: "+JSON.stringify(a,null,2));if(-1===i)throw new Error("The ordering for "+u+" does not have an entry for "+r+".\nOrder specified: "+JSON.stringify(a,null,2));return o<i?-1:i<o?1:0},(o=H.call(t,0)).sort(r),o);return Fe.value(e)}catch(n){return Fe.error([n])}var t,r,o},Wi=function(n,e){return{name:sn(n),handler:sn(e)}},Ui=function(n,e,t){var r,o,i=xn(xn({},t),(r=n,o={},U(e,function(n){o[n.name()]=n.handlers(r)}),o));return Li(i,Wi)},zi=function(n){var e,i=M(e=n)?{can:sn(!0),abort:sn(!1),run:e}:e;return function(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];var o=[n,e].concat(t);i.abort.apply(void 0,o)?e.stop():i.can.apply(void 0,o)&&i.run.apply(void 0,o)}},qi=function(n,e,t){var r,o,i=e[t];return i?Vi("Event: "+t,"name",n,i).map(function(n){var e=W(n,function(n){return n.handler()});return Mr(e)}):(r=t,o=n,Fe.error(["The event ("+r+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(W(o,function(n){return n.name()}),null,2)]))},Gi=function(n,i){var e=mn(n,function(r,o){return(1===r.length?Fe.value(r[0].handler()):qi(r,i,o)).map(function(n){var e=zi(n),t=1<r.length?z(i[o],function(e){return V(r,function(n){return n.name()===e})}).join(" > "):r[0].name();return Rt(o,{handler:e,purpose:sn(t)})})});return It(e,{})},Yi=function(n){return or("custom.definition",Kt([$t("dom","dom",Mt(),Kt([mr("tag"),wr("styles",{}),wr("classes",[]),wr("attributes",{}),hr("value"),hr("innerHtml")])),mr("components"),mr("uid"),wr("events",{}),wr("apis",{}),$t("eventOrder","eventOrder",(e={"alloy.execute":["disabling","alloy.base.behaviour","toggling","typeaheadevents"],"alloy.focus":["alloy.base.behaviour","focusing","keying"],"alloy.system.init":["alloy.base.behaviour","disabling","toggling","representing"],input:["alloy.base.behaviour","representing","streaming","invalidating"],"alloy.system.detached":["alloy.base.behaviour","representing","item-events","tooltipping"],mousedown:["focusing","alloy.base.behaviour","item-type-events"],touchstart:["focusing","alloy.base.behaviour","item-type-events"],mouseover:["item-type-events","tooltipping"]},kt.mergeWithThunk(sn(e))),sr()),hr("domModification")]),n);var e},Ki=function(e,n){U(n,function(n){Qe(e,n)})},Xi=function(e,n){U(n,function(n){Ze(e,n)})},Ji=function(n){return void 0!==n.style&&M(n.style.getPropertyValue)},Qi=function(n,e,t){if(!E(t))throw b.console.error("Invalid call to CSS.set. Property ",e,":: Value ",t,":: Element ",n),new Error("CSS value must be a string: "+t);Ji(n)&&n.style.setProperty(e,t)},$i=function(n,e){Ji(n)&&n.style.removeProperty(e)},Zi=function(n,e,t){var r=n.dom();Qi(r,e,t)},nu=function(n,e){var t=n.dom();cn(e,function(n,e){Qi(t,e,n)})},eu=function(n,e){var t=n.dom(),r=b.window.getComputedStyle(t).getPropertyValue(e),o=""!==r||tt(n)?r:tu(t,e);return null===o?void 0:o},tu=function(n,e){return Ji(n)?n.style.getPropertyValue(e):""},ru=function(n,e){var t=n.dom(),r=tu(t,e);return ln.from(r).filter(function(n){return 0<n.length})},ou=function(n,e){var t=n.dom();$i(t,e),qe(n,"style")&&""===ze(n,"style").replace(/^\s+|\s+$/g,"")&&Ge(n,"style")},iu=function(n){return n.dom().value},uu=function(n,e){if(void 0===e)throw new Error("Value.set was undefined");n.dom().value=e},cu=function(n){var e,t,r,o=w.fromTag(n.tag);e=o,t=n.attributes,r=e.dom(),cn(t,function(n,e){We(r,e,n)}),Ki(o,n.classes),nu(o,n.styles),n.innerHtml.each(function(n){return zo(o,n)});var i=n.domChildren;return Lo(o,i),n.value.each(function(n){uu(o,n)}),n.uid,Oi(o,n.uid),o},au=function(n,e){return t=n,o=W(r=e,function(n){return yr(n.name(),[mr("config"),wr("state",Sr)])}),i=or("component.behaviours",Kt(o),t.behaviours).fold(function(n){throw new Error(cr(n)+"\nComplete spec:\n"+JSON.stringify(t,null,2))},function(n){return n}),{list:r,data:an(i,function(n){var e=n.map(function(n){return{config:n.config,state:n.state.init(n.config)}});return function(){return e}})};var t,r,o,i},su=function(n){var e,t,r=(e=gn(n,"behaviours").getOr({}),t=z(on(e),function(n){return void 0!==e[n]}),W(t,function(n){return e[n].me}));return au(n,r)},fu=function(n,e,t){var r,o,i,u=xn(xn({},(r=n).dom),{uid:r.uid,domChildren:W(r.components,function(n){return n.element()})}),c=n.domModification.fold(function(){return _o({})},_o),a={"alloy.base.modification":c},s=0<e.length?function(e,n,t,r){var o=xn({},n);U(t,function(n){o[n.name()]=n.exhibit(e,r)});var i=Li(o,function(n,e){return{name:n,modification:e}}),u=function(n){return q(n,function(n,e){return xn(xn({},e.modification),n)},{})},c=q(i.classes,function(n,e){return e.modification.concat(n)},[]),a=u(i.attributes),s=u(i.styles);return _o({classes:c,attributes:a,styles:s})}(t,a,e,u):c;return i=s,xn(xn({},o=u),{attributes:xn(xn({},o.attributes),i.attributes),styles:xn(xn({},o.styles),i.styles),classes:o.classes.concat(i.classes)})},lu=function(n,e,t){var r,o,i,u,c,a,s={"alloy.base.behaviour":(r=n,r.events)};return(o=t,i=n.eventOrder,u=e,c=s,a=Ui(o,u,c),Gi(a,i)).getOrDie()},du=function(n){var e,t,r,o,i,u,c,a,s,f,l,d,m,g=Ri(n),p=g.events,v=On(g,["events"]),h=(e=gn(v,"components").getOr([]),W(e,pu)),b=xn(xn({},v),{events:xn(xn({},Fi),p),components:h});return Fe.value((t=b,r=function(){return m},o=kn(Ii),i=ir(Yi(t)),u=su(t),c=u.list,a=u.data,s=fu(i,c,a),f=cu(s),l=lu(i,c,a),d=kn(i.components),m={getSystem:o.get,config:function(n){var e=a;return(M(e[n.name()])?e[n.name()]:function(){throw new Error("Could not find "+n.name()+" in "+JSON.stringify(t,null,2))})()},hasConfigured:function(n){return M(a[n.name()])},spec:sn(t),readState:function(n){return a[n]().map(function(n){return n.state.readState()}).getOr("not enabled")},getApis:function(){return i.apis},connect:function(n){o.set(n)},disconnect:function(){o.set(Bi(r))},element:sn(f),syncComponents:function(){var n=le(f),e=J(n,function(n){return o.get().getByDom(n).fold(function(){return[]},function(n){return[n]})});d.set(e)},components:d.get,events:sn(l)}))},mu=function(n){var e=ur("external.component",Yt([mr("element"),hr("uid")]),n),t=kn(Bi());e.uid.each(function(n){Oi(e.element,n)});var r={getSystem:t.get,config:ln.none,hasConfigured:sn(!1),connect:function(n){t.set(n)},disconnect:function(){t.set(Bi(function(){return r}))},getApis:function(){return{}},element:sn(e.element),spec:sn(n),readState:sn("No state"),syncComponents:_,components:sn([]),events:sn({})};return Pi(r)},gu=Ei,pu=function(e){return(n=e,gn(n,Hi)).fold(function(){var n=e.hasOwnProperty("uid")?e:xn({uid:gu("")},e);return du(n).getOrDie()},function(n){return n});var n},vu=Pi,hu=function(r,n){return e=r,t={},o=W(n,function(n){return e=n.name(),t="Cannot configure "+n.name()+" for "+r,$t(e,e,Dt(),Gt(function(n){return xt("The field: "+e+" is forbidden. "+t)}));var e,t}).concat([Or("dump",fn)]),xr(e,t,Kt(o));var e,t,o},bu=function(n){return n.dump},yu=function(n,e){return xn(xn({},n.dump),Eo(e))},_u=hu,wu=yu,xu=sn([mr("menu"),mr("selectedMenu")]),Ou=sn([mr("item"),mr("selectedItem")]),Su=(sn(Kt(Ou().concat(xu()))),sn(Kt(Ou()))),Eu=vr("initSize",[mr("numColumns"),mr("numRows")]),Cu=function(){return vr("markers",[mr("backgroundMenu")].concat(xu()).concat(Ou()))},ku=function(n,e,t){!function(){var n=new Error;if(void 0===n.stack)return;var e=n.stack.split("\n");Y(e,function(e){return 0<e.indexOf("alloy")&&!V(Qo,function(n){return-1<e.indexOf(n)})}).getOr(Ko)}();return $t(e,e,t,tr(function(t){return Fe.value(function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t.apply(void 0,n)})}))},Tu=function(n){return ku(0,n,Tt(_))},Mu=function(n){return ku(0,n,Tt(ln.none))},Du=function(n){return ku(0,n,Mt())},Nu=function(n){return ku(0,n,Mt())},Au=function(n,e){return Or(n,sn(e))},Fu=function(n){return Or(n,fn)},Ru=sn(Eu),Bu="placeholder",Iu=st([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),Hu=function(n){return pn(n,"uiType")},Pu=function(n,e,t,r){return Hu(t)&&t.uiType===Bu?(i=t,u=r,(o=n).exists(function(n){return n!==i.owner})?Iu.single(!0,sn(i)):gn(u,i.name).fold(function(){throw new Error("Unknown placeholder component: "+i.name+"\nKnown: ["+on(u)+"]\nNamespace: "+o.getOr("none")+"\nSpec: "+JSON.stringify(i,null,2))},function(n){return n.replace()})):Iu.single(!1,sn(t));var o,i,u},ju=function(i,u,c,a){return Pu(i,0,c,a).fold(function(n,e){var t=Hu(c)?e(u,c.config,c.validated):e(u),r=gn(t,"components").getOr([]),o=J(r,function(n){return ju(i,u,n,a)});return[xn(xn({},t),{components:o})]},function(n,e){if(Hu(c)){var t=e(u,c.config,c.validated);return c.validated.preprocess.getOr(fn)(t)}return e(u)})},Lu=function(e,t,n,r){var o,i,u,c=an(r,function(n,e){return r=n,o=!1,{name:sn(t=e),required:function(){return r.fold(function(n,e){return n},function(n,e){return n})},used:function(){return o},replace:function(){if(o)throw new Error("Trying to use the same placeholder more than once: "+t);return o=!0,r}};var t,r,o}),a=(o=e,i=t,u=c,J(n,function(n){return ju(o,i,n,u)}));return cn(c,function(n){if(!1===n.used()&&n.required())throw new Error("Placeholder: "+n.name()+" was not found in components list\nNamespace: "+e.getOr("none")+"\nComponents: "+JSON.stringify(t.components,null,2))}),a},Vu=Iu.single,Wu=Iu.multiple,Uu=sn(Bu),zu=st([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),qu=wr("factory",{sketch:fn}),Gu=wr("schema",[]),Yu=mr("name"),Ku=$t("pname","pname",Nt(function(n){return"<alloy."+bi(n.name)+">"}),sr()),Xu=Or("schema",function(){return[hr("preprocess")]}),Ju=wr("defaults",sn({})),Qu=wr("overrides",sn({})),$u=Kt([qu,Gu,Yu,Ku,Ju,Qu]),Zu=Kt([qu,Gu,Yu,Ju,Qu]),nc=Kt([qu,Gu,Yu,Ku,Ju,Qu]),ec=Kt([qu,Xu,Yu,mr("unit"),Ku,Ju,Qu]),tc=function(n){var e=function(n){return n.name};return n.fold(e,e,e,e)},rc=function(t,r){return function(n){var e=ur("Converting part type",r,n);return t(e)}},oc=rc(zu.required,$u),ic=rc(zu.external,Zu),uc=rc(zu.optional,nc),cc=rc(zu.group,ec),ac=sn("entirety"),sc=function(n,e,t,r){return dt(e.defaults(n,t,r),t,{uid:n.partUids[e.name]},e.overrides(n,t,r))},fc=function(o,n){var i={};return U(n,function(n){var e;(e=n,e.fold(ln.some,ln.none,ln.some,ln.some)).each(function(t){var r=lc(o,t.pname);i[t.name]=function(n){var e=ur("Part: "+t.name+" in "+o,Kt(t.schema),n);return xn(xn({},r),{config:n,validated:e})}})}),i},lc=function(n,e){return{uiType:Uu(),owner:n,name:e}},dc=function(n,e,t){return r=e,i={},o={},U(t,function(n){n.fold(function(r){i[r.pname]=Vu(!0,function(n,e,t){return r.factory.sketch(sc(n,r,e,t))})},function(n){var e=r.parts[n.name];o[n.name]=sn(n.factory.sketch(sc(r,n,e[ac()]),e))},function(r){i[r.pname]=Vu(!1,function(n,e,t){return r.factory.sketch(sc(n,r,e,t))})},function(o){i[o.pname]=Wu(!0,function(e,n,t){var r=e[o.name];return W(r,function(n){return o.factory.sketch(dt(o.defaults(e,n,t),n,o.overrides(e,n)))})})})}),{internals:sn(i),externals:sn(o)};var r,i,o},mc=function(n,e,t){return Lu(ln.some(n),e,e.components,t)},gc=function(e,n){var t=W(n,tc);return Bt(W(t,function(n){return{key:n,value:e+"-"+n}}))},pc=function(e){return $t("partUids","partUids",At(function(n){return gc(n.uid,e)}),sr())},vc=function(n,e,t,r,o){var i,u,c=(u=o,(0<(i=r).length?[vr("parts",i)]:[]).concat([mr("uid"),wr("dom",{}),wr("components",[]),Fu("originalSpec"),wr("debug.sketcher",{})]).concat(u));return ur(n+" [SpecSchema]",Yt(c.concat(e)),t)},hc=function(n,e,t,r,o){var i=bc(o),u=J(t,function(n){return n.fold(ln.none,ln.some,ln.none,ln.none).map(function(n){return vr(n.name,n.schema.concat([Fu(ac())]))}).toArray()}),c=pc(t),a=vc(n,e,i,u,[c]),s=dc(0,a,t);return r(a,mc(n,a,s.internals()),i,s.externals())},bc=function(n){return pn(n,"uid")?n:xn(xn({},n),{uid:Ei("uid")})};var yc=Yt([mr("name"),mr("factory"),mr("configFields"),wr("apis",{}),wr("extraApis",{})]),_c=Yt([mr("name"),mr("factory"),mr("configFields"),mr("partFields"),wr("apis",{}),wr("extraApis",{})]),wc=function(n){var i=ur("Sketcher for "+n.name,yc,n),e=an(i.apis,ji),t=an(i.extraApis,function(n,e){return yo(n,e)});return xn(xn({name:sn(i.name),configFields:sn(i.configFields),sketch:function(n){return e=i.name,t=i.configFields,r=i.factory,o=bc(n),r(vc(e,t,o,[],[]),o);var e,t,r,o}},e),t)},xc=function(n){var e=ur("Sketcher for "+n.name,_c,n),t=fc(e.name,e.partFields),r=an(e.apis,ji),o=an(e.extraApis,function(n,e){return yo(n,e)});return xn(xn({name:sn(e.name),partFields:sn(e.partFields),configFields:sn(e.configFields),sketch:function(n){return hc(e.name,e.configFields,e.partFields,e.factory,n)},parts:sn(t)},r),o)},Oc=(wc({name:"Container",factory:function(n){var e=n.dom,t=e.attributes,r=On(e,["attributes"]);return{uid:n.uid,dom:xn({tag:"div",attributes:xn({role:"presentation"},t)},r),components:n.components,behaviours:bu(n.containerBehaviours),events:n.events,domModification:n.domModification,eventOrder:n.eventOrder}},configFields:[wr("components",[]),hu("containerBehaviours",[]),wr("events",{}),wr("domModification",{}),wr("eventOrder",{})]}),function(n){oo(n,$r());var e=n.components();U(e,Oc)}),Sc=function(n){var e=n.components();U(e,Sc),oo(n,Qr())},Ec=function(n,e){ve(n.element(),e.element())},Cc=function(e,n){var t,r=e.components();U((t=e).components(),function(n){return Wo(n.element())}),Vo(t.element()),t.syncComponents();var o=Z(r,n);U(o,function(n){Oc(n),e.getSystem().removeFromWorld(n)}),U(n,function(n){n.getSystem().isConnected()?Ec(e,n):(e.getSystem().addToWorld(n),Ec(e,n),tt(e.element())&&Sc(n)),e.syncComponents()})},kc=function(n,e){Tc(n,e,ve)},Tc=function(n,e,t){n.getSystem().addToWorld(e),t(n.element(),e.element()),tt(n.element())&&Sc(e),n.syncComponents()},Mc=function(n){Oc(n),Wo(n.element()),n.getSystem().removeFromWorld(n)},Dc=function(e){var n=fe(e.element()).bind(function(n){return e.getSystem().getByDom(n).toOption()});Mc(e),n.each(function(n){n.syncComponents()})},Nc=function(n){var e=n.components();U(e,Mc),Vo(n.element()),n.syncComponents()},Ac=function(t){var r=function(e){return fe(t.element()).fold(function(){return!0},function(n){return ce(e,n)})},o=Mi(),s=function(n,e){return o.find(r,n,e)},n=fi(t.element(),{triggerEvent:function(u,c){return $o(u,c.target(),function(n){return e=s,t=u,o=n,i=(r=c).target(),vi(e,t,r,i,o);var e,t,r,o,i})}}),i={debugInfo:sn("real"),triggerEvent:function(e,t,r){$o(e,t,function(n){return vi(s,e,r,t,n)})},triggerFocus:function(c,a){Si(c).fold(function(){Ho(c)},function(n){$o(Vr(),c,function(n){var e,t,r,o,i,u;return e=s,t=Vr(),r={originator:sn(a),kill:_,prevent:_,target:sn(c)},i=n,u=li(r,o=c),mi(e,t,r,o,u,i),!1})})},triggerEscape:function(n,e){i.triggerEvent("keydown",n.element(),e.event())},getByUid:function(n){return g(n)},getByDom:function(n){return p(n)},build:pu,addToGui:function(n){c(n)},removeFromGui:function(n){a(n)},addToWorld:function(n){e(n)},removeFromWorld:function(n){u(n)},broadcast:function(n){l(n)},broadcastOn:function(n,e){d(n,e)},broadcastEvent:function(n,e){m(n,e)},isConnected:sn(!0)},e=function(n){n.connect(i),Ve(n.element())||(o.register(n),U(n.components(),e),i.triggerEvent(Jr(),n.element(),{target:sn(n.element())}))},u=function(n){Ve(n.element())||(U(n.components(),u),o.unregister(n)),n.disconnect()},c=function(n){kc(t,n)},a=function(n){Dc(n)},f=function(t){var n=o.filter(zr());U(n,function(n){var e=n.descHandler();ei(e)(t)})},l=function(n){f({universal:sn(!0),data:sn(n)})},d=function(n,e){f({universal:sn(!1),channels:sn(n),data:sn(e)})},m=function(n,e){var t=o.filter(n);return pi(t,e)},g=function(n){return o.getById(n).fold(function(){return Fe.error(new Error('Could not find component with uid: "'+n+'" in system.'))},Fe.value)},p=function(n){var e=Si(n).getOr("not found");return g(e)};return e(t),{root:sn(t),element:t.element,destroy:function(){n.unbind(),Wo(t.element())},add:c,remove:a,getByUid:g,getByDom:p,addToWorld:e,removeFromWorld:u,broadcast:l,broadcastOn:d,broadcastEvent:m}},Fc=function(n){var e=void 0!==n.uid&&vn(n,"uid")?n.uid:Ei("memento");return{get:function(n){return n.getSystem().getByUid(e).getOrDie()},getOpt:function(n){return n.getSystem().getByUid(e).toOption()},asSpec:function(){return xn(xn({},n),{uid:e})}}},Rc=Object.freeze({__proto__:null,exhibit:function(n,e){return _o({classes:[],styles:e.useFixed()?{}:{position:"relative"}})}}),Bc=function(t,r){return{left:sn(t),top:sn(r),translate:function(n,e){return Bc(t+n,r+e)}}},Ic=Bc,Hc=function(n,e){return void 0!==n?n:void 0!==e?e:0},Pc=function(n){var e=n.dom().ownerDocument,t=e.body,r=e.defaultView,o=e.documentElement;if(t===n.dom())return Ic(t.offsetLeft,t.offsetTop);var i=Hc(r.pageYOffset,o.scrollTop),u=Hc(r.pageXOffset,o.scrollLeft),c=Hc(o.clientTop,t.clientTop),a=Hc(o.clientLeft,t.clientLeft);return jc(n).translate(u-a,i-c)},jc=function(n){var e,t=n.dom(),r=t.ownerDocument.body;return r===t?Ic(r.offsetLeft,r.offsetTop):tt(n)?(e=t.getBoundingClientRect(),Ic(e.left,e.top)):Ic(0,0)};function Lc(r,o){var n=function(n){var e=o(n);if(e<=0||null===e){var t=eu(n,r);return parseFloat(t)||0}return e},i=function(o,n){return G(n,function(n,e){var t=eu(o,e),r=void 0===t?0:parseInt(t,10);return isNaN(r)?n:n+r},0)};return{set:function(n,e){if(!D(e)&&!e.match(/^[0-9]+$/))throw new Error(r+".set accepts only positive integer values. Value was "+e);var t=n.dom();Ji(t)&&(t.style[r]=e+"px")},get:n,getOuter:n,aggregate:i,max:function(n,e,t){var r=i(n,t);return r<e?e-r:0}}}var Vc,Wc,Uc=Lc("height",function(n){var e=n.dom();return tt(n)?e.getBoundingClientRect().height:e.offsetHeight}),zc=function(n){return Uc.getOuter(n)},qc=Lc("width",function(n){return n.dom().offsetWidth}),Gc=function(n){return qc.getOuter(n)},Yc=(Zn().browser.isSafari(),function(n){var e=void 0!==n?n.dom():b.document,t=e.body.scrollLeft||e.documentElement.scrollLeft,r=e.body.scrollTop||e.documentElement.scrollTop;return Ic(t,r)}),Kc=function(n,e,t,r){return{x:sn(n),y:sn(e),width:sn(t),height:sn(r),right:sn(n+t),bottom:sn(e+r)}},Xc=function(n){var e,t,r=void 0===n?b.window:n,o=r.document,i=Yc(w.fromDom(o));return(e=r,t=void 0===e?b.window:e,ln.from(t.visualViewport)).fold(function(){var n=r.document.documentElement,e=n.clientWidth,t=n.clientHeight;return Kc(i.left(),i.top(),e,t)},function(n){return Kc(Math.max(n.pageLeft,i.left()),Math.max(n.pageTop,i.top()),n.width,n.height)})},Jc=function(r,n){return r.view(n).fold(sn([]),function(n){var e=r.owner(n),t=Jc(r,e);return[n].concat(t)})},Qc=Object.freeze({__proto__:null,view:function(n){return(n.dom()===b.document?ln.none():ln.from(n.dom().defaultView.frameElement)).map(w.fromDom)},owner:function(n){return ae(n)}}),$c=function(r){var n,e,t,o,i=w.fromDom(b.document),u=Yc(i);return(n=r,t=(e=Qc).owner(n),o=Jc(e,t),ln.some(o)).fold(g(Pc,r),function(n){var e=jc(r),t=q(n,function(n,e){var t=jc(e);return{left:n.left+t.left(),top:n.top+t.top()}},{left:0,top:0});return Ic(t.left+e.left()+u.left(),t.top+e.top()+u.top())})},Zc=rn("point","width","height"),na=rn("x","y","width","height"),ea=function(n,e,t,r){return{x:sn(n),y:sn(e),width:sn(t),height:sn(r),right:sn(n+t),bottom:sn(e+r)}},ta=function(n){var e=Pc(n),t=Gc(n),r=zc(n);return ea(e.left(),e.top(),t,r)},ra=function(){return Xc(b.window)},oa=function(n,t){var r=ae(t),e=Po(r).bind(function(e){var o,i,n=function(n){return ce(e,n)};return n(t)?ln.some(t):(o=n,(i=function(n){for(var e=0;e<n.childNodes.length;e++){var t=w.fromDom(n.childNodes[e]);if(o(t))return ln.some(t);var r=i(n.childNodes[e]);if(r.isSome())return r}return ln.none()})(t.dom()))}),o=n(t);return e.each(function(e){Po(r).filter(function(n){return ce(n,e)}).fold(function(){Ho(e)},_)}),o},ia=st([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),ua=ia.southeast,ca=ia.southwest,aa=ia.northeast,sa=ia.northwest,fa=ia.south,la=ia.north,da=ia.east,ma=ia.west,ga=rn("position","left","top","right","bottom"),pa=function(n,e){var t,r,o,i=function(n){return n+"px"};t=n,r={position:ln.some(e.position()),left:e.left().map(i),top:e.top().map(i),right:e.right().map(i),bottom:e.bottom().map(i)},o=t.dom(),cn(r,function(n,e){n.fold(function(){$i(o,e)},function(n){Qi(o,e,n)})})},va=st([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),ha=function(n,e,t,r,o,i){var u,c,a,s,f,l,d,m,g,p=e.x()-t,v=e.y()-r,h=o-(p+e.width()),b=i-(v+e.height()),y=ln.some(p),_=ln.some(v),w=ln.some(h),x=ln.some(b),O=ln.none();return u=e.direction(),c=function(){return ga(n,y,_,O,O)},a=function(){return ga(n,O,_,w,O)},s=function(){return ga(n,y,O,O,x)},f=function(){return ga(n,O,O,w,x)},l=function(){return ga(n,y,_,O,O)},d=function(){return ga(n,y,O,O,x)},m=function(){return ga(n,y,_,O,O)},g=function(){return ga(n,O,_,w,O)},u.fold(c,a,s,f,l,d,m,g)},ba=function(n,e){var t=g($c,e),r=n.fold(t,t,function(){var n=Yc();return $c(e).translate(-n.left(),-n.top())}),o=Gc(e),i=zc(e);return ea(r.left(),r.top(),o,i)},ya=function(n,e,t){var r=Ic(e,t);return n.fold(sn(r),sn(r),function(){var n=Yc();return r.translate(-n.left(),-n.top())})},_a=(va.none,va.relative),wa=va.fixed,xa=rn("anchorBox","origin"),Oa=function(n,e,t,r){var o=n+e;return r<o?t:o<t?r:o},Sa=function(n,e,t){return Math.min(Math.max(n,e),t)},Ea=function(e,t){return function(n,e){for(var t={},r=0,o=n.length;r<o;r++){var i=n[r];t[String(i)]=e(i,r)}return t}(["left","right","top","bottom"],function(n){return gn(t,n).map(function(n){return function(n,e){switch(e){case 1:return n.x();case 0:return n.x()+n.width();case 2:return n.y();case 3:return n.y()+n.height()}}(e,n)})})},Ca=yn(["x","y","width","height","maxHeight","maxWidth","direction","classes","label","candidateYforTest"],[]),ka=st([{fit:["reposition"]},{nofit:["reposition","deltaW","deltaH"]}]),Ta=function(n,e,t,r){var o,i,u,c,a,s,f,l,d,m,g,p,v,h,b,y,_,w,x,O,S,E,C,k,T,M,D,N,A,F,R,B,I,H=n.x(),P=n.y(),j=n.bubble().offset(),L=j.left(),V=j.top(),W=(o=r,i=n.boundsRestriction(),u=j,a=(c=function(e,t){var r="top"===e||"bottom"===e?u.top():u.left();return gn(i,e).bind(fn).bind(function(n){return"left"===e||"top"===e?t<=n?ln.some(n):ln.none():n<=t?ln.some(n):ln.none()}).map(function(n){return n+r}).getOr(t)})("left",o.x()),s=c("top",o.y()),f=c("right",o.right()),l=c("bottom",o.bottom()),ea(a,s,f-a,l-s)),U=W.y(),z=W.bottom(),q=W.x(),G=W.right(),Y=P+V,K=(d=H+L,m=Y,g=e,p=t,h=(v=W).x(),b=v.y(),y=v.width(),_=v.height(),x=b<=m,O=(w=h<=d)&&x,S=d+g<=h+y&&m+p<=b+_,E=Math.abs(Math.min(g,w?h+y-d:h-(d+g))),C=Math.abs(Math.min(p,x?b+_-m:b-(m+p))),k=Math.max(v.x(),v.right()-g),T=Math.max(v.y(),v.bottom()-p),{originInBounds:O,sizeInBounds:S,limitX:Sa(d,v.x(),k),limitY:Sa(m,v.y(),T),deltaW:E,deltaH:C}),X=K.originInBounds,J=K.sizeInBounds,Q=K.limitX,$=K.limitY,Z=K.deltaW,nn=K.deltaH,en=sn($+nn-U),tn=sn(z-$),rn=(M=n.direction(),N=D=tn,A=en,M.fold(D,D,A,A,D,A,N,N)),on=sn(Q+Z-q),un=sn(G-Q),cn=(F=n.direction(),B=R=un,I=on,F.fold(R,I,R,I,B,B,R,I)),an=Ca({x:Q,y:$,width:Z,height:nn,maxHeight:rn,maxWidth:cn,direction:n.direction(),classes:{on:n.bubble().classesOn(),off:n.bubble().classesOff()},label:n.label(),candidateYforTest:Y});return X&&J?ka.fit(an):ka.nofit(an,Z,nn)},Ma=function(n,e,t,r){ou(e,"max-height"),ou(e,"max-width");var o,i,u,c,a,s,f,l,d,m={width:sn(Gc(o=e)),height:sn(zc(o))};return i=r.preference(),u=n,c=m,a=t,s=r.bounds(),f=c.width(),l=c.height(),d=function(n,r,o,i){var e=n(u,c,a);return Ta(e,f,l,s).fold(ka.fit,function(n,e,t){return i<t||o<e?ka.nofit(n,e,t):ka.nofit(r,o,i)})},G(i,function(n,e){var t=g(d,e);return n.fold(ka.fit,t)},ka.nofit(Ca({x:u.x(),y:u.y(),width:c.width(),height:c.height(),maxHeight:c.height(),maxWidth:c.width(),direction:ua(),classes:{on:[],off:[]},label:"none",candidateYforTest:u.y()}),-1,-1)).fold(fn,fn)},Da=function(n,e,t){var r,o;pa(n,(r=t.origin(),o=e,r.fold(function(){return ga("absolute",ln.some(o.x()),ln.some(o.y()),ln.none(),ln.none())},function(n,e,t,r){return ha("absolute",o,n,e,t,r)},function(n,e,t,r){return ha("fixed",o,n,e,t,r)})))},Na=function(n,e){var t,r,o;t=n,r=Math.floor(e),o=Uc.max(t,r,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]),Zi(t,"max-height",o+"px")},Aa=sn(function(n,e){Na(n,e),nu(n,{"overflow-x":"hidden","overflow-y":"auto"})}),Fa=yn(["bounds","origin","preference","maxHeightFunction","maxWidthFunction"],[]),Ra=function(n,e,t){return void 0===n[e]?t:n[e]},Ba=function(n,e,t,r,o,i){var u,c,a=Ra(i,"maxHeightFunction",Aa()),s=Ra(i,"maxWidthFunction",_),f=n.anchorBox(),l=n.origin(),d=Fa({bounds:(u=l,c=o,c.fold(function(){return u.fold(ra,ra,ea)},function(t){return u.fold(t,t,function(){var n=t(),e=ya(u,n.x(),n.y());return ea(e.left(),e.top(),n.width(),n.height())})})),origin:l,preference:r,maxHeightFunction:a,maxWidthFunction:s});Ia(f,e,t,d)},Ia=function(n,e,t,r){var o,i,u,c,a,s,f=Ma(n,e,t,r);Da(e,f,r),o=e,i=f.classes(),Xi(o,i.off),Ki(o,i.on),u=e,c=f,r.maxHeightFunction()(u,c.maxHeight()),a=e,s=f,r.maxWidthFunction()(a,s.maxWidth())},Ha=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right"],Pa=function(){return e=n=0,t={},o=function(n){return gn(t,n).getOr([])},r=function(n,e,t){var r=Z(Ha,t);return{offset:function(){return Ic(n,e)},classesOn:function(){return J(t,o)},classesOff:function(){return J(r,o)}}},{southeast:function(){return r(-n,e,["top","alignLeft"])},southwest:function(){return r(n,e,["top","alignRight"])},south:function(){return r(-n/2,e,["top","alignCentre"])},northeast:function(){return r(-n,-e,["bottom","alignLeft"])},northwest:function(){return r(n,-e,["bottom","alignRight"])},north:function(){return r(-n/2,-e,["bottom","alignCentre"])},east:function(){return r(n,-e/2,["valignCentre","left"])},west:function(){return r(-n,-e/2,["valignCentre","right"])},innerNorthwest:function(){return r(-n,e,["top","alignRight"])},innerNortheast:function(){return r(n,e,["top","alignLeft"])},innerNorth:function(){return r(-n/2,e,["top","alignCentre"])},innerSouthwest:function(){return r(-n,-e,["bottom","alignRight"])},innerSoutheast:function(){return r(n,-e,["bottom","alignLeft"])},innerSouth:function(){return r(-n/2,-e,["bottom","alignCentre"])},innerWest:function(){return r(n,-e/2,["valignCentre","right"])},innerEast:function(){return r(-n,-e/2,["valignCentre","left"])}};var n,e,t,o,r},ja=rn("x","y","bubble","direction","boundsRestriction","label"),La=function(n){return n.x()},Va=function(n,e){return n.x()+n.width()/2-e.width()/2},Wa=function(n,e){return n.x()+n.width()-e.width()},Ua=function(n,e){return n.y()-e.height()},za=function(n){return n.y()+n.height()},qa=function(n,e){return n.y()+n.height()/2-e.height()/2},Ga=function(n,e,t){return ja(La(n),za(n),t.southeast(),ua(),Ea(n,{left:1,top:3}),"layout-se")},Ya=function(n,e,t){return ja(Wa(n,e),za(n),t.southwest(),ca(),Ea(n,{right:0,top:3}),"layout-sw")},Ka=function(n,e,t){return ja(La(n),Ua(n,e),t.northeast(),aa(),Ea(n,{left:1,bottom:2}),"layout-ne")},Xa=function(n,e,t){return ja(Wa(n,e),Ua(n,e),t.northwest(),sa(),Ea(n,{right:0,bottom:2}),"layout-nw")},Ja=function(n,e,t){return ja(Va(n,e),Ua(n,e),t.north(),la(),Ea(n,{bottom:2}),"layout-n")},Qa=function(n,e,t){return ja(Va(n,e),za(n),t.south(),fa(),Ea(n,{top:3}),"layout-s")},$a=function(n,e,t){return ja((r=n).x()+r.width(),qa(n,e),t.east(),da(),Ea(n,{left:0}),"layout-e");var r},Za=function(n,e,t){return ja((r=e,n.x()-r.width()),qa(n,e),t.west(),ma(),Ea(n,{right:1}),"layout-w");var r},ns=function(){return[Ga,Ya,Ka,Xa,Qa,Ja,$a,Za]},es=function(){return[Ya,Ga,Xa,Ka,Qa,Ja,$a,Za]},ts=function(){return[Ka,Xa,Ga,Ya,Ja,Qa]},rs=function(){return[Ga,Ya,Ka,Xa,Qa,Ja]},os=function(){return[Ya,Ga,Xa,Ka,Qa,Ja]},is=function(n){return n},us=function(e,t){return function(n){return"rtl"===cs(n)?t:e}},cs=function(n){return"rtl"===eu(n,"direction")?"rtl":"ltr"};(Wc=Vc||(Vc={})).TopToBottom="toptobottom",Wc.BottomToTop="bottomtotop";var as=function(n){return Io(n,function(n){return Le(n)&&ze(n,"data-alloy-vertical-dir")===Vc.BottomToTop})},ss=function(){return yr("layouts",[mr("onLtr"),mr("onRtl"),hr("onBottomLtr"),hr("onBottomRtl")])},fs=function(e,n,t,r,o,i,u){var c=u.map(as).getOr(!1),a=n.layouts.map(function(n){return n.onLtr(e)}),s=n.layouts.map(function(n){return n.onRtl(e)}),f=c?n.layouts.bind(function(n){return n.onBottomLtr.map(function(n){return n(e)})}).or(a).getOr(o):a.getOr(t),l=c?n.layouts.bind(function(n){return n.onBottomRtl.map(function(n){return n(e)})}).or(s).getOr(i):s.getOr(r);return us(f,l)(e)},ls=[mr("hotspot"),hr("bubble"),wr("overrides",{}),ss(),Au("placement",function(n,e,t){var r=e.hotspot,o=ba(t,r.element()),i=fs(n.element(),e,rs(),os(),ts(),[Xa,Ka,Ya,Ga,Ja,Qa],ln.some(e.hotspot.element()));return ln.some(is({anchorBox:o,bubble:e.bubble.getOr(Pa()),overrides:e.overrides,layouts:i,placer:ln.none()}))})],ds=[mr("x"),mr("y"),wr("height",0),wr("width",0),wr("bubble",Pa()),wr("overrides",{}),ss(),Au("placement",function(n,e,t){var r=ya(t,e.x,e.y),o=ea(r.left(),r.top(),e.width,e.height),i=fs(n.element(),e,ns(),es(),ns(),es(),ln.none());return ln.some(is({anchorBox:o,bubble:e.bubble,overrides:e.overrides,layouts:i,placer:ln.none()}))})],ms={create:rn("start","soffset","finish","foffset")},gs=st([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),ps=(gs.before,gs.on,gs.after,function(n){return n.fold(fn,fn,fn)}),vs=st([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),hs={domRange:vs.domRange,relative:vs.relative,exact:vs.exact,exactFromRange:function(n){return vs.exact(n.start(),n.soffset(),n.finish(),n.foffset())},getWin:function(n){var e=n.match({domRange:function(n){return w.fromDom(n.startContainer)},relative:function(n,e){return ps(n)},exact:function(n,e,t,r){return n}});return se(e)},range:ms.create},bs=function(n,e,t){var r,o,i=n.document.createRange();return r=i,e.fold(function(n){r.setStartBefore(n.dom())},function(n,e){r.setStart(n.dom(),e)},function(n){r.setStartAfter(n.dom())}),o=i,t.fold(function(n){o.setEndBefore(n.dom())},function(n,e){o.setEnd(n.dom(),e)},function(n){o.setEndAfter(n.dom())}),i},ys=function(n,e,t,r,o){var i=n.document.createRange();return i.setStart(e.dom(),t),i.setEnd(r.dom(),o),i},_s=function(n){return{left:sn(n.left),top:sn(n.top),right:sn(n.right),bottom:sn(n.bottom),width:sn(n.width),height:sn(n.height)}},ws=st([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),xs=function(n,e,t){return e(w.fromDom(t.startContainer),t.startOffset,w.fromDom(t.endContainer),t.endOffset)},Os=function(n,e){var o,t,r,i=(o=n,e.match({domRange:function(n){return{ltr:sn(n),rtl:ln.none}},relative:function(n,e){return{ltr:et(function(){return bs(o,n,e)}),rtl:et(function(){return ln.some(bs(o,e,n))})}},exact:function(n,e,t,r){return{ltr:et(function(){return ys(o,n,e,t,r)}),rtl:et(function(){return ln.some(ys(o,t,r,n,e))})}}}));return(r=(t=i).ltr()).collapsed?t.rtl().filter(function(n){return!1===n.collapsed}).map(function(n){return ws.rtl(w.fromDom(n.endContainer),n.endOffset,w.fromDom(n.startContainer),n.startOffset)}).getOrThunk(function(){return xs(0,ws.ltr,r)}):xs(0,ws.ltr,r)};ws.ltr,ws.rtl;var Ss,Es,Cs,ks,Ts,Ms,Ds,Ns=(Ss=Ve,Es="text",{get:function(n){if(!Ss(n))throw new Error("Can only get "+Es+" value of a "+Es+" node");return Cs(n).getOr("")},getOption:Cs=function(n){return Ss(n)?ln.from(n.dom().nodeValue):ln.none()},set:function(n,e){if(!Ss(n))throw new Error("Can only set raw "+Es+" value of a "+Es+" node");n.dom().nodeValue=e}}),As=function(n,e,t,r){var o,i,u,c,a,s=(i=e,u=t,c=r,(a=ae(o=n).dom().createRange()).setStart(o.dom(),i),a.setEnd(u.dom(),c),a),f=ce(n,t)&&e===r;return s.collapsed&&!f},Fs=function(n){var e=w.fromDom(n.anchorNode),t=w.fromDom(n.focusNode);return As(e,n.anchorOffset,t,n.focusOffset)?ln.some(ms.create(e,n.anchorOffset,t,n.focusOffset)):function(n){if(0<n.rangeCount){var e=n.getRangeAt(0),t=n.getRangeAt(n.rangeCount-1);return ln.some(ms.create(w.fromDom(e.startContainer),e.startOffset,w.fromDom(t.endContainer),t.endOffset))}return ln.none()}(n)},Rs=function(n,e){var i,t,r,o,u=Os(i=n,e).match({ltr:function(n,e,t,r){var o=i.document.createRange();return o.setStart(n.dom(),e),o.setEnd(t.dom(),r),o},rtl:function(n,e,t,r){var o=i.document.createRange();return o.setStart(t.dom(),r),o.setEnd(n.dom(),e),o}});return r=(t=u).getClientRects(),0<(o=0<r.length?r[0]:t.getBoundingClientRect()).width||0<o.height?ln.some(o).map(_s):ln.none()},Bs=rn("element","offset"),Is=function(n,e){var t=le(n);if(0===t.length)return Bs(n,e);if(e<t.length)return Bs(t[e],0);var r,o=t[t.length-1],i=Ve(o)?(r=o,Ns.get(r)).length:le(o).length;return Bs(o,i)},Hs=st([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),Ps=function(n){return n.fold(fn,function(n,e,t){return n.translate(-e,-t)})},js=function(n){return n.fold(fn,fn)},Ls=function(n){return G(n,function(n,e){return n.translate(e.left(),e.top())},Ic(0,0))},Vs=function(n){var e=W(n,js);return Ls(e)},Ws=Hs.screen,Us=Hs.absolute,zs=function(n,e,t){var r,o,i,u=ae(n.element()),c=Yc(u),a=(r=n,o=t,i=se(o.root).dom(),ln.from(i.frameElement).map(w.fromDom).filter(function(n){var e=ae(n),t=ae(r.element());return ce(e,t)}).map(Pc)).getOr(c);return Us(a,c.left(),c.top())},qs=function(n,e,t,r){var o=n,i=e,u=t,c=r;n<0&&(o=0,u=t+n),e<0&&(i=0,c=r+e);var a=Ws(Ic(o,i));return ln.some(Zc(a,u,c))},Gs=function(n,f,l,d,m){return n.map(function(n){var e,t,r,o=[f,n.point()],i=(e=function(){return Vs(o)},t=function(){return Vs(o)},r=function(){return n=W(o,Ps),Ls(n);var n},d.fold(e,t,r)),u=na(i.left(),i.top(),n.width(),n.height()),c=l.showAbove?ts():rs(),a=(l.showAbove,os()),s=fs(m,l,c,a,c,a,ln.none());return is({anchorBox:u,bubble:l.bubble.getOr(Pa()),overrides:l.overrides,layouts:s,placer:ln.none()})})},Ys=rn("element","offset"),Ks=function(n,e){return Ve(n)?Ys(n,e):Is(n,e)},Xs=function(e,n){return n.getSelection.getOrThunk(function(){return function(){return n=e,ln.from(n.getSelection()).filter(function(n){return 0<n.rangeCount}).bind(Fs);var n}})().map(function(n){var e=Ks(n.start(),n.soffset()),t=Ks(n.finish(),n.foffset());return hs.range(e.element(),e.offset(),t.element(),t.offset())})},Js=[hr("getSelection"),mr("root"),hr("bubble"),ss(),wr("overrides",{}),wr("showAbove",!1),Au("placement",function(n,e,t){var r=se(e.root).dom(),o=zs(n,0,e),i=Xs(r,e).bind(function(n){return Rs(r,hs.exactFromRange(n)).orThunk(function(){var e=w.fromText("\ufeff");return ge(n.start(),e),Rs(r,hs.exact(e,0,e,1)).map(function(n){return Wo(e),n})}).bind(function(n){return qs(n.left(),n.top(),n.width(),n.height())})}),u=Xs(r,e).bind(function(n){return Le(n.start())?ln.some(n.start()):fe(n.start())}).getOr(n.element());return Gs(i,o,e,t,u)})],Qs=[mr("node"),mr("root"),hr("bubble"),ss(),wr("overrides",{}),wr("showAbove",!1),Au("placement",function(o,i,u){var c=zs(o,0,i);return i.node.bind(function(n){var e=n.dom().getBoundingClientRect(),t=qs(e.left,e.top,e.width,e.height),r=i.node.getOr(o.element());return Gs(t,c,i,u,r)})})],$s=function(n){return n.x()+n.width()},Zs=function(n,e){return n.x()-e.width()},nf=function(n,e){return n.y()-e.height()+n.height()},ef=function(n){return n.y()},tf=function(n,e,t){return ja($s(n),ef(n),t.southeast(),ua(),Ea(n,{left:0,top:2}),"link-layout-se")},rf=function(n,e,t){return ja(Zs(n,e),ef(n),t.southwest(),ca(),Ea(n,{right:1,top:2}),"link-layout-sw")},of=function(n,e,t){return ja($s(n),nf(n,e),t.northeast(),aa(),Ea(n,{left:0,bottom:3}),"link-layout-ne")},uf=function(n,e,t){return ja(Zs(n,e),nf(n,e),t.northwest(),sa(),Ea(n,{right:1,bottom:3}),"link-layout-nw")},cf=function(){return[tf,rf,of,uf]},af=function(){return[rf,tf,uf,of]},sf=[mr("item"),ss(),wr("overrides",{}),Au("placement",function(n,e,t){var r=ba(t,e.item.element()),o=fs(n.element(),e,cf(),af(),cf(),af(),ln.none());return ln.some(is({anchorBox:r,bubble:Pa(),overrides:e.overrides,layouts:o,placer:ln.none()}))})],ff=ar("anchor",{selection:Js,node:Qs,hotspot:ls,submenu:sf,makeshift:ds}),lf=function(n,e,t,r,o){var i,u=(i=t.anchorBox,xa(i,e));Ba(u,o.element(),t.bubble,t.layouts,r,t.overrides)},df=function(n,e,t,r,o,i){var u=i.map(ta);return mf(n,e,t,r,o,u)},mf=function(a,s,n,e,f,l){var d=ur("positioning anchor.info",ff,e);oa(function(){Zi(f.element(),"position","fixed");var n=ru(f.element(),"visibility");Zi(f.element(),"visibility","hidden");var e,t,r,o,i=s.useFixed()?(o=b.document.documentElement,wa(0,0,o.clientWidth,o.clientHeight)):(t=Pc((e=a).element()),r=e.element().dom().getBoundingClientRect(),_a(t.left(),t.top(),r.width,r.height)),u=d.placement,c=l.map(sn).or(s.getBounds);u(a,d,i).each(function(n){n.placer.getOr(lf)(a,i,n,c,f)}),n.fold(function(){ou(f.element(),"visibility")},function(n){Zi(f.element(),"visibility",n)}),ru(f.element(),"left").isNone()&&ru(f.element(),"top").isNone()&&ru(f.element(),"right").isNone()&&ru(f.element(),"bottom").isNone()&&ru(f.element(),"position").is("fixed")&&ou(f.element(),"position")},f.element())},gf=Object.freeze({__proto__:null,position:function(n,e,t,r,o){df(n,e,t,r,o,ln.none())},positionWithin:df,positionWithinBounds:mf,getMode:function(n,e,t){return e.useFixed()?"fixed":"absolute"}}),pf=[wr("useFixed",m),hr("getBounds")],vf=ko({fields:pf,name:"positioning",active:Rc,apis:gf}),hf=function(n,e,t,r){var o=n.getSystem().build(r);Tc(n,o,t)},bf=function(n,e,t,r){var o=yf(n);Y(o,function(n){return ce(r.element(),n.element())}).each(Dc)},yf=function(n,e){return n.components()},_f=function(e,n,t,o,r){var i=yf(e);return ln.from(i[o]).map(function(n){return bf(e,0,0,n),r.each(function(n){hf(e,0,function(n,e){var t,r;r=e,de(t=n,o).fold(function(){ve(t,r)},function(n){ge(n,r)})},n)}),n})},wf=ko({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(n,e,t,r){hf(n,0,ve,r)},prepend:function(n,e,t,r){hf(n,0,pe,r)},remove:bf,replaceAt:_f,replaceBy:function(e,n,t,r,o){var i=yf(e);return K(i,r).bind(function(n){return _f(e,0,0,n,o)})},set:function(e,n,t,r){oa(function(){var n=W(r,e.getSystem().build);Cc(e,n)},e.element())},contents:yf})}),xf=function(n){var e,t=n.dom();return!((e=t).offsetWidth<=0&&e.offsetHeight<=0)},Of=Object.freeze({__proto__:null,getCurrent:function(n,e,t){return e.find(n)}}),Sf=[mr("find")],Ef=ko({fields:Sf,name:"composing",apis:Of}),Cf=function(n,e){e.ignore||(Ho(n.element()),e.onFocus(n))},kf=Object.freeze({__proto__:null,focus:Cf,blur:function(n,e){e.ignore||n.element().dom().blur()},isFocused:function(n){return e=n.element(),t=ae(e).dom(),e.dom()===t.activeElement;var e,t}}),Tf=Object.freeze({__proto__:null,exhibit:function(n,e){var t=e.ignore?{}:{attributes:{tabindex:"-1"}};return _o(t)},events:function(t){return so([fo(Vr(),function(n,e){Cf(n,t),e.stop()})].concat(t.stopMousedown?[fo(Fr(),function(n,e){e.event().prevent()})]:[]))}}),Mf=[Tu("onFocus"),wr("stopMousedown",!1),wr("ignore",!1)],Df=ko({fields:Mf,name:"focusing",active:Tf,apis:kf}),Nf=function(n,e,t){e.store.manager.onLoad(n,e,t)},Af=function(n,e,t){e.store.manager.onUnload(n,e,t)},Ff=Object.freeze({__proto__:null,onLoad:Nf,onUnload:Af,setValue:function(n,e,t,r){e.store.manager.setValue(n,e,t,r)},getValue:function(n,e,t){return e.store.manager.getValue(n,e,t)},getState:function(n,e,t){return t}}),Rf=Object.freeze({__proto__:null,events:function(t,r){var n=t.resetOnDom?[go(function(n,e){Nf(n,t,r)}),po(function(n,e){Af(n,t,r)})]:[wo(t,r,Nf)];return so(n)}}),Bf=function(){var n=kn(null);return Er({set:n.set,get:n.get,isNotSet:function(){return null===n.get()},clear:function(){n.set(null)},readState:function(){return{mode:"memory",value:n.get()}}})},If=function(){var i=kn({}),u=kn({});return Er({readState:function(){return{mode:"dataset",dataByValue:i.get(),dataByText:u.get()}},lookup:function(n){return gn(i.get(),n).orThunk(function(){return gn(u.get(),n)})},update:function(n){var e=i.get(),t=u.get(),r={},o={};U(n,function(e){r[e.value]=e,gn(e,"meta").each(function(n){gn(n,"text").each(function(n){o[n]=e})})}),i.set(xn(xn({},e),r)),u.set(xn(xn({},t),o))},clear:function(){i.set({}),u.set({})}})},Hf=Object.freeze({__proto__:null,memory:Bf,dataset:If,manual:function(){return Er({readState:function(){}})},init:function(n){return n.store.manager.state(n)}}),Pf=function(n,e,t,r){var o=e.store;t.update([r]),o.setValue(n,r),e.onSetValue(n,r)},jf=[hr("initialValue"),mr("getFallbackEntry"),mr("getDataKey"),mr("setValue"),Au("manager",{setValue:Pf,getValue:function(n,e,t){var r=e.store,o=r.getDataKey(n);return t.lookup(o).fold(function(){return r.getFallbackEntry(o)},function(n){return n})},onLoad:function(e,t,r){t.store.initialValue.each(function(n){Pf(e,t,r,n)})},onUnload:function(n,e,t){t.clear()},state:If})],Lf=[mr("getValue"),wr("setValue",_),hr("initialValue"),Au("manager",{setValue:function(n,e,t,r){e.store.setValue(n,r),e.onSetValue(n,r)},getValue:function(n,e,t){return e.store.getValue(n)},onLoad:function(e,t,n){t.store.initialValue.each(function(n){t.store.setValue(e,n)})},onUnload:_,state:Sr.init})],Vf=[hr("initialValue"),Au("manager",{setValue:function(n,e,t,r){t.set(r),e.onSetValue(n,r)},getValue:function(n,e,t){return t.get()},onLoad:function(n,e,t){e.store.initialValue.each(function(n){t.isNotSet()&&t.set(n)})},onUnload:function(n,e,t){t.clear()},state:Bf})],Wf=[xr("store",{mode:"memory"},ar("mode",{memory:Vf,manual:Lf,dataset:jf})),Tu("onSetValue"),wr("resetOnDom",!1)],Uf=ko({fields:Wf,name:"representing",active:Rf,apis:Ff,extra:{setValueFrom:function(n,e){var t=Uf.getValue(e);Uf.setValue(n,t)}},state:Hf}),zf=Object.freeze({__proto__:null,exhibit:function(n,e){return _o({attributes:Bt([{key:e.tabAttr,value:"true"}])})}}),qf=[wr("tabAttr","data-alloy-tabstop")],Gf=ko({fields:qf,name:"tabstopping",active:zf}),Yf=function(n,e,t,r){return gn(e.routes,r.start).bind(function(n){return gn(n,r.destination)})},Kf=function(n,e,t,r){return Yf(0,e,0,r).bind(function(e){return e.transition.map(function(n){return{transition:n,route:e}})})},Xf=function(t,r,n){var e,o,i;(e=t,o=r,i=n,Jf(e,o).bind(function(n){return Kf(e,o,i,n)})).each(function(n){var e=n.transition;Ze(t.element(),e.transitionClass),Ge(t.element(),r.destinationAttr)})},Jf=function(n,e,t){var r=n.element();return qe(r,e.destinationAttr)?ln.some({start:ze(n.element(),e.stateAttr),destination:ze(n.element(),e.destinationAttr)}):ln.none()},Qf=function(n,e,t,r){Xf(n,e,t),qe(n.element(),e.stateAttr)&&ze(n.element(),e.stateAttr)!==r&&e.onFinish(n,r),Ue(n.element(),e.stateAttr,r)},$f=Object.freeze({__proto__:null,findRoute:Yf,disableTransition:Xf,getCurrentRoute:Jf,jumpTo:Qf,progressTo:function(t,r,o,i){var n,e;e=r,qe((n=t).element(),e.destinationAttr)&&(Ue(n.element(),e.stateAttr,ze(n.element(),e.destinationAttr)),Ge(n.element(),e.destinationAttr));var u,c,a=(u=r,c=i,{start:ze(t.element(),u.stateAttr),destination:c});Kf(t,r,o,a).fold(function(){Qf(t,r,o,i)},function(n){Xf(t,r,o);var e=n.transition;Qe(t.element(),e.transitionClass),Ue(t.element(),r.destinationAttr,i)})},getState:function(n,e,t){var r=n.element();return qe(r,e.stateAttr)?ln.some(ze(r,e.stateAttr)):ln.none()}}),Zf=Object.freeze({__proto__:null,events:function(o,i){return so([fo(jr(),function(t,n){var r=n.event().raw();Jf(t,o).each(function(e){Yf(0,o,0,e).each(function(n){n.transition.each(function(n){r.propertyName===n.property&&(Qf(t,o,i,e.destination),o.onTransition(t,e))})})})}),go(function(n,e){Qf(n,o,i,o.initialState)})])}}),nl=[wr("destinationAttr","data-transitioning-destination"),wr("stateAttr","data-transitioning-state"),mr("initialState"),Tu("onTransition"),Tu("onFinish"),gr("routes",rr(Fe.value,rr(Fe.value,Yt([_r("transition",[mr("property"),mr("transitionClass")])]))))],el=ko({fields:nl,name:"transitioning",active:Zf,apis:$f,extra:{createRoutes:function(n){var r={};return cn(n,function(n,e){var t=e.split("<->");r[t[0]]=Rt(t[1],n),r[t[1]]=Rt(t[0],n)}),r},createBistate:function(n,e,t){return Bt([{key:n,value:Rt(e,t)},{key:e,value:Rt(n,t)}])},createTristate:function(n,e,t,r){return Bt([{key:n,value:Bt([{key:e,value:r},{key:t,value:r}])},{key:e,value:Bt([{key:n,value:r},{key:t,value:r}])},{key:t,value:Bt([{key:n,value:r},{key:e,value:r}])}])}}}),tl=Zn().os.isOSX()?"":"Ctrl",rl=an({tc_menu_name:"TinyComments",tc_announce_sidebar_available:"Comment. Sidebar available. Press "+tl+" + Alt + M to switch to sidebar",tc_items_addcomment:"Add comment",tc_items_showcomments:"Show comments",tc_items_deleteall:"Delete all conversations",tc_edit_buttons_save:"Save",tc_edit_buttons_cancel:"Cancel",tc_reply_buttons_save:"Save",tc_reply_buttons_clear:"Clear",tc_reply_placeholders:"Say something ...",tc_kebab_deleteconversation:"Delete conversation",tc_kebab_delete:"Delete",tc_kebab_edit:"Edit",tc_edit_problem_comment:"An error occurred editing this comment. See the Console for details.",tc_edit_unauthorised_comment:"You are not allowed to edit this comment",tc_delete_buttons_cancel:"Cancel",tc_delete_buttons_proceed:"Delete",tc_create_problem:"An error occurred while creating a comment. See the Console for details",tc_reply_problem:"An error occurred while replying to a comment. See the Console for details",tc_delete_prompts_conversation:"Delete this conversation?",tc_delete_prompts_conversation_detail_sing:"1 comment will be deleted. You can't undo this action.",tc_delete_prompts_conversation_detail_pl:"{0} comments will be deleted. You can't undo this action.",tc_delete_prompts_all:"Delete all conversations in the content? This cannot be undone",tc_delete_prompts_comment:"Are you sure you want to delete this comment?",tc_delete_problem_all:"An error occurred deleting all the conversations. See the Console for details.",tc_delete_problem_conversation:"An error occurred deleting the conversation. See the Console for details.",tc_delete_problem_comment:"An error occurred deleting the comment. See the Console for details.",tc_delete_unauthorised_all:"You are not allowed to delete all the conversations",tc_delete_unauthorised_conversation:"You are not allowed to delete this conversation",tc_delete_unauthorised_comment:"You are not allowed to delete this comment",tc_date_less_than_a_minute_ago:"a moment ago",tc_date_1_minute_ago:"1 minute ago",tc_date_x_minutes_ago:"{0} minutes ago",tc_date_1_hour_ago:"1 hour ago",tc_date_x_hours_ago:"{0} hours ago",tc_date_1_day_ago:"1 day ago",tc_date_x_days_ago:"{0} days ago",tc_date_1_week_ago:"1 week ago",tc_date_x_weeks_ago:"{0} weeks ago",tc_date_1_month_ago:"1 month ago",tc_date_x_months_ago:"{0} months ago",tc_date_1_year_ago:"1 year ago",tc_date_x_years_ago:"{0} years ago",tc_date_comment_edited:" (edited)",tc_comment_buttons_showmore:"SHOW MORE",tc_comment_buttons_showless:"SHOW LESS"},fn),ol=function(n,e,t){var r=e.aria;r.update(n,r,t.get())},il=function(e,n,t){n.toggleClass.each(function(n){t.get()?Qe(e.element(),n):Ze(e.element(),n)})},ul=function(n,e,t){sl(n,e,t,!t.get())},cl=function(n,e,t){t.set(!0),il(n,e,t),ol(n,e,t)},al=function(n,e,t){t.set(!1),il(n,e,t),ol(n,e,t)},sl=function(n,e,t,r){(r?cl:al)(n,e,t)},fl=function(n,e,t){sl(n,e,t,e.selected)},ll=Object.freeze({__proto__:null,onLoad:fl,toggle:ul,isOn:function(n,e,t){return t.get()},on:cl,off:al,set:sl}),dl=Object.freeze({__proto__:null,exhibit:function(){return _o({})},events:function(n,e){var t,r,o,i=(t=n,r=e,o=ul,ho(function(n){o(n,t,r)})),u=wo(n,e,fl);return so(X([n.toggleOnExecute?[i]:[],[u]]))}}),ml=function(n,e,t){Ue(n.element(),"aria-expanded",t)},gl=[wr("selected",!1),hr("toggleClass"),wr("toggleOnExecute",!0),xr("aria",{mode:"none"},ar("mode",{pressed:[wr("syncWithExpanded",!1),Au("update",function(n,e,t){Ue(n.element(),"aria-pressed",t),e.syncWithExpanded&&ml(n,e,t)})],checked:[Au("update",function(n,e,t){Ue(n.element(),"aria-checked",t)})],expanded:[Au("update",ml)],selected:[Au("update",function(n,e,t){Ue(n.element(),"aria-selected",t)})],none:[Au("update",_)]}))],pl=ko({fields:gl,name:"toggling",active:dl,apis:ll,state:(ks=!1,{init:function(){var e=kn(ks);return{get:function(){return e.get()},set:function(n){return e.set(n)},clear:function(){return e.set(ks)},readState:function(){return e.get()}}}})}),vl=function(){var n=function(n,e){e.stop(),uo(n)};return[fo(Pr(),n),fo(Yr(),n),mo(Dr()),mo(Fr())]},hl=function(n){return so(X([n.map(function(t){return ho(function(n,e){t(n),e.stop()})}).toArray(),vl()]))},bl=function(n,e,t){var r=$(n.slice(0,e)),o=$(n.slice(e+1));return Y(r.concat(o),t)},yl=function(n,e,t){var r=$(n.slice(0,e));return Y(r,t)},_l=function(n,e,t){var r=n.slice(0,e),o=n.slice(e+1);return Y(o.concat(r),t)},wl=function(n,e,t){var r=n.slice(e+1);return Y(r,t)},xl=function(t){return function(n){var e=n.raw();return L(t,e.which)}},Ol=function(n){return function(e){return Q(n,function(n){return n(e)})}},Sl=function(n){return!0===n.raw().shiftKey},El=function(n){return!0===n.raw().ctrlKey},Cl=(Ts=Sl,function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return!Ts.apply(null,n)}),kl=function(n,e){return{matches:n,classification:e}},Tl=function(n){for(var e=[],t=function(n){e.push(n)},r=0;r<n.length;r++)n[r].each(t);return e},Ml=function(t,r,n,o){var e=rt(t.element(),"."+r.highlightClass);U(e,function(e){V(o,function(n){return n.element()===e})||(Ze(e,r.highlightClass),t.getSystem().getByDom(e).each(function(n){r.onDehighlight(t,n),oo(n,ro())}))})},Dl=function(n,e,t,r){Ml(n,e,0,[r]),Nl(n,e,t,r)||(Qe(r.element(),e.highlightClass),e.onHighlight(n,r),oo(r,to()))},Nl=function(n,e,t,r){return nt(r.element(),e.highlightClass)},Al=function(n,e,t,r){var o=rt(n.element(),"."+e.itemClass);return ln.from(o[r]).fold(function(){return Fe.error("No element found with index "+r)},n.getSystem().getByDom)},Fl=function(e,n,t){return ri(e.element(),"."+n.itemClass).bind(function(n){return e.getSystem().getByDom(n).toOption()})},Rl=function(e,n,t){var r=rt(e.element(),"."+n.itemClass);return(0<r.length?ln.some(r[r.length-1]):ln.none()).bind(function(n){return e.getSystem().getByDom(n).toOption()})},Bl=function(t,e,n,r){var o=rt(t.element(),"."+e.itemClass);return K(o,function(n){return nt(n,e.highlightClass)}).bind(function(n){var e=Oa(n,r,0,o.length-1);return t.getSystem().getByDom(o[e]).toOption()})},Il=function(e,n,t){var r=rt(e.element(),"."+n.itemClass);return Tl(W(r,function(n){return e.getSystem().getByDom(n).toOption()}))},Hl=Object.freeze({__proto__:null,dehighlightAll:function(n,e,t){return Ml(n,e,0,[])},dehighlight:function(n,e,t,r){Nl(n,e,t,r)&&(Ze(r.element(),e.highlightClass),e.onDehighlight(n,r),oo(r,ro()))},highlight:Dl,highlightFirst:function(e,t,r){Fl(e,t).each(function(n){Dl(e,t,r,n)})},highlightLast:function(e,t,r){Rl(e,t).each(function(n){Dl(e,t,r,n)})},highlightAt:function(e,t,r,n){Al(e,t,r,n).fold(function(n){throw new Error(n)},function(n){Dl(e,t,r,n)})},highlightBy:function(e,t,r,n){var o=Il(e,t);Y(o,n).each(function(n){Dl(e,t,r,n)})},isHighlighted:Nl,getHighlighted:function(e,n,t){return ri(e.element(),"."+n.highlightClass).bind(function(n){return e.getSystem().getByDom(n).toOption()})},getFirst:Fl,getLast:Rl,getPrevious:function(n,e,t){return Bl(n,e,0,-1)},getNext:function(n,e,t){return Bl(n,e,0,1)},getCandidates:Il}),Pl=[mr("highlightClass"),mr("itemClass"),Tu("onHighlight"),Tu("onDehighlight")],jl=ko({fields:Pl,name:"highlighting",apis:Hl}),Ll=function(n,e,t){e.exists(function(e){return t.exists(function(n){return ce(n,e)})})||io(n,eo(),{prevFocus:e,newFocus:t})},Vl=function(){var o=function(n){return jo(n.element())};return{get:o,set:function(n,e){var t=o(n);n.getSystem().triggerFocus(e,n.element());var r=o(n);Ll(n,t,r)}}};(Ds=Ms||(Ms={})).OnFocusMode="onFocus",Ds.OnEnterOrSpaceMode="onEnterOrSpace",Ds.OnApiMode="onApi";var Wl,Ul,zl,ql,Gl,Yl,Kl,Xl,Jl,Ql,$l,Zl,nd,ed,td=function(n,e,t,r,c){var a=function(e,t,n,r,o){var i,u,c=n(e,t,r,o);return(i=c,u=t.event(),Y(i,function(n){return n.matches(u)}).map(function(n){return n.classification})).bind(function(n){return n(e,t,r,o)})},o={schema:function(){return n.concat([wr("focusManager",Vl()),xr("focusInside","onFocus",tr(function(n){return L(["onFocus","onEnterOrSpace","onApi"],n)?Fe.value(n):Fe.error("Invalid value for focusInside")})),Au("handler",o),Au("state",e),Au("sendFocusIn",c)])},processKey:a,toEvents:function(i,u){var n=i.focusInside!==Ms.OnFocusMode?ln.none():c(i).map(function(t){return fo(Vr(),function(n,e){t(n,i,u),e.stop()})});return so(n.toArray().concat([fo(Br(),function(r,o){a(r,o,t,i,u).fold(function(){var e,t,n;e=r,t=o,n=xl([32].concat([13]))(t.event()),i.focusInside===Ms.OnEnterOrSpaceMode&&n&&kr(e,t)&&c(i).each(function(n){n(e,i,u),t.stop()})},function(n){o.stop()})}),fo(Ir(),function(n,e){a(n,e,r,i,u).each(function(n){e.stop()})})]))}};return o},rd=function(n){var e=[hr("onEscape"),hr("onEnter"),wr("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),wr("firstTabstop",0),wr("useTabstopAt",sn(!0)),hr("visibilitySelector")].concat([n]),c=function(n,e){var t,r=n.visibilitySelector.bind(function(n){return oi(e,n)}).getOr(e);return t=r,0<Uc.get(t)},t=function(e,t,n){var r,o,i,u;(r=e,o=t,i=rt(r.element(),o.selector),u=z(i,function(n){return c(o,n)}),ln.from(u[o.firstTabstop])).each(function(n){t.focusManager.set(e,n)})},a=function(e,n,t,r,o){return o(n,t,function(n){return c(e=r,t=n)&&e.useTabstopAt(t);var e,t}).fold(function(){return r.cyclic?ln.some(!0):ln.none()},function(n){return r.focusManager.set(e,n),ln.some(!0)})},o=function(e,n,t,r){var o,i,u=rt(e.element(),t.selector);return(o=e,i=t,i.focusManager.get(o).bind(function(n){return oi(n,i.selector)})).bind(function(n){return K(u,g(ce,n)).bind(function(n){return a(e,u,n,t,r)})})},r=sn([kl(Ol([Sl,xl([9])]),function(n,e,t){var r=t.cyclic?bl:yl;return o(n,0,t,r)}),kl(xl([9]),function(n,e,t){var r=t.cyclic?_l:wl;return o(n,0,t,r)}),kl(xl([27]),function(e,t,n){return n.onEscape.bind(function(n){return n(e,t)})}),kl(Ol([Cl,xl([13])]),function(e,t,n){return n.onEnter.bind(function(n){return n(e,t)})})]),i=sn([]);return td(e,Sr.init,r,i,function(){return ln.some(t)})},od=rd(Or("cyclic",sn(!1))),id=rd(Or("cyclic",sn(!0))),ud=function(n){return"input"===Pe(n)&&"radio"!==ze(n,"type")||"textarea"===Pe(n)},cd=function(n,e,t){return ud(t)&&xl([32])(e.event())?ln.none():(co(n,t,qr()),ln.some(!0))},ad=function(n,e){return ln.some(!0)},sd=[wr("execute",cd),wr("useSpace",!1),wr("useEnter",!0),wr("useControlEnter",!1),wr("useDown",!1)],fd=function(n,e,t){return t.execute(n,e,n.element())},ld=td(sd,Sr.init,function(n,e,t,r){var o=t.useSpace&&!ud(n.element())?[32]:[],i=t.useEnter?[13]:[],u=t.useDown?[40]:[],c=o.concat(i).concat(u);return[kl(xl(c),fd)].concat(t.useControlEnter?[kl(Ol([El,xl([13])]),fd)]:[])},function(n,e,t,r){return t.useSpace&&!ud(n.element())?[kl(xl([32]),ad)]:[]},function(){return ln.none()}),dd=function(){var t=kn(ln.none());return Er({readState:function(){return t.get().map(function(n){return{numRows:String(n.numRows()),numColumns:String(n.numColumns())}}).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(n,e){t.set(ln.some({numRows:sn(n),numColumns:sn(e)}))},getNumRows:function(){return t.get().map(function(n){return n.numRows()})},getNumColumns:function(){return t.get().map(function(n){return n.numColumns()})}})},md=Object.freeze({__proto__:null,flatgrid:dd,init:function(n){return n.state(n)}}),gd=function(i){return function(n,e,t,r){var o=i(n.element());return bd(o,n,e,t,r)}},pd=function(n,e){var t=us(n,e);return gd(t)},vd=function(n,e){var t=us(e,n);return gd(t)},hd=function(o){return function(n,e,t,r){return bd(o,n,e,t,r)}},bd=function(e,t,n,r,o){return r.focusManager.get(t).bind(function(n){return e(t.element(),n,r,o)}).map(function(n){return r.focusManager.set(t,n),!0})},yd=hd,_d=hd,wd=hd,xd=function(n,e,t){var r,o=rt(n,t),i=z(o,xf);return K(r=i,function(n){return ce(n,e)}).map(function(n){return{index:sn(n),candidates:sn(r)}})},Od=function(n,e){return K(n,function(n){return ce(e,n)})},Sd=function(t,n,r,e){return e(Math.floor(n/r),n%r).bind(function(n){var e=n.row()*r+n.column();return 0<=e&&e<t.length?ln.some(t[e]):ln.none()})},Ed=function(o,n,i,u,c){return Sd(o,n,u,function(n,e){var t=n===i-1?o.length-n*u:u,r=Oa(e,c,0,t-1);return ln.some({row:sn(n),column:sn(r)})})},Cd=function(i,n,u,c,a){return Sd(i,n,c,function(n,e){var t=Oa(n,a,0,u-1),r=t===u-1?i.length-t*c:c,o=Sa(e,0,r-1);return ln.some({row:sn(t),column:sn(o)})})},kd=[mr("selector"),wr("execute",cd),Mu("onEscape"),wr("captureTab",!1),Ru()],Td=function(e,t,n){ri(e.element(),t.selector).each(function(n){t.focusManager.set(e,n)})},Md=function(o){return function(n,e,t,r){return xd(n,e,t.selector).bind(function(n){return o(n.candidates(),n.index(),r.getNumRows().getOr(t.initSize.numRows),r.getNumColumns().getOr(t.initSize.numColumns))})}},Dd=function(n,e,t){return t.captureTab?ln.some(!0):ln.none()},Nd=Md(function(n,e,t,r){return Ed(n,e,t,r,-1)}),Ad=Md(function(n,e,t,r){return Ed(n,e,t,r,1)}),Fd=Md(function(n,e,t,r){return Cd(n,e,t,r,-1)}),Rd=Md(function(n,e,t,r){return Cd(n,e,t,r,1)}),Bd=sn([kl(xl([37]),pd(Nd,Ad)),kl(xl([39]),vd(Nd,Ad)),kl(xl([38]),yd(Fd)),kl(xl([40]),_d(Rd)),kl(Ol([Sl,xl([9])]),Dd),kl(Ol([Cl,xl([9])]),Dd),kl(xl([27]),function(n,e,t){return t.onEscape(n,e)}),kl(xl([32].concat([13])),function(e,t,r,n){return(o=e,i=r,i.focusManager.get(o).bind(function(n){return oi(n,i.selector)})).bind(function(n){return r.execute(e,t,n)});var o,i})]),Id=sn([kl(xl([32]),ad)]),Hd=td(kd,dd,Bd,Id,function(){return ln.some(Td)}),Pd=function(n,e,t,i){var u=function(n,e,t){var r,o=Oa(e,i,0,t.length-1);return o===n?ln.none():(r=t[o],"button"===Pe(r)&&"disabled"===ze(r,"disabled")?u(n,o,t):ln.from(t[o]))};return xd(n,t,e).bind(function(n){var e=n.index(),t=n.candidates();return u(e,e,t)})},jd=[mr("selector"),wr("getInitial",ln.none),wr("execute",cd),Mu("onEscape"),wr("executeOnMove",!1),wr("allowVertical",!0)],Ld=function(e,t,r){return(n=e,o=r,o.focusManager.get(n).bind(function(n){return oi(n,o.selector)})).bind(function(n){return r.execute(e,t,n)});var n,o},Vd=function(e,t,n){t.getInitial(e).orThunk(function(){return ri(e.element(),t.selector)}).each(function(n){t.focusManager.set(e,n)})},Wd=function(n,e,t){return Pd(n,t.selector,e,-1)},Ud=function(n,e,t){return Pd(n,t.selector,e,1)},zd=function(o){return function(n,e,t,r){return o(n,e,t,r).bind(function(){return t.executeOnMove?Ld(n,e,t):ln.some(!0)})}},qd=function(n,e,t){return t.onEscape(n,e)},Gd=sn([kl(xl([32]),ad)]),Yd=td(jd,Sr.init,function(n,e,t,r){var o=[37].concat(t.allowVertical?[38]:[]),i=[39].concat(t.allowVertical?[40]:[]);return[kl(xl(o),zd(pd(Wd,Ud))),kl(xl(i),zd(vd(Wd,Ud))),kl(xl([13]),Ld),kl(xl([32]),Ld),kl(xl([27]),qd)]},Gd,function(){return ln.some(Vd)}),Kd=yn(["rowIndex","columnIndex","cell"],[]),Xd=function(n,e,t){return ln.from(n[e]).bind(function(n){return ln.from(n[t]).map(function(n){return Kd({rowIndex:e,columnIndex:t,cell:n})})})},Jd=function(n,e,t,r){var o=n[e].length,i=Oa(t,r,0,o-1);return Xd(n,e,i)},Qd=function(n,e,t,r){var o=Oa(t,r,0,n.length-1),i=n[o].length,u=Sa(e,0,i-1);return Xd(n,o,u)},$d=function(n,e,t,r){var o=n[e].length,i=Sa(t+r,0,o-1);return Xd(n,e,i)},Zd=function(n,e,t,r){var o=Sa(t+r,0,n.length-1),i=n[o].length,u=Sa(e,0,i-1);return Xd(n,o,u)},nm=[vr("selectors",[mr("row"),mr("cell")]),wr("cycles",!0),wr("previousSelector",ln.none),wr("execute",cd)],em=function(e,t,n){t.previousSelector(e).orThunk(function(){var n=t.selectors;return ri(e.element(),n.cell)}).each(function(n){t.focusManager.set(e,n)})},tm=function(n,e){return function(t,r,i){var u=i.cycles?n:e;return oi(r,i.selectors.row).bind(function(n){var e=rt(n,i.selectors.cell);return Od(e,r).bind(function(r){var o=rt(t,i.selectors.row);return Od(o,n).bind(function(n){var e,t=(e=i,W(o,function(n){return rt(n,e.selectors.cell)}));return u(t,n,r).map(function(n){return n.cell()})})})})}},rm=tm(function(n,e,t){return Jd(n,e,t,-1)},function(n,e,t){return $d(n,e,t,-1)}),om=tm(function(n,e,t){return Jd(n,e,t,1)},function(n,e,t){return $d(n,e,t,1)}),im=tm(function(n,e,t){return Qd(n,t,e,-1)},function(n,e,t){return Zd(n,t,e,-1)}),um=tm(function(n,e,t){return Qd(n,t,e,1)},function(n,e,t){return Zd(n,t,e,1)}),cm=sn([kl(xl([37]),pd(rm,om)),kl(xl([39]),vd(rm,om)),kl(xl([38]),yd(im)),kl(xl([40]),_d(um)),kl(xl([32].concat([13])),function(e,t,r){return jo(e.element()).bind(function(n){return r.execute(e,t,n)})})]),am=sn([kl(xl([32]),ad)]),sm=td(nm,Sr.init,cm,am,function(){return ln.some(em)}),fm=[mr("selector"),wr("execute",cd),wr("moveOnTab",!1)],lm=function(e,t,r){return r.focusManager.get(e).bind(function(n){return r.execute(e,t,n)})},dm=function(e,t,n){ri(e.element(),t.selector).each(function(n){t.focusManager.set(e,n)})},mm=function(n,e,t){return Pd(n,t.selector,e,-1)},gm=function(n,e,t){return Pd(n,t.selector,e,1)},pm=sn([kl(xl([38]),wd(mm)),kl(xl([40]),wd(gm)),kl(Ol([Sl,xl([9])]),function(n,e,t,r){return t.moveOnTab?wd(mm)(n,e,t,r):ln.none()}),kl(Ol([Cl,xl([9])]),function(n,e,t,r){return t.moveOnTab?wd(gm)(n,e,t,r):ln.none()}),kl(xl([13]),lm),kl(xl([32]),lm)]),vm=sn([kl(xl([32]),ad)]),hm=td(fm,Sr.init,pm,vm,function(){return ln.some(dm)}),bm=[Mu("onSpace"),Mu("onEnter"),Mu("onShiftEnter"),Mu("onLeft"),Mu("onRight"),Mu("onTab"),Mu("onShiftTab"),Mu("onUp"),Mu("onDown"),Mu("onEscape"),wr("stopSpaceKeyup",!1),hr("focusIn")],ym=td(bm,Sr.init,function(n,e,t){return[kl(xl([32]),t.onSpace),kl(Ol([Cl,xl([13])]),t.onEnter),kl(Ol([Sl,xl([13])]),t.onShiftEnter),kl(Ol([Sl,xl([9])]),t.onShiftTab),kl(Ol([Cl,xl([9])]),t.onTab),kl(xl([38]),t.onUp),kl(xl([40]),t.onDown),kl(xl([37]),t.onLeft),kl(xl([39]),t.onRight),kl(xl([32]),t.onSpace),kl(xl([27]),t.onEscape)]},function(n,e,t){return t.stopSpaceKeyup?[kl(xl([32]),ad)]:[]},function(n){return n.focusIn}),_m=od.schema(),wm=id.schema(),xm=Yd.schema(),Om=Hd.schema(),Sm=sm.schema(),Em=ld.schema(),Cm=hm.schema(),km=ym.schema(),Tm=(Ql=ur("Creating behaviour: "+(Wl={branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:_m,cyclic:wm,flow:xm,flatgrid:Om,matrix:Sm,execution:Em,menu:Cm,special:km}),name:"keying",active:{events:function(n,e){return n.handler.toEvents(n,e)}},apis:{focusIn:function(e,t,r){t.sendFocusIn(t).fold(function(){e.getSystem().triggerFocus(e.element(),e.element())},function(n){n(e,t,r)})},setGridSize:function(n,e,t,r,o){vn(t,"setGridSize")?t.setGridSize(r,o):b.console.error("Layout does not support setGridSize")}},state:md}).name,To,Wl),Ul=ar(Ql.branchKey,Ql.branches),zl=Ql.name,ql=Ql.active,Gl=Ql.apis,Yl=Ql.extra,Kl=Ql.state,Jl=yr(zl,[br("config",Xl=Ul)]),So(Xl,Jl,zl,ql,Gl,Yl,Kl)),Mm=wc({name:"Button",factory:function(n){var e=hl(n.action),t=n.dom.tag,r=function(e){return gn(n.dom,"attributes").bind(function(n){return gn(n,e)})};return{uid:n.uid,dom:n.dom,components:n.components,events:e,behaviours:wu(n.buttonBehaviours,[Df.config({}),Tm.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"!==t)return{role:r("role").getOr("button")};var n=r("type").getOr("button"),e=r("role").map(function(n){return{role:n}}).getOr({});return xn({type:n},e)}()},eventOrder:n.eventOrder}},configFields:[wr("uid",void 0),mr("dom"),wr("components",[]),_u("buttonBehaviours",[Df,Tm]),hr("action"),hr("role"),wr("eventOrder",{})]}),Dm=["input","button","textarea","select"],Nm=function(n,e,t){e.disabled&&Hm(n,e)},Am=function(n,e){return!0===e.useNative&&L(Dm,Pe(n.element()))},Fm=function(n){Ue(n.element(),"disabled","disabled")},Rm=function(n){Ge(n.element(),"disabled")},Bm=function(n){Ue(n.element(),"aria-disabled","true")},Im=function(n){Ue(n.element(),"aria-disabled","false")},Hm=function(e,n,t){n.disableClass.each(function(n){Qe(e.element(),n)}),(Am(e,n)?Fm:Bm)(e),n.onDisabled(e)},Pm=function(e,n,t){n.disableClass.each(function(n){Ze(e.element(),n)}),(Am(e,n)?Rm:Im)(e),n.onEnabled(e)},jm=function(n,e){return Am(n,e)?qe(n.element(),"disabled"):"true"===ze(n.element(),"aria-disabled")},Lm=Object.freeze({__proto__:null,enable:Pm,disable:Hm,isDisabled:jm,onLoad:Nm,set:function(n,e,t,r){(r?Hm:Pm)(n,e)}}),Vm=Object.freeze({__proto__:null,exhibit:function(n,e){return _o({classes:e.disabled?e.disableClass.map(nn).getOr([]):[]})},events:function(t,n){return so([(e=qr(),r=function(n,e){return jm(n,t)},{key:e,value:Tr({abort:r})}),wo(t,n,Nm)]);var e,r}}),Wm=[wr("disabled",!1),wr("useNative",!0),hr("disableClass"),Tu("onDisabled"),Tu("onEnabled")],Um=ko({fields:Wm,name:"disabling",active:Vm,apis:Lm}),zm=Object.freeze({__proto__:null,events:function(a){return so([fo(zr(),function(o,n){var e,t,i=a.channels,r=on(i),u=n,c=(e=r,(t=u).universal()?e:z(e,function(n){return L(t.channels(),n)}));U(c,function(n){var e=i[n],t=e.schema,r=ur("channel["+n+"] data\nReceiver: "+Yo(o.element()),t,u.data());e.onReceive(o,r)})})])}}),qm=[gr("channels",rr(Fe.value,Yt([Du("onReceive"),wr("schema",sr())])))],Gm=ko({fields:qm,name:"receiving",active:zm}),Ym="comments.readonly",Km=function(n){return Um.config(n)},Xm=function(){var n,e;return Gm.config({channels:(n={},n[Ym]={schema:Yt([(e="readonly",gr(e,lr))]),onReceive:function(n,e){Um.set(n,e.readonly)}},n)})},Jm=function(n){return[Km(n),Xm()]},Qm=Ym,$m="tox-button--naked",Zm="tox-comment",ng="tox-comment__body",eg="tox-textarea",tg="tox-comment__reply",rg="tox-comment__overlay",og="tox-comment__overlaytext",ig="tox-comment__buttonspacing",ug="tox-button",cg="tox-comment__edit",ag="tox-comment__scroll",sg="tox-collection__item",fg="tox-conversations",lg="tox-comment__expander",dg=lg+" p:contains("+rl.tc_comment_buttons_showmore+")",mg=lg+" p:contains("+rl.tc_comment_buttons_showless+")",gg=function(n){return"."+n},pg=function(e){return function(n){return[gg(Zm)+":contains("+n+")",gg(e)].join(" ")}},vg={selectors:{kebab:gg($m),cardBody:gg(Zm)+" "+gg(ng),card:gg(Zm),showMore:gg(dg),showLess:gg(mg),editItem:[".tox-menu",'[role="menuitem"]:contains('+rl.tc_kebab_edit+")"].join(" "),deleteItem:[".tox-menu",'[role="menuitem"]:contains('+rl.tc_kebab_delete+")"].join(" "),outerScroll:gg(ag),outerContainer:gg(fg),cardFor:function(n){return gg(Zm)+':contains("'+n+'")'},cardN:function(n){return gg(Zm)+":nth-child("+(n+1)+")"},kebabFor:pg($m),showMoreFor:pg(dg),showLessFor:pg(mg),saveButton:".tox-button:contains("+rl.tc_edit_buttons_save+")",cancelButton:".tox-button:contains("+rl.tc_edit_buttons_cancel+")",clearButton:".tox-button:contains("+rl.tc_reply_buttons_clear+")",deleteButton:".tox-button:contains("+rl.tc_delete_buttons_proceed+")",commentText:[gg(fg),gg(ag),gg(Zm),"textarea"].join(" "),editActions:gg(cg),cardDeleteButtons:gg(ig),cardDeleteOverlay:gg(rg),cardDeleteOverlayText:gg(og),replyTextarea:"."+tg+" textarea",editTextarea:[gg(Zm),"textarea"].join(" "),kebabMenu:gg("tox-menu"),textarea:gg(eg)},states:{kebabOpen:$m+"--open",bodyExpanded:"tox-comment__body--expanded",bodyNotAnimating:"tox-comment__body--pending",disappearing:"tox-comment--disappearing",deletingConversation:"tox-comment-thread__overlay",bodyHasGradient:"tox-comment__gradient",editingTextarea:eg},classes:{showMoreLessContainer:[lg],outerContainer:[fg],date:["tox-comment__date"],replySection:[tg],replyTextarea:[eg],textarea:[],editTextarea:[],kebab:[$m,ug,"tox-button--icon"],kebabIcon:["tox-icon"],card:[Zm],cardHead:["tox-comment__header"],cardHeadMeta:["tox-comment__meta"],cardBody:[ng],cardDelete:[rg],cardDeleteLabel:[og],cardDeleteButtons:[ig],button:[ug],secondaryButton:[ug,"tox-button--secondary"],editActions:[cg],outerScroll:[ag],commentList:["tox-comment-thread"],avatar:["tox-user__avatar"],username:["tox-user__name"],user:["tox-user"],showMoreLess:[],kebabItem:[sg],kebabItemLabel:["tox-collection__item-label"],kebabDisabledItem:["tox-collection__item--state-disabled"],kebabMenu:["tox-menu","tox-collection","tox-collection--list"],kebabMenuGroup:["tox-collection__group"],roots:{silver:[fg],modern:[fg,"tox"]}},markers:{kebab:{backgroundMenu:"tox-menu--background",selectedMenu:"tox-menu--active",menu:"tox-menu",item:sg,selectedItem:"tox-collection__item--active"}}},hg=function(t){return function(n){var e=n.eventName.map(function(e){return{action:function(n){oo(n,e)}}}).getOr({});return Mm.sketch(xn(xn({dom:{tag:"button",classes:t,styles:void 0!==n.styles?n.styles:{},innerHtml:n.text}},e),{buttonBehaviours:Eo(Sn([Gf.config({})],Jm({})))}))}},bg=hg(vg.classes.button),yg=hg(vg.classes.secondaryButton),_g={withClasses:hg,primary:bg,secondary:yg},wg="tc-save-edit",xg="tc-cancel-edit",Og=bi("tc-patch-comment-state-event"),Sg=bi("tc-purge-comment-state-event"),Eg=bi("tc-force-patch-state-event");(Zl=$l||($l={})).None="Prop_None",Zl.Collapsed="Prop_Collapsed",Zl.Expanded="Prop_Expanded",Zl.CollapsedOrNone="Prop_CollapsedOrNone",Zl.ExpandOrNone="Prop_ExpandOrNone",Zl.Edit="Prop_Edit",(ed=nd||(nd={}))[ed.BeforeDelete=0]="BeforeDelete",ed[ed.QueryingDelete=1]="QueryingDelete",ed[ed.PostDelete=2]="PostDelete";var Cg,kg,Tg=function(n){return W(n.conversation,function(n){return n.props})},Mg=function(n,e){return xn(xn({},n),{targetUid:e})},Dg=function(n,e){return xn(xn({},n),{queue:n.queue.concat(e)})},Ng=function(n){if(0<n.queue.length){var e=(t=W((r=n).conversation,function(t){return Y(r.queue,function(n){return n.uid===t.uid}).fold(function(){return t},function(n){var e=void 0!==n.patch.content?{mode:$l.ExpandOrNone}:{};return{uid:t.uid,props:xn(xn(xn({},t.props),n.patch),e)}})}),{targetUid:r.targetUid,conversation:t,queue:[]});return ln.some({world:e,props:Tg(e)})}return ln.none();var r,t},Ag=function(){return{targetUid:ln.none(),conversation:[],queue:[]}},Fg=function(t,r){return function(n){var e=r(n);io(n,Og,{uid:t,patch:e})}},Rg=function(t,r){return function(n){var e=r(n);io(n,Og,{uid:t,patch:e}),oo(n,Eg)}},Bg=function(n){return oo(n,Eg)},Ig=function(n,e){Zi(n.element(),"visibility","hidden"),pl.set(n,!1);var t=n.element().dom().clientHeight;return pl.set(n,!0),ou(n.element(),"visibility"),n.element().dom().scrollHeight>t+1?e:$l.None},Hg=function(n){pl.off(n),Qe(n.element(),vg.states.bodyHasGradient)},Pg=function(n){pl.on(n),Ze(n.element(),vg.states.bodyHasGradient)},jg=function(n){return me(n.element())},Lg=function(n,e){Wg(n),e.getOpt(n).fold(function(){wf.append(n,e.asSpec())},function(){})},Vg=function(n){Ze(n.element(),vg.states.bodyHasGradient),pl.set(n,!1),Ge(n.element(),"aria-expanded")},Wg=function(n){jg(n).each(function(n){Ge(n,"readonly"),Qe(n,vg.states.editingTextarea),Ho(n);var e=n.dom(),t=iu(n).length;e.setSelectionRange(t,t)}),n.element().dom().scrollTop=0},Ug=function(n){jg(n).each(function(n){Ue(n,"readonly","true"),Ze(n,vg.states.editingTextarea)})},zg=function(r){var n,e=function(n){return function(e){U(n,function(n){return n(e)})}},t=function(e){jg(e).each(function(n){ou(n,"height"),Uf.setValue(e,r.props.content),e.getSystem().triggerEvent(Hr(),n,{})})},o=function(n){return e=n,t=r.memCommands,Ug(e),void t.getOpt(e).each(function(n){wf.remove(e,n)});var e,t},i=((n={})[$l.None]=e([o,t,Vg]),n[$l.Expanded]=e([o,t,Pg]),n[$l.Collapsed]=e([o,t,Hg]),n[$l.ExpandOrNone]=e([o,t,function(n){Qe(n.element(),vg.states.bodyNotAnimating);var e=Ig(n,$l.Expanded);Fg(r.props.uid,function(){return{mode:e}})(n)}]),n[$l.CollapsedOrNone]=e([o,t,function(n){Qe(n.element(),vg.states.bodyNotAnimating);var e=Ig(n,$l.Collapsed);e===$l.Collapsed&&(Qe(n.element(),vg.states.bodyHasGradient),pl.off(n)),n.element().dom().offsetWidth,Fg(r.props.uid,function(){return{mode:e}})(n)}]),n[$l.Edit]=e([function(n){return e=n,t=r.memCommands,pl.on(e),Ze(e.element(),vg.states.bodyHasGradient),void Lg(e,t);var e,t},t]),n);return gn(i,r.props.mode)},qg=bi("tc-focus-outer-comment"),Gg=bi("tc-start-delete-comment"),Yg=bi("tc-start-delete-conversation"),Kg=bi("tc-commit-delete"),Xg=bi("tc-start-edit-comment"),Jg=bi("tc-commit-edit-comment"),Qg=(bi("tc-cancel-edit-comment"),bi("tc-long-content"),bi("tc-short-content"),bi("tc-toggle-comment")),$g=sn([hr("data"),wr("inputAttributes",{}),wr("inputStyles",{}),wr("tag","input"),wr("inputClasses",[]),Tu("onSetValue"),wr("styles",{}),wr("eventOrder",{}),hu("inputBehaviours",[Uf,Df]),wr("selectOnFocus",!0)]),Zg=function(n){return xn(xn({},(e=n,Eo([Df.config({onFocus:e.selectOnFocus?function(n){var e=n.element(),t=iu(e);e.dom().setSelectionRange(0,t.length)}:_})]))),yu(n.inputBehaviours,[Uf.config({store:xn(xn({mode:"manual"},n.data.map(function(n){return{initialValue:n}}).getOr({})),{getValue:function(n){return iu(n.element())},setValue:function(n,e){iu(n.element())!==e&&uu(n.element(),e)}}),onSetValue:n.onSetValue})]));var e},np=wc({name:"Input",configFields:$g(),factory:function(n,e){return{uid:n.uid,dom:(t=n,{tag:t.tag,attributes:xn({type:"text"},t.inputAttributes),styles:t.inputStyles,classes:t.inputClasses}),components:[],behaviours:Zg(n),eventOrder:n.eventOrder};var t}}),ep="data-alloy-widget-tabstop",tp=function(n){return Tm.config({mode:"cyclic",onEscape:n.onEscape,useTabstopAt:function(n){return"textarea"!==Pe(n)||"true"!==ze(n,"readonly")}})},rp=function(e){return Tm.config({mode:"special",onEnter:function(n){return oo(n,e.enterEvent),ln.some(!0)},onShiftEnter:function(n,e){return e.cut(),ln.none()},onSpace:function(n,e){return e.cut(),ln.none()}})},op=function(t){return Tm.config({mode:"cyclic",selector:"["+ep+'="true"]',focusInside:Ms.OnEnterOrSpaceMode,onEscape:function(n,e){return kr(n,e)?ln.none():(oo(n,t.escapeEvent),ln.some(!0))}})},ip=function(n){return Tm.config({mode:"flow",allowVertical:!0,selector:n.selector})},up=ep,cp={"data-gramm_editor":"false",rows:"2"},ap={"white-space":"pre-wrap"},sp=function(n){var e=n.element().dom().clientHeight,t=n.element().dom().scrollHeight;e<t&&Zi(n.element(),"height",t+"px")},fp=function(n,e){var t,r,o=kn(n),i=function(n){oo(n,qg),Rg(o.get().uid,function(n){return{mode:$l.ExpandOrNone}})(n)},u={updateWith:function(e,n,t){o.set(n),zg({props:n,memCommands:c}).each(function(n){Ze(e.element(),vg.states.bodyNotAnimating),n(e)})}},c=Fc((o.get(),t=e,{dom:{tag:"div",classes:vg.classes.editActions},components:[_g.withClasses(vg.classes.secondaryButton)({text:t.translate(rl.tc_edit_buttons_cancel),eventName:ln.some(xg)}),_g.withClasses(vg.classes.button)({text:t.translate(rl.tc_edit_buttons_save),eventName:ln.some(wg)})]}));return{dom:{tag:"div",classes:vg.classes.cardBody},components:[(r=o.get().content,np.sketch({tag:"textarea",inputAttributes:xn(xn({},cp),{readonly:"true"}),inputClasses:vg.classes.editTextarea,inputStyles:xn(xn({},ap),{"overflow-y":"hidden",border:"none !important"}),data:r,inputBehaviours:Eo(Sn([Do("textarea-events",[go(function(n){sp(n)}),fo(Hr(),sp)]),rp({enterEvent:Jg}),Gf.config({})],Jm({})))}))],behaviours:Eo([Do("overflow-events",[go(function(n){u.updateWith(n,o.get(),{})}),fo(wg,function(n){oo(n,Jg)}),fo(xg,i)]),tp({onEscape:function(n,e){return i(n),ln.some(!0)}}),pl.config({toggleClass:vg.states.bodyExpanded,selected:!1,toggleOnExecute:!1,aria:{mode:"expanded"}}),Uf.config({store:{mode:"manual",getValue:function(n){return me(n.element()).map(iu).getOr("")},setValue:function(n,e){me(n.element()).each(function(n){uu(n,e)})}}}),wf.config({})]),apis:u}},lp=6048e5,dp=4*lp;(kg=Cg||(Cg={}))[kg.LessThanMinute=0]="LessThanMinute",kg[kg.Minute=1]="Minute",kg[kg.Hour=2]="Hour",kg[kg.Day=3]="Day",kg[kg.Week=4]="Week",kg[kg.Month=5]="Month",kg[kg.Year=6]="Year";var mp,gp,pp,vp=function(n,e){var t=n()-Date.parse(e);return t<6e4?{interval:Cg.LessThanMinute,intervalUnits:t,intervalMs:t}:t<36e5?{interval:Cg.Minute,intervalUnits:Math.floor(t/6e4),intervalMs:t}:t<864e5?{interval:Cg.Hour,intervalUnits:Math.floor(t/36e5),intervalMs:t}:t<lp?{interval:Cg.Day,intervalUnits:Math.floor(t/864e5),intervalMs:t}:t<dp?{interval:Cg.Week,intervalUnits:Math.floor(t/lp),intervalMs:t}:t<290304e5?{interval:Cg.Month,intervalUnits:Math.floor(t/dp),intervalMs:t}:{interval:Cg.Year,intervalUnits:Math.floor(t/290304e5),intervalMs:t}},hp={nowISO8601:function(){return(new Date).toISOString()},distanceFromNow:g(vp,function(){return Date.now()}),distanceFrom:vp},bp=((mp={})[Cg.LessThanMinute]=[rl.tc_date_less_than_a_minute_ago,rl.tc_date_less_than_a_minute_ago],mp[Cg.Minute]=[rl.tc_date_1_minute_ago,rl.tc_date_x_minutes_ago],mp[Cg.Hour]=[rl.tc_date_1_hour_ago,rl.tc_date_x_hours_ago],mp[Cg.Day]=[rl.tc_date_1_day_ago,rl.tc_date_x_days_ago],mp[Cg.Week]=[rl.tc_date_1_week_ago,rl.tc_date_x_weeks_ago],mp[Cg.Month]=[rl.tc_date_1_month_ago,rl.tc_date_x_months_ago],mp[Cg.Year]=[rl.tc_date_1_year_ago,rl.tc_date_x_years_ago],mp),yp=function(n,c){var r=function(n){return[(e=""+(r=hp.distanceFromNow(n.createdAt),o=c,i=bp[r.interval],u=1===r.intervalUnits?i[0]:i[1],o.translate([u,r.intervalUnits])),t=w.fromText(e),mu({element:t})),{dom:{tag:"span",classes:[],innerHtml:n.modifiedAt===n.createdAt?"":c.translate(rl.tc_date_comment_edited)}}];var e,t,r,o,i,u},e={updateWith:function(n,e,t){wf.set(n,r(e))}};return{dom:{tag:"div",classes:vg.classes.date},components:r(n),behaviours:Eo([wf.config({})]),apis:e}},_p={editCommentEvent:bi("tc-conversation-edit-comment"),deleteCommentEvent:bi("tc-conversation-delete-comment"),deleteConversationEvent:bi("tc-conversation-delete-all"),createCommentEvent:bi("tc-conversation-create")},wp=function(n){var e,t,r,o=w.fromHtml(n),i=le(o),u=(t=void 0!==(e=o).dom().attributes?e.dom().attributes:[],G(t,function(n,e){var t;return"class"===e.name?n:xn(xn({},n),((t={})[e.name]=e.value,t))},{})),c=(r=o,Array.prototype.slice.call(r.dom().classList,0)),a=0===i.length?{}:{innerHtml:Uo(o)};return xn({tag:Pe(o),classes:c,attributes:u},a)},xp=[Gf.config({}),Do("overlay-button-events",[fo(Fr(),function(n,e){e.event().prevent()})])],Op=function(n,e,t){t?(ou(e.element(),"display"),e.hasConfigured(Tm)&&Tm.focusIn(e)):Zi(e.element(),"display","none")},Sp=function(e,n){return(t=n,Bo(t,function(n){if(!Le(n))return!1;var e=ze(n,"id");return void 0!==e&&-1<e.indexOf("aria-owns")}).bind(function(n){var e=ze(n,"id"),t=ae(n);return ri(t,'[aria-owns="'+e+'"]')})).exists(function(n){return Ep(e,n)});var t},Ep=function(e,n){return Io(n,function(n){return ce(n,e.element())},sn(!1))||Sp(e,n)},Cp=Object.freeze({__proto__:null,getCoupled:function(n,e,t,r){return t.getOrCreate(n,e,r)}}),kp=[gr("others",rr(Fe.value,sr()))],Tp=ko({fields:kp,name:"coupling",apis:Cp,state:Object.freeze({__proto__:null,init:function(){var i={},n=sn({});return Er({readState:n,getOrCreate:function(t,r,o){var n=on(r.others);if(n)return gn(i,o).getOrThunk(function(){var n=gn(r.others,o).getOrDie("No information found for coupled component: "+o)(t),e=t.getSystem().build(n);return i[o]=e});throw new Error("Cannot find coupled component: "+o+". Known coupled components: "+JSON.stringify(n,null,2))}})}})}),Mp=function(e,n,t,r){t.get().each(function(n){Nc(e)});var o=n.getAttachPoint(e);kc(o,e);var i=e.getSystem().build(r);return kc(e,i),t.set(i),i},Dp=function(n,e,t,r){var o=Mp(n,e,t,r);return e.onOpen(n,o),o},Np=function(e,t,r){r.get().each(function(n){Nc(e),Dc(e),t.onClose(e,n),r.clear()})},Ap=function(n,e,t){return t.isOpen()},Fp=function(n,e,t){var r,o,i,u,c=e.getAttachPoint(n);Zi(n.element(),"position",vf.getMode(c)),r=n,o="visibility",i=e.cloakVisibilityAttr,u="hidden",ru(r.element(),o).fold(function(){Ge(r.element(),i)},function(n){Ue(r.element(),i,n)}),Zi(r.element(),o,u)},Rp=function(n,e,t){var r;r=n.element(),V(["top","left","right","bottom"],function(n){return ru(r,n).isSome()})||ou(n.element(),"position"),function(n,e,t){if(qe(n.element(),t)){var r=ze(n.element(),t);Zi(n.element(),e,r)}else ou(n.element(),e)}(n,"visibility",e.cloakVisibilityAttr)},Bp=Object.freeze({__proto__:null,cloak:Fp,decloak:Rp,open:Dp,openWhileCloaked:function(n,e,t,r,o){Fp(n,e),Dp(n,e,t,r),o(),Rp(n,e)},close:Np,isOpen:Ap,isPartOf:function(e,t,n,r){return Ap(0,0,n)&&n.get().exists(function(n){return t.isPartOf(e,n,r)})},getState:function(n,e,t){return t.get()},setContent:function(n,e,t,r){return t.get().map(function(){return Mp(n,e,t,r)})}}),Ip=Object.freeze({__proto__:null,events:function(t,r){return so([fo(Xr(),function(n,e){Np(n,t,r)})])}}),Hp=[Tu("onOpen"),Tu("onClose"),mr("isPartOf"),mr("getAttachPoint"),wr("cloakVisibilityAttr","data-precloak-visibility")],Pp=ko({fields:Hp,name:"sandboxing",active:Ip,apis:Bp,state:Object.freeze({__proto__:null,init:function(){var e=kn(ln.none()),n=sn("not-implemented");return Er({readState:n,isOpen:function(){return e.get().isSome()},clear:function(){e.set(ln.none())},set:function(n){e.set(ln.some(n))},get:function(){return e.get()}})}})}),jp="alloy.item-hover",Lp="alloy.item-focus",Vp=function(n){(jo(n.element()).isNone()||Df.isFocused(n))&&(Df.isFocused(n)||Df.focus(n),io(n,jp,{item:n}))},Wp=function(n){io(n,Lp,{item:n})},Up=sn(jp),zp=sn(Lp),qp=[mr("data"),mr("components"),mr("dom"),wr("hasSubmenu",!1),hr("toggling"),_u("itemBehaviours",[pl,Df,Tm,Uf]),wr("ignoreFocus",!1),wr("domModification",{}),Au("builder",function(n){return{dom:n.dom,domModification:xn(xn({},n.domModification),{attributes:xn(xn(xn({role:n.toggling.isSome()?"menuitemcheckbox":"menuitem"},n.domModification.attributes),{"aria-haspopup":n.hasSubmenu}),n.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:wu(n.itemBehaviours,[n.toggling.fold(pl.revoke,function(n){return pl.config(xn({aria:{mode:"checked"}},n))}),Df.config({ignore:n.ignoreFocus,stopMousedown:n.ignoreFocus,onFocus:function(n){Wp(n)}}),Tm.config({mode:"execution"}),Uf.config({store:{mode:"memory",initialValue:n.data}}),Do("item-type-events",Sn(vl(),[fo(Rr(),Vp),fo(Gr(),Df.focus)]))]),components:n.components,eventOrder:n.eventOrder}}),wr("eventOrder",{})],Gp=[mr("dom"),mr("components"),Au("builder",function(n){return{dom:n.dom,components:n.components,events:so([(e=Gr(),fo(e,function(n,e){e.stop()}))])};var e})],Yp=sn([oc({name:"widget",overrides:function(e){return{behaviours:Eo([Uf.config({store:{mode:"manual",getValue:function(n){return e.data},setValue:function(){}}})])}}})]),Kp=[mr("uid"),mr("data"),mr("components"),mr("dom"),wr("autofocus",!1),wr("ignoreFocus",!1),_u("widgetBehaviours",[Uf,Df,Tm]),wr("domModification",{}),pc(Yp()),Au("builder",function(i){var n=dc(0,i,Yp()),e=mc("item-widget",i,n.internals()),t=function(n){return(e=n,t=i,r="widget",o=t.partUids[r],e.getSystem().getByUid(o).toOption()).map(function(n){return Tm.focusIn(n),n});var e,t,r,o},r=function(n,e){return ud(e.event().target())||i.autofocus&&e.setSource(n.element()),ln.none()};return{dom:i.dom,components:e,domModification:i.domModification,events:so([ho(function(n,e){t(n).each(function(n){e.stop()})}),fo(Rr(),Vp),fo(Gr(),function(n,e){i.autofocus?t(n):Df.focus(n)})]),behaviours:wu(i.widgetBehaviours,[Uf.config({store:{mode:"memory",initialValue:i.data}}),Df.config({ignore:i.ignoreFocus,onFocus:function(n){Wp(n)}}),Tm.config({mode:"special",focusIn:i.autofocus?function(n){t(n)}:Mo(),onLeft:r,onRight:r,onEscape:function(n,e){return Df.isFocused(n)||i.autofocus?(i.autofocus&&e.setSource(n.element()),ln.none()):(Df.focus(n),ln.some(!0))}})])}})],Xp=ar("type",{widget:Kp,item:qp,separator:Gp}),Jp=sn([cc({factory:{sketch:function(n){var e=ur("menu.spec item",Xp,n);return e.builder(e)}},name:"items",unit:"item",defaults:function(n,e){return e.hasOwnProperty("uid")?e:xn(xn({},e),{uid:Ei("item")})},overrides:function(n,e){return{type:e.type,ignoreFocus:n.fakeFocus,domModification:{classes:[n.markers.item]}}}})]),Qp=sn([mr("value"),mr("items"),mr("dom"),mr("components"),wr("eventOrder",{}),hu("menuBehaviours",[jl,Uf,Ef,Tm]),xr("movement",{mode:"menu",moveOnTab:!0},ar("mode",{grid:[Ru(),Au("config",function(n,e){return{mode:"flatgrid",selector:"."+n.markers.item,initSize:{numColumns:e.initSize.numColumns,numRows:e.initSize.numRows},focusManager:n.focusManager}})],matrix:[Au("config",function(n,e){return{mode:"matrix",selectors:{row:e.rowSelector,cell:"."+n.markers.item},focusManager:n.focusManager}}),mr("rowSelector")],menu:[wr("moveOnTab",!0),Au("config",function(n,e){return{mode:"menu",selector:"."+n.markers.item,moveOnTab:e.moveOnTab,focusManager:n.focusManager}})]})),gr("markers",Su()),wr("fakeFocus",!1),wr("focusManager",Vl()),Tu("onHighlight")]),$p=sn("alloy.menu-focus"),Zp=xc({name:"Menu",configFields:Qp(),partFields:Jp(),factory:function(n,e,t,r){return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:yu(n.menuBehaviours,[jl.config({highlightClass:n.markers.selectedItem,itemClass:n.markers.item,onHighlight:n.onHighlight}),Uf.config({store:{mode:"memory",initialValue:n.value}}),Ef.config({find:ln.some}),Tm.config(n.movement.config(n,n.movement))]),events:so([fo(zp(),function(e,t){var n=t.event();e.getSystem().getByDom(n.target()).each(function(n){jl.highlight(e,n),t.stop(),io(e,$p(),{menu:e,item:n})})}),fo(Up(),function(n,e){var t=e.event().item();jl.highlight(n,t)})]),components:e,eventOrder:n.eventOrder,domModification:{attributes:{role:"menu"}}}}}),nv=function(t,r,o,n){return gn(o,n).bind(function(n){return gn(t,n).bind(function(n){var e=nv(t,r,o,n);return ln.some([n].concat(e))})}).getOr([])},ev=function(n,e){var t={};cn(n,function(n,e){U(n,function(n){t[n]=e})});var r=e,o=dn(e,function(n,e){return{k:n,v:e}}),i=an(o,function(n,e){return[e].concat(nv(t,r,o,e))});return an(t,function(n){return gn(i,n).getOr([n])})},tv=function(n){return"prepared"===n.type?ln.some(n.menu):ln.none()},rv={init:function(){var i=kn({}),u=kn({}),c=kn({}),a=kn(ln.none()),s=kn({}),f=function(t){return function(n,e){for(var t=on(n),r=0,o=t.length;r<o;r++){var i=t[r],u=n[i];if(e(u,i,n))return ln.some(u)}return ln.none()}(i.get(),function(n,e){return n===t})},l=function(n){return e(n).bind(tv)},e=function(n){return gn(u.get(),n)},t=function(n){return gn(i.get(),n)};return{setMenuBuilt:function(n,e){var t;u.set(xn(xn({},u.get()),((t={})[n]={type:"prepared",menu:e},t)))},setContents:function(n,e,t,r){a.set(ln.some(n)),i.set(t),u.set(e),s.set(r);var o=ev(r,t);c.set(o)},expand:function(t){return gn(i.get(),t).map(function(n){var e=gn(c.get(),t).getOr([]);return[n].concat(e)})},refresh:function(n){return gn(c.get(),n)},collapse:function(n){return gn(c.get(),n).bind(function(n){return 1<n.length?ln.some(n.slice(1)):ln.none()})},lookupMenu:e,lookupItem:t,otherMenus:function(n){var e=s.get();return Z(on(e),n)},getPrimary:function(){return a.get().bind(l)},getMenus:function(){return u.get()},clear:function(){i.set({}),u.set({}),c.set({}),a.set(ln.none())},isClear:function(){return a.get().isNone()},getTriggeringPath:function(n,u){var e=z(t(n).toArray(),function(n){return l(n).isSome()});return gn(c.get(),n).bind(function(n){var i=$(e.concat(n));return function(n){for(var e=[],t=0;t<n.length;t++){var r=n[t];if(!r.isSome())return ln.none();e.push(r.getOrDie())}return ln.some(e)}(J(i,function(n,e){return(t=n,r=u,o=i.slice(0,e+1),l(t).bind(function(e){return f(t).bind(function(n){return r(n).map(function(n){return{triggeredMenu:e,triggeringItem:n,triggeringPath:o}})})})).fold(function(){return a.get().is(n)?[]:[ln.none()]},function(n){return[ln.some(n)]});var t,r,o}))})}}},extractPreparedMenu:tv},ov=sn("collapse-item"),iv=wc({name:"TieredMenu",configFields:[Nu("onExecute"),Nu("onEscape"),Du("onOpenMenu"),Du("onOpenSubmenu"),Tu("onRepositionMenu"),Tu("onCollapseMenu"),wr("highlightImmediately",!0),vr("data",[mr("primary"),mr("menus"),mr("expansions")]),wr("fakeFocus",!1),Tu("onHighlight"),Tu("onHover"),Cu(),mr("dom"),wr("navigateOnHover",!0),wr("stayInDom",!1),hu("tmenuBehaviours",[Tm,jl,Ef,wf]),wr("eventOrder",{})],apis:{collapseMenu:function(n,e){n.collapseMenu(e)},highlightPrimary:function(n,e){n.highlightPrimary(e)},repositionMenus:function(n,e){n.repositionMenus(e)}},factory:function(c,n){var a,e,i=kn(ln.none()),u=function(r,o,n){return an(n,function(n,e){var t=function(){return Zp.sketch(xn(xn({dom:n.dom},n),{value:e,items:n.items,markers:c.markers,fakeFocus:c.fakeFocus,onHighlight:c.onHighlight,focusManager:c.fakeFocus?(o=function(n){return jl.getHighlighted(n).map(function(n){return n.element()})},{get:o,set:function(e,n){var t=o(e);e.getSystem().getByDom(n).fold(_,function(n){jl.highlight(e,n)});var r=o(e);Ll(e,t,r)}}):Vl()}));var o};return e===o?{type:"prepared",menu:r.getSystem().build(t())}:{type:"notbuilt",nbMenu:t}})},s=rv.init(),f=function(n){return Uf.getValue(n).value},l=function(n){return an(c.data.menus,function(n,e){return J(n.items,function(n){return"separator"===n.type?[]:[n.data.value]})})},d=function(e,n){jl.highlight(e,n),jl.getHighlighted(n).orThunk(function(){return jl.getFirst(n)}).each(function(n){co(e,n.element(),Gr())})},m=function(e,n){return Tl(W(n,function(n){return e.lookupMenu(n).bind(function(n){return"prepared"===n.type?ln.some(n.menu):ln.none()})}))},g=function(e,n,t){var r=m(n,n.otherMenus(t));U(r,function(n){Xi(n.element(),[c.markers.backgroundMenu]),c.stayInDom||wf.remove(e,n)})},p=function(n,r){var o,e=(o=n,i.get().getOrThunk(function(){var t={},n=rt(o.element(),"."+c.markers.item),e=z(n,function(n){return"true"===ze(n,"aria-haspopup")});return U(e,function(n){o.getSystem().getByDom(n).each(function(n){var e=f(n);t[e]=n})}),i.set(ln.some(t)),t}));cn(e,function(n,e){var t=L(r,e);Ue(n.element(),"aria-expanded",t)})},v=function(r,o,i){return ln.from(i[0]).bind(function(n){return o.lookupMenu(n).bind(function(n){if("notbuilt"===n.type)return ln.none();var e=n.menu,t=m(o,i.slice(1));return U(t,function(n){Qe(n.element(),c.markers.backgroundMenu)}),tt(e.element())||wf.append(r,vu(e)),Xi(e.element(),[c.markers.backgroundMenu]),d(r,e),g(r,o,i),ln.some(e)})})};(e=a||(a={}))[e.HighlightSubmenu=0]="HighlightSubmenu",e[e.HighlightParent=1]="HighlightParent";var h=function(o,i,u){void 0===u&&(u=a.HighlightSubmenu);var n=f(i);return s.expand(n).bind(function(r){return p(o,r),ln.from(r[0]).bind(function(t){return s.lookupMenu(t).bind(function(n){var e=function(n,e,t){if("notbuilt"!==t.type)return t.menu;var r=n.getSystem().build(t.nbMenu());return s.setMenuBuilt(e,r),r}(o,t,n);return tt(e.element())||wf.append(o,vu(e)),c.onOpenSubmenu(o,i,e,$(r)),u===a.HighlightSubmenu?(jl.highlightFirst(e),v(o,s,r)):(jl.dehighlightAll(e),ln.some(i))})})})},r=function(e,t){var n=f(t);return s.collapse(n).bind(function(n){return p(e,n),v(e,s,n).map(function(n){return c.onCollapseMenu(e,t,n),n})})},t=function(t){return function(e,n){return oi(n.getSource(),"."+c.markers.item).bind(function(n){return e.getSystem().getByDom(n).toOption().bind(function(n){return t(e,n).map(function(){return!0})})})}},o=so([fo($p(),function(t,r){var n=r.event().item();s.lookupItem(f(n)).each(function(){var n=r.event().menu();jl.highlight(t,n);var e=f(r.event().item());s.refresh(e).each(function(n){return g(t,s,n)})})}),ho(function(e,n){var t=n.event().target();e.getSystem().getByDom(t).each(function(n){0===f(n).indexOf("collapse-item")&&r(e,n),h(e,n,a.HighlightSubmenu).fold(function(){c.onExecute(e,n)},function(){})})}),go(function(e,n){var t,r,o;(t=e,r=u(t,c.data.primary,c.data.menus),o=l(),s.setContents(c.data.primary,r,c.data.expansions,o),s.getPrimary()).each(function(n){wf.append(e,vu(n)),c.onOpenMenu(e,n),c.highlightImmediately&&d(e,n)})})].concat(c.navigateOnHover?[fo(Up(),function(n,e){var t,r,o=e.event().item();t=n,r=f(o),s.refresh(r).bind(function(n){return p(t,n),v(t,s,n)}),h(n,o,a.HighlightParent),c.onHover(n,o)})]:[])),b=function(n){return jl.getHighlighted(n).bind(jl.getHighlighted)},y={collapseMenu:function(e){b(e).each(function(n){r(e,n)})},highlightPrimary:function(e){s.getPrimary().each(function(n){d(e,n)})},repositionMenus:function(r){s.getPrimary().bind(function(e){return b(r).bind(function(n){var e,t=f(n),r=(e=s.getMenus(),mn(e,function(n){return n})),o=Tl(W(r,rv.extractPreparedMenu));return s.getTriggeringPath(t,function(n){return t=n,tn(o,function(n){if(!n.getSystem().isConnected())return ln.none();var e=jl.getCandidates(n);return Y(e,function(n){return f(n)===t})});var t})}).map(function(n){return{primary:e,triggeringPath:n}})}).fold(function(){var n;(n=r,ln.from(n.components()[0]).filter(function(n){return"menu"===ze(n.element(),"role")})).each(function(n){c.onRepositionMenu(r,n,[])})},function(n){var e=n.primary,t=n.triggeringPath;c.onRepositionMenu(r,e,t)})}};return{uid:c.uid,dom:c.dom,markers:c.markers,behaviours:yu(c.tmenuBehaviours,[Tm.config({mode:"special",onRight:t(function(n,e){return ud(e.element())?ln.none():h(n,e,a.HighlightSubmenu)}),onLeft:t(function(n,e){return ud(e.element())?ln.none():r(n,e)}),onEscape:t(function(n,e){return r(n,e).orThunk(function(){return c.onEscape(n,e).map(function(){return n})})}),focusIn:function(e,n){s.getPrimary().each(function(n){co(e,n.element(),Gr())})}}),jl.config({highlightClass:c.markers.selectedMenu,itemClass:c.markers.menu}),Ef.config({find:function(n){return jl.getHighlighted(n)}}),wf.config({})]),eventOrder:c.eventOrder,apis:y,events:o}},extraApis:{tieredData:function(n,e,t){return{primary:n,menus:e,expansions:t}},singleData:function(n,e){return{primary:n,menus:Rt(n,e),expansions:{}}},collapseItem:function(n){return{value:bi(ov()),meta:{text:n}}}}}),uv=sn("sink"),cv=sn(uc({name:uv(),overrides:sn({dom:{tag:"div"},behaviours:Eo([vf.config({useFixed:i})]),events:so([mo(Br()),mo(Fr()),mo(Pr())])})})),av=Yt([wr("isExtraPart",sn(!1)),yr("fireEventInstead",[wr("event",Zr())])]),sv=Yt([yr("fireEventInstead",[wr("event",no())]),pr("doReposition")]);(pp=gp||(gp={}))[pp.HighlightFirst=0]="HighlightFirst",pp[pp.HighlightNone=1]="HighlightNone";var fv,lv,dv=function(n,e){var t=n.getHotspot(e).getOr(e),r=n.getAnchorOverrides();return n.layouts.fold(function(){return{anchor:"hotspot",hotspot:t,overrides:r}},function(n){return{anchor:"hotspot",hotspot:t,overrides:r,layouts:n}})},mv=function(n,e,t,r,o,i,u){var c,a,s,f,l,d,m,g,p,v,h=dv(n,t);return(a=h,f=r,l=o,d=u,m=e,g=s=t,p=(0,(c=n).fetch)(g).map(m),v=hv(s,c),p.map(function(n){return n.bind(function(n){return ln.from(iv.sketch(xn(xn({},l.menu()),{uid:Ei(""),data:n,highlightImmediately:d===gp.HighlightFirst,onOpenMenu:function(n,e){var t=v().getOrDie();vf.position(t,a,e),Pp.decloak(f)},onOpenSubmenu:function(n,e,t){var r=v().getOrDie();vf.position(r,{anchor:"submenu",item:e},t),Pp.decloak(f)},onRepositionMenu:function(n,e,t){var r=v().getOrDie();vf.position(r,a,e),U(t,function(n){vf.position(r,{anchor:"submenu",item:n.triggeringItem},n.triggeredMenu)})},onEscape:function(){return Df.focus(s),Pp.close(f),ln.some(!0)}})))})})).map(function(n){return n.fold(function(){Pp.isOpen(r)&&Pp.close(r)},function(n){Pp.cloak(r),Pp.open(r,n),i(r)}),r})},gv=function(n,e,t,r,o,i,u){return Pp.close(r),De(r)},pv=function(n,e,t,r,o,i){var u=Tp.getCoupled(t,"sandbox");return(Pp.isOpen(u)?gv:mv)(n,e,t,u,r,o,i)},vv=function(n,e,t){var r,o,i,u=Ef.getCurrent(e).getOr(e),c=(r=n.element(),qc.get(r));t?Zi(u.element(),"min-width",c+"px"):(o=u.element(),i=c,qc.set(o,i))},hv=function(e,n){return e.getSystem().getByUid(n.uid+"-"+uv()).map(function(n){return function(){return Fe.value(n)}}).getOrThunk(function(){return n.lazySink.fold(function(){return function(){return Fe.error(new Error("No internal sink is specified, nor could an external sink be found"))}},function(n){return function(){return n(e)}})})},bv=function(n){Pp.getState(n).each(function(n){iv.repositionMenus(n)})},yv=function(r,o,i){var e,n,t,u,c,a,s,f=(e=bi("aria-owns"),{id:sn(e),link:function(n){Ue(n,"aria-owns",e)},unlink:function(n){Ge(n,"aria-owns")}}),l=hv(o,r);return{dom:{tag:"div",classes:r.sandboxClasses,attributes:{id:f.id(),role:"listbox"}},behaviours:wu(r.sandboxBehaviours,[Uf.config({store:{mode:"memory",initialValue:o}}),Pp.config({onOpen:function(n,e){var t=dv(r,o);f.link(o.element()),r.matchWidth&&vv(t.hotspot,e,r.useMinWidth),r.onOpen(t,n,e),void 0!==i&&void 0!==i.onOpen&&i.onOpen(n,e)},onClose:function(n,e){f.unlink(o.element()),void 0!==i&&void 0!==i.onClose&&i.onClose(n,e)},isPartOf:function(n,e,t){return Ep(e,t)||Ep(o,t)},getAttachPoint:function(){return l().getOrDie()}}),Ef.config({find:function(n){return Pp.getState(n).bind(function(n){return Ef.getCurrent(n)})}}),Gm.config({channels:xn(xn({},(c={isExtraPart:m},s=ur("Dismissal",av,c),(a={})[y()]={schema:Yt([mr("target")]),onReceive:function(e,n){Pp.isOpen(e)&&(Pp.isPartOf(e,n.target)||s.isExtraPart(e,n.target)||s.fireEventInstead.fold(function(){return Pp.close(e)},function(n){return oo(e,n.event)}))}},a)),(n={doReposition:bv},u=ur("Reposition",sv,n),(t={})[p()]={onReceive:function(e){Pp.isOpen(e)&&u.fireEventInstead.fold(function(){return u.doReposition(e)},function(n){return oo(e,n.event)})}},t))})])}},_v=sn([mr("dom"),mr("fetch"),Tu("onOpen"),Mu("onExecute"),wr("getHotspot",ln.some),wr("getAnchorOverrides",sn({})),ss(),hu("dropdownBehaviours",[pl,Tp,Tm,Df]),mr("toggleClass"),wr("eventOrder",{}),hr("lazySink"),wr("matchWidth",!1),wr("useMinWidth",!1),hr("role")].concat([wr("sandboxClasses",[]),_u("sandboxBehaviours",[Ef,Gm,Pp,Uf])])),wv=sn([ic({schema:[Cu()],name:"menu",defaults:function(n){return{onExecute:n.onExecute}}}),cv()]),xv=xc({name:"Dropdown",configFields:_v(),partFields:wv(),factory:function(e,n,t,r){var o,i,u=function(n){Pp.getState(n).each(function(n){iv.highlightPrimary(n)})},c={expand:function(n){pl.isOn(n)||pv(e,function(n){return n},n,r,_,gp.HighlightNone).get(_)},open:function(n){pl.isOn(n)||pv(e,function(n){return n},n,r,_,gp.HighlightFirst).get(_)},isOpen:pl.isOn,close:function(n){pl.isOn(n)&&pv(e,function(n){return n},n,r,_,gp.HighlightFirst).get(_)},repositionMenus:function(n){var e,t;pl.isOn(n)&&(e=n,t=Tp.getCoupled(e,"sandbox"),bv(t))}},a=function(n,e){return uo(n),ln.some(!0)};return{uid:e.uid,dom:e.dom,components:n,behaviours:yu(e.dropdownBehaviours,[pl.config({toggleClass:e.toggleClass,aria:{mode:"expanded"}}),Tp.config({others:{sandbox:function(n){return yv(e,n,{onOpen:function(){pl.on(n)},onClose:function(){pl.off(n)}})}}}),Tm.config({mode:"special",onSpace:a,onEnter:a,onDown:function(n,e){if(xv.isOpen(n)){var t=Tp.getCoupled(n,"sandbox");u(t)}else xv.open(n);return ln.some(!0)},onEscape:function(n,e){return xv.isOpen(n)?(xv.close(n),ln.some(!0)):ln.none()}}),Df.config({})]),events:hl(ln.some(function(n){pv(e,function(n){return n},n,r,u,gp.HighlightFirst).get(_)})),eventOrder:xn(xn({},e.eventOrder),(o={},o[qr()]=["disabling","toggling","alloy.base.behaviour"],o)),apis:c,domModification:{attributes:xn(xn({"aria-haspopup":"true"},e.role.fold(function(){return{}},function(n){return{role:n}})),"button"===e.dom.tag?{type:(i="type",gn(e.dom,"attributes").bind(function(n){return gn(n,i)})).getOr("button")}:{})}}},apis:{open:function(n,e){return n.open(e)},expand:function(n,e){return n.expand(e)},close:function(n,e){return n.close(e)},isOpen:function(n,e){return n.isOpen(e)},repositionMenus:function(n,e){return n.repositionMenus(e)}}}),Ov=bi("tc-kebab-action"),Sv="basecamp",Ev="deleting",Cv={textKey:rl.tc_kebab_edit,eventName:Xg},kv={textKey:rl.tc_kebab_delete,eventName:Gg},Tv={textKey:rl.tc_kebab_deleteconversation,eventName:Yg},Mv=function(n,c,e,t,r){var o,i;void 0===e&&(e='<svg width="24" height="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 24C5.373 24 0 18.627 0 12S5.373 0 12 0s12 5.373 12 12-5.373 12-12 12zm-8.693-5.259A10.981 10.981 0 0 0 12 23c3.535 0 6.68-1.668 8.693-4.259C19.432 16.251 14.591 15 12 15c-2.59 0-7.432 1.25-8.693 3.741zm8.7-5.741C14.224 13 16 10.99 16 8.5S14.224 4 12.007 4C9.79 4 8 6.01 8 8.5S9.79 13 12.007 13z" fill-rule="nonzero"></path></svg>');var u,a,s,f,l,d,m,g,p,v,h,b,y,_,w,x,O=kn(n),S=X([t.deleteConversation?[Tv]:[],t.editComment?[Cv]:[],t.deleteComment?[kv]:[]]),E=Fc(yp(n,r.universe)),C={updateWith:function(n,e,t){var r,o,i,u;O.set(e),T.getOpt(n).each(function(n){n.getApis().updateWith(n,e,{})}),M.getOpt(n).each(function(n){n.getApis().updateWith(n,e,{})}),r=n,o=t.numComments,i=e.isDeleting===nd.QueryingDelete,u=c,D.getOpt(r).each(function(n){return Op(0,n,i)}),N.getOpt(r).each(function(n){var e=u?[rl.tc_delete_prompts_conversation,1===o?rl.tc_delete_prompts_conversation_detail_sing:{pattern:rl.tc_delete_prompts_conversation_detail_pl,targets:[o]}]:[rl.tc_delete_prompts_comment];n.getApis().setText(n,e),Op(0,n,i)}),e.isDeleting===nd.PostDelete&&el.getCurrentRoute(n).filter(function(n){return n.destination===Ev}).fold(function(){el.progressTo(n,Ev)},function(n){}),E.getOpt(n).each(function(n){n.getApis().updateWith(n,e,{})})}},k={dom:{tag:"div",classes:vg.classes.cardHead},components:X([[{dom:{tag:"div",classes:vg.classes.cardHeadMeta},components:[(f=O.get().authorName,l=e,d={dom:{tag:"div",classes:vg.classes.avatar,innerHtml:l}},m={dom:{tag:"div",classes:vg.classes.username,innerHtml:f}},{dom:{tag:"div",classes:vg.classes.user},components:[d,{dom:{tag:"div"},components:[m,E.asSpec()]}]})]}],0<S.length?[(u=S,a=r,s=W(u,function(e){var n;return{type:"item",data:{value:e.eventName},dom:{tag:"div",classes:vg.classes.kebabItem},components:[{dom:{tag:"span",classes:vg.classes.kebabItemLabel,innerHtml:a.universe.translate(e.textKey)}}],itemBehaviours:Eo(Sn([Do("item-events",[ho(function(n){io(n,Ov,{eventName:e.eventName}),oo(n,Xr())})])],Jm({disableClass:vg.classes.kebabDisabledItem.join(" ")}))),eventOrder:(n={},n[qr()]=["disabling","alloy.base.behaviour","toggling","typeaheadevents","item-events"],n)}}),xv.sketch({dom:{tag:"button",attributes:{type:"button"},classes:vg.classes.kebab},components:[{dom:{tag:"div",classes:vg.classes.kebabIcon,innerHtml:'<svg width="24" height="24" data-name="icon-image-options"><g id="icon-image-options" stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M6 10a2 2 0 0 0-2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2 2 2 0 0 0-2-2zm12 0a2 2 0 0 0-2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2 2 2 0 0 0-2-2zm-6 0a2 2 0 0 0-2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2 2 2 0 0 0-2-2z" id="Shape" fill-rule="nonzero"></path></g></svg>'}}],lazySink:function(n){return a.getSink(n).fold(function(){return Fe.error("Could not find sink for kebab")},Fe.value)},dropdownBehaviours:Eo(Sn(Jm({}),[Gf.config({tabAttr:up})])),sandboxBehaviours:Eo([Do("kebab-sandbox-events",[fo(Ov,function(n,e){var t=Uf.getValue(n);oo(t,e.event().eventName())})])]),parts:{menu:{dom:{tag:"div"},markers:vg.markers.kebab}},toggleClass:vg.states.kebabOpen,layouts:{onLtr:function(){return[Ya]},onRtl:function(){return[Ga]}},fetch:function(n){var e=bi("kebab-id");return De(ln.some(iv.singleData(e,{value:bi(e),dom:{tag:"div",classes:vg.classes.kebabMenu},components:[{dom:{tag:"div",classes:vg.classes.kebabMenuGroup},components:[Zp.parts().items({})]}],items:s})))}}))]:[]])},T=Fc((g={uid:n.uid,mode:n.mode},p=kn(g),v={updateWith:function(n,e,t){switch(p.set(e),e.mode){case $l.None:Zi(n.element(),"display","none");break;case $l.Collapsed:ou(n.element(),"display"),me(n.element()).each(function(n){return zo(n,rl.tc_comment_buttons_showmore)});break;case $l.Expanded:ou(n.element(),"display"),me(n.element()).each(function(n){return zo(n,rl.tc_comment_buttons_showless)});break;case $l.ExpandOrNone:case $l.CollapsedOrNone:break;case $l.Edit:Zi(n.element(),"display","none")}}},{dom:{tag:"div",classes:vg.classes.showMoreLessContainer,styles:{display:"none"}},components:[Mm.sketch({dom:{tag:"p",classes:vg.classes.showMoreLess,innerHtml:rl.tc_comment_buttons_showmore},action:function(n){Rg(p.get().uid,function(n){return{mode:p.get().mode===$l.Collapsed?$l.Expanded:$l.Collapsed}})(n)},buttonBehaviours:Eo([Gf.config({tabAttr:up})])})],apis:v})),M=Fc(fp(O.get(),r.universe)),D=Fc((r.universe,{dom:{tag:"div",classes:vg.classes.cardDelete,styles:{display:"none"}}})),N=Fc((h=function(){return O.get().uid},b=r.universe,y=function(n){oo(n,qg),Rg(h(),function(n){return{isDeleting:nd.BeforeDelete}})(n)},_=function(n,e,t){var r;return Mm.sketch({dom:{tag:"button",classes:n?vg.classes.button:vg.classes.secondaryButton,innerHtml:e},eventOrder:(r={},r[Fr()]=["alloy.base.behaviour","focusing","overlay-button-events"],r),action:t,buttonBehaviours:Eo(xp)})},w={setText:function(n,e){wf.set(n,W(e,function(n){var e="string"==typeof n?b.translate(n):b.translate([n.pattern].concat(n.targets));return{dom:{tag:"div"},components:[{dom:wp("<p>"+e+"</p>")}]}}).concat([x.asSpec()]))}},x=Fc({dom:{tag:"div",classes:vg.classes.cardDeleteButtons},components:[_(!0,b.translate(rl.tc_delete_buttons_cancel),y),_(!1,b.translate(rl.tc_delete_buttons_proceed),function(n){oo(n,Kg)})]}),{dom:{tag:"div",styles:{display:"none"},classes:vg.classes.cardDeleteLabel},components:[],apis:w,behaviours:Eo([wf.config({}),Do("card-delete-events",[fo(Wr(),function(n){jo(n.element()).fold(function(){Rg(h(),function(n){return{isDeleting:nd.BeforeDelete}})(n)},function(){})})]),Tm.config({mode:"cyclic",onEscape:function(n){return y(n),ln.some(!0)}})])}));return{dom:{tag:"div",classes:vg.classes.card,styles:{position:"relative"}},components:[k,M.asSpec(),D.asSpec(),N.asSpec(),T.asSpec()],behaviours:Eo([Df.config({}),Gf.config({}),op({escapeEvent:qg}),el.config({initialState:Sv,onTransition:function(n,e){var t;t=O.get().uid,io(n,Sg,{uid:t})},routes:(o={},o[Sv]=(i={},i[Ev]={transition:{property:"opacity",transitionClass:vg.states.disappearing}},i),o)}),Uf.config({store:{mode:"memory",initialValue:O.get().uid}}),Do("comment-events",[fo(Qg,function(n){return Rg(O.get().uid,function(){return{mode:O.get().mode===$l.Collapsed?$l.Expanded:$l.Collapsed}})(n)}),fo(qg,Df.focus),fo(Gg,function(n,e){Rg(O.get().uid,function(n){return{isDeleting:nd.QueryingDelete}})(n)}),fo(Yg,function(n,e){Rg(O.get().uid,function(n){return{isDeleting:nd.QueryingDelete}})(n)}),fo(Xg,function(n){return Rg(O.get().uid,function(n){return{mode:$l.Edit}})(n)}),fo(Jg,function(t){M.getOpt(t).each(function(n){var e=Uf.getValue(n);io(t,_p.editCommentEvent,{uid:O.get().uid,content:e})})}),fo(Kg,function(n,e){io(n,c?_p.deleteConversationEvent:_p.deleteCommentEvent,{uid:O.get().uid})})])]),apis:C}},Dv=function(n,r){return W(n,function(n,e){var t=0===e;return Mv(n,t,void 0,{editComment:!0,deleteComment:0<e,deleteConversation:t},r)})},Nv=function(n,o){var e={setComments:function(n,e){Ef.getCurrent(n).each(function(n){wf.set(n,Dv(e,o))}),Bg(n)},updateWith:function(e,r,n){Ef.getCurrent(e).each(function(n){var t=wf.contents(n);en(r).exists(function(n){return n.isDeleting===nd.QueryingDelete})?Qe(n.element(),vg.states.deletingConversation):Ze(n.element(),vg.states.deletingConversation),t.length!==r.length?wf.set(n,Dv(r,o)):U(t,function(n,e){t[e].getApis().updateWith(t[e],r[e],{numComments:r.length})}),Bg(e)})},scrollToEnd:function(o){Ef.getCurrent(o).each(function(n){var e,t=wf.contents(n);(e=t,0===e.length?ln.none():ln.some(e[e.length-1])).each(function(n){var e=o.element().dom(),t=e.getBoundingClientRect(),r=n.element().dom().getBoundingClientRect();r.top<t.top?e.scrollTop=r.top-t.top:r.bottom>t.bottom&&(e.scrollTop=r.bottom-t.bottom)})})}};return{dom:{tag:"div",classes:vg.classes.outerScroll},components:[{dom:{tag:"div",classes:vg.classes.commentList},components:Dv(n,o),behaviours:Eo([ip({selector:vg.selectors.card}),wf.config({})])}],behaviours:Eo([Ef.config({find:function(e){return me(e.element()).bind(function(n){return e.getSystem().getByDom(n).toOption()})}})]),apis:e}};(lv=fv||(fv={}))[lv.Start=0]="Start",lv[lv.Reply=1]="Reply";var Av=bi("tc-clear-input"),Fv=bi("tc-submit-input"),Rv=function(n){return e=Fv,t=n,np.sketch({tag:"textarea",inputClasses:vg.classes.replyTextarea,inputAttributes:xn(xn({},cp),{placeholder:t.translate(rl.tc_reply_placeholders)}),inputStyles:ap,inputBehaviours:Eo(Sn([rp({enterEvent:e}),Gf.config({}),Do("reply-events",[fo(Hr(),sp)])],Jm({})))});var e,t},Bv=function(t,n){var r=Fc(Rv(n)),e={focusEditor:function(n){r.getOpt(n).each(Df.focus)},updateWith:function(n,e,t){V(e,function(n){return n.mode===$l.Edit})?Zi(n.element(),"display","none"):ou(n.element(),"display")}};return{dom:{tag:"div",classes:vg.classes.replySection},behaviours:Eo([Do("reply-events",[fo(Av,function(n){r.getOpt(n).each(function(n){Uf.setValue(n,"")})}),fo(Fv,function(e){r.getOpt(e).map(Uf.getValue).each(function(n){0<n.length&&io(e,_p.createCommentEvent,{content:n,mode:t})})})])]),components:[r.asSpec(),_g.secondary({text:n.translate(rl.tc_reply_buttons_clear),eventName:ln.some(Av)}),_g.primary({text:n.translate(rl.tc_reply_buttons_save),eventName:ln.some(Fv)})],apis:e}},Iv=function(){var r=kn(Ag()),n=function(n){r.set(n(r.get()))};return{clearAll:function(){r.set(Ag())},recalibrate:function(r){n(function(n){return t=n,e=r.comments,{targetUid:t.targetUid,conversation:W(e,function(n,e){return{uid:n.uid,props:xn(xn({},n),{isDeleting:nd.BeforeDelete,mode:t.targetUid.is(n.uid)?$l.ExpandOrNone:$l.CollapsedOrNone})}}),queue:[]};var t,e})},enqueuePatch:function(e,t){n(function(n){return Dg(n,[{uid:e,patch:t}])})},enqueuePatches:function(e){n(function(n){return Dg(n,e)})},setTargetUid:function(e){n(function(n){return Mg(n,ln.some(e))})},clearTargetUid:function(){n(function(n){return Mg(n,ln.none())})},processQueue:function(){return Ng(r.get()).map(function(n){var e=n.world,t=n.props;return r.set(e),t})},purge:function(t){n(function(n){var e=z(n.conversation,function(n){return n.uid!==t});return xn(xn({},n),{conversation:e})})},getProps:function(){return Tg(r.get())},adjust:function(e){n(function(n){return Dg(n,W(e,function(n){return{uid:n.uid,patch:"to-delete"===n.type?{isDeleting:nd.PostDelete}:{}}}))})}}},Hv=function(n){return{type:"redraw-sidebar",view:n}},Pv=function(n,e){if(n.conversation.uid!==e.conversation.uid)return Hv(e);var t,r,o,i=W(n.conversation.comments,function(n){return n.uid}),u=W(e.conversation.comments,function(n){return n.uid});return t=i,r=u,void 0===o&&(o=I),R(o).eq(t,r)?{type:"refresh-comments",comments:W(e.conversation.comments,function(n,e){return{uid:n.uid,patch:xn({},n)}})}:0!==Z(u,i).length?Hv(e):{type:"remove-comments",adjustments:W(i,function(n){return{type:L(u,n)?"to-remain":"to-delete",uid:n}})}},jv=bi("tc-escapeInSidebar"),Lv=function(n,t,r,e){var o=function(e){l.get().each(function(n){"comments"===n.type&&e(n.conversation.uid)})},u=Iv(),c=function(){u.processQueue().each(function(e){h(e),m.getOpt(s).each(function(n){n.getApis().updateWith(n,e,{})})})},i=function(e){o(function(n){return e(n).get(function(n){n.fold(function(n){return n()},function(n){return n()})})})},a=function(n){n.get(function(n){n.fold(function(n){n()},function(n){u.setTargetUid(n.targetUid),n.fn()})})},s=pu({dom:{tag:"div",classes:n,styles:{position:"relative"}},behaviours:Eo([wf.config({}),tp({onEscape:function(n){return oo(n,jv),ln.some(!0)}}),Do("sidebar-events",[fo(Og,function(n,e){u.enqueuePatch(e.event().uid(),e.event().patch())}),fo(Sg,function(n,e){u.purge(e.event().uid()),m.getOpt(s).each(function(n){var e=u.getProps();h(e),n.getApis().updateWith(n,e,{})})}),fo(Eg,function(n){c()}),fo(jv,function(n,e){t.onEscape()}),fo(_p.deleteConversationEvent,function(n,e){i(function(n){return r.deleteConversation(n,e.event().uid())})}),fo(_p.deleteCommentEvent,function(n,e){i(function(n){return r.deleteComment(n,e.event().uid())})}),fo(_p.editCommentEvent,function(n,e){o(function(n){a(r.editComment(n,e.event().uid(),e.event().content()))})}),fo(_p.createCommentEvent,function(n,e){e.event().mode()===fv.Reply?o(function(n){a(r.reply(n,e.event().content()))}):a(r.createConversation(e.event().content()))})])])}),f=Ac(s),l=kn(ln.none()),d=function(n){wf.set(s,[g.asSpec()].concat(n))},m=Fc(Nv([],{getSink:function(n){return g.getOpt(n)},universe:e})),g=Fc({dom:{tag:"div",styles:{"z-index":"100"}},behaviours:Eo([vf.config({})])}),p=Fc(Bv(fv.Start,e)),v=Fc(Bv(fv.Reply,e)),h=function(e){v.getOpt(s).each(function(n){n.getApis().updateWith(n,e,{})})},b=function(n){"splash"===n.view.type?(u.clearAll(),d([p.asSpec()])):"comments"===n.view.type&&(u.recalibrate(n.view.conversation),d([m.asSpec(),v.asSpec()]),m.getOpt(s).each(function(n){var e=u.getProps();h(e),n.getApis().setComments(n,e),n.getApis().scrollToEnd(n)}))};return{system:f,root:s,element:f.element,update:function(i){m.getOpt(s).bind(function(e){return l.get().map(function(n){return{convUi:e,pview:n}})}).fold(function(){return b(i)},function(n){n.convUi;var e,t,r=n.pview,o=(e=r,t=i.view,e.type!==t.type?Hv(t):"splash"===t.type?{type:"no-change"}:Pv(e,t));switch(o.type){case"add-comment":b(i);break;case"no-change":break;case"redraw-sidebar":b(i);break;case"remove-comments":u.adjust(o.adjustments),c();break;case"refresh-comments":u.enqueuePatches(o.comments),c()}}),l.set(ln.some(i.view)),xf(s.element())&&i.grabFocus()&&v.getOpt(s).orThunk(function(){return p.getOpt(s)}).each(function(n){n.getApis().focusEditor(n)})},hasFocus:function(){return jo(s.element()).isSome()},setReadonly:function(n){n&&f.broadcastOn([y()],{target:f.element()}),f.broadcastOn([Qm],{readonly:n})},getSink:g.getOpt}},Vv="tc-delete-conversation-at-cursor",Wv=function(n,e){n.execCommand(Vv,null,{conversationUid:e})},Uv=function(n,e,t,r){return n.fold(function(n){return Fe.error({message:e,error:n,refresh:r})},function(n){return t(n).fold(function(n){return Fe.error({message:n.permError,error:n.reason,refresh:r})},Fe.value)})},zv=function(n){return pn(n,"reason")?n.reason:""},qv=function(o,r,i){var u=function(n){return function(){i().showError(n.message,n.error),n.refresh&&n.refresh()}};return{createConversation:function(n){return He.wrap(o.create({content:n,createdAt:hp.nowISO8601()}).map(function(n){var e=Fe.value,t=_;return Uv(n,rl.tc_create_problem,e,t).fold(function(n){return Fe.error(u(n))},function(n){return Fe.value({targetUid:n.conversationUid,fn:function(){r.annotator.annotate(it(),{uid:n.conversationUid}),i().refreshSidebar(ln.some(n.conversationUid),3)}})})}))},reply:function(r,n){return He.wrap(o.reply({conversationUid:r,content:n,createdAt:hp.nowISO8601()}).map(function(n){var e=Fe.value,t=_;return Uv(n,rl.tc_reply_problem,e,t).fold(function(n){return Fe.error(u(n))},function(n){return Fe.value({targetUid:n.commentUid,fn:function(){i().refreshSidebar(ln.some(r),3)}})})}))},editComment:function(t,r,n){return He.wrap(o.editComment({conversationUid:t,commentUid:r,content:n,modifiedAt:hp.nowISO8601()}).map(function(n){var e=_;return Uv(n,rl.tc_edit_problem_comment,function(n){return n.canEdit?Fe.value(n):Fe.error({permError:rl.tc_edit_unauthorised_comment,reason:zv(n)})},e).fold(function(n){return Fe.error(u(n))},function(n){return Fe.value({targetUid:r,fn:function(){i().refreshSidebar(ln.some(t),4)}})})}))},deleteComment:function(e,n){return He.wrap(o.deleteComment({conversationUid:e,commentUid:n}).map(function(n){return Uv(n,rl.tc_delete_problem_comment,function(n){return n.canDelete?Fe.value(n):Fe.error({permError:rl.tc_delete_unauthorised_comment,reason:zv(n)})},function(){i().refreshSidebar(ln.some(e),4)}).fold(function(n){return Fe.error(u(n))},function(n){return Fe.value(function(){i().refreshSidebar(ln.some(e),4)})})}))},deleteConversation:function(e){return He.wrap(o.deleteConversation({conversationUid:e}).map(function(n){return Uv(n,rl.tc_delete_problem_conversation,function(n){return n.canDelete?Fe.value(n):Fe.error({permError:rl.tc_delete_unauthorised_conversation,reason:zv(n)})},function(){i().refreshSidebar(ln.some(e),4)}).fold(function(n){return Fe.error(u(n))},function(n){return Fe.value(function(){Wv(r,e),i().refreshSidebar(ln.none(),2)})})}))}}};tinymce.Resource.add("tinymce.plugins.tinycomments.sidebar",function(n,e,t,r,o,i){var u,c,a,s,f,l,d=qv(t,e,function(){return p}),m=n===En.Modern?(s=e,f=d,l=i,{createSidebar:function(){return Lv(vg.classes.roots.modern,{onEscape:function(){return s.focus()}},f,l)},createController:ut}):(u=e,c=d,a=i,{createSidebar:function(){return Lv(vg.classes.roots.silver,{onEscape:function(){return u.focus()}},c,a)},createController:ut}),g=m.createSidebar(),p=m.createController(t,r,e,g),v=function(n){g.system.broadcastOn([y()],{target:w.fromDom(n.target)})},h=x(w.fromDom(b.document),"mousedown",function(n){g.system.broadcastOn([y()],{target:n.target()})});e.on("mousedown",v),e.on("remove",function(){e.off("mousedown",v),h.unbind()});o({controller:p,attachTo:function(n){ve(n,g.element())}})})}(window);