/* Ephox advanced code plugin
 *
 * Copyright 2010-2016 Ephox Corporation.  All rights reserved.
 *
 * Version: 2.2.0-140
 */

!function(l){"use strict";var e,n,t,r,o,i,u,c=function(e){return parseInt(e,10)},a=function(e,n){var t=e-n;return 0===t?0:0<t?1:-1},s=function(e,n,t){return{major:e,minor:n,patch:t}},f=function(e){var n=/([0-9]+)\.([0-9]+)\.([0-9]+)(?:(\-.+)?)/.exec(e);return n?s(c(n[1]),c(n[2]),c(n[3])):s(0,0,0)},d=function(e,n){var t=a(e.major,n.major);if(0!==t)return t;var r=a(e.minor,n.minor);if(0!==r)return r;var o=a(e.patch,n.patch);return 0!==o?o:0},m=function(e){return f([(n=e).majorVersion,n.minorVersion].join(".").split(".").slice(0,3).join("."));var n},p=function(e,n){return!!e&&-1===d(m(e),f(n))},h=function(r,o){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var t=r.console;t&&o in t&&t[o].apply(t,arguments)}},v={log:h(l.window,"log"),error:h(l.window,"error"),warn:h(l.window,"warm")},g=function(){},y=function(e){return function(){return e}},w=y(!1),T=y(!0),_=function(){return b},b=(e=function(e){return e.isNone()},r={fold:function(e,n){return e()},is:w,isSome:w,isNone:T,getOr:t=function(e){return e},getOrThunk:n=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:y(null),getOrUndefined:y(void 0),or:t,orThunk:n,map:_,each:g,bind:_,exists:w,forall:T,filter:_,equals:e,equals_:e,toArray:function(){return[]},toString:y("none()")},Object.freeze&&Object.freeze(r),r),E=function(t){var e=y(t),n=function(){return o},r=function(e){return e(t)},o={fold:function(e,n){return n(t)},is:function(e){return t===e},isSome:T,isNone:w,getOr:e,getOrThunk:e,getOrDie:e,getOrNull:e,getOrUndefined:e,or:n,orThunk:n,map:function(e){return E(e(t))},each:function(e){e(t)},bind:r,exists:r,forall:r,filter:function(e){return e(t)?o:b},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(e){return e.is(t)},equals_:function(e,n){return e.fold(w,function(e){return n(t,e)})}};return o},O={some:E,none:_,from:function(e){return null==e?b:E(e)}},S=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:y(e)}},N={fromHtml:function(e,n){var t=(n||l.document).createElement("div");if(t.innerHTML=e,!t.hasChildNodes()||1<t.childNodes.length)throw l.console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return S(t.childNodes[0])},fromTag:function(e,n){var t=(n||l.document).createElement(e);return S(t)},fromText:function(e,n){var t=(n||l.document).createTextNode(e);return S(t)},fromDom:S,fromPoint:function(e,n,t){var r=e.dom();return O.from(r.elementFromPoint(n,t)).map(S)}},x={},C={exports:x};i=x,u=C,o=void 0,function(e){"object"==typeof i&&void 0!==u?u.exports=e():"function"==typeof o&&o.amd?o([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=e()}(function(){return function i(u,c,a){function s(n,e){if(!c[n]){if(!u[n]){var t=!1;if(!e&&t)return t(n,!0);if(f)return f(n,!0);var r=new Error("Cannot find module '"+n+"'");throw r.code="MODULE_NOT_FOUND",r}var o=c[n]={exports:{}};u[n][0].call(o.exports,function(e){return s(u[n][1][e]||e)},o,o.exports,i,u,c,a)}return c[n].exports}for(var f=!1,e=0;e<a.length;e++)s(a[e]);return s}({1:[function(e,n,t){var r,o,i=n.exports={};function u(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function a(n){if(r===setTimeout)return setTimeout(n,0);if((r===u||!r)&&setTimeout)return r=setTimeout,setTimeout(n,0);try{return r(n,0)}catch(e){try{return r.call(null,n,0)}catch(e){return r.call(this,n,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:u}catch(e){r=u}try{o="function"==typeof clearTimeout?clearTimeout:c}catch(e){o=c}}();var s,f=[],d=!1,l=-1;function m(){d&&s&&(d=!1,s.length?f=s.concat(f):l=-1,f.length&&p())}function p(){if(!d){var e=a(m);d=!0;for(var n=f.length;n;){for(s=f,f=[];++l<n;)s&&s[l].run();l=-1,n=f.length}s=null,d=!1,function(n){if(o===clearTimeout)return clearTimeout(n);if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(n);try{o(n)}catch(e){try{return o.call(null,n)}catch(e){return o.call(this,n)}}}(e)}}function h(e,n){this.fun=e,this.array=n}function v(){}i.nextTick=function(e){var n=new Array(arguments.length-1);if(1<arguments.length)for(var t=1;t<arguments.length;t++)n[t-1]=arguments[t];f.push(new h(e,n)),1!==f.length||d||a(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(e,d,n){(function(t){!function(e){var n=setTimeout;function r(){}function i(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(e,this)}function o(t,r){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,i._immediateFn(function(){var e=1===t._state?r.onFulfilled:r.onRejected;if(null!==e){var n;try{n=e(t._value)}catch(e){return void c(r.promise,e)}u(r.promise,n)}else(1===t._state?u:c)(r.promise,t._value)})):t._deferreds.push(r)}function u(n,e){try{if(e===n)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var t=e.then;if(e instanceof i)return n._state=3,n._value=e,void a(n);if("function"==typeof t)return void f((r=t,o=e,function(){r.apply(o,arguments)}),n)}n._state=1,n._value=e,a(n)}catch(e){c(n,e)}var r,o}function c(e,n){e._state=2,e._value=n,a(e)}function a(e){2===e._state&&0===e._deferreds.length&&i._immediateFn(function(){e._handled||i._unhandledRejectionFn(e._value)});for(var n=0,t=e._deferreds.length;n<t;n++)o(e,e._deferreds[n]);e._deferreds=null}function s(e,n,t){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof n?n:null,this.promise=t}function f(e,n){var t=!1;try{e(function(e){t||(t=!0,u(n,e))},function(e){t||(t=!0,c(n,e))})}catch(e){if(t)return;t=!0,c(n,e)}}i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,n){var t=new this.constructor(r);return o(this,new s(e,n,t)),t},i.all=function(e){var c=Array.prototype.slice.call(e);return new i(function(r,o){if(0===c.length)return r([]);var i=c.length;function u(n,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var t=e.then;if("function"==typeof t)return void t.call(e,function(e){u(n,e)},o)}c[n]=e,0==--i&&r(c)}catch(e){o(e)}}for(var e=0;e<c.length;e++)u(e,c[e])})},i.resolve=function(n){return n&&"object"==typeof n&&n.constructor===i?n:new i(function(e){e(n)})},i.reject=function(t){return new i(function(e,n){n(t)})},i.race=function(o){return new i(function(e,n){for(var t=0,r=o.length;t<r;t++)o[t].then(e,n)})},i._immediateFn="function"==typeof t?function(e){t(e)}:function(e){n(e,0)},i._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},i._setImmediateFn=function(e){i._immediateFn=e},i._setUnhandledRejectionFn=function(e){i._unhandledRejectionFn=e},void 0!==d&&d.exports?d.exports=i:e.Promise||(e.Promise=i)}(this)}).call(this,e("timers").setImmediate)},{timers:3}],3:[function(a,e,s){(function(e,n){var r=a("process/browser.js").nextTick,t=Function.prototype.apply,o=Array.prototype.slice,i={},u=0;function c(e,n){this._id=e,this._clearFn=n}s.setTimeout=function(){return new c(t.call(setTimeout,window,arguments),clearTimeout)},s.setInterval=function(){return new c(t.call(setInterval,window,arguments),clearInterval)},s.clearTimeout=s.clearInterval=function(e){e.close()},c.prototype.unref=c.prototype.ref=function(){},c.prototype.close=function(){this._clearFn.call(window,this._id)},s.enroll=function(e,n){clearTimeout(e._idleTimeoutId),e._idleTimeout=n},s.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},s._unrefActive=s.active=function(e){clearTimeout(e._idleTimeoutId);var n=e._idleTimeout;0<=n&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},n))},s.setImmediate="function"==typeof e?e:function(e){var n=u++,t=!(arguments.length<2)&&o.call(arguments,1);return i[n]=!0,r(function(){i[n]&&(t?e.apply(null,t):e.call(null),s.clearImmediate(n))}),n},s.clearImmediate="function"==typeof n?n:function(e){delete i[e]}}).call(this,a("timers").setImmediate,a("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(e,n,t){var r=e("promise-polyfill"),o="undefined"!=typeof window?window:Function("return this;")();n.exports={boltExport:o.Promise||r}},{"promise-polyfill":2}]},{},[4])(4)});var I,R=C.exports.boltExport,D=function(){var t={},c={};tinymce.Resource={add:function(e,n){c[e]&&(c[e](n),delete c[e]),t[e]=R.resolve(n)},load:function(r,o){var i='Script at URL "'+o+'" failed to load',u='Script at URL "'+o+"\" did not call `tinymce.Resource.add('"+r+"', data)` within 1 second";if(void 0!==t[r])return t[r];var e=new R(function(e,n){var t=function(e,n,t){void 0===t&&(t=1e3);var r=!1,o=null,i=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];r||(r=!0,null!==o&&(l.clearTimeout(o),o=null),t.apply(null,e))}},u=i(e),c=i(n);return{reject:c,resolve:u,start:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];r||(o=l.setTimeout(function(){return c.apply(null,e)},t))}}}(e,n);c[r]=t.resolve,tinymce.ScriptLoader.loadScripts([o],function(){return t.start(u)},function(){return t.reject(i)})});return t[r]=e}}},A=function(e,n){return tinymce.Resource||D(),tinymce.Resource.load(e,n)},M=function(t,r){return new R(function(e,n){(r||tinymce.DOM.styleSheetLoader).load(t,e,n)})},P=(I="function",function(e){return function(e){if(null===e)return"null";var n=typeof e;return"object"===n&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"===n&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":n}(e)===I}),j=Array.prototype.slice,L=(P(Array.from)&&Array.from,function(e,n,t){return 0!=(e.compareDocumentPosition(n)&t)}),k=function(e,n){return L(e,n,l.Node.DOCUMENT_POSITION_CONTAINED_BY)},F=function(){return(F=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e}).apply(this,arguments)},U=function(e){var n=e,t=function(){return n};return{get:t,set:function(e){n=e},clone:function(){return U(t())}}},B=function(){return W(0,0)},W=function(e,n){return{major:e,minor:n}},V={nu:W,detect:function(e,n){var t=String(n).toLowerCase();return 0===e.length?B():function(e,n){var t=function(e,n){for(var t=0;t<e.length;t++){var r=e[t];if(r.test(n))return r}}(e,n);if(!t)return{major:0,minor:0};var r=function(e){return Number(n.replace(t,"$"+e))};return W(r(1),r(2))}(e,t)},unknown:B},H="Firefox",q=function(e,n){return function(){return n===e}},G=function(e){var n=e.current;return{current:n,version:e.version,isEdge:q("Edge",n),isChrome:q("Chrome",n),isIE:q("IE",n),isOpera:q("Opera",n),isFirefox:q(H,n),isSafari:q("Safari",n)}},X={unknown:function(){return G({current:void 0,version:V.unknown()})},nu:G,edge:y("Edge"),chrome:y("Chrome"),ie:y("IE"),opera:y("Opera"),firefox:y(H),safari:y("Safari")},Y="Windows",z="Android",$="Solaris",J="FreeBSD",K="ChromeOS",Q=function(e,n){return function(){return n===e}},Z=function(e){var n=e.current;return{current:n,version:e.version,isWindows:Q(Y,n),isiOS:Q("iOS",n),isAndroid:Q(z,n),isOSX:Q("OSX",n),isLinux:Q("Linux",n),isSolaris:Q($,n),isFreeBSD:Q(J,n),isChromeOS:Q(K,n)}},ee={unknown:function(){return Z({current:void 0,version:V.unknown()})},nu:Z,windows:y(Y),ios:y("iOS"),android:y(z),linux:y("Linux"),osx:y("OSX"),solaris:y($),freebsd:y(J),chromeos:y(K)},ne=function(e,n){var t=String(n).toLowerCase();return function(e,n){for(var t=0,r=e.length;t<r;t++){var o=e[t];if(n(o,t))return O.some(o)}return O.none()}(e,function(e){return e.search(t)})},te=function(e,t){return ne(e,t).map(function(e){var n=V.detect(e.versionRegexes,t);return{current:e.name,version:n}})},re=function(e,t){return ne(e,t).map(function(e){var n=V.detect(e.versionRegexes,t);return{current:e.name,version:n}})},oe=function(e,n){return-1!==e.indexOf(n)},ie=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,ue=function(n){return function(e){return oe(e,n)}},ce=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return oe(e,"edge/")&&oe(e,"chrome")&&oe(e,"safari")&&oe(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,ie],search:function(e){return oe(e,"chrome")&&!oe(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return oe(e,"msie")||oe(e,"trident")}},{name:"Opera",versionRegexes:[ie,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:ue("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:ue("firefox")},{name:"Safari",versionRegexes:[ie,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(oe(e,"safari")||oe(e,"mobile/"))&&oe(e,"applewebkit")}}],ae=[{name:"Windows",search:ue("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return oe(e,"iphone")||oe(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:ue("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:ue("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:ue("linux"),versionRegexes:[]},{name:"Solaris",search:ue("sunos"),versionRegexes:[]},{name:"FreeBSD",search:ue("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:ue("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],se={browsers:y(ce),oses:y(ae)},fe=U(function(e,n){var t,r,o,i,u,c,a,s,f,d,l,m,p=se.browsers(),h=se.oses(),v=te(p,e).fold(X.unknown,X.nu),g=re(h,e).fold(ee.unknown,ee.nu);return{browser:v,os:g,deviceType:(r=v,o=e,i=n,u=(t=g).isiOS()&&!0===/ipad/i.test(o),c=t.isiOS()&&!u,a=t.isiOS()||t.isAndroid(),s=a||i("(pointer:coarse)"),f=u||!c&&a&&i("(min-device-width:768px)"),d=c||a&&!f,l=r.isSafari()&&t.isiOS()&&!1===/safari/i.test(o),m=!d&&!f&&!l,{isiPad:y(u),isiPhone:y(c),isTablet:y(f),isPhone:y(d),isTouch:y(s),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:y(l),isDesktop:y(m)})}}(l.navigator.userAgent,function(e){return l.window.matchMedia(e).matches})),de=(l.Node.ATTRIBUTE_NODE,l.Node.CDATA_SECTION_NODE,l.Node.COMMENT_NODE,l.Node.DOCUMENT_NODE,l.Node.DOCUMENT_TYPE_NODE,l.Node.DOCUMENT_FRAGMENT_NODE,l.Node.ELEMENT_NODE,l.Node.TEXT_NODE,l.Node.PROCESSING_INSTRUCTION_NODE,l.Node.ENTITY_REFERENCE_NODE,l.Node.ENTITY_NODE,l.Node.NOTATION_NODE,fe.get().browser.isIE(),function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n]}("element","offset"),P(l.Element.prototype.attachShadow)&&P(l.Node.prototype.getRootNode)),le=de?function(e){return N.fromDom(e.dom().getRootNode())}:function(e){return n=e,N.fromDom(n.dom().ownerDocument);var n},me=function(e){return e.getParam("code_dialog_width",600)};var pe={},he=function(n){return O.from(tinymce.get).bind(function(e){return O.from(e(n))})},ve=function(e,n,t,r){void 0===r&&(r="");var o,i,u,c=he(t.editorId).map(function(e){var n,t=le(N.fromDom(e.getElement()));return(n=t,11===n.dom().nodeType?n:N.fromDom(n.dom().body)).dom()}).getOrUndefined(),a=(o=e,i=c,{completeAfter:u=function(e,n){return n&&!n()||l.setTimeout(function(){e.state.completionActive||e.showHint({completeSingle:!1,container:i})},100),o.Pass},completeIfAfterLt:function(n){return u(n,function(){var e=n.getCursor();return"<"===n.getRange(o.Pos(e.line,e.ch-1),e)})},completeIfInTag:function(n){return u(n,function(){var e=n.getTokenAt(n.getCursor());return!!("string"!==e.type||/['"]/.test(e.string.charAt(e.string.length-1))&&1!==e.string.length)&&o.innerMode(n.getMode(),e.state).state.tagName})}}),s={lineWrapping:t.lineWrapping,lineNumbers:t.lineNumbers,foldGutter:t.foldGutter,theme:t.theme,direction:t.direction,matchTags:{bothTags:!0},keyMap:"sublime",gutters:t.gutter?["CodeMirror-linenumbers","CodeMirror-foldgutter"]:[],extraKeys:{"Alt-F":"findPersistent","Ctrl-J":"toMatchingTag","Ctrl-B":"selectNextOccurrence","'<'":a.completeAfter,"'/'":a.completeIfAfterLt,"' '":a.completeIfInTag,"'='":a.completeIfInTag,"Ctrl-Q":function(e){e.foldCode(e.getCursor())}},mode:"text/html",value:r},f=e(n,s),d=function(e){27!==e.keyCode&&e.stopPropagation()};n.addEventListener("keyup",d),n.addEventListener("keydown",d),n.addEventListener("keypress",d);return l.setTimeout(function(){f&&(f.refresh(),f.focus())},200),{cmi:f,unbind:function(){n.removeEventListener("keyup",d),n.removeEventListener("keydown",d),n.removeEventListener("keypress",d)}}},ge=function(e,n,t){return R.all([function(n,t){if(!0===pe[t])return R.resolve();var e=he(t),r=e.bind(function(e){var n;return O.from(null===(n=e.ui)||void 0===n?void 0:n.styleSheetLoader)}).getOr(tinymce.DOM.styleSheetLoader);return e.each(function(e){e.on("remove",function(){r.unload&&r.unload(n),delete pe[t]})}),pe[t]=!0,M(n,r)}(n,t),A("tinymce.plugins.advcode.CodeMirror",e)]).then(function(e){e[0];return(0,e[1])()})},ye=function(e,n){e.focus(),e.undoManager.transact(function(){e.setContent(n)}),e.selection.setCursorLocation(),e.nodeChanged()},we=function(e,o){e.windowManager.open({title:o.title,body:o.body,buttons:[{text:"Ok",subtype:"primary",onclick:"submit",disabled:!0},{text:"Cancel",onclick:"close"}],onPostRender:function(){var e,n,t,r=this.getRoot();n=r.find("form > *")[0],t=r.getEl("body"),(e=new tinymce.ui.Throbber(t)).show(1e3),o.onPostRender(n).then(function(){e.hide(),r.statusbar.items().disabled(!1)})},onSubmit:function(e){o.onSubmit(e.data)},onClose:function(e){o.onClose&&o.onClose()}})},Te=function(r,o){var n,i=ge(o.codeMirrorScriptUrl,o.codeMirrorCssUrl,o.editorId),u=(n=U(O.none()),{clear:function(){n.set(O.none())},set:function(e){n.set(O.some(e))},isSet:function(){return n.get().isSome()},on:function(e){n.get().each(e)}});we(r,{title:"Source code",body:{type:"panel",border:1,classes:"codemirror",minWidth:me(r),minHeight:me(r)},onPostRender:function(e){var n=e.getEl("body"),t=r.getContent({source_view:!0});return i.then(function(e){return ve(e,n,o,t)}).then(function(e){u.set(e)})},onSubmit:function(){return u.on(function(e){ye(r,e.cmi.doc.getValue()),e.unbind()})},onClose:function(){return u.on(function(e){return e.unbind()})}})},_e=function(n,t){var e,r,o,i=n.getContent({source_view:!0}),u={name:"codeview",type:"customeditor",tag:"div"};if(r=tinymce,o="5.0.12",r&&1===d(m(r),f(o))){var c=t.customEditorScriptUrl;e=F(F({},u),{scriptId:"tinymce.plugins.advcode.customeditor",scriptUrl:c,settings:t})}else e=F(F({},u),{init:function(e){return o=e,i=t,new R(function(e){o.style.width="100%",o.parentElement.classList.add("mce-codemirror"),e(ge(i.codeMirrorScriptUrl,i.codeMirrorCssUrl,i.editorId).then(function(e){var n=ve(e,o,i),t=n.cmi,r=n.unbind;return{getValue:function(){return t.doc.getValue()},setValue:function(e){return t.doc.setValue(e)},destroy:function(){return r()}}}))});var o,i}});var a={title:"Source Code",size:"large",body:{type:"panel",items:[e]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:{codeview:i},onSubmit:function(e){ye(n,e.getData().codeview),e.close()}};n.windowManager.open(a)},be=function(m,p,h){return function(){var e,n,t,r,o,i,u,c,a,s,f,d,l={customEditorScriptUrl:(n=h)+"/customeditor.min.js",codeMirrorScriptUrl:(f=e=p,d=n,f.getParam("codemirror_script",d+"/codemirror.min.js","string")),codeMirrorCssUrl:(a=e,s=n,a.getParam("codemirror_css",s+"/codemirror.min.css","string")),lineWrapping:(c=e,c.getParam("codemirror_linewrapping",!0,"boolean")),lineNumbers:(u=e,u.getParam("codemirror_linenumbers",!0,"boolean")),foldGutter:(i=e,i.getParam("codemirror_foldgutter",!0,"boolean")),theme:(o=e,o.getParam("codemirror_theme","default","string")),direction:(r=e,"rtl"===r.getBody().dir?"rtl":"ltr"),gutter:(t=e,t.getParam("codemirror_gutter",!0,"boolean")),editorId:e.id};m(p,l)}},Ee=function(e,n){return p(tinymce,"4.3.13")?(v.error("The advcode plugin requires at least 4.3.13 version of TinyMCE."),function(){}):(p(tinymce,"5.0.0")?(u=be(Te,i=e,n),i.addCommand("mceCodeEditor",u),i.addButton("code",{icon:"code",tooltip:"Source code",onclick:u}),i.addMenuItem("code",{icon:"code",text:"Source code",context:"tools",onclick:u})):(r="sourcecode",o=be(_e,t=e,n),t.addCommand("mceCodeEditor",o),t.ui.registry.addButton("code",{icon:r,tooltip:"Source code",onAction:o}),t.ui.registry.addMenuItem("code",{icon:r,text:"Source code",onAction:o})),{});var t,r,o,i,u};tinymce.PluginManager.add("advcode",Ee)}(window);