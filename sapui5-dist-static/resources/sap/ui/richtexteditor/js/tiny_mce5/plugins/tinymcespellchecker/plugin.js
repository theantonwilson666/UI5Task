/* Ephox Spell Checker Pro
 *
 * Copyright 2010-2016 Ephox Corporation.  All rights reserved.
 *
 * Version: 2.1.0-180
 */

!function(E){"use strict";var t=function(n){return parseInt(n,10)},u=function(n,e){var t=n-e;return 0===t?0:0<t?1:-1},r=function(n,e,t){return{major:n,minor:e,patch:t}},h=function(n){var e=/([0-9]+)\.([0-9]+)\.([0-9]+)(?:(\-.+)?)/.exec(n);return e?r(t(e[1]),t(e[2]),t(e[3])):r(0,0,0)},v=function(n,e){var t=u(n.major,e.major);if(0!==t)return t;var r=u(n.minor,e.minor);if(0!==r)return r;var o=u(n.patch,e.patch);return 0!==o?o:0},y=function(n){return h([(e=n).majorVersion,e.minorVersion].join(".").split(".").slice(0,3).join("."));var e},C=function(n,e){return!!n&&-1===v(y(n),h(e))},b=function(){},d=function(t,r){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t(r.apply(null,n))}},w=function(n){return function(){return n}},k=function(n){return n};function a(r){for(var o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=o.concat(n);return r.apply(null,t)}}var n,e,o,i,c,f,s=function(n){return n()},l=w(!1),g=w(!0),p=function(){return m},m=(n=function(n){return n.isNone()},i={fold:function(n,e){return n()},is:l,isSome:l,isNone:g,getOr:o=function(n){return n},getOrThunk:e=function(n){return n()},getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:w(null),getOrUndefined:w(void 0),or:o,orThunk:e,map:p,each:b,bind:p,exists:l,forall:g,filter:p,equals:n,equals_:n,toArray:function(){return[]},toString:w("none()")},Object.freeze&&Object.freeze(i),i),x=function(t){var n=w(t),e=function(){return o},r=function(n){return n(t)},o={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:g,isNone:l,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return x(n(t))},each:function(n){n(t)},bind:r,exists:r,forall:r,filter:function(n){return n(t)?o:m},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(l,function(n){return e(t,n)})}};return o},T={some:x,none:p,from:function(n){return null==n?m:x(n)}},O=Object.keys,S=Object.hasOwnProperty,_=function(n,e){for(var t=O(n),r=0,o=t.length;r<o;r++){var u=t[r];e(n[u],u)}},I=function(n,t){return N(n,function(n,e){return{k:e,v:t(n,e)}})},N=function(n,r){var o={};return _(n,function(n,e){var t=r(n,e);o[t.k]=t.v}),o},A=function(n,t){var r=[];return _(n,function(n,e){r.push(t(n,e))}),r},D=function(n){return A(n,function(n){return n})},R=function(n,e){return L(n,e)?T.from(n[e]):T.none()},L=function(n,e){return S.call(n,e)},M=function(e){return function(n){return function(n){if(null===n)return"null";var e=typeof n;return"object"===e&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===e&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":e}(n)===e}},j=M("string"),P=M("object"),B=M("array"),F=M("boolean"),z=M("function"),W=M("number"),q=Array.prototype.slice,U=Array.prototype.indexOf,V=Array.prototype.push,H=function(n,e){return U.call(n,e)},J=function(n,e){return-1<H(n,e)},K=function(n,e){for(var t=0,r=n.length;t<r;t++){if(e(n[t],t))return!0}return!1},Y=function(n,e){for(var t=n.length,r=new Array(t),o=0;o<t;o++){var u=n[o];r[o]=e(u,o)}return r},X=function(n,e){for(var t=0,r=n.length;t<r;t++){e(n[t],t)}},$=function(n,e){for(var t=[],r=0,o=n.length;r<o;r++){var u=n[r];e(u,r)&&t.push(u)}return t},G=function(n,e,t){return X(n,function(n){t=e(t,n)}),t},Q=function(n,e){for(var t=0,r=n.length;t<r;t++){var o=n[t];if(e(o,t))return T.some(o)}return T.none()},Z=function(n,e){for(var t=0,r=n.length;t<r;t++){if(e(n[t],t))return T.some(t)}return T.none()},nn=function(n){for(var e=[],t=0,r=n.length;t<r;++t){if(!B(n[t]))throw new Error("Arr.flatten item "+t+" was not an array, input: "+n);V.apply(e,n[t])}return e},en=function(n,e){return nn(Y(n,e))},tn=function(n,e){for(var t=0,r=n.length;t<r;++t){if(!0!==e(n[t],t))return!1}return!0},rn=function(n){var e=q.call(n,0);return e.reverse(),e},on=function(n){return[n]},un=(z(Array.from)&&Array.from,function(t){return{is:function(n){return t===n},isValue:g,isError:l,getOr:w(t),getOrThunk:w(t),getOrDie:w(t),or:function(n){return un(t)},orThunk:function(n){return un(t)},fold:function(n,e){return e(t)},map:function(n){return un(n(t))},mapError:function(n){return un(t)},each:function(n){n(t)},bind:function(n){return n(t)},exists:function(n){return n(t)},forall:function(n){return n(t)},toOption:function(){return T.some(t)}}}),cn=function(t){return{is:l,isValue:l,isError:g,getOr:k,getOrThunk:function(n){return n()},getOrDie:function(){return n=String(t),function(){throw new Error(n)}();var n},or:function(n){return n},orThunk:function(n){return n()},fold:function(n,e){return n(t)},map:function(n){return cn(t)},mapError:function(n){return cn(n(t))},each:b,bind:function(n){return cn(t)},exists:l,forall:g,toOption:T.none}},an={value:un,error:cn,fromOption:function(n,e){return n.fold(function(){return cn(e)},un)}};(f=c||(c={}))[f.Error=0]="Error",f[f.Value=1]="Value";var fn,sn,ln,dn=function(n,e,t){return n.stype===c.Error?e(n.serror):t(n.svalue)},gn=function(n){return{stype:c.Value,svalue:n}},pn=function(n){return{stype:c.Error,serror:n}},mn=function(n){return dn(n,an.error,an.value)},hn=gn,vn=function(n){var e=[],t=[];return X(n,function(n){dn(n,function(n){return t.push(n)},function(n){return e.push(n)})}),{values:e,errors:t}},yn=pn,bn=function(n,e){return n.stype===c.Value?e(n.svalue):n},wn=function(n,e){return n.stype===c.Error?e(n.serror):n},kn=function(n,e){return n.stype===c.Value?{stype:c.Value,svalue:e(n.svalue)}:n},xn=function(n,e){return n.stype===c.Error?{stype:c.Error,serror:e(n.serror)}:n},Tn=function(n){return P(n)&&100<O(n).length?" removed due to size":JSON.stringify(n,null,2)},On=function(n,e){return yn([{path:n,getErrorInfo:e}])},Sn=function(i){if(!B(i))throw new Error("cases must be an array");if(0===i.length)throw new Error("there must be at least one case");var c=[],t={};return X(i,function(n,r){var e=O(n);if(1!==e.length)throw new Error("one and only one name per case");var o=e[0],u=n[o];if(void 0!==t[o])throw new Error("duplicate key detected:"+o);if("cata"===o)throw new Error("cannot have a case named cata (sorry)");if(!B(u))throw new Error("case arguments must be an array");c.push(o),t[o]=function(){var n=arguments.length;if(n!==u.length)throw new Error("Wrong number of arguments to case "+o+". Expected "+u.length+" ("+u+"), got "+n);for(var t=new Array(n),e=0;e<t.length;e++)t[e]=arguments[e];return{fold:function(){if(arguments.length!==i.length)throw new Error("Wrong number of arguments to fold. Expected "+i.length+", got "+arguments.length);return arguments[r].apply(null,t)},match:function(n){var e=O(n);if(c.length!==e.length)throw new Error("Wrong number of arguments to match. Expected: "+c.join(",")+"\nActual: "+e.join(","));if(!tn(c,function(n){return J(e,n)}))throw new Error("Not all branches were specified when using match. Specified: "+e.join(", ")+"\nRequired: "+c.join(", "));return n[o].apply(null,t)},log:function(n){E.console.log(n,{constructors:c,constructor:o,params:t})}}}}),t},_n=Object.prototype.hasOwnProperty,En=function(i){return function(){for(var n=new Array(arguments.length),e=0;e<n.length;e++)n[e]=arguments[e];if(0===n.length)throw new Error("Can't merge zero objects");for(var t={},r=0;r<n.length;r++){var o=n[r];for(var u in o)_n.call(o,u)&&(t[u]=i(t[u],o[u]))}return t}},Cn=En(function(n,e){return P(n)&&P(e)?Cn(n,e):e}),In=En(function(n,e){return e}),Nn=Sn([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),An=Nn.strict,Dn=(Nn.asOption,Nn.defaultedThunk,Nn.asDefaultedOptionThunk,Nn.mergeWithThunk,function(n,e){var t;return(t={})[n]=e,t}),Rn=(Sn([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(n){var e=[],t=[];return X(n,function(n){n.fold(function(n){e.push(n)},function(n){t.push(n)})}),{errors:e,values:t}}),Ln=function(n){return d(yn,nn)(n)},Mn=function(n,e){var t,r,o=vn(n);return 0<o.errors.length?Ln(o.errors):(t=o.values,r=e,0<t.length?hn(Cn(r,In.apply(void 0,t))):hn(r))},jn=function(n){var e=vn(n);return 0<e.errors.length?Ln(e.errors):hn(e.values)},Pn=Sn([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),Bn=function(t,r,o){return R(r,o).fold(function(){return n=o,e=r,On(t,function(){return'Could not find valid *strict* value for "'+n+'" in '+Tn(e)});var n,e},hn)},Fn=function(n,e,t){var r=R(n,e).fold(function(){return t(n)},k);return hn(r)},zn=function(c,a,n,f){return n.fold(function(o,t,n,r){var u=function(n){var e=r.extract(c.concat([o]),f,n);return kn(e,function(n){return Dn(t,f(n))})},i=function(n){return n.fold(function(){var n=Dn(t,f(T.none()));return hn(n)},function(n){var e=r.extract(c.concat([o]),f,n);return kn(e,function(n){return Dn(t,f(T.some(n)))})})};return n.fold(function(){return bn(Bn(c,a,o),u)},function(n){return bn(Fn(a,o,n),u)},function(){return bn(hn(R(a,o)),i)},function(n){return bn((t=n,r=R(e=a,o).map(function(n){return!0===n?t(e):n}),hn(r)),i);var e,t,r},function(n){var e=n(a),t=kn(Fn(a,o,w({})),function(n){return Cn(e,n)});return bn(t,u)})},function(n,e){var t=e(a);return hn(Dn(n,f(t)))})},Wn=function(r){return{extract:function(t,n,e){return wn(r(e,n),function(n){return e=n,On(t,function(){return e});var e})},toString:function(){return"val"}}},qn=function(c){return{extract:function(n,e,t){return r=n,o=t,u=e,i=Y(c,function(n){return zn(r,o,n,u)}),Mn(i,{});var r,o,u,i},toString:function(){return"obj{\n"+Y(c,function(n){return n.fold(function(n,e,t,r){return n+" -> "+r.toString()},function(n,e){return"state("+n+")"})}).join("\n")+"}"}}},Un=w(Wn(hn)),Vn=d(function(o){return{extract:function(t,r,n){var e=Y(n,function(n,e){return o.extract(t.concat(["["+e+"]"]),r,n)});return jn(e)},toString:function(){return"array("+o.toString()+")"}}},qn),Hn=(Pn.state,Pn.field),Jn=function(n,e,t){return mn((r=n,o=k,u=t,i=e.extract([r],o,u),xn(i,function(n){return{input:u,errors:n}})));var r,o,u,i},Kn=function(n,e,t){return Jn(n,e,t).fold(function(n){throw new Error(Yn(n))},k)},Yn=function(n){return"Errors: \n"+(e=n.errors,t=10<e.length?e.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):e,Y(t,function(n){return"Failed path: ("+n.path.join(" > ")+")\n"+n.getErrorInfo()})).join("\n")+"\n\nInput object: "+Tn(n.input);var e,t},Xn=function(){return(Xn=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++)for(var o in e=arguments[t])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}).apply(this,arguments)},$n={},Gn={exports:$n};sn=$n,ln=Gn,fn=void 0,function(n){"object"==typeof sn&&void 0!==ln?ln.exports=n():"function"==typeof fn&&fn.amd?fn([],n):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=n()}(function(){return function u(i,c,a){function f(e,n){if(!c[e]){if(!i[e]){var t=!1;if(!n&&t)return t(e,!0);if(s)return s(e,!0);var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}var o=c[e]={exports:{}};i[e][0].call(o.exports,function(n){return f(i[e][1][n]||n)},o,o.exports,u,i,c,a)}return c[e].exports}for(var s=!1,n=0;n<a.length;n++)f(a[n]);return f}({1:[function(n,e,t){var r,o,u=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function a(e){if(r===setTimeout)return setTimeout(e,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(n){try{return r.call(null,e,0)}catch(n){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(n){r=i}try{o="function"==typeof clearTimeout?clearTimeout:c}catch(n){o=c}}();var f,s=[],l=!1,d=-1;function g(){l&&f&&(l=!1,f.length?s=f.concat(s):d=-1,s.length&&p())}function p(){if(!l){var n=a(g);l=!0;for(var e=s.length;e;){for(f=s,s=[];++d<e;)f&&f[d].run();d=-1,e=s.length}f=null,l=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(n){try{return o.call(null,e)}catch(n){return o.call(this,e)}}}(n)}}function m(n,e){this.fun=n,this.array=e}function h(){}u.nextTick=function(n){var e=new Array(arguments.length-1);if(1<arguments.length)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];s.push(new m(n,e)),1!==s.length||l||a(p)},m.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=h,u.addListener=h,u.once=h,u.off=h,u.removeListener=h,u.removeAllListeners=h,u.emit=h,u.prependListener=h,u.prependOnceListener=h,u.listeners=function(n){return[]},u.binding=function(n){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(n){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},{}],2:[function(n,l,e){(function(t){!function(n){var e=setTimeout;function r(){}function u(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],s(n,this)}function o(t,r){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,u._immediateFn(function(){var n=1===t._state?r.onFulfilled:r.onRejected;if(null!==n){var e;try{e=n(t._value)}catch(n){return void c(r.promise,n)}i(r.promise,e)}else(1===t._state?i:c)(r.promise,t._value)})):t._deferreds.push(r)}function i(e,n){try{if(n===e)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var t=n.then;if(n instanceof u)return e._state=3,e._value=n,void a(e);if("function"==typeof t)return void s((r=t,o=n,function(){r.apply(o,arguments)}),e)}e._state=1,e._value=n,a(e)}catch(n){c(e,n)}var r,o}function c(n,e){n._state=2,n._value=e,a(n)}function a(n){2===n._state&&0===n._deferreds.length&&u._immediateFn(function(){n._handled||u._unhandledRejectionFn(n._value)});for(var e=0,t=n._deferreds.length;e<t;e++)o(n,n._deferreds[e]);n._deferreds=null}function f(n,e,t){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof e?e:null,this.promise=t}function s(n,e){var t=!1;try{n(function(n){t||(t=!0,i(e,n))},function(n){t||(t=!0,c(e,n))})}catch(n){if(t)return;t=!0,c(e,n)}}u.prototype.catch=function(n){return this.then(null,n)},u.prototype.then=function(n,e){var t=new this.constructor(r);return o(this,new f(n,e,t)),t},u.all=function(n){var c=Array.prototype.slice.call(n);return new u(function(r,o){if(0===c.length)return r([]);var u=c.length;function i(e,n){try{if(n&&("object"==typeof n||"function"==typeof n)){var t=n.then;if("function"==typeof t)return void t.call(n,function(n){i(e,n)},o)}c[e]=n,0==--u&&r(c)}catch(n){o(n)}}for(var n=0;n<c.length;n++)i(n,c[n])})},u.resolve=function(e){return e&&"object"==typeof e&&e.constructor===u?e:new u(function(n){n(e)})},u.reject=function(t){return new u(function(n,e){e(t)})},u.race=function(o){return new u(function(n,e){for(var t=0,r=o.length;t<r;t++)o[t].then(n,e)})},u._immediateFn="function"==typeof t?function(n){t(n)}:function(n){e(n,0)},u._unhandledRejectionFn=function(n){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",n)},u._setImmediateFn=function(n){u._immediateFn=n},u._setUnhandledRejectionFn=function(n){u._unhandledRejectionFn=n},void 0!==l&&l.exports?l.exports=u:n.Promise||(n.Promise=u)}(this)}).call(this,n("timers").setImmediate)},{timers:3}],3:[function(a,n,f){(function(n,e){var r=a("process/browser.js").nextTick,t=Function.prototype.apply,o=Array.prototype.slice,u={},i=0;function c(n,e){this._id=n,this._clearFn=e}f.setTimeout=function(){return new c(t.call(setTimeout,window,arguments),clearTimeout)},f.setInterval=function(){return new c(t.call(setInterval,window,arguments),clearInterval)},f.clearTimeout=f.clearInterval=function(n){n.close()},c.prototype.unref=c.prototype.ref=function(){},c.prototype.close=function(){this._clearFn.call(window,this._id)},f.enroll=function(n,e){clearTimeout(n._idleTimeoutId),n._idleTimeout=e},f.unenroll=function(n){clearTimeout(n._idleTimeoutId),n._idleTimeout=-1},f._unrefActive=f.active=function(n){clearTimeout(n._idleTimeoutId);var e=n._idleTimeout;0<=e&&(n._idleTimeoutId=setTimeout(function(){n._onTimeout&&n._onTimeout()},e))},f.setImmediate="function"==typeof n?n:function(n){var e=i++,t=!(arguments.length<2)&&o.call(arguments,1);return u[e]=!0,r(function(){u[e]&&(t?n.apply(null,t):n.call(null),f.clearImmediate(e))}),e},f.clearImmediate="function"==typeof e?e:function(n){delete u[n]}}).call(this,a("timers").setImmediate,a("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(n,e,t){var r=n("promise-polyfill"),o="undefined"!=typeof window?window:Function("return this;")();e.exports={boltExport:o.Promise||r}},{"promise-polyfill":2}]},{},[4])(4)});var Qn,Zn,ne=Gn.exports.boltExport,ee=function(n){var t=T.none(),e=[],r=function(n){o()?i(n):e.push(n)},o=function(){return t.isSome()},u=function(n){X(n,i)},i=function(e){t.each(function(n){E.setTimeout(function(){e(n)},0)})};return n(function(n){t=T.some(n),u(e),e=[]}),{get:r,map:function(t){return ee(function(e){r(function(n){e(t(n))})})},isReady:o}},te={nu:ee,pure:function(e){return ee(function(n){n(e)})}},re=function(n){E.setTimeout(function(){throw n},0)},oe=function(t){var n=function(n){t().then(n,re)};return{map:function(n){return oe(function(){return t().then(n)})},bind:function(e){return oe(function(){return t().then(function(n){return e(n).toPromise()})})},anonBind:function(n){return oe(function(){return t().then(function(){return n.toPromise()})})},toLazy:function(){return te.nu(n)},toCached:function(){var n=null;return oe(function(){return null===n&&(n=t()),n})},toPromise:t,get:n}},ue={nu:function(n){return oe(function(){return new ne(n)})},pure:function(n){return oe(function(){return ne.resolve(n)})}},ie=function(u){return Xn(Xn({},u),{toCached:function(){return ie(u.toCached())},bindFuture:function(e){return ie(u.bind(function(n){return n.fold(function(n){return ue.pure(an.error(n))},function(n){return e(n)})}))},bindResult:function(e){return ie(u.map(function(n){return n.bind(e)}))},mapResult:function(e){return ie(u.map(function(n){return n.map(e)}))},mapError:function(e){return ie(u.map(function(n){return n.mapError(e)}))},foldResult:function(e,t){return u.map(function(n){return n.fold(e,t)})},withTimeout:function(n,o){return ie(ue.nu(function(e){var t=!1,r=E.setTimeout(function(){t=!0,e(an.error(o()))},n);u.get(function(n){t||(E.clearTimeout(r),e(n))})}))}})},ce=function(n){return ie(ue.nu(n))},ae=function(n){return ie(ue.pure(an.value(n)))},fe={nu:ce,wrap:ie,pure:ae,value:ae,error:function(n){return ie(ue.pure(an.error(n)))},fromResult:function(n){return ie(ue.pure(n))},fromFuture:function(n){return ie(n.map(an.value))},fromPromise:function(n){return ce(function(e){n.then(function(n){e(an.value(n))},function(n){e(an.error(n))})})}},se=function(){return(new Date).getTime()},le=function(n,t){void 0===t&&(t=36e5);var e,r,o={},u=function(n,e,t){o[n]={result:e,timestamp:t}},i=function(n,e){return n-e<t};return P(n)&&(e=n,r=se(),_(e,function(n,e){i(r,n.timestamp)&&u(e,n.result,n.timestamp)})),{set:u,get:function(e,n){return T.from(o[n]).filter(function(n){return i(e,n.timestamp)}).map(function(n){return n.result})},dump:function(){return o}}};(Zn=Qn||(Qn={})).JSON="json",Zn.Blob="blob",Zn.Text="text",Zn.FormData="formdata",Zn.MultipartFormData="multipart/form-data";var de,ge,pe,me,he=function(n,e,t){return""===e||!(n.length<e.length)&&n.substr(t,t+e.length)===e},ve=function(n,e){return-1!==n.indexOf(e)},ye=function(n,e){return he(n,e,n.length-e.length)},be=function(n){return n.replace(/^\s+|\s+$/g,"")},we=void 0!==E.window?E.window:Function("return this;")(),ke=function(n){try{var e=JSON.parse(n);return an.value(e)}catch(n){return an.error("Response was not JSON.")}},xe=function(e){return ue.nu(function(t){var n=new E.FileReader;n.onload=function(n){var e=n.target?n.target.result:new E.Blob([]);t(e)},n.readAsText(e)})},Te=function(n){return ue.pure(n.response)},Oe=function(n,e){switch(n){case Qn.JSON:return ke(e.response).fold(function(){return Te(e)},ue.pure);case Qn.Blob:return t=e,T.from(t.response).map(xe).getOr(ue.pure("no response content"));case Qn.Text:default:return Te(e)}var t},Se=function(n){var e,t=(e=n.body,T.from(e).bind(function(n){switch(n.type){case Qn.JSON:return T.some("application/json");case Qn.FormData:return T.some("application/x-www-form-urlencoded; charset=UTF-8");case Qn.MultipartFormData:return T.none();case Qn.Text:default:return T.some("text/plain")}})),r=!0===n.credentials?T.some(!0):T.none(),o=function(n){switch(n){case Qn.Blob:return"application/octet-stream";case Qn.JSON:return"application/json, text/javascript";case Qn.Text:return"text/plain";default:return""}}(n.responseType)+", */*; q=0.01",u=void 0!==n.headers?n.headers:{};return{contentType:t,responseType:function(n){switch(n){case Qn.JSON:return T.none();case Qn.Blob:return T.some("blob");case Qn.Text:return T.some("text");default:return T.none()}}(n.responseType),credentials:r,accept:o,headers:u,progress:z(n.progress)?T.some(n.progress):T.none()}},_e=function(n){var t=new E.FormData;return _(n,function(n,e){t.append(e,n)}),t},Ee=function(a){return fe.nu(function(r){var o,u=new E.XMLHttpRequest;u.open(a.method,(o=a.url,T.from(a.query).map(function(n){var e=A(n,function(n,e){return encodeURIComponent(e)+"="+encodeURIComponent(n)}),t=ve(o,"?")?"&":"?";return 0<e.length?o+t+e.join("&"):o}).getOr(o)),!0);var t,n,e=Se(a);t=u,(n=e).contentType.each(function(n){return t.setRequestHeader("Content-Type",n)}),t.setRequestHeader("Accept",n.accept),n.credentials.each(function(n){return t.withCredentials=n}),n.responseType.each(function(n){return t.responseType=n}),n.progress.each(function(e){return t.upload.addEventListener("progress",function(n){return e(n.loaded,n.total)})}),_(n.headers,function(n,e){return t.setRequestHeader(e,n)});var i,c=function(){var e,n,t;(e=a.url,n=a.responseType,t=u,Oe(n,t).map(function(n){return{message:0===t.status?"Unknown HTTP error (possible cross-domain request)":"Could not load url "+e+": "+t.statusText,status:t.status,responseText:n}})).get(function(n){return r(an.error(n))})};u.onerror=c,u.onload=function(){var n;0!==u.status||(n=a.url,he(n,"file:",0))?u.status<100||400<=u.status?c():function(n,e){var t=function(){return fe.pure(e.response)},r=function(n){return fe.error({message:n,status:e.status,responseText:e.responseText})};switch(n){case Qn.JSON:return ke(e.response).fold(r,fe.pure);case Qn.Blob:case Qn.Text:return t();default:return r("unknown data type")}}(a.responseType,u).get(r):c()},(i=a.body,T.from(i).map(function(n){return n.type===Qn.JSON?JSON.stringify(n.data):n.type===Qn.FormData?_e(n.data):n.type===Qn.MultipartFormData?_e(n.data):n})).fold(function(){return u.send()},function(n){u.send(n)})})},Ce=function(n){return n.fold(function(n){var e=n.responseText,t=P(e)?e:n.message;return an.error(t)},an.value)},Ie=function(c,a){var n,f=R(n=a,"tiny-api-key").orThunk(function(){return R(n,"tinymce-api-key")}).orThunk(function(){return R(n,"textbox-api-key")}).getOrUndefined();return{execute:function(n){var e,t,r,o,u,i=(e={url:(r=c,o=f,u=-1===r.indexOf("?")?"?":"&",o?r+u+"apiKey="+encodeURIComponent(o):r),body:(t=n,{type:Qn.JSON,data:t}),responseType:Qn.JSON,credentials:!0,headers:a},Ee(Xn(Xn({},e),{method:"post"}))).map(Ce);return fe.wrap(i)}}},Ne=function(e,t){var r=[];return{execute:function(n){return fe.wrap((0===e?ue.nu(function(n){return r.push(n)}):(e-=1,ue.pure(void 0))).bind(function(){return t.execute(n)}).map(function(n){return 0!==r.length?E.setTimeout(r.shift(),0):e+=1,n}))}}},Ae=function(e,o,n,u,t){return!0===t?{known:{},unknown:n}:G(n,function(t,n){var r=u(n);return e(o,r).fold(function(){return{known:t.known,unknown:t.unknown.concat([n])}},function(n){var e=Dn(r,n);return{known:Xn(Xn({},t.known),e),unknown:t.unknown}})},{known:{},unknown:[]})},De=function(n,e,t,r,o,u){var i,c,a,f,s,l=Ae(e.get,o,t,r,u);return 0===l.unknown.length?fe.value(l.known):(i=n,c=e,a=l.known,f=l.unknown,s=o,i(f,u).mapResult(function(n){return _(n,function(n,e){c.set(e,n,s)}),Xn(Xn({},a),n)}))},Re=function(n){return Hn(n,n,An(),Un())},Le=function(n,e){return Hn(n,n,(t=e,Nn.defaultedThunk(w(t))),Un());var t},Me="iframely",je="oembed",Pe="fallback",Be="wikipedia",Fe=function(n){return"["+n.join(", ")+"]"},ze=[Me,je,Pe],We=function(e,n,t){return K(n,function(n){return J(e,n)})?an.error("Embed response source: "+Fe(e)+" contains more than one of "+Fe(ze)):an.value(t)},qe=(qn([Re("url"),Re("maxWidth"),Le("fresh",!1)]),qn([Re("status_code"),Re("sub_code"),Re("msg")]),qn([Re("html"),(de="rels",ge=[Hn("source","source",An(),(pe=function(n){return B(n)?J(e=n,Me)?We(e,[je,Pe,Be],Me):J(e,je)?We(e,[Me,Pe,Be],je):J(e,Pe)?We(e,[Me,je,Be],Pe):J(e,Be)?We(e,[Me,je,Pe],Be):an.error("Embed response source: "+Fe(e)+" did not contain any of: "+Fe(ze)):an.error("Sources was not an array: "+n);var e},Wn(function(n){return pe(n).fold(yn,hn)})))],Hn(de,de,An(),qn(ge)))]),[Re("url"),Le("fresh",!1)]),Ue=(qn([Hn("urls","urls",An(),(me=qe,Vn(me)))]),Sn([{invalid:["invalidUrl"]},{unknown:["unknownUrl"]},{valid:["validUrl"]}]),function(i,n){return n(function(r){var o=[],u=0;0===i.length?r([]):X(i,function(n,e){var t;n.get((t=e,function(n){o[t]=n,++u>=i.length&&r(o)}))})})}),Ve=function(n){return Ue(n,ue.nu)},He=0,Je=function(n){var e=(new Date).getTime();return n+"_"+Math.floor(1e9*Math.random())+ ++He+String(e)},Ke=qn([Re("language"),Re("words")]),Ye=function(t,o,r,n,e){var u=function(n,e){for(var t=[],r=0;r<n.length;r+=e){var o=q.call(n,r,r+e);t.push(o)}return t}(n,e),i=Y(u,function(n){var e=Kn("ephox.spelling.service.many.ajax.service.get",Ke,{language:r,words:n});return t.execute(e)}),c=Ve(i).map(function(n){var e=Rn(n);if(0<e.values.length){var t=Y(e.values,o),r=G(t,In,{});return an.value(r)}return 0<e.errors.length?an.error("Failures communicating with the spelling server: "+e.errors.join(", ")):an.error("Unknown error")});return fe.wrap(c)},Xe=function(t,o,r,n,u,i,e){var c=function(n){return n.spell};return De(function(n,e){return Ye(t,c,r,n,i)},o,n,k,u,void 0!==e&&e).mapResult(function(e){X(n,function(n){L(e,n)||o.set(n,Ge,u)});var r={};return _(e,function(e,t){o.get(u,t).each(function(n){n!==Ge&&(r[t]=e)})}),r})},$e=function(n){void 0===n&&(n={});var t={};return _(n,function(n,e){t[e]=le(n)}),t},Ge=Je("good-spelling"),Qe=function(n,e){return R(n,e).getOrThunk(function(){return le()})},Ze=function(n){return(e=n,t={},X(e,function(n){t[n]={}}),O(t)).sort();var e,t},nt={chunkSize:1500,maxRetries:3,maxInFlight:8},et=function(n,e,t,r,m){void 0===m&&(m=nt);var h=$e(r),v=$e({}),o=function(n){return u=m.maxRetries,i=Ne(m.maxInFlight,n),{execute:function(n){for(var e=function(){return i.execute(n)},t=function(n){return n.fold(e,fe.pure)},r=e(),o=1;o<u;++o)r=r.bind(t);return fe.wrap(r)}};var u,i},y=o(Ie(n,t)),u=o(Ie(e,t));return{checkMany:function(n,e){var t,o,r,u,i,c,a,f,s,l=Ze(e),d=se(),g=Qe(v,n),p=Qe(h,n);return v[n]=g,h[n]=p,t=y,o=p,r=g,u=n,i=l,c=d,a=m.chunkSize,s=function(n){return n.check},De(function(n,e){return Ye(t,s,u,n,a)},r,i,k,c,void 0!==f&&f).mapResult(function(n){var t=[],r={};return _(n,function(n,e){n?o.set(e,Ge,c):r[e]=t}),r})},correctOne:function(n,e){var t=se(),r=Qe(h,n);return h[n]=r,Xe(u,r,n,[e],t,m.chunkSize)},correctMany:function(n,e){var t=Ze(e),r=se(),o=Qe(h,n);return h[n]=o,Xe(u,o,n,t,r,m.chunkSize)},dumpCache:function(){return I(h,function(n){return n.dump()})}}},tt=function(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:w(n)}},rt={fromHtml:function(n,e){var t=(e||E.document).createElement("div");if(t.innerHTML=n,!t.hasChildNodes()||1<t.childNodes.length)throw E.console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return tt(t.childNodes[0])},fromTag:function(n,e){var t=(e||E.document).createElement(n);return tt(t)},fromText:function(n,e){var t=(e||E.document).createTextNode(n);return tt(t)},fromDom:tt,fromPoint:function(n,e,t){var r=n.dom();return T.from(r.elementFromPoint(e,t)).map(tt)}},ot=(E.Node.ATTRIBUTE_NODE,E.Node.CDATA_SECTION_NODE,E.Node.COMMENT_NODE),ut=E.Node.DOCUMENT_NODE,it=(E.Node.DOCUMENT_TYPE_NODE,E.Node.DOCUMENT_FRAGMENT_NODE,E.Node.ELEMENT_NODE),ct=E.Node.TEXT_NODE,at=(E.Node.PROCESSING_INSTRUCTION_NODE,E.Node.ENTITY_REFERENCE_NODE,E.Node.ENTITY_NODE,E.Node.NOTATION_NODE,function(n,e){return function(n,e){for(var t=null!=e?e:we,r=0;r<n.length&&null!=t;++r)t=t[n[r]];return t}(n.split("."),e)}),ft=function(n,e){var t=at(n,e);if(null==t)throw new Error(n+" not available on this browser");return t},st=function(n){var e,t=at("ownerDocument.defaultView",n);return(e=t,ft("HTMLElement",e)).prototype.isPrototypeOf(n)},lt=function(n){return n.dom().nodeName.toLowerCase()},dt=function(n){return n.dom().nodeType},gt=function(e){return function(n){return dt(n)===e}},pt=function(n){return dt(n)===ot||"#comment"===lt(n)},mt=gt(it),ht=gt(ct),vt=function(n,e,t){if(!(j(t)||F(t)||W(t)))throw E.console.error("Invalid call to Attr.set. Key ",e,":: Value ",t,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,t+"")},yt=function(n,e,t){vt(n.dom(),e,t)},bt=function(n,e){var t=n.dom().getAttribute(e);return null===t?void 0:t},wt=function(n,e){n.dom().removeAttribute(e)};var kt=function(n,e,t){return 0!=(n.compareDocumentPosition(e)&t)},xt=function(n,e){return kt(n,e,E.Node.DOCUMENT_POSITION_CONTAINED_BY)},Tt=function(n){var e=n,t=function(){return e};return{get:t,set:function(n){e=n},clone:function(){return Tt(t())}}},Ot=function(){return St(0,0)},St=function(n,e){return{major:n,minor:e}},_t={nu:St,detect:function(n,e){var t=String(e).toLowerCase();return 0===n.length?Ot():function(n,e){var t=function(n,e){for(var t=0;t<n.length;t++){var r=n[t];if(r.test(e))return r}}(n,e);if(!t)return{major:0,minor:0};var r=function(n){return Number(e.replace(t,"$"+n))};return St(r(1),r(2))}(n,t)},unknown:Ot},Et="Firefox",Ct=function(n,e){return function(){return e===n}},It=function(n){var e=n.current;return{current:e,version:n.version,isEdge:Ct("Edge",e),isChrome:Ct("Chrome",e),isIE:Ct("IE",e),isOpera:Ct("Opera",e),isFirefox:Ct(Et,e),isSafari:Ct("Safari",e)}},Nt={unknown:function(){return It({current:void 0,version:_t.unknown()})},nu:It,edge:w("Edge"),chrome:w("Chrome"),ie:w("IE"),opera:w("Opera"),firefox:w(Et),safari:w("Safari")},At="Windows",Dt="Android",Rt="Solaris",Lt="FreeBSD",Mt="ChromeOS",jt=function(n,e){return function(){return e===n}},Pt=function(n){var e=n.current;return{current:e,version:n.version,isWindows:jt(At,e),isiOS:jt("iOS",e),isAndroid:jt(Dt,e),isOSX:jt("OSX",e),isLinux:jt("Linux",e),isSolaris:jt(Rt,e),isFreeBSD:jt(Lt,e),isChromeOS:jt(Mt,e)}},Bt={unknown:function(){return Pt({current:void 0,version:_t.unknown()})},nu:Pt,windows:w(At),ios:w("iOS"),android:w(Dt),linux:w("Linux"),osx:w("OSX"),solaris:w(Rt),freebsd:w(Lt),chromeos:w(Mt)},Ft=function(n,e){var t=String(e).toLowerCase();return Q(n,function(n){return n.search(t)})},zt=function(n,t){return Ft(n,t).map(function(n){var e=_t.detect(n.versionRegexes,t);return{current:n.name,version:e}})},Wt=function(n,t){return Ft(n,t).map(function(n){var e=_t.detect(n.versionRegexes,t);return{current:n.name,version:e}})},qt=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Ut=function(e){return function(n){return ve(n,e)}},Vt=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return ve(n,"edge/")&&ve(n,"chrome")&&ve(n,"safari")&&ve(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,qt],search:function(n){return ve(n,"chrome")&&!ve(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return ve(n,"msie")||ve(n,"trident")}},{name:"Opera",versionRegexes:[qt,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Ut("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Ut("firefox")},{name:"Safari",versionRegexes:[qt,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(ve(n,"safari")||ve(n,"mobile/"))&&ve(n,"applewebkit")}}],Ht=[{name:"Windows",search:Ut("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return ve(n,"iphone")||ve(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Ut("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Ut("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Ut("linux"),versionRegexes:[]},{name:"Solaris",search:Ut("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Ut("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Ut("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Jt={browsers:w(Vt),oses:w(Ht)},Kt=Tt(function(n,e){var t,r,o,u,i,c,a,f,s,l,d,g,p=Jt.browsers(),m=Jt.oses(),h=zt(p,n).fold(Nt.unknown,Nt.nu),v=Wt(m,n).fold(Bt.unknown,Bt.nu);return{browser:h,os:v,deviceType:(r=h,o=n,u=e,i=(t=v).isiOS()&&!0===/ipad/i.test(o),c=t.isiOS()&&!i,a=t.isiOS()||t.isAndroid(),f=a||u("(pointer:coarse)"),s=i||!c&&a&&u("(min-device-width:768px)"),l=c||a&&!s,d=r.isSafari()&&t.isiOS()&&!1===/safari/i.test(o),g=!l&&!s&&!d,{isiPad:w(i),isiPhone:w(c),isTablet:w(s),isPhone:w(l),isTouch:w(f),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:w(d),isDesktop:w(g)})}}(E.navigator.userAgent,function(n){return E.window.matchMedia(n).matches})),Yt=function(){return Kt.get()},Xt=it,$t=ut,Gt=function(n,e){var t=n.dom();if(t.nodeType!==Xt)return!1;var r=t;if(void 0!==r.matches)return r.matches(e);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(e);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(e);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")},Qt=function(n,e){var t,r=void 0===e?E.document:e.dom();return(t=r).nodeType!==Xt&&t.nodeType!==$t||0===t.childElementCount?[]:Y(r.querySelectorAll(n),rt.fromDom)},Zt=function(n,e){return n.dom()===e.dom()},nr=(Yt().browser.isIE(),Gt),er=function(n){var e=ht(n)?n.dom().parentNode:n.dom();return null!=e&&e.ownerDocument.body.contains(e)},tr=function(n,e,t){for(var r=n.dom(),o=z(t)?t:w(!1);r.parentNode;){r=r.parentNode;var u=rt.fromDom(r);if(e(u))return T.some(u);if(o(u))break}return T.none()},rr=function(n,e,t){return tr(n,function(n){return Gt(n,e)},t)},or=function(n,e,t){return r=rr,i=t,Gt(o=n,u=e)?T.some(o):z(i)&&i(o)?T.none():r(o,u,i);var r,o,u,i},ur={ar:"Arabic",ca:"Catalan",zh:"Chinese",zh_cn:"Chinese (Simplified)",zh_tw:"Chinese (Traditional)",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch",en:"English",en_au:"English (Australia)",en_ca:"English (Canada)",en_gb:"English (United Kingdom)",en_us:"English (United States)",fa:"Farsi",fi:"Finnish",fr:"French",fr_ca:"French (Canada)",de:"German",el:"Greek",he:"Hebrew",hu:"Hungarian",it:"Italian",ja:"Japanese",kk:"Kazakh",ko:"Korean",nb:"Norwegian",no:"Norwegian",pl:"Polish",pt:"Portuguese",pt_br:"Portuguese (Brazil)",pt_pt:"Portuguese (Portugal)",ro:"Romanian",ru:"Russian",sk:"Slovak",sl:"Slovenian",es:"Spanish",es_419:"Spanish (Latin America)",es_es:"Spanish (Spain)",sv:"Swedish",tt:"Tatar",th:"Thai",tr:"Turkish",uk:"Ukrainian"},ir=["en_us","en_gb","da","nl","fi","fr","de","it","nb","pt","pt_pt","es","sv"],cr=[{value:"no.language",text:"Off"}],ar=function(n){return n.getParam("spellchecker_dialog",!1,"boolean")},fr={useDialog:ar,getLanguage:function(n){return n.getParam("spellchecker_language","en_us","string")},setLanguage:function(n,e){n.settings.spellchecker_language=e},getLanguages:function(n){var e,t=!ar(n),r=n.getParam("spellchecker_languages",ir),o=[];return j(r)?(e=r.split(","),o=Y(e,function(n){var e=n.split("=");return{value:e[1],text:e[0]}})):B(r)&&(o=Y(r,function(n){return{value:n,text:L(ur,n)?ur[n]:n.toUpperCase()}})),t?cr.concat(o):o},getWhitelist:function(n){return n.getParam("spellchecker_whitelist",[],"array")},getApiKey:function(n){return n.getParam("api_key")||n.getParam("spellchecker_api_key")},getHandler:function(n){return n.getParam("spellchecker_handler")},getRpcUrl:function(n){return n.getParam("spellchecker_rpc_url","","string")},isActive:function(n){return n.getParam("spellchecker_active",!0,"boolean")},getSelectContentLanguages:function(n){return n.getParam("spellchecker_select_languages","en,es,fr,de,pt,zh")},getSpellingServiceSettings:function(n){return{chunkSize:n.getParam("spellchecker_service_chunk_size",nt.chunkSize,"number"),maxRetries:n.getParam("spellchecker_service_max_retries",nt.maxRetries,"number"),maxInFlight:n.getParam("spellchecker_service_max_in_flight",nt.maxInFlight,"number")}}},sr=function(n){return void 0!==n.style&&z(n.style.getPropertyValue)},lr=function(n,e,t){!function(n,e,t){if(!j(t))throw E.console.error("Invalid call to CSS.set. Property ",e,":: Value ",t,":: Element ",n),new Error("CSS value must be a string: "+t);sr(n)&&n.style.setProperty(e,t)}(n.dom(),e,t)},dr=function(n,e){var t=n.dom(),r=E.window.getComputedStyle(t).getPropertyValue(e),o=""!==r||er(n)?r:gr(t,e);return null===o?void 0:o},gr=function(n,e){return sr(n)?n.style.getPropertyValue(e):""},pr=function(n,e){var t=n.dom(),r=gr(t,e);return T.from(r).filter(function(n){return 0<n.length})},mr=function(n,e){var t,r,o,u,i=n.dom();r=e,sr(t=i)&&t.style.removeProperty(r),o="style",(u=n.dom())&&u.hasAttribute&&u.hasAttribute(o)&&""===be(bt(n,"style"))&&wt(n,"style")},hr=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(e.length!==t.length)throw new Error('Wrong number of arguments to struct. Expected "['+e.length+']", got '+t.length+" arguments");var r={};return X(e,function(n,e){r[n]=w(t[e])}),r}},vr=function(n){return n.slice(0).sort()},yr=function(n,e){throw new Error("All required keys ("+vr(n).join(", ")+") were not specified. Specified keys were: "+vr(e).join(", ")+".")},br=function(n){throw new Error("Unsupported keys for object: "+vr(n).join(", "))},wr=function(e,n){if(!B(n))throw new Error("The "+e+" fields must be an array. Was: "+n+".");X(n,function(n){if(!j(n))throw new Error("The value "+n+" in the "+e+" fields was not a string.")})},kr=function(n){var t=vr(n);Q(t,function(n,e){return e<t.length-1&&n===t[e+1]}).each(function(n){throw new Error("The field: "+n+" occurs more than once in the combined fields: ["+t.join(", ")+"].")})},xr=function(n){return rt.fromDom(n.dom().ownerDocument)},Tr=function(n){return T.from(n.dom().parentNode).map(rt.fromDom)},Or=function(n,e){for(var t=z(e)?e:l,r=n.dom(),o=[];null!==r.parentNode&&void 0!==r.parentNode;){var u=r.parentNode,i=rt.fromDom(u);if(o.push(i),!0===t(i))break;r=u}return o},Sr=function(n){return T.from(n.dom().previousSibling).map(rt.fromDom)},_r=function(n){return T.from(n.dom().nextSibling).map(rt.fromDom)},Er=function(n){return Y(n.dom().childNodes,rt.fromDom)},Cr=function(n,e){var t=n.dom().childNodes;return T.from(t[e]).map(rt.fromDom)},Ir=function(n){return n.dom().childNodes.length},Nr=hr("element","offset"),Ar=function(e,t){Tr(e).each(function(n){n.dom().insertBefore(t.dom(),e.dom())})},Dr=function(n,e){_r(n).fold(function(){Tr(n).each(function(n){Lr(n,e)})},function(n){Ar(n,e)})},Rr=function(e,t){Cr(e,0).fold(function(){Lr(e,t)},function(n){e.dom().insertBefore(t.dom(),n.dom())})},Lr=function(n,e){n.dom().appendChild(e.dom())},Mr=function(n,e){Ar(n,e),Lr(e,n)},jr=function(e,n){X(n,function(n){Ar(e,n)})},Pr=function(r,o){X(o,function(n,e){var t=0===e?r:o[e-1];Dr(t,n)})},Br=function(e,n){X(n,function(n){Lr(e,n)})},Fr=function(n,e){var t=[];return X(Er(n),function(n){e(n)&&(t=t.concat([n])),t=t.concat(Fr(n,e))}),t},zr=function(n){var e=n.dom();null!==e.parentNode&&e.parentNode.removeChild(e)},Wr=function(n){var e=Er(n);0<e.length&&jr(n,e),zr(n)},qr=function(n,e){return Qt(e,n)};var Ur,Vr,Hr,Jr=(Ur=ht,Vr="text",{get:function(n){if(!Ur(n))throw new Error("Can only get "+Vr+" value of a "+Vr+" node");return Hr(n).getOr("")},getOption:Hr=function(n){return Ur(n)?T.from(n.dom().nodeValue):T.none()},set:function(n,e){if(!Ur(n))throw new Error("Can only set raw "+Vr+" value of a "+Vr+" node");n.dom().nodeValue=e}}),Kr=function(n){return Jr.get(n)},Yr=function(n,e){Jr.set(n,e)},Xr=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function $r(){return{up:w({selector:rr,closest:or,predicate:tr,all:Or}),down:w({selector:qr,predicate:Fr}),styles:w({get:dr,getRaw:pr,set:lr,remove:mr}),attrs:w({get:bt,set:yt,remove:wt,copyTo:function(n,e){var t,r,o=G(n.dom().attributes,function(n,e){return n[e.name]=e.value,n},{});t=o,r=e.dom(),_(t,function(n,e){vt(r,e,n)})}}),insert:w({before:Ar,after:Dr,afterAll:Pr,append:Lr,appendAll:Br,prepend:Rr,wrap:Mr}),remove:w({unwrap:Wr,remove:zr}),create:w({nu:rt.fromTag,clone:function(n){return rt.fromDom(n.dom().cloneNode(!1))},text:rt.fromText}),query:w({comparePosition:function(n,e){return n.dom().compareDocumentPosition(e.dom())},prevSibling:Sr,nextSibling:_r}),property:w({children:Er,name:lt,parent:Tr,document:function(n){return n.dom().ownerDocument},isText:ht,isComment:pt,isElement:mt,getText:Kr,setText:Yr,isBoundary:function(n){return!!mt(n)&&("body"===lt(n)||J(Xr,lt(n)))},isEmptyTag:function(n){return!!mt(n)&&J(["br","img","hr","input"],lt(n))},isNonEditable:function(n){return mt(n)&&"false"===bt(n,"contenteditable")}}),eq:Zt,is:nr}}var Gr=hr("element","offset"),Qr=(hr("element","deltaOffset"),hr("element","start","finish")),Zr=(hr("begin","end"),hr("element","text"),function(n,e){if(n.property().isText(e))return Gr(e,n.property().getText(e).length);var t=n.property().children(e);return 0<t.length?Zr(n,t[t.length-1]):Gr(e,t.length)}),no=function(n,e,t){var r=n.property().children(e);return 0<r.length&&t<r.length?no(n,r[t],0):0<r.length&&n.property().isElement(e)&&r.length===t?Zr(n,r[r.length-1]):Gr(e,t)},eo=no,to=$r(),ro=function(n,e){return eo(to,n,e)},oo=function(n){var r=hr.apply(null,n),o=[];return{bind:function(n){if(void 0===n)throw new Error("Event bind error: undefined handler");o.push(n)},unbind:function(e){o=$(o,function(n){return n!==e})},trigger:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=r.apply(null,n);X(o,function(n){n(t)})}}},uo={create:function(n){return{registry:I(n,function(n){return{bind:n.bind,unbind:n.unbind}}),trigger:I(n,function(n){return n.trigger})}}},io=function(){return n=function(n){n.unbind()},e=Tt(T.none()),t=function(){e.get().each(n)},{clear:function(){t(),e.set(T.none())},isSet:function(){return e.get().isSome()},set:function(n){t(),e.set(T.some(n))}};var n,e,t},co=function(t,r){var o=null;return{cancel:function(){null!==o&&(E.clearTimeout(o),o=null)},throttle:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];null!==o&&E.clearTimeout(o),o=E.setTimeout(function(){t.apply(null,n),o=null},r)}}},ao=Sn([{aboveView:["item"]},{inView:["item"]},{belowView:["item"]}]),fo=Xn(Xn({},ao),{cata:function(n,e,t,r){return n.fold(e,t,r)}}),so=function(n){var e,t,r,o,u,i,c,a=rt.fromDom(n.target),f=function(){n.stopPropagation()},s=function(){n.preventDefault()},l=d(s,f);return e=a,t=n.clientX,r=n.clientY,o=f,u=s,i=l,c=n,{target:w(e),x:w(t),y:w(r),stop:o,prevent:u,kill:i,raw:w(c)}},lo=function(n,e,t,r,o){var u,i,c=(u=t,i=r,function(n){u(n)&&i(so(n))});return n.dom().addEventListener(e,c,o),{unbind:a(go,n,e,c,o)}},go=function(n,e,t,r){n.dom().removeEventListener(e,t,r)},po=w(!0),mo=function(n,e,t){return lo(n,e,po,t,!1)},ho=function(n,e){return n+e.top},vo=function(n){return n.dom().getBoundingClientRect()};function yo(i,n){var t=io(),e=uo.create({onChange:oo([])}),r=co(function(){e.trigger.onChange()},1e3),o=function(){return!i.inline&&ve(i.settings.plugins,"autoresize")},u=function(){return!i.inline&&!o()},c=function(){return u()?i.getWin():E.window};n&&(i.on("init",function(){var n=u()?i.getDoc():E.document,e=rt.fromDom(n);t.set(mo(e,"scroll",function(){r.throttle()})),r.throttle()}),i.on("remove",t.clear));var a=function(){if(o()){var t=(i.inline?i.getBody():i.getContentAreaContainer()).getBoundingClientRect();return function(n){var e=vo(n);return Xn(Xn({},e),{top:ho(e.top,t),bottom:ho(e.bottom,t)})}}return vo};return{sections:function(){return function(){var n=i.getBody();if(!n)return[];var e=c(),t=a(),r=e.innerHeight,o=rt.fromDom(n),u=Er(o);return Z(u,function(n){if(!mt(n))return!1;var e=t(n);return e.top<r&&0<e.bottom}).map(function(e){var n=Z(u.slice(e+1),function(n){if(!mt(n))return!1;var e=t(n);return!(e.top<r&&0<e.bottom)}).map(function(n){return e+1+n}).getOr(u.length);return u.slice(e,n)}).getOr([o])}()},viewport:function(){var n=c(),o=n?n.innerHeight:0,u=a();return{assess:function(n){if(!mt(n))return fo.inView(n);var e,t,r=u(n);return t=o,((e=r).bottom<0?fo.aboveView:e.top>t?fo.belowView:fo.inView)(n)}}},events:e.registry}}var bo={fireSpellcheckStart:function(n){return n.fire("SpellcheckStart")},fireSpellcheckEnd:function(n){return n.fire("SpellcheckEnd")},fireIgnore:function(n,e){return n.fire("SpellcheckerIgnore",{word:e})},fireIgnoreAll:function(n,e){return n.fire("SpellcheckerIgnoreAll",{word:e})},fireError:function(n,e){return n.fire("SpellcheckError",e)}},wo=function(n,e,t,r){var o,u,i,c,a,f=(u=e,i=t,c=r,(a=xr(o=n).dom().createRange()).setStart(o.dom(),u),a.setEnd(i.dom(),c),a),s=Zt(n,t)&&e===r;return f.collapsed&&!s},ko=Sn([{single:["element"]},{range:["start","soffset","finish","foffset"]}]),xo={cata:function(n,e,t){return n.fold(e,t)},single:ko.single,range:function(n,e,t,r){var o=wo(t,r,n,e),u=o?Gr(n,e):Gr(t,r),i=o?Gr(t,r):Gr(n,e);return ko.range(u.element(),u.offset(),i.element(),i.offset())}},To=function(n,e){var t=bt(n,e);return void 0===t||""===t?[]:t.split(" ")},Oo=function(n){return void 0!==n.dom().classList},So=function(n,e){return o=e,u=To(t=n,r="class").concat([o]),yt(t,r,u.join(" ")),!0;var t,r,o,u},_o=function(n,e){return o=e,0<(u=$(To(t=n,r="class"),function(n){return n!==o})).length?yt(t,r,u.join(" ")):wt(t,r),!1;var t,r,o,u},Eo=function(n,e){Oo(n)?n.dom().classList.add(e):So(n,e)},Co=function(n){0===(Oo(n)?n.dom().classList:To(n,"class")).length&&wt(n,"class")},Io=function(n,e){Oo(n)?n.dom().classList.remove(e):_o(n,e);Co(n)},No="\ufeff",Ao=Sn([{before:["element"]},{after:["element"]},{rest:["element"]},{last:["element"]},{invalid:["element","offset"]}]),Do=(Ao.before,Ao.after,Ao.rest,Ao.last,Ao.invalid,function(n,e){return Z(n,function(n){return n.start()===e})}),Ro=function(n,e,t){var r,o,u=t(n,e);return r=u,o=n.start(),Y(r,function(n){return Xn(Xn({},n),{start:w(n.start()+o),finish:w(n.finish()+o)})})},Lo=function(n,t,e){return void 0===e&&(e=0),G(n,function(e,n){return t(n,e.len).fold(w(e),function(n){return{len:n.finish(),list:e.list.concat([n])}})},{len:e,list:[]}).list},Mo=function(n,e,t){return 0===e.length?n:en(n,function(r){var n=en(e,function(n){return(t=n)>=(e=r).start()&&t<=e.finish()?[n-r.start()]:[];var e,t});return 0<n.length?Ro(r,n,t):[r]})},jo=function(o,n,u){var e=Do(o,n),i=Do(o,u);return e.bind(function(n){var e,t,r=i.getOr((t=u,(e=o)[e.length-1]&&e[e.length-1].finish()===t?e.length+1:-1));return-1<r?T.some(o.slice(n,r)):T.none()}).getOr([])},Po=function(r,n){if(0===n.length)return[r];var e=G(n,function(n,e){if(0===e)return n;var t=r.substring(n.prev,e);return{prev:e,values:n.values.concat([t])}},{prev:0,values:[]}),t=n[n.length-1];return t<r.length?e.values.concat(r.substring(t)):e.values},Bo=Sn([{none:[]},{start:["element"]},{middle:["before","after"]},{end:["element"]}]),Fo=(Bo.none,Bo.start,Bo.middle,Bo.end,Sn([{include:["item"]},{excludeWith:["item"]},{excludeWithout:["item"]}])),zo={include:Fo.include,excludeWith:Fo.excludeWith,excludeWithout:Fo.excludeWithout,cata:function(n,e,t,r){return n.fold(e,t,r)}},Wo=function(n,t){var r=[],o=[];return X(n,function(n){var e=t(n);zo.cata(e,function(){o.push(n)},function(){0<o.length&&r.push(o),r.push([n]),o=[]},function(){0<o.length&&r.push(o),o=[]})}),0<o.length&&r.push(o),r},qo=Sn([{boundary:["item","universe"]},{empty:["item","universe"]},{text:["item","universe"]},{nonEditable:["item","universe"]}]),Uo=l,Vo=g,Ho=w(0),Jo=w(1),Ko=function(n){return Xn(Xn({},n),{isBoundary:function(){return n.fold(Vo,Uo,Uo,Uo)},toText:function(){return n.fold(T.none,T.none,function(n){return T.some(n)},T.none)},is:function(t){return n.fold(Uo,Uo,function(n,e){return e.eq(n,t)},Uo)},len:function(){return n.fold(Ho,Jo,function(n,e){return e.property().getText(n).length},Jo)}})},Yo={text:d(Ko,qo.text),boundary:d(Ko,qo.boundary),empty:d(Ko,qo.empty),nonEditable:d(Ko,qo.empty),cata:function(n,e,t,r,o){return n.fold(e,t,r,o)}},Xo=w([]),$o=function(e,n,t){if(e.property().isText(n))return[Yo.text(n,e)];if(e.property().isEmptyTag(n))return[Yo.empty(n,e)];if(e.property().isNonEditable(n))return[];if(e.property().isElement(n)){var r=e.property().children(n),o=e.property().isBoundary(n)?[Yo.boundary(n,e)]:[],u=void 0!==t&&t(n)?[]:en(r,function(n){return $o(e,n,t)});return o.concat(u).concat(o)}return[]},Go=$o,Qo=function(e,n,t){var r=en(n,function(n){return Go(e,n,t)}),o=Wo(r,function(n){return n.match({boundary:function(){return zo.excludeWithout(n)},empty:function(){return zo.excludeWith(n)},text:function(){return zo.include(n)},nonEditable:function(){return zo.excludeWithout(n)}})});return $(o,function(n){return 0<n.length})},Zo=(hr("before","after"),function(e,t){return{element:w(t),wrap:function(n){e.insert().append(t,n)}}}),nu=function(t,n,r){if(0===n.length)return n;var e=$(n,function(n){return t.property().isText(n)&&0<t.property().getText(n).length});return Y(e,function(n){var e=r();return t.insert().before(n,e.element()),e.wrap(n),e.element()})},eu=$r(),tu={assess:fo.inView},ru={anything:w(tu)},ou=function(e,n){return e.up().closest(n,"[lang]",w(!1)).map(function(n){return e.attrs().get(n,"lang")})},uu=function(e){var t=[],n=[],r=[],o=e,u=function(n){n.each(function(n){t.push(n)})},i=function(n){n.each(function(n){t=t.slice(0,t.length-1)})},c=function(){0<r.length&&n.push({lang:w(o),details:w(r)})},a=function(n){c(),r=[],o=n},f=function(n){return n.or(T.from(t[t.length-1])).getOr(e)};return{openInline:function(n,e){var t=f(n);t!==o&&a(t),u(n)},closeInline:function(n,e){i(n)},addDetail:function(n){var e=f(T.none());e!==o&&a(e),r.push(n)},addEmpty:function(n){var e=f(T.none());a(e)},openBoundary:function(n,e){u(n);var t=f(n);a(t)},closeBoundary:function(n,e){i(n);var t=f(n);a(t)},done:function(){return c(),n.slice(0)}}},iu=ou,cu=function(r){return function(n,e){var t=ou(n,e);return!r.equals(t)}},au=function(r,o){return function(n,e){var t=ou(n,e).getOr(r);return o!==t}},fu=hr("item","mode"),su=function(n,e,t,r){return void 0===r&&(r=lu),n.property().parent(e).map(function(n){return fu(n,r)})},lu=function(n,e,t,r){return void 0===r&&(r=du),t.sibling(n,e).map(function(n){return fu(n,r)})},du=function(n,e,t,r){void 0===r&&(r=du);var o=n.property().children(e);return t.first(o).map(function(n){return fu(n,r)})},gu=[{current:su,next:lu,fallback:T.none()},{current:lu,next:du,fallback:T.some(su)},{current:du,next:du,fallback:T.some(lu)}],pu=function(e,t,r,o,n){return void 0===n&&(n=gu),Q(n,function(n){return n.current===r}).bind(function(n){return n.current(e,t,o,n.next).orThunk(function(){return n.fallback.bind(function(n){return pu(e,t,n,o)})})})},mu={left:function(){return{sibling:function(n,e){return n.query().prevSibling(e)},first:function(n){return 0<n.length?T.some(n[n.length-1]):T.none()}}},right:function(){return{sibling:function(n,e){return n.query().nextSibling(e)},first:function(n){return 0<n.length?T.some(n[0]):T.none()}}}},hu=function(e,n,t,r,o,u){return pu(e,n,r,o).bind(function(n){return u(n.item())?T.none():t(n.item())?T.some(n.item()):hu(e,n.item(),t,n.mode(),o,u)})},vu=function(n,e,t,r){return hu(n,e,t,lu,mu.right(),r)},yu=vu,bu=function(){return{left:mu.left,right:mu.right}},wu=pu,ku=hr("item","start","finish","text"),xu=hr("items","abort"),Tu=function(n,e){var t=n.property().getText(e);return ku(e,0,t.length,t)},Ou=function(n,e,t){return xu([],!0)},Su=function(n,e,t){return xu([],!1)},_u=function(n,t,e){var r=n.property().getText(t);return e(r).fold(function(){return xu([ku(t,0,r.length,r)],!1)},function(n){var e=n[0]===n[1]?[]:[ku(t,n[0],n[1],r.substring(n[0],n[1]))];return xu(e,!0)})},Eu=Tu,Cu=function(n,e){return n.property().isText(e)?Tu(n,e):ku(e,0,0,"")},Iu=function(n,e,t,r){return(n.property().isBoundary(e)?Ou:n.property().isEmptyTag(e)?Ou:r(n,e)?Ou:n.property().isText(e)?_u:Su)(n,e,t)},Nu=w("[^\\w'\\-\\u0100-\\u017F\\u00C0-\\u00FF\ufeff\\u2018\\u2019]"),Au=w("[\\w'\\-\\u0100-\\u017F\\u00C0-\\u00FF\ufeff\\u2018\\u2019]"),Du=function(n,e,t,r){return{term:function(){return new RegExp(n,r.getOr("g"))},prefix:e,suffix:t}},Ru=function(n){return Du(n,w(0),w(0),T.none())},Lu=function(n){return n.replace(/[-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},Mu=function(n){var e,t,r=Lu(n);return e=r,t="((?:^'?)|(?:"+Nu()+"+'?))"+e+"((?:'?$)|(?:'?"+Nu()+"+))",Du(t,function(n){return 1<n.length?n[1].length:0},function(n){return 2<n.length?n[2].length:0},T.none())},ju=Du,Pu=Ru,Bu=Nu,Fu=Au,zu=function(n,e){for(var t=e.term(),r=[],o=t.exec(n);o;){var u=o.index+e.prefix(o),i=o[0].length-e.prefix(o)-e.suffix(o);r.push({start:w(u),finish:w(u+i)}),t.lastIndex=u+i,o=t.exec(n)}return r},Wu=zu,qu=function(t,n){var e,r,o=en(n,function(e){var n=zu(t,e.pattern());return Y(n,function(n){return Xn(Xn({},e),n)})});return e=o,(r=Array.prototype.slice.call(e,0)).sort(function(n,e){return n.start()<e.start()?-1:e.start()<n.start()?1:0}),r},Uu=new RegExp(Bu()+"+","g"),Vu=w(0),Hu=function(n){var e=Wu(n,ju(Bu(),Vu,Vu,T.none()));return T.from(e[e.length-1]).map(function(n){return n.start()})},Ju=function(n){var e=n.search(Uu);return-1<e?T.some(e):T.none()},Ku={firstWord:function(e){return Ju(e).map(function(n){return e.substring(0,n+1)})},lastWord:function(e){return Hu(e).map(function(n){return e.substring(n)})},leftBreak:Hu,rightBreak:Ju,hasBreak:function(n){return Ju(n).isSome()}},Yu=bu(),Xu=Yu.left(),$u=Yu.right(),Gu={left:{sibling:Xu.sibling,first:Xu.first,slicer:function(e){return Ku.leftBreak(e).map(function(n){return[n+1,e.length]})}},right:{sibling:$u.sibling,first:$u.first,slicer:function(n){return Ku.rightBreak(n).map(function(n){return[0,n]})}}},Qu=function(r,n,e,o,u){var t=wu(r,n,e,o).map(function(n){var e=Iu(r,n.item(),o.slicer,u),t=e.abort()?[]:Qu(r,n.item(),n.mode(),o,u);return e.items().concat(t)}).getOr([]);return $(t,function(n){return 0<n.text().trim().length})},Zu=function(n,e,t){return Qu(n,e,lu,Gu.left,t)},ni=function(n,e,t){return Qu(n,e,lu,Gu.right,t)},ei=function(n,e){return!n.property().isText(e)&&0===n.down().predicate(e,n.property().isText).length},ti=function(n,e,t,r){var o=Zu(n,e,r),u=ni(n,t,r),i=0<o.length?o[o.length-1]:Cu(n,e),c=0<u.length?u[u.length-1]:Cu(n,t),a=0===o.length&&0===u.length;return{left:w(i),right:w(c),isEmpty:w(a)}},ri={byBoundary:function(n,e){var t=w(!1),r=ti(n,e,e,t),o=r.isEmpty()&&ei(n,e);return{left:r.left,right:r.right,isEmpty:w(o)}},getEdges:ti,byLanguage:function(n,e){var t=iu(n,e),r=cu(t),o=Zu(n,e,r),u=ni(n,e,r),i=n.property().isText(e)?[Eu(n,e)]:[],c=rn(o).concat(i).concat(u);return{all:w(c),left:w(o),middle:w(i),right:w(u),lang:w(t)}}},oi=hr("left","right"),ui=hr("first","second","splits"),ii=function(n,e,t){var r=n.property().children(e);return Z(r,a(n.eq,t)).map(function(n){return{before:w(r.slice(0,n)),after:w(r.slice(n+1))}})},ci=function(r,o,n,e){var t,u,i=o(r,n);return t=function(n,e){var t=o(r,e);return ai(r,n,t)},u=i,function(n,e){for(var t=n.length-1;0<=t;t--)e(n[t],t)}(e,function(n){u=t(u,n)}),u},ai=function(e,n,t){return n.bind(function(n){return t.filter(a(e.eq,n))})},fi=function(n,e){return a(n.eq,e)},si=function(e,n,t,r){void 0===r&&(r=l);var o=[n].concat(e.up().all(n)),u=[t].concat(e.up().all(t)),i=function(e){return Z(e,r).fold(function(){return e},function(n){return e.slice(0,n+1)})},c=i(o),a=i(u),f=Q(c,function(n){return K(a,fi(e,n))});return{firstpath:w(c),secondpath:w(a),shared:w(f)}},li={sharedOne:function(n,e,t){return 0<t.length?ci(n,e,(r=t)[0],r.slice(1)):T.none();var r},subset:function(e,n,t){var r=si(e,n,t);return r.shared().bind(function(n){return function(o,u,n,e){var i=o.property().children(u);if(o.eq(u,n[0]))return T.some([n[0]]);if(o.eq(u,e[0]))return T.some([e[0]]);var t=function(n){var e=rn(n),t=Z(e,fi(o,u)).getOr(-1),r=t<e.length-1?e[t+1]:e[t];return Z(i,fi(o,r))},r=t(n),c=t(e);return r.bind(function(r){return c.map(function(n){var e=Math.min(r,n),t=Math.max(r,n);return i.slice(e,t+1)})})}(e,n,r.firstpath(),r.secondpath())})},ancestors:si,breakToLeft:function(t,r,o){return ii(t,r,o).map(function(n){var e=t.create().clone(r);return t.insert().appendAll(e,n.before().concat([o])),t.insert().appendAll(r,n.after()),t.insert().before(r,e),oi(e,r)})},breakToRight:function(t,r,n){return ii(t,r,n).map(function(n){var e=t.create().clone(r);return t.insert().appendAll(e,n.after()),t.insert().after(r,e),oi(r,e)})},breakPath:function(u,n,i,c){var a=function(n,e,o){var t=ui(n,T.none(),o);return i(n)?ui(n,e,o):u.property().parent(n).bind(function(r){return c(u,r,n).map(function(n){var e=[{first:n.left,second:n.right}],t=i(r)?r:n.left();return a(t,T.some(n.right()),o.concat(e))})}).getOr(t)};return a(n,T.none(),[])}},di=hr("word","left","right"),gi=["'","‘","’"],pi=en(gi,function(e){return Y(["twas"],function(n){return e+n})}),mi=function(n){return J(gi,n)},hi=function(n){var e,t,r=n.word();return 2<=r.length&&mi(r.charAt(r.length-1))&&!mi(r.charAt(r.length-2))?(t=(e=n).word(),di(t.substring(0,t.length-1),e.left(),T.some(t.charAt(t.length-1)))):n},vi=function(n){var e,t,r=n.word(),o=K(pi,function(n){return-1<r.indexOf(n)})?2:1,u=r.substring(0,o);return tn(u,mi)&&!mi(r.charAt(o))?(t=(e=n).word(),di(t.substring(1),T.some(t.charAt(0)),e.right())):n},yi=function(n){var e=hi(n);return vi(e)},bi=yi,wi=function(c){var n=Pu(Fu()+"+"),e=Wu(c,n),a=c.length;return Y(e,function(n){var e=n.start(),t=n.finish(),r=c.substring(e,t),o=0<e?T.some(c.charAt(e-1)):T.none(),u=t<a?T.some(c.charAt(t)):T.none(),i=di(r,o,u);return bi(i)})},ki=function(o,u){var i=o.concat(u);if(0===i.length)throw new Error("You must specify at least one required or optional field.");return wr("required",o),wr("optional",u),kr(i),function(e){var t=O(e);tn(o,function(n){return J(t,n)})||yr(o,t);var n=$(t,function(n){return!J(i,n)});0<n.length&&br(n);var r={};return X(o,function(n){r[n]=w(e[n])}),X(u,function(n){r[n]=w(Object.prototype.hasOwnProperty.call(e,n)?T.some(e[n]):T.none())}),r}}(["elements","lang","words"],[]),xi=function(n,e){var t=Y(e,function(n){var e=n.details(),t=n.lang(),r=Y(e,function(n){return n.text()}).join(""),o=Y(e,function(n){return n.item()}),u=wi(r);return ki({lang:t,words:u,elements:o})});return{zones:w(t)}},Ti="trampoline.stop",Oi={stop:w(Ti),run:function(n){for(var e=n();e!==Ti;)e=e()}},Si=Sn([{inline:["item","mode","lang"]},{text:["item","mode"]},{empty:["item","mode"]},{boundary:["item","mode","lang"]},{concluded:["item","mode"]}]),_i=function(n,e,t,r){var o=n.property().isElement(e)?T.from(n.attrs().get(e,"lang")):T.none();return n.property().isText(e)?Si.text(e,t):r(e,t)?Si.concluded(e,t):n.property().isBoundary(e)?Si.boundary(e,t,o):n.property().isEmptyTag(e)?Si.empty(e,t):Si.inline(e,t,o)},Ei=function(o,n,u,i,c,a){return function(){return n.fold(function(n,e,t){return(e===du?i.openInline:i.closeInline)(t,n),Ci(o,n,e,u,i,c,a)},function(n,e){var t=c(o,n);return i.addDetail(t),u(n,e)?Oi.stop():Ci(o,n,e,u,i,c,a)},function(n,e){return i.addEmpty(n),Ci(o,n,e,u,i,c,a)},function(e,t,r){var n=a.assess(e);return fo.cata(n,function(n){return t!==su?Ci(o,e,lu,u,i,c,a):Oi.stop()},function(n){return(t===du?i.openBoundary:i.closeBoundary)(r,e),Ci(o,e,t,u,i,c,a)},function(n){return Oi.stop()})},function(n,e){return Oi.stop()})}},Ci=function(n,e,t,r,o,u,i){var c,a,f,s,l=(s=r,wu(c=n,a=e,f=t,bu().right()).fold(function(){return Si.concluded(a,f)},function(n){return _i(c,n.item(),n.mode(),s)}));return Ei(n,l,r,o,u,i)},Ii=function(t,n,r,e,o,u){var i=function(n,e){return t.eq(n,r)&&(e!==du||t.property().isText(n)||0===t.property().children(n).length)},c=uu(e),a=_i(t,n,du,i);return Oi.run(Ei(t,a,i,c,o,u)),c.done()},Ni=function(f,n,e,s,l,d){var t=li.subset(f,n,e).bind(function(n){if(0===n.length)return T.none();var t,r,o,u,i,c,e=n[0],a=n[n.length-1];return r=e,o=a,u=s,i=l,c=d,((t=f).eq(r,o)?T.some(r):t.property().parent(r)).map(function(n){var e=iu(t,n).getOr(u);return Ii(t,r,o,e,i,c)})}).getOr([]);return xi(f,t)},Ai=function(t,r){return function(n,e){return n.eq(e,t.item())?t:n.eq(e,r.item())?r:Eu(n,e)}},Di=function(){return{zones:w([])}},Ri={fromRange:function(n,e,t,r,o){var u=ri.getEdges(n,e,t,w(!1)),i=Ai(u.left(),u.right());return Ni(n,u.left().item(),u.right().item(),r,i,o)},transformEdges:Ai,fromBounded:function(n,e,t,r,o){return Ni(n,e,t,r,Eu,o)},fromBoundedWith:Ni,fromInline:function(n,e,t,r){var o=ri.byBoundary(n,e),u=Ai(o.left(),o.right());return o.isEmpty()?Di():Ni(n,o.left().item(),o.right().item(),t,u,r)},empty:Di},Li=function(n,e,t,r,o,u){var i,c,a=Ri.fromBoundedWith(n,e,t,r,u,ru.anything()).zones();return 1===a.length?(i=a[0],c=o,i.lang()===c?T.some(i):T.none()):T.none()},Mi=function(n,e,t,r,o){return Li(n,e,t,r,o,Eu)},ji=function(n,e,t,r){var o=n.property().isText(e)?n.property().getText(e).length:n.property().children(e).length,u=eo(n,e,0),i=eo(n,e,o);return Mi(n,u.element(),i.element(),t,r)},Pi=Mi,Bi=function(n,e,t,r){var o=au(t,r),u=ri.getEdges(n,e,e,o),i=Ri.transformEdges(u.left(),u.right());return u.isEmpty()?ji(n,e,t,r):Li(n,u.left().item(),u.right().item(),t,r,i)},Fi=function(){return T.none()},zi=function(n,e,t,r){return n.property().isBoundary(e)?Pi(n,e,e,t,r):n.property().isEmptyTag(e)?Fi():Bi(n,e,t,r)},Wi=zi,qi=$r(),Ui=function(n,e,t){return Wi(qi,n,e,t)},Vi=function(n){return en(n,function(n){return Fr(n,ht)})},Hi=Vi,Ji=function(n){var e=Vi(n);return Y(e,function(n){return ht(n)?Kr(n):""}).join("")},Ki=function(n,e,t){return T.from(n[0]).bind(function(n){return Ui(n,e,t).bind(function(n){var e=n.words();return 1===e.length?T.some(e[0]).map(function(n){return n.word()}):T.none()})})},Yi=function(n){return en(n,Er)},Xi=function(t,r){var o=Yi(t),u=Hi(t);return T.from(t[0]).bind(function(n){jr(n,o);var e=T.from(u[0]);return e.each(function(n){Yr(n,r)}),X(u.slice(1),function(n){Yr(n,"")}),X(t,zr),e})};hr("component","index");var $i=function(n){return n.replace(/\./g,"-")},Gi=function(n,e){return n+"-"+e},Qi=function(n){var t=$i(n);return{resolve:function(n){var e=n.split(" ");return Y(e,function(n){return Gi(t,n)}).join(" ")}}};Qi("ephox.flour").resolve;var Zi={resolve:Qi("data.mce").resolve},nc=Zi.resolve("annotation"),ec=Zi.resolve("highlight-id"),tc=function(n){return T.from(bt(n,ec))},rc={nonIgnoredMarker:function(n,e,t){return or(n,"."+e+":not(."+t+")")},allNonIgnoredMarkers:function(n,e,t){return Y(n.dom.select("."+e+":not(."+t+")"),rt.fromDom)},marker:function(n,e){return or(n,"."+e)},id:tc,set:function(n,e){yt(n,ec,e),Eo(n,e)},sameId:function(t){return tc(t).fold(w([t]),function(n){var e=xr(t);return qr(e,"."+n)})},all:function(t){var n;return(n=t,T.from(bt(n,nc))).fold(w([t]),function(n){var e=xr(t);return qr(e,"span["+nc+"="+n+"]")})},otherCurrents:function(n,e){var t=xr(n);return qr(t,"."+e)},label:w(nc)},oc={resolve:Qi("mce").resolve},uc=Zi.resolve("lingo"),ic=oc.resolve("spellchecker-annotation"),cc=oc.resolve("spellchecker-word"),ac=oc.resolve("spellchecker-ignore"),fc=oc.resolve("spellchecker-current"),sc=function(n,e){return T.from(bt(n,e))},lc={nu:function(){var e,n=rt.fromTag("span");return e=n,X([ic,cc],function(n){Eo(e,n)}),yt(n,"aria-invalid","spelling"),Zo(eu,n)},set:function(n,e,t){yt(n,"data-mce-bogus",1),yt(n,rc.label(),t),yt(n,uc,e)},setCurrent:function(n){Eo(n,fc)},unSetCurrent:function(n){Io(n,fc)},label:w(ic),wordLabel:w(cc),ignoreLabel:w(ac),currentLabel:w(fc),detail:function(r){return rc.id(r).bind(function(t){return sc(r,rc.label()).bind(function(e){return sc(r,uc).map(function(n){return{id:w(t),word:w(e),lang:w(n),element:w(r)}})})})}},dc=function(n){return{fold:n}},gc=function(t){return dc(function(n,e){return e(t)})},pc=function(t){return dc(function(n,e){return n(t)})},mc=oc.resolve("wrap-disabled"),hc=function(n){var e=rc.sameId(n);X(e,function(n){Io(n,mc)})},vc=hr("id","match","current"),yc=hr("word","pattern"),bc=function(o,n,e){var t=en(e,function(n){return[n.start(),n.finish()]}),u=Mo(n,t,function(n,e){return function(o,n,e){var t=o.property().getText(n),r=$(Po(t,e),function(n){return 0<n.length});if(r.length<=1)return[Qr(n,0,t.length)];o.property().setText(n,r[0]);var u=Lo(r.slice(1),function(n,e){var t=o.create().text(n),r=Qr(t,e,e+n.length);return T.some(r)},r[0].length),i=Y(u,function(n){return n.element()});return o.insert().afterAll(n,i),[Qr(n,0,r[0].length)].concat(u)}(o,n.element(),e)});return Y(e,function(n){var e=jo(u,n.start(),n.finish()),t=Y(e,function(n){return n.element()}),r=Y(t,o.property().getText).join("");return{elements:function(){return t},word:n.word,exact:function(){return r}}})},wc=function(i,n,c,e){var t=Qo(i,n,e);return en(t,function(n){var r,e=en(n,function(n){return n.fold(Xo,Xo,function(n){return[n]},Xo)}),t=Y(e,i.property().getText).join(""),o=qu(t,c),u=(r=i,Lo(e,function(n,e){var t=e+r.property().getText(n).length;return T.from(Qr(n,e,t))}));return bc(i,u,o)})},kc=function(n,e,t,r){var o=Y(t,function(n){var e=Mu(n);return yc(n,e)});return wc(n,e,o,r)},xc=$r(),Tc=function(n,e,t){return kc(xc,n,e,t)},Oc=function(n,u){return Y(n,function(n){return t=u,r=en((e=n).elements(),function(n){return rc.marker(n,t).fold(w([]),function(n){return[n]})}),o=Je("mce-cram"),vc(o,e,T.from(r[0]));var e,t,r,o})},Sc=hr("id","elements","word","lang"),_c=function(n){return{fold:n}},Ec=function(t){return _c(function(n,e){e(t)})},Cc=function(t){return _c(function(n,e){n(t)})},Ic=function(n,e,t,r){var o=Ji(n),u=Ki(n,t,r);return o===e&&u.is(e)},Nc=function(n,e,t,r,o){var u,i,c,a,f,s,l,d=(u=n.elements(),i=e,c={},X(u,function(n){rc.marker(n,i.label()).filter(er).each(function(u){i.detail(u).each(function(n){var e=n.id(),t=n.word(),r=n.lang(),o=rc.sameId(u);0<o.length&&(c[e]=Sc(e,o,t,r))})})}),c),g=(a=d,f=o,s=n.lang(),l=D(a),Y(l,function(n){return n.lang()===s&&Ic(n.elements(),n.word(),f,n.lang())?Ec(n):Cc(n)}));X(g,function(n){var e=function(e){return function(n){X(n.elements(),e)}};n.fold(e(r),e(t))})},Ac=function(n){return rc.nonIgnoredMarker(n,lc.label(),lc.ignoreLabel())},Dc={label:lc.label,highlight:function(c,a,n,e){Nc(a,lc,hc,Wr,c.lang());var t=Tc(a.elements(),n,e),r=Oc(t,lc.label());return en(r,function(i){return i.current().fold(function(){var n=i.match(),e=n.word();if(c.ignore(n))return[];var t,r,o=$(n.elements(),function(n){return ht(n)?Tr(n).fold(function(){return!1},function(n){return"false"!==n.dom().contentEditable}):st(n.dom())?"false"!==n.dom().contentEditable:n.dom().isContentEditable}),u=(t=o,r=lc.nu,nu(eu,t,r)||[]);return X(u,function(n){rc.set(n,i.id()),lc.set(n,a.lang(),e)}),0<u.length?[gc(u)]:[]},function(n){return[pc(n)]})})},marker:Ac,allMarkers:function(n){return rc.allNonIgnoredMarkers(n,lc.label(),lc.ignoreLabel())},substitute:function(n,e){var t=Ac(n).fold(w([]),rc.sameId);return Xi(t,e)},ignore:function(n){var e=Ac(n).fold(w([]),rc.sameId);X(e,function(n){Io(n,lc.wordLabel()),Eo(n,lc.ignoreLabel())})},ignoreAll:function(n){var e=Ac(n).fold(w([]),rc.all);X(e,Wr)},detail:function(n){return lc.detail(n)},setCurrent:function(n){var e=rc.otherCurrents(n,lc.currentLabel());X(e,lc.unSetCurrent),lc.setCurrent(n)}},Rc=Dc.label(),Lc={isWrap:function(n){return t=Rc,Oo(e=n)&&e.dom().classList.contains(t);var e,t}},Mc=hr("area","f");var jc=function(n,e,t,r){return n.property().isBoundary(e)?Ri.fromBounded(n,e,e,t,r):n.property().isEmptyTag(e)?Pc():Ri.fromInline(n,e,t,r)},Pc=Ri.empty,Bc={single:jc,range:function(n,e,t,r,o,u,i){var c=eo(n,e,t),a=eo(n,r,o);return n.eq(c.element(),a.element())?jc(n,c.element(),u,i):Ri.fromRange(n,c.element(),a.element(),u,i)},empty:Pc},Fc=$r(),zc={single:function(n,e,t){return Bc.single(Fc,n,e,t)},range:function(n,e,t,r,o,u){return Bc.range(Fc,n,e,t,r,o,u)},empty:function(){return Bc.empty()}};function Wc(n,o){var t,r,u,i=Tt(n),e=(r=!(t=[]),u=function(){r=!0,T.from(t.shift()).fold(function(){r=!1},function(n){n.f()(n.area(),u)})},{enqueue:function(n,e){t.push(Mc(n,e)),r||u()},destroy:function(){t=[]}}),c=function(n,e,t,r){e(n,xo.cata(t,function(n){return er(n)?zc.single(n,i.get(),o()):zc.empty()},function(n,e,t,r){return er(n)&&er(t)?zc.range(n,e,t,r,i.get(),o()):zc.empty()}),i.get(),r)};return{run:function(n,e,t,r){void 0===r&&(r=k),c(n,e,t,r)},setLang:i.set,schedule:function(t,r,n,o){e.enqueue(n,function(n,e){void 0!==o&&o()?e():c(t,r,n,e)})},destroy:function(){e.destroy()}}}var qc=function(n,e){return n.fold(function(){return!1},function(n){return!n.ignore()&&(n.suggestions().isSome()||!e)})},Uc={update:function(e,t,r){var n=O(r);X(n,function(n){e.add(t,n,r[n])})},getInCache:function(t,r,n,o){return $(n,function(n){var e=t.get(r,n.word());return qc(e,o)})},getInCacheString:function(t,r,n,o){return $(n,function(n){var e=t.get(r,n);return qc(e,o)})}},Vc={highlight:function(n,e,t){var r={ignore:w(!1),lang:w(t)},u=Y(e,function(n){return n.word()}),o=$(u,function(n,e){return(t=u,r=n,o=H(t,r),-1===o?T.none():T.some(o)).filter(function(n){return n===e}).isSome();var t,r,o});Dc.highlight(r,n,o,w(!1))}},Hc=function(n){var e=new RegExp(No,"g"),t=new RegExp("[‘’]","g");return n.replace(e,"").replace(t,"'")},Jc=function(n){return an.error(new Error(n))},Kc=function(n,e){return $(n,function(n){return!J(e,n)})},Yc=function(u,t,r){return ue.nu(function(o){var n=Y(u.words(),function(n){return Hc(n.word())}),e=Kc(n,r);t(e,u.lang()).get(function(n){return n.fold(function(n){var e=Jc(n);o(e)},function(n){var e,t,r=(e=u,t=n,an.value({spelling:w(t),zone:w(e)}));o(r)})})})},Xc=function(e,o,t,u){return ue.nu(function(r){var n=Kc(e,u);t.correctionMany(n,o).get(function(n){return n.fold(function(n){var e=Jc(n);r(e)},function(n){var e,t;r((e=o,t=n,an.value({spelling:w(t),lang:w(e)})))})})})},$c=function(n){var e,t,r;return function(n,e){if(0===n.length)return[];for(var t=e(n[0]),r=[],o=[],u=0,i=n.length;u<i;u++){var c=n[u],a=e(c);a!==t&&(r.push(o),o=[]),t=a,o.push(c)}return 0!==o.length&&r.push(o),r}((e=n,t=function(n,e){return n.detail.lang()<e.detail.lang()?-1:e.detail.lang()<n.detail.lang()?1:0},(r=q.call(e,0)).sort(t),r),function(n){return n.detail.lang()})},Gc={scan:function(u,e,n,t,i){var r=function(n){var e=n.zone();Uc.update(u,e.lang(),n.spelling());var t=O(n.spelling()),r=Uc.getInCacheString(u,e.lang(),t,i),o=$(e.words(),function(n){var e=Hc(n.word());return J(r,e)});return{zone:w(e),words:w(o)}},o=Y(n,function(n){return Yc(n,e,t)});return Ve(o).map(function(n){var e=en(n,function(n){return n.fold(w([]),on)});return Y(e,r)})},fetch:function(e,t,n,r){var o=function(n){Uc.update(e,n.lang(),n.spelling())},u=$c(n),i=Y(u,function(n){var e=Y(n,function(n){return n.detail.word()});return Xc(e,n[0].detail.lang(),t,r)});return Ve(i).map(function(n){return X(n,function(n){n.each(o)}),Rn(n)})}},Qc=!0;function Zc(u,i,c,a){var f=function(n,e,t){n(function(){X(e,function(n){Vc.highlight(n.zone(),n.words(),t)})})};return{local:function(n,e,t,r){var o=e.zones(),u=Y(o,function(n){var e=Uc.getInCache(i,n.lang(),n.words(),Qc);return{zone:w(n),words:w(e),lang:n.lang}});f(n,u,t),r()},remote:function(e,n,t,r){var o=n.zones();Gc.scan(i,c.correctionMany,o,a,Qc).get(function(n){u.removed||(f(e,n,t),r())})},check:function(e,n,t,r){var o=n.zones();Gc.scan(i,c.check,o,a,!Qc).get(function(n){u.removed||(f(e,n,t),r())})},fetch:function(n){return Gc.fetch(i,c,n,a)}}}var na=function(){return{zh_hk:"zh_tw",iw:"he",no:"nb",nn:"nb",en:"en",ar:"ar",ca:"ca",cs:"cs",da:"da",de:"de",el:"el",es:"es",fa:"fa",fi:"fi",fr:"fr",he:"he",hr:"hr",hu:"hu",it:"it",ja:"ja",kk:"kk",ko:"ko",nl:"nl",nb:"nb",pl:"pl",pt:"pt",pt_pt:"pt_pt",ro:"ro",ru:"ru",sl:"sl",sk:"sk",sv:"sv",th:"th",tr:"tr",uk:"uk",zh:"zh",zh_tw:"zh_tw"}},ea=function(n){var e=n.toLowerCase().replace("-","_"),t=e.indexOf(";"),r=-1<t?e.substring(0,t):e,o=be(r),u=o.indexOf("_"),i=-1<u?o.substring(0,u):o;return{full:o,languageCode:i}},ta=function(n,r){var e=n.split(","),t=Y(e,function(n){return e=r,t=ea(n),e[t.full]||e[t.languageCode]||"";var e,t});return Q(t,function(n){return""!==n})},ra={extract:ea,determine:function(n){return ta(n,{zh_hk:"zh_tw",iw:"he",no:"nb",nn:"nb",en:"en",ar:"ar",ca:"ca",cs:"cs",da:"da",de:"de",el:"el",es:"es",fa:"fa",fi:"fi",fr:"fr",he:"he",hr:"hr",hu:"hu",it:"it",ja:"ja",kk:"kk",ko:"ko",nl:"nl",nb:"nb",pl:"pl",pt:"pt",pt_pt:"pt_pt",ro:"ro",ru:"ru",sl:"sl",sk:"sk",sv:"sv",th:"th",tr:"tr",uk:"uk",zh:"zh",zh_tw:"zh_tw"})},determineFrom:ta,localeList:na},oa="no.language",ua={en_au:"en_gb",en_bz:"en_gb",en_ca:"en_gb",en_gb:"en_gb",en_ie:"en_gb",en_in:"en_gb",en_jm:"en_gb",en_my:"en_gb",en_nz:"en_gb",en_ph:"en_gb",en_sg:"en_gb",en_tt:"en_gb",en_za:"en_gb",en_zw:"en_gb",en_us:"en_us",en:"en_us"},ia=["da","de","en","en_au","en_br","en_gb","en_uk","en_us","es","fi","fr","it","nb","nl","pt","pt_pt","sv"],ca={determine:function(n){return n===oa?T.some(n):(e=n,t=In(ra.localeList(),ua),ra.determineFrom(e,t).filter(function(n){return J(ia,n)}));var e,t},isOn:function(n){return n!==oa},offKey:w(oa)},aa={consoleMessage:function(n){if(z((t=n).message)&&z(t.status)&&z(t.responseText)){var e=n.responseText();return n.message()+". Response code "+n.status()+(0===e.length?".":". Error details: "+e)}return n;var t}},fa={get:function(n){var e=fr.getApiKey(n);return null===e?{}:{"tiny-api-key":e}}},sa={spelling:w("1")},la=function(n,e){var t,r;return(ye(t=n,r="/")?t:t+r)+e},da={corsQuery:function(n){return la(n,"version")},spelling:function(n){return la(n,sa.spelling())+"/"}};function ga(e){var r=e.gaol,t=e.editor,n=e.language,o=fr.getHandler(t),u=o||function(n,o,u,i,e){var t=da.spelling(o),r=et(t+"correct",t+"correction",fa.get(n),void 0,e),c=uo.create({failed:oo(["resource"])}),a=te.nu(function(n){r.checkMany(u,["startup"]).get(n)});a.get(function(n){n.fold(function(n){E.console.error("Unable to communicate with the spelling service:",aa.consoleMessage(n)),c.trigger.failed(o)},b)});var f=function(t,r){return ue.nu(function(e){a.get(function(n){n.fold(function(){return e(n)},function(){r(i?t:u).get(function(n){e(n),n.fold(function(n){E.console.error("Error response from the spelling service:",aa.consoleMessage(n)),c.trigger.failed(o)},b)})})})})};return{check:function(e,n){return f(n,function(n){return r.checkMany(n,e)})},correction:function(e,n){return f(n,function(n){return r.correctOne(n,e)})},correctionMany:function(e,n){return f(n,function(n){return r.correctMany(n,e)})},events:c.registry,state:function(){return r.dumpCache()}}}(t,e.url,n,e.multilingual,e.serverSettings),i=uo.create({failed:oo(["resource"])});u.events.failed.bind(function(n){i.trigger.failed(n.resource())});var c=Wc(n,e.viewable.viewport),a=Zc(t,e.cache,u,fr.getWhitelist(t)),f=function(){return!ca.isOn(r.spelling().get())},s=function(){var n,e;n="mce-spellchecker-word",e=t.dom.select("span."+n),X(e,function(n){!function(n){var e=n.parentNode,t=n.childNodes;if(e){for(;0<t.length;)e.insertBefore(t[0],n);e.removeChild(n)}}(n)})};return e.editor.on("remove",function(){c.destroy()}),{run:function(n,e){var t=r.spelling().get();ca.isOn(t)&&(c.setLang(t),c.run(n,a.local,e),c.schedule(n,a.remote,e,f))},fetch:a.fetch,check:function(n,e,t){c.setLang(r.nonOffSpelling()),c.run(n,a.check,e,t)},refresh:function(){var n=r.spelling().get();ca.isOn(n)&&e.asYouType||s()},clear:s,state:u.state,events:i.registry}}var pa=function(){var n=!1;return{isBlocked:function(){return n},block:function(){n=!0},unblock:function(){n=!1}}},ma=function(n,e){return{control:n,instance:e}},ha={tap:function(t){var r=pa();return ma(r,function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];r.isBlocked()||t.apply(null,n)})}},va=function(n,e,t,r){var o=Zt(n,t)&&e===r;return{startContainer:w(n),startOffset:w(e),endContainer:w(t),endOffset:w(r),collapsed:w(o)}},ya={isSpace:function(n){return 32===(n.which||n.keyCode)},isEnter:function(n){return 13===(n.which||n.keyCode)}};function ba(r){var o=uo.create({lookup:oo(["element"])}),e=function(){var n,e;n=function(n){o.trigger.lookup(n.startContainer())},e=r.selection.getRng(),n(va(rt.fromDom(e.startContainer),e.startOffset,rt.fromDom(e.endContainer),e.endOffset))},n=function(n){ya.isSpace(n)&&e()};return r.on("keyup",n),r.on("remove",function(){r.off("keyup",n)}),r.on("init",function(){var t=rt.fromDom(r.getBody()),n=function(n){if(!n.selectionChange){var e=rt.fromDom(n.element);Zt(t,e)||(o.trigger.lookup(t),t=e)}};r.on("nodechange",n),r.on("remove",function(){r.off("nodechange",n)})}),{events:o.registry}}var wa=Yt().browser.isFirefox(),ka=function(n){return n.filter(function(n){return"img"===lt(n)})},xa=function(n){return ht(n)&&0===Kr(n).length},Ta=function(u){var n,i=ka(Cr(u.startContainer(),u.startOffset()));return(n=u,ka(_r(n.startContainer()))).orThunk(function(){return i}).bind(function(o){return(n=u,ka(Sr(n.endContainer()))).bind(function(n){var e=Zt(o,n),t=u.startContainer().dom().length===u.startOffset(),r=0===u.endOffset();return e&&(t||i.isSome())&&r?T.some(o):T.none()});var n})},Oa=function(n){return n.filter(function(n){return!n.collapsed()}).bind(function(n){return function(n){var e=n.startContainer();if(!Zt(e,n.endContainer()))return T.none();if("img"===lt(e))return T.some(e);var t=Math.min(n.startOffset(),n.endOffset()),r=Math.max(n.startOffset(),n.endOffset()),o=ka(Cr(e,t));return r===t||r===t+1?o:wa&&r===t+2?o.filter(function(n){return _r(n).filter(xa).isSome()}):T.none()}(n).orThunk(function(){return Ta(n)})})},Sa=hr("image"),_a={detect:function(n){return Oa(n).map(Sa)}},Ea=function(r,o,u){if(0===o.length)throw new Error("You must specify at least one required field.");return wr("required",o),kr(o),function(e){var t=O(e);tn(o,function(n){return J(t,n)})||yr(o,t),r(o,t);var n=$(o,function(n){return!u.validate(e[n],n)});return 0<n.length&&function(n,e){throw new Error("All values need to be of type: "+e+". Keys ("+vr(n).join(", ")+") were not.")}(n,u.label),e}},Ca=function(e,n){var t=$(n,function(n){return!J(e,n)});0<t.length&&br(t)},Ia=hr("ch","offset"),Na=function(n,e){return Ia(n.charAt(e),e)},Aa=function(n,e){for(var t=e.getOr(n.length)-1;0<=t;t--)if(n.charAt(t)!==No)return T.some(Na(n,t));return T.none()},Da=function(n,e){for(var t=e.getOr(0)+1;t<n.length;t++)if(n.charAt(t)!==No)return T.some(Na(n,t));return T.none()},Ra=function(n,e){e.lastIndex=-1;var t=rn(n).join(""),r=t.match(e);return null!=r&&void 0!==r.index&&0<=r.index?T.some(t.length-1-r.index):T.none()},La=function(n,e){e.lastIndex=-1;var t=n.match(e);return null!=t&&void 0!==t.index&&0<=t.index?T.some(t.index):T.none()},Ma=function(n,e){return J(["br","img","hr","input"],n.property().name(e))},ja=Ma,Pa=bu().left(),Ba=bu().right(),Fa=Sn([{abort:[]},{kontinue:[]},{finish:["info"]}]),za=Sn([{aborted:[]},{edge:["element"]},{success:["info"]}]),Wa=function(n,e){return ja(n,e)||n.property().isBoundary(e)},qa=function(t,n,r,e,o,u,i){var c=function(){return i.fold(za.aborted,za.edge)},a=function(e){return wu(t,n,r,u).fold(c,function(n){return qa(t,n.item(),n.mode(),T.none(),o,u,e)})};if(Wa(t,n))return c();if(t.property().isText(n)){var f=t.property().getText(n);return o(t,Fa,n,f,e).fold(c,function(){return a(T.some(n))},za.success)}return a(i)},Ua=function(e,n,t,r){var o,u,i,c,a=eo(e,n,t);return e.property().isText(n)?T.none():(o=e,u=a.element(),i=e.property().isText,c=r,hu(o,u,i,lu,mu.left(),c)).map(function(n){return Gr(n,e.property().getText(n).length)})},Va=function(o,u,i){var c=function(n){return Wa(o,n)};return Ua(o,u,i,c).orThunk(function(){return t=c,r=eo(n=o,e=u,i),n.property().isText(e)?T.none():vu(n,r.element(),n.property().isText,t).map(function(n){return Gr(n,0)});var n,e,t,r}).getOr(Gr(u,i))},Ha=function(n,e,t,r){var o=Va(n,e,t);return qa(n,o.element(),lu,T.some(o.offset()),r,Pa,T.none())},Ja=function(n,e,t,r){var o=Va(n,e,t);return qa(n,o.element(),lu,T.some(o.offset()),r,Ba,T.none())},Ka=Ea(Ca,["regex","attempt"],{validate:z,label:"function"}),Ya=Ha,Xa=Ja,$a=function(e,n,t){var r=w(!1);if(!e.property().isText(n))return T.none();var o=e.property().getText(n);return t<=o.length?T.some(Gr(n,t)):yu(e,n,e.property().isText,r).bind(function(n){return $a(e,n,t-o.length)})},Ga={previousChar:Aa,nextChar:Da,repeatLeft:Ya,repeatRight:Xa,expandLeft:function(n,e,t,r){var i=Ka(r);return Ya(n,e,t,function(n,e,t,r,o){var u=o.getOr(r.length);return Ra(r.substring(0,u),i.regex()).fold(function(){return e.kontinue()},function(n){return i.attempt(e,t,r,n)})})},expandRight:function(n,e,t,r){var i=Ka(r);return Xa(n,e,t,function(n,e,t,r,o){var u=o.getOr(0);return La(r.substring(u),i.regex()).fold(function(){return e.kontinue()},function(n){return i.attempt(e,t,r,u+n)})})},scanRight:$a},Qa=$r(),Za=function(n,e){return Ga.scanRight(Qa,n,e)},nf=function(n,e){var t=Gr(n,e);return ht(n)?Za(n,e).getOr(t):t},ef={handle:function(n){var e=nf(n.startContainer(),n.startOffset()),t=nf(n.endContainer(),n.endOffset());return va(e.element(),e.offset(),t.element(),t.offset())}},tf=Yt().browser,rf=function(n){return wo(n.endContainer(),n.endOffset(),n.startContainer(),n.startOffset())},of=function(n){var e,t,r,o=(e=n.startContainer(),t=n.startOffset(),r=Er(e),0<r.length&&t<r.length?Nr(r[t],0):Nr(e,t)).element();return mt(o)&&"false"===bt(o,"contenteditable")&&Zt(n.startContainer(),n.endContainer())&&n.startOffset()===n.endOffset()-1},uf=function(n){return ht(n)||"br"===lt(n)};function cf(c){var a=function(){var n=c.selection.getRng(),e=rt.fromDom(n.startContainer),t=rt.fromDom(n.endContainer);return va(e,n.startOffset,t,n.endOffset)},u=function(n,e){var t,r,o=n(),u=ef.handle(e),i=a();return(!Zt(i.startContainer(),u.startContainer())||!Zt(i.endContainer(),u.endContainer())||i.startOffset()!==u.startOffset()||i.endOffset()!==u.endOffset())&&(t=u,(r=c.dom.createRng()).setStart(t.startContainer().dom(),t.startOffset()),r.setEnd(t.endContainer().dom(),t.endOffset()),c.selection.setRng(r)),o},o=function(n,e){var t,r,o;return uf(e.startContainer())&&uf(e.endContainer())||_a.detect(T.some(e)).isSome()?u(n,e):(t=n,r=c.selection.getBookmark(),o=t(),c.selection.moveToBookmark(r),o)};return{transaction:function(n){var e=a(),t=e.collapsed()||!tf.isIE()||rf(e),r=function(n,e){if(!e||tf.isFirefox()||of(n))return n;var t=ro(n.endContainer(),n.endOffset()),r=ro(n.startContainer(),n.startOffset());return va(r.element(),r.offset(),t.element(),t.offset())}(e,t);return(t?o:s)(n,r)}}}function af(o,t,r,n,e,u){var i,c,a,f,s,l,d=yo(o,e),g=ga({editor:o,gaol:n,viewable:d,cache:r,url:t,language:n.spelling().get(),multilingual:!0,asYouType:e,serverSettings:u}),p=(i=o,c=g,a=e,f=ha.tap(function(n){var e=n.element();if(a){var t=xo.single(e);l(t)}}),s=cf(i),l=function(n){c.run(s.transaction,n)},a&&ba(i).events.lookup.bind(function(n){f.instance(n)}),{scan:l,check:function(n,e){c.check(s.transaction,n,e)},lock:function(n){var e=f.control.isBlocked();f.control.block(),n(),e||f.control.unblock()}}),m=uo.create({analytics:oo(["message"])});g.events.failed.bind(function(n){var e=o.translate(["The spelling service was not found: ({0})",t]);bo.fireError(o,{message:e}),E.console.error(e)}),o.on("init",function(){var n=o.getBody(),e=rt.fromDom(n);yt(e,"spellcheck",!1),g.refresh()}),o.on("remove",function(){var n=o.getBody(),e=rt.fromDom(n);wt(e,"spellcheck"),r.destroy()});var h=function(n,e,t,r){var o=Lc.isWrap(n)?ro(n,e):Gr(n,e),u=Lc.isWrap(t)?ro(t,r):Gr(t,r);return xo.range(o.element(),o.offset(),u.element(),u.offset())},v=function(n){var e=n[0],t=n[n.length-1],r=Ir(t);return h(e,0,t,r)},y=function(){var n=d.sections();if(0<n.length){var e=v(n);p.scan(e)}};d.events.onChange.bind(y);var b=g.clear;return{events:function(){return m.registry},scanView:y,scanRange:function(n,e,t,r){(0,p.scan)(h(n,e,t,r))},fetch:g.fetch,checkDocument:function(n){var e=rt.fromDom(o.getBody()),t=Er(e);if(0<t.length){var r=v(t);p.check(r,n)}},lock:function(n){return p.lock(n)},clear:b}}var ff=function(n){return"img"===lt(n)?1:(e=n,Jr.getOption(e)).fold(function(){return Er(n).length},function(n){return n.length});var e},sf=function(n,t){return Dc.marker(n).bind(Dc.detail).map(function(n){var e=t.suggestions(n.lang(),n.word());return{detail:n,suggestions:e}})},lf=function(t,n,e){t.undoManager.transact(function(){Dc.substitute(n,e).each(function(n){var e=ff(n);t.selection.setCursorLocation(n.dom(),e),t.focus()})})},df=sf,gf=function(n,e,t){n.undoManager.transact(function(){Dc.ignore(e)}),bo.fireIgnore(n,t)},pf=function(n,e,t,r,o){o.ignore(r,t),Dc.ignoreAll(e),bo.fireIgnoreAll(n,t)},mf=function(n,e,t,r,o){var u=4<r.length?o.getSubstituteItemsOverMax(n,r,4):o.getSubstituteItems(n,r),i=[o.getSeparator(),o.getIgnoreItem(n,t),o.getIgnoreAllItem(n,t,e)];return u.concat(i)},hf=function(n,e,t){void 0===t&&(t=100);var r,o=n.length>t?t:n.length,u=n.slice(0,o),i=function(n){for(var e=[],t=function(n){e.push(n)},r=0;r<n.length;r++)n[r].each(t);return e}(Y(u,function(n){return sf(n,e)}));return r={},X(i,function(n){r[n.detail.word()]=n}),D(r)},vf=function(n){var e,t=Dc.allMarkers(n);return(e=t,0===e.length?T.none():T.some(e[0])).bind(Dc.detail)},yf=function(n){return Dc.allMarkers(n)},bf=function(n,e,t){e.clear(),t&&!n.removed&&e.scanView()},wf=function(t,e,u,i,r){var o=function(n){var e=ca.isOn(n);(e?u.scanView:u.clear)(),(e?bo.fireSpellcheckStart:bo.fireSpellcheckEnd)(t)},c=function(e,n,t,r){var o=function(){r<3?c(e,n,t,r+1):n()};u.fetch(e).get(function(n){0<n.values.length?sf(e[0].detail.element(),i).fold(function(){o()},function(n){n.suggestions.fold(function(){o()},function(n){t(n)})}):o()})};return{changeLanguage:function(n){e.spelling().setAndCache(t,n),r&&o(n)},toggleLanguage:function(){var n=ca.isOn(e.spelling().get())?ca.offKey():e.nonOffSpelling();e.spelling().setAndCache(t,n),o(n)},getWordsAsync:function(n){u.checkDocument(n)},getWordsSuggestionsAsync:c}},kf=function(r,o){var a=function(n,e){return{text:e,onAction:function(){lf(r,n,e)}}},u={getSubstituteItemsOverMax:function(e,n,t){var r=n.slice(0,t),o=n.slice(t),u=Y(r,function(n){return a(e,n)}),i=Y(o,function(n){return a(e,n)}),c={type:"submenu",text:"More...",getSubmenuItems:function(){return i}};return u.concat([c])},getSubstituteItems:function(e,n){return Y(n,function(n){return a(e,n)})},getSeparator:function(){return{type:"separator"}},getIgnoreItem:function(n,e){return{text:"Ignore",onAction:function(){gf(r,n,e)}}},getIgnoreAllItem:function(n,e,t){return{text:"Ignore all",onAction:function(){pf(r,n,e,t,o)}}}};r.ui.registry.addContextMenu("spellchecker",{update:function(n){var t,e=rt.fromDom(n);return df(t=e,o).bind(function(e){return e.suggestions.map(function(n){return mf(t,e.detail.lang(),e.detail.word(),n,u)})}).getOr([])}})},xf="SpellcheckStart SpellcheckEnd",Tf=function(o,n,t,r,e){var u=Y(n,function(n){return Xn(Xn({},n),{type:"choiceitem"})}),i={tooltip:"Spellcheck...",icon:"spell-check",onAction:function(){o.execCommand("mceSpellcheckDocument")}},c={tooltip:"Spellcheck...",icon:"spell-check",onAction:function(){o.execCommand("mceSpellcheckDocument")},select:function(n){return n===t.spelling().get()},fetch:function(n){n(u)},onItemAction:function(n,e){r.changeLanguage(e)}},a={tooltip:"Spellcheck",icon:"spell-check",onAction:r.toggleLanguage,onSetup:function(n){var e=function(){n.setActive(ca.isOn(t.spelling().get()))};return e(),o.on(xf,e),function(){return o.off(xf,e)}},select:function(n){return n===t.spelling().get()},fetch:function(n){n(u)},onItemAction:function(n,e){r.changeLanguage(e)}},f={text:"Spellcheck...",icon:"spell-check",onAction:function(){o.execCommand("mceSpellcheckDocument")}};e?(o.ui.registry.addSplitButton("spellchecker",a),o.ui.registry.addToggleMenuItem("spellchecker",{text:"Spellcheck",icon:"spell-check",onAction:r.toggleLanguage,onSetup:function(n){var e=function(){return n.setActive(ca.isOn(t.spelling().get()))};return e(),o.on(xf,e),function(){return o.off(xf,e)}}}),o.ui.registry.addButton("spellcheckdialog",i),o.ui.registry.addMenuItem("spellcheckdialog",f)):(o.ui.registry.addSplitButton("spellchecker",c),o.ui.registry.addMenuItem("spellchecker",f));var s,l,d,g=function(n){return{type:"togglemenuitem",text:n.text,onAction:function(){return r.changeLanguage(n.value)},active:n.value===t.spelling().get()}};if(o.ui.registry.addNestedMenuItem("spellcheckerlanguage",{text:"Spellcheck Language",getSubmenuItems:function(){return Y(u,g)}}),l=tinymce,d="5.0.3",l&&1===v(y(l),h(d))){var p=fr.getSelectContentLanguages(o),m=(s={},X(p.split(","),function(n){n=n.toLowerCase(),s[n]=L(ur,n)?ur[n]:n.toUpperCase()}),s);o.ui.registry.addMenuButton("language",{tooltip:"Language",icon:"translate",fetch:function(n){var e,t,r=(e=o,t=m,or(rt.fromDom(e.selection.getNode()),"[lang]").map(function(n){var e=bt(n,"lang").toLowerCase();return L(t,e)||(t[e]=L(ur,e)?ur[e]:e.toUpperCase()),e}));n(A(m,function(n,t){return{type:"togglemenuitem",value:t,text:n,onSetup:function(n){return r.is(t)&&n.setActive(!0),b},onAction:function(){var n,e;e=t,(n=o).formatter.has("powerspell_language_select")||n.formatter.register("powerspell_language_select",{inline:"span",attributes:{lang:"%value"}}),n.undoManager.transact(function(){n.focus(),n.formatter.toggle("powerspell_language_select",{value:e}),n.nodeChanged()})}}}))},onSetup:function(t){var n=function(n){var e;t.setActive((e=n.parents,K(e,function(n){return""!==n.lang})))};return o.on("NodeChange",n),function(){o.off("NodeChange",n)}}})}},Of=function(n,e){n.addCommand("mceSpellcheckDocument",e.open)},Sf=function(t,r,n,e,o){return{title:"Spellcheck",body:{type:"panel",items:[{type:"input",name:"textlabel",label:"Misspelled word"},{type:"selectbox",name:"suggestions",label:"Suggestions",size:6,items:Y(n,function(n){return{text:n,value:n}})}]},initialData:{textlabel:r,suggestions:0<n.length?n[0]:""},onClose:t.onClose,onAction:function(n,e){switch(e.name){case"change":t.replace(n,r);break;case"ignore":t.ignore(n);break;case"ignoreall":t.ignoreAll(n)}n.focus("textlabel")},buttons:[{type:"custom",primary:!0,name:"change",text:"Change"},{type:"custom",name:"ignore",text:"Ignore"},{type:"custom",name:"ignoreall",text:"Ignore all"}]}},_f=function(i,u,n,e,o){var c=function(){var n=i.translate("No misspellings found.");i.notificationManager.open({text:n,type:"info",timeout:3e3})},a=function(n,e,t,r){n.redial(Sf(d,e,t))},f=function(e,n){e.block("Finding word suggestions");var t=hf(n,u),r=$(t,function(n){return n.suggestions.isNone()});o.getWordsSuggestionsAsync(r,function(){e.unblock()},function(n){a(e,t[0].detail.word(),n,t[0].detail),e.unblock()},0)},s=function(n){var e=hf(n,u);if(0<$(e,function(n){return n.suggestions.isNone()}).length){o.getWordsSuggestionsAsync(e,function(){},function(n){},0)}},l=function(n){var t,r,e=yf(i);0<e.length?(t=n,df((r=e)[0],u).each(function(e){e.suggestions.fold(function(){f(t,r)},function(n){a(t,e.detail.word(),n,e.detail),s(r)})})):(c(),n.close())},d={replace:function(n,e){var t=n.getData(),r=t.textlabel,o=t.suggestions,u=r===e?o:r;vf(i).each(function(n){lf(i,n.element(),u)}),l(n)},ignore:function(n){vf(i).each(function(n){gf(i,n.element(),n.word())}),l(n)},ignoreAll:function(n){vf(i).each(function(n){pf(i,n.element(),n.word(),n.lang(),u)}),l(n)},onClose:function(){bf(i,n,e)}},t=function(o){var n=o[0];df(n,u).each(function(r){r.suggestions.fold(function(){var n,e,t=(n=r.detail.word(),e=[],r.detail,i.windowManager.open(Sf(d,n,e)));f(t,o)},function(n){var e,t;e=r.detail.word(),t=n,r.detail,i.windowManager.open(Sf(d,e,t)),s(o)})})},r={open:function(){o.getWordsAsync(function(){var n=yf(i);0<n.length?t(n):c()})}};return Of(i,r),r},Ef=tinymce.dom.DOMUtils,Cf=function(i,r){var o=function(r,n){return Y(n,function(n){return e=r,{text:t=n,onclick:function(){lf(i,e,t)}};var e,t})},u={getSubstituteItemsOverMax:function(n,e,t){var r=e.slice(0,t);return o(n,r)},getSubstituteItems:o,getSeparator:function(){return{text:"-"}},getIgnoreItem:function(n,e){return{text:"Ignore",onclick:function(){gf(i,n,e)}}},getIgnoreAllItem:function(n,e,t){return{text:"Ignore all",onclick:function(){pf(i,n,e,t,r)}}}},c=function(n){var t;return df(t=n,r).bind(function(e){return e.suggestions.map(function(n){return mf(t,e.detail.lang(),e.detail.word(),n,u)})}).getOr([])};i.on("contextmenu",function(n){var e=rt.fromDom(n.target),t=c(e);0<t.length&&(n.preventDefault(),n.stopImmediatePropagation(),function(n,e){var t=tinymce.ui.Factory.create("menu",{items:e,context:"contextmenu",onautohide:function(n){-1!==n.target.className.indexOf("spellchecker")&&n.preventDefault()},onhide:function(){t.remove()}});t.renderTo(E.document.body);var r=Ef.DOM.getPos(i.getContentAreaContainer()),o=i.dom.getPos(n.dom()),u=i.dom.getRoot();"BODY"===u.nodeName?(o.x-=u.ownerDocument.documentElement.scrollLeft||u.scrollLeft,o.y-=u.ownerDocument.documentElement.scrollTop||u.scrollTop):(o.x-=u.scrollLeft,o.y-=u.scrollTop),r.x+=o.x,r.y+=o.y,t.moveTo(r.x,r.y+n.dom().offsetHeight)}(e,t))},!0)},If="SpellcheckStart SpellcheckEnd",Nf=function(c,u,n,e,o){var t,r=function(){var n=c.translate("No misspellings found.");c.notificationManager.open({text:n,type:"info",timeout:3e3})},i=(t=Tt(T.none()),{clear:function(){t.set(T.none())},set:function(n){t.set(T.some(n))},isSet:function(){return t.get().isSome()},on:function(n){t.get().each(n)}}),a=function(t,r){i.on(function(n){n.find("#text")[0].value(t);var e=n.find("#suggestions")[0];e.options(r),e.getEl().selectedIndex=0,e.getEl().focus()})},f=function(n){var e=n.find("#text")[0],t=n.find("#change")[0],r=n.find("#ignore")[0],o=n.find("#ignoreall")[0];e.disabled(!1),t.disabled(!1),r.disabled(!1),o.disabled(!1)},s=function(n){i.on(function(n){var e,t,r,o,u,i;t=(e=n).find("#text")[0],r=e.find("#suggestions")[0],o=e.find("#change")[0],u=e.find("#ignore")[0],i=e.find("#ignoreall")[0],t.value("Finding word suggestions"),t.disabled(!0),r.options([]),o.disabled(!0),u.disabled(!0),i.disabled(!0)});var e=hf(n,u),t=$(e,function(n){return n.suggestions.isNone()});o.getWordsSuggestionsAsync(t,function(){i.on(function(n){f(n)})},function(n){i.on(function(n){f(n)}),a(t[0].detail.word(),n)},0)},l=function(n){var e=hf(n,u);if(0<$(e,function(n){return n.suggestions.isNone()}).length){var t=b,r=b;o.getWordsSuggestionsAsync(e,r,t,0)}},d=function(n){var t,e=yf(c);0<e.length?df((t=e)[0],u).each(function(e){e.suggestions.fold(function(){s(t)},function(n){a(e.detail.word(),n),l(t)})}):(r(),n.close())},g=function(n){i.on(function(i){vf(c).each(function(n){var e=i.find("#text")[0],t=i.find("#suggestions")[0],r=e.value(),o=t.getEl().value,u=r===n.word()?o:r;lf(c,n.element(),u),d(i)})})},p={change:g,submit:g,ignore:function(n){i.on(function(n){vf(c).each(function(n){gf(c,n.element(),n.word())}),d(n)})},ignoreall:function(n){i.on(function(n){vf(c).each(function(n){pf(c,n.element(),n.word(),n.lang(),u)}),d(n)})},close:function(n){i.on(function(n){n.close()})},onClose:function(){bf(c,n,e),i.clear()}},m=function(n,e){return c.windowManager.open({layout:"flex",align:"stretch",direction:"column",title:"Spellcheck",spacing:10,padding:10,callbacks:t=p,minWidth:350,items:[{type:"label",name:"textlabel",text:"Misspelled word"},{type:"textbox",name:"text",ariaLabel:"Misspelled word",spellcheck:!1,value:n},{type:"label",name:"suggestionslabel",text:"Suggestions"},{type:"container",layout:"flex",direction:"row",align:"stretch",spacing:10,items:[{type:"selectbox",name:"suggestions",ariaLabel:"Suggestion",minWidth:150,flex:1,size:6,border:1,options:e},{type:"container",layout:"flex",flex:1,spacing:5,direction:"column",pack:"center",align:"stretch",items:[{type:"button",subtype:"primary",name:"change",text:"Change",onclick:"change"},{type:"button",name:"ignore",text:"Ignore",onclick:"ignore"},{type:"button",name:"ignoreall",text:"Ignore all",onclick:"ignoreall"}]}]}],onsubmit:function(n){n.preventDefault(),t.replace()},onclose:function(n){t.onClose()},buttons:[]});var t},h={open:function(){o.getWordsAsync(function(){var o,n,e=yf(c);0<e.length?(n=(o=e)[0],df(n,u).each(function(r){r.suggestions.fold(function(){var n=m(r.detail.word(),[]);i.set(n),s(o)},function(n){var e=m(r.detail.word(),n),t=e.find("#suggestions")[0];t.options(n),t.getEl().selectedIndex=0,t.getEl().focus(),i.set(e),l(o)})})):r()})}};return Of(c,h),h},Af=hr("suggestions","ignore"),Df=function(n){return function(n){void 0===n&&(n={});var r={},o=function(n){return r.hasOwnProperty(n)&&void 0!==r[n]?r[n]:{}},e=function(n,e){var t=o(n);e(t),r[n]=t},u=function(n,e){return e(o(n))},i=function(n,r,o){e(n,function(n){var e=Hc(r);if(!L(n,e)||n[e].suggestions().isNone()){var t=0<o.length?T.some(o):T.none();n[e]=Af(t,!1)}})},c=function(n,u){e(n,function(n){var e=Hc(u),t=n.hasOwnProperty(e)?n[e]:void 0,r=void 0!==t?t.suggestions():T.none(),o=Af(r,!0);n[e]=o})};_(n,function(n,t){_(n,function(n,e){!0===n.ignore&&c(t,e),void 0!==n.suggestions&&i(t,e,n.suggestions)})});return{add:i,get:function(n,t){return u(n,function(n){var e=Hc(t);return n.hasOwnProperty(e)?T.from(n[e]):T.none()})},ignore:c,suggestions:function(n,t){return u(n,function(n){var e=Hc(t);return(n.hasOwnProperty(e)?T.from(n[e]):T.none()).bind(function(n){return n.ignore()?T.none():n.suggestions()})})},state:function(){return I(r,function(n,e){return I(n,function(n,e){return{ignore:n.ignore(),suggestions:n.suggestions().getOr([])}})})},destroy:function(){r={}}}}(n)},Rf=function(){try{var n=we.localStorage,e="__storage_test__";return n.setItem(e,e),n.removeItem(e),T.some(n)}catch(n){return T.none()}}().fold(function(){var t={};return{getItem:function(n){return t[n]},setItem:function(n,e){t[n]=e}}},function(t){return{getItem:function(n){return t.getItem("mce."+n)},setItem:function(n,e){t.setItem("mce."+n,e)}}}),Lf=function(n,e){var t;return(t=n,T.from(Rf.getItem(t))).map(JSON.parse).getOr(e)},Mf=function(n){return Lf(n,{})},jf=function(n,e){var t=JSON.stringify(e);Rf.setItem(n,t)},Pf={read:Mf,readOr:Lf,write:jf,access:function(n){return{read:a(Mf,n),write:a(jf,n)}}};tinymce.PluginManager.requireLangPack("tinymcespellchecker","ar,bg_BG,ca,cs,da,de,el,es,eu,fa,fi,fr_FR,he_IL,hr,hu_HU,id,it,ja,kk,ko_KR,nb_NO,nl,pl,pt_BR,pt_PT,ro,ru,sk,sl_SI,sv_SE,th_TH,tr,uk,zh_CN,zh_TW"),tinymce.PluginManager.add("tinymcespellchecker",function(n,e){if(C(tinymce,"4.2.8"))return E.console.error('The "tinymcespellchecker" plugin requires at least version 4.2.8 of TinyMCE.'),function(){};var t,r,o,u,i,c,a,f=fr.getLanguage(n),s=fr.getRpcUrl(n),l=Df({}),d=(t=f,r=Pf.readOr("spelling",t),o=Tt(r),u=Tt("no.language"===r?"en_us":r),i=o.set,c=o.get,a={setAndCache:function(n,e){fr.setLanguage(n,e),i(e),Pf.write("spelling",e),ca.isOn(e)&&u.set(e)},set:i,get:c},{spelling:function(){return a},nonOffSpelling:u.get});fr.isActive(n)||"no.language"===d.spelling().get()||d.spelling().set("no.language");var g,p,m,h,v,y,b,w,k,x,T=fr.getLanguages(n),O=!fr.useDialog(n),S=af(n,s,l,d,O,fr.getSpellingServiceSettings(n)),_=wf(n,d,S,l,O);C(tinymce,"5.0.0")?(Cf(n,l),g=n,p=d,m=_,h=O,v=Y(T,function(n){return{selectable:!0,text:n.text,data:n.value,onclick:function(){m.changeLanguage(n.value)}}}),y=function(n){var e=p.spelling().get();X(n.control.items(),function(n){n.active(n.data.data===e)})},w=Xn(Xn({},b={icon:"spellchecker",type:"button",tooltip:"Spellcheck...",onclick:function(){g.execCommand("mceSpellcheckDocument")}}),{type:"splitbutton",menu:v,onshow:y}),k={type:"splitbutton",tooltip:"Spellcheck",menu:v,onclick:m.toggleLanguage,onPostRender:function(n){var e=function(){n.control.active(ca.isOn(p.spelling().get()))};e(),g.on(If,e)},onshow:y},x={text:"Spellcheck...",context:"tools",onclick:function(){g.execCommand("mceSpellcheckDocument")}},h?(g.addButton("spellchecker",k),g.addMenuItem("spellchecker",{text:"Spellcheck",context:"tools",onclick:m.toggleLanguage,onPostRender:function(n){var e=function(){return n.control.active(ca.isOn(p.spelling().get()))};e(),g.on(If,e)},selectable:!0}),g.addButton("spellcheckdialog",b),g.addMenuItem("spellcheckdialog",x)):(g.addButton("spellchecker",w),g.addMenuItem("spellchecker",x)),g.addMenuItem("spellcheckerlanguage",{text:"Spellcheck Language",context:"tools",menu:v,onPostRender:function(n){n.control.on("show",function(n){y(n)})}}),Nf(n,l,S,O,_)):(kf(n,l),Tf(n,T,d,_,O),_f(n,l,S,O,_))})}(window);