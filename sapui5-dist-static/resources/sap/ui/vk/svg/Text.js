/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.define(["./Element","./Path"],function(E,P){"use strict";var T=function(p){p=p||{};E.call(this,p);this.type="Text";this.content=p.content||(p.text?[{type:10,text:p.text}]:[]);this.style=p.style||{};this.style.size=this.style.size||1;this.x=(p.textTranslate&&p.textTranslate[0])||p.x||0;this.y=(p.textTranslate&&p.textTranslate[1])||p.y||0;this.fillStyle=p.fillStyle||{colour:[0,0,0,1]};this.lineStyle=p.lineStyle||{colour:[0,0,0,0],width:1};if(this.style.fill){this.fillStyle={colour:this.style.fill};}if(this.style.stroke){if(this.lineStyle==null){this.lineStyle={};}this.lineStyle.colour=this.style.stroke;}this.setMaterial(p.material);};T.prototype=Object.assign(Object.create(E.prototype),{constructor:T});T.prototype.tagName=function(){return"text";};T.prototype.defaultFillAlpha=1;var a=document.createElement("canvas");var b=a.getContext("2d");T.prototype._expandBoundingBox=function(f,m){if(this.domRef){var g=this.domRef.getBBox();if(g){this._expandBoundingBoxCE(f,m,g.x+g.width*0.5,g.y+g.height*0.5,g.width*0.5,g.height*0.5);return;}}function h(p){var t="";for(var i=0,l=p.length;i<l;i++){var c=p[i];switch(c.type){case 10:t+=c.text;break;case 11:case 12:t+=h(c.content);break;default:break;}}return t;}var j=isNaN(this.strokeWidth)?0:this.strokeWidth*0.5;b.font=this.style.size+"px "+(this.style.fontFace||"Arial");var k=b.measureText(h(this.content));var n=k.width*0.5+j;var o=(k.actualBoundingBoxAscent||this.style.size)*0.5+j;this._expandBoundingBoxCE(f,m,this.x+n,this.y-o,n,o);};function s(c,f){if(c.size){f("font-size",c.size);}if(c.fontFace){f("font-family",c.fontFace);}}T.prototype._setSpecificAttributes=function(c){c("x",this.x);c("y",this.y);s(this.style,c);};function r(f,g){for(var i=0,l=f.length;i<l;i++){var c=f[i];switch(c.type){case 10:g.write(c.text);break;case 11:g.write("<tspan");if(c.style){s(c.style,g.writeAttribute.bind(g));}g.write(">");r(c.content,g);g.write("</tspan>");break;case 12:g.write("<textPath");if(c.style){s(c.style,g.writeAttribute.bind(g));}if(!c.path&&c.pathSegments){c.path=new P({segments:c.pathSegments});}var p=c.path;if(p instanceof P){g.writeAttribute("href","#"+p.uid);g.write(">");g.write("<"+p.tagName());g.writeAttribute("id",p.uid);p._setSpecificAttributes(g.writeAttribute.bind(g));g.write("/>");}else{g.write(">");}r(c.content,g);g.write("</textPath>");break;default:break;}}}T.prototype._renderContent=function(c){r(this.content,c);};var d="http://www.w3.org/2000/svg";function e(f,p){var g;for(var i=0,l=f.length;i<l;i++){var c=f[i];switch(c.type){case 10:p.append(c.text);break;case 11:g=document.createElementNS(d,"tspan");if(c.style){s(c.style,g.setAttribute.bind(g));}e(c.content,g);p.append(g);break;case 12:g=document.createElementNS(d,"textPath");if(c.style){s(c.style,g.setAttribute.bind(g));}if(!c.path&&c.pathSegments){c.path=new P({segments:c.pathSegments});}var h=c.path;if(h instanceof P){g.setAttribute("href","#"+h.uid);var j=document.createElementNS(d,h.tagName());j.setAttribute("id",h.uid);h._setSpecificAttributes(j.setAttribute.bind(j));g.append(j);}e(c.content,g);p.append(g);break;default:break;}}}T.prototype._createContent=function(c){e(this.content,c);};T.prototype.copy=function(c,f){E.prototype.copy.call(this,c,f);this.content=c.content;this.style=c.style;this.x=c.x;this.y=c.y;return this;};return T;});
