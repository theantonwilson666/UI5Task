/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
(function(){"use strict";var f=[],r=/[()]/g,s=c(),S=[],t,a=/\w/;function b(i,B,n,y){if(B>=0){if(n){S[i].branchTracking[B].truthy+=1;}else{S[i].branchTracking[B].falsy+=1;}}if(y>=0){l(i,y);}return n;}function g(E,A,D){var V=parseInt(E.getAttribute(A));return V>0?V:D;}function c(){var s,y=document.getElementsByTagName("script"),i,n;for(i=0,n=y.length;i<n;i+=1){s=y[i];if(/BranchTracking.js$/.test(s.getAttribute("src"))){return s;}}}function d(i,n){var B=blanket.options("branchTracking"),y=false,D,z=f.length,A=i.inputFileName,E,H=i.inputFile,J;if(H.indexOf("// sap-ui-cover-browser msie")>=0){y=true;D=sap.ui.require("sap/ui/Device");if(D&&D.browser.msie){D=undefined;}}f.push(A);S[z]=_$blanket[A]=[];if(B){_$blanket[A].branchTracking=[];}_$blanket[A].source=H.split("\n");_$blanket[A].source.unshift("");_$blanket[A].warnings=[];J=""+falafel(H,{attachComment:y,comment:y,loc:true,range:true,source:H},v.bind(null,B,z,D));E=J.split("\n").length+1;if(E!==_$blanket[A].source.length){w(A,"Line length mismatch! "+_$blanket[A].source.length+" vs. "+E);}n(J);}function e(D,n){if(!("$ignored"in n)){if(n.parent&&e(D,n.parent)){n.$ignored=true;}else{n.$ignored=n.type==="BlockStatement"&&h(D,n);}}return n.$ignored;}function h(D,n){function i(y){return y.type==="Line"&&y.value===" sap-ui-cover-browser msie"&&!(D&&D.browser.msie);}return n.body[0]&&n.body[0].leadingComments&&n.body[0].leadingComments.some(i);}function l(i,n){S[i][n]+=1;}function v(B,i,D,n){var H=S[i],y=H.branchTracking,z=n.loc.start.line,A;function E(){n.update("blanket.$l("+i+", "+z+"); "+n.source());J();return true;}function J(){if(z in H){w(i,"Multiple statements on same line detected"+" â€“ minified code not supported! Line number "+z);}H[z]=0;}function K(){return n.loc.source.slice(n.left.range[1],n.right.range[0]).replace(r,"");}if(D&&e(D,n)){return false;}switch(n.type){case"FunctionDeclaration":case"FunctionExpression":if(n.body.body[0]&&z===n.body.body[0].loc.start.line){w(i,"Function body must not start on same line! Line number "+z);}break;default:}switch(n.type){case"AssignmentExpression":case"ArrayExpression":case"BlockStatement":case"BinaryExpression":case"Block":case"CallExpression":case"CatchClause":case"DebuggerStatement":case"EmptyStatement":case"FunctionExpression":case"Identifier":case"Line":case"Literal":case"MemberExpression":case"NewExpression":case"ObjectExpression":case"Program":case"Property":case"SequenceExpression":case"SwitchCase":case"ThisExpression":case"UnaryExpression":case"UpdateExpression":case"VariableDeclarator":return false;case"ConditionalExpression":if(!B){return false;}n.test.update("blanket.$b("+i+", "+y.length+", "+n.test.source()+")");y.push({alternate:n.alternate.loc,consequent:n.consequent.loc,falsy:0,truthy:0});return true;case"ExpressionStatement":if(n.expression.type==="Literal"&&n.expression.value==="use strict"){return false;}case"DoWhileStatement":case"ForInStatement":case"ForStatement":case"WhileStatement":case"WithStatement":case"BreakStatement":case"ContinueStatement":case"FunctionDeclaration":case"ReturnStatement":case"SwitchStatement":case"ThrowStatement":case"TryStatement":return E(n);case"IfStatement":if(h(undefined,n.consequent)){B=false;}n.test.update("blanket.$b("+i+", "+(B?y.length:-1)+", "+n.test.source()+", "+z+")");J();if(B){y.push({alternate:(n.alternate||n.test).loc,consequent:n.consequent.loc,falsy:0,truthy:0});}return true;case"LogicalExpression":if(!B){return false;}if(n.operator==="||"||n.operator==="&&"){A="blanket.$b("+i+", "+y.length+", "+n.left.source()+") "+K()+" ("+n.right.source()+")";if(!a.test(n.loc.source[n.range[0]])){A=" "+A;}n.update(A);y.push({alternate:n.operator==="&&"?n.left.loc:n.right.loc,consequent:n.operator==="&&"?n.right.loc:n.left.loc,falsy:0,truthy:0});}return true;case"VariableDeclaration":if(n.parent.type==="ForInStatement"||n.parent.type==="ForStatement"){return false;}return E(n);case"LabeledStatement":default:throw new Error(n.source());}}function w(i,M){var n=typeof i==="string"?i:f[i];jQuery.sap.log.warning(M,n,"sap.ui.test.BranchTracking");_$blanket[n].warnings.push(M);}function j(){var M={},i=[],n;QUnit.begin(function(D){n=D.modules.length;D.modules.forEach(function(y){M[y.name]=y;});});QUnit.moduleStart(function(y){i=i.concat(Object.keys(M).filter(function(z){return M[z].tests===y.tests;}));});return function(){return i.length<n?i:undefined;};}if(window.blanket){window._$blanket={};blanket.$b=b;blanket.$l=l;blanket.instrument=d;var G=j(),L=g(s,"data-lines-of-context",3);t=Math.min(g(s,"data-threshold",0),100);sap.ui.require(["sap/ui/test/BlanketReporter"],function(B){blanket.options("reporter",B.bind(null,L,t,G));});}var I,C="sap.ui.base.SyncPromise",F={},k,m,N=0,T,u={},U=new Map();function o(n,y){var B,H=_$blanket[n.$currentFileName],z=F[n.$currentFileName],A;if(n.$oldHits){A=Object.keys(H).filter(function(i){return!(z&&z[i])&&H[i]===n.$oldHits[i];});y.notOk(A.length,"Some lines have not been covered by this module in isolation: "+A);}if(n.$oldBranchTracking){B=Object.keys(H.branchTracking).filter(function(i){return H.branchTracking[i].falsy===n.$oldBranchTracking[i].falsy||H.branchTracking[i].truthy===n.$oldBranchTracking[i].truthy;});y.notOk(B.length,"Some branches have not been fully covered by this module in isolation: "+B);}}function p(R){var i,n=Object.keys(u).length+(U?U.size:0),M="Uncaught (in promise): "+n+" times\n",P,y,z,A;if(n){for(i in u){P=u[i];if(P.getResult()&&P.getResult().stack){M+=P.getResult().stack;}else{M+=P.getResult();}if(P.$error.stack){M+="\n>>> SyncPromise rejected with above reason...\n"+P.$error.stack.split("\n").slice(2).join("\n");}M+="\n\n";}u={};if(U&&U.size){A=U.values();for(;;){z=A.next();if(z.done){break;}y=z.value;M+=(y&&y.stack||y)+"\n\n";}U.clear();}if(R){R(M);}else if(I){jQuery.sap.log.info("Clearing "+n+" uncaught promises",M,C);}}}if(s.getAttribute("data-uncaught-in-promise")!=="true"){window.addEventListener("unhandledrejection",function(E){if(E.reason&&E.reason.$uncaughtInPromise){return;}if(U){U.set(E.promise,E.reason);E.preventDefault();}else{alert("Uncaught (in promise) "+E.reason);}});window.addEventListener("rejectionhandled",function(E){if(U){U.delete(E.promise);}});}function q(P,i){if(i){delete u[P.$id];if(I){jQuery.sap.log.info("Promise "+P.$id+" caught",Object.keys(u),C);}return;}P.$id=N++;P.$error=new Error();u[P.$id]=P;if(I){jQuery.sap.log.info("Promise "+P.$id+" rejected with "+P.getResult(),Object.keys(u),C);}}function x(i,H){var A,n,B,y;H=H||{};A=H.after||function(){};n=H.afterEach||function(){};B=H.before||function(){};y=H.beforeEach||function(){};H.after=function(z){if(window.blanket&&!k&&!T&&!this.__ignoreIsolatedCoverage__&&t>=100&&!z.test.module.stats.bad){o(this,z);}return A.apply(this,arguments);};H.afterEach=function(z){var D=p.bind(null,z.ok.bind(z,false));function E(K){D();throw K;}function J(R){if(R&&typeof R.then==="function"){return R.then(J,E);}D();return R;}try{return J(n.apply(this,arguments));}catch(K){E(K);}};H.before=function(z){var D;this.$currentFileName=jQuery.sap.getResourceName(z.test.module.name);D=window.blanket&&_$blanket[this.$currentFileName];if(D){this.$oldHits=D.slice();if(D.branchTracking){this.$oldBranchTracking=JSON.parse(JSON.stringify(D.branchTracking,["falsy","truthy"]));}D.warnings.forEach(function(M){z.ok(false,M);});}return B.apply(this,arguments);};H.beforeEach=function(z){p();return y.apply(this,arguments);};m(i,H);}if(QUnit.module!==x){m=QUnit.module.bind(QUnit);QUnit.module=x;sap.ui.require(["sap/base/Log","sap/base/util/UriParameters","sap/ui/base/SyncPromise"],function(i,n,y){var z=n.fromQuery(window.location.search);I=i.isLoggable(i.Level.INFO,C);k=z.get("filter");T=z.get("testId");y.listener=q;});QUnit.begin(function(){var i,H;jQuery("#qunit-modulefilter-dropdown-list").css("max-height","none");jQuery("#qunit-modulefilter-dropdown").on("click",function(M){if(M.target.tagName==="LABEL"){setTimeout(function(){jQuery("#qunit-modulefilter-actions").children().first().trigger("click");});}});if(window.blanket){for(i in _$blanket){H=_$blanket[i];F[i]=H.slice();}}});QUnit.done(function(){U=null;});}}());
