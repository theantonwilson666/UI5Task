// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/core/mvc/Controller","sap/base/Log","sap/ushell/resources","sap/ui/core/library","sap/ui/thirdparty/hasher"],function(C,L,r,c,h){"use strict";var V=c.ValueState;return C.extend("sap.ushell.ui.footerbar.SaveAsTile",{onInit:function(){var v=this.getView();v.getTitleInput().attachLiveChange(function(){if(this.getValue()===""){this.setValueStateText(r.i18n.getText("bookmarkTitleInputError"));this.setValueState(V.Error);}else{this.setValueState(V.None);}});},loadPersonalizedGroups:function(){return sap.ushell.Container.getServiceAsync("LaunchPage").then(function(a){return new Promise(function(b,d){a.getGroupsForBookmarks().done(b).fail(d);});}).then(function(b){var m=this.getView().getModel();m.setProperty("/groups",b);m.setProperty("/groups/length",b.length);}.bind(this)).catch(function(){L.error("SaveAsTile controller: Unable to determine targets for bookmark placement.");});},getLocalizedText:function(m,p){return p?r.i18n.getText(m,p):r.i18n.getText(m);},getBookmarkTileData:function(){var v=this.getView();var m=v.getModel();var o=v.getViewData();var s;if(v.oGroupsSelect&&v.oGroupsSelect.getSelectedItem()){s=v.oGroupsSelect.getSelectedItem().getBindingContext().getObject();}var u;if(o.customUrl){if(typeof(o.customUrl)==="function"){u=o.customUrl();}else{u=o.customUrl;}}else{u=h.getHash()?("#"+h.getHash()):window.location.href;}var d={title:m.getProperty("/title")||"",subtitle:m.getProperty("/subtitle")||"",url:u,icon:m.getProperty("/icon")||"",info:m.getProperty("/info")||"",numberUnit:m.getProperty("/numberUnit")||"",serviceUrl:typeof(o.serviceUrl)==="function"?o.serviceUrl():o.serviceUrl,serviceRefreshInterval:m.getProperty("/serviceRefreshInterval"),group:s,keywords:m.getProperty("/keywords")||""};d.title=d.title.substring(0,256).trim();d.subtitle=d.subtitle.substring(0,256).trim();d.info=d.info.substring(0,256).trim();return d;},onExit:function(){var v=this.getView();var t=v.getTileView();t.destroy();}});});
