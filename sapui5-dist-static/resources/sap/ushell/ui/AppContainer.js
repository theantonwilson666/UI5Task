// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/thirdparty/jquery","sap/ui/core/Control","sap/ui/Device","sap/base/Log","sap/ushell/renderers/fiori2/AccessKeysHandler","./AppContainerRenderer"],function(q,C,D,L,A){"use strict";var a=C.extend("sap.ushell.ui.AppContainer",{metadata:{library:"sap.ushell",properties:{visible:{type:"boolean",group:"Appearance",defaultValue:true}},aggregations:{pages:{type:"sap.ui.core.Control",multiple:true,singularName:"pages"}},events:{beforeNavigate:{parameters:{fromId:{type:"string"},from:{type:"sap.ui.core.Control"},toId:{type:"string"},to:{type:"sap.ui.core.Control"}}},afterNavigate:{parameters:{fromId:{type:"string"},from:{type:"sap.ui.core.Control"},toId:{type:"string"},to:{type:"sap.ui.core.Control"}}}}}});a.prototype.addPages=function(c){if(this.getPages().indexOf(c)>-1){return;}c.toggleStyleClass("hidden",true);this.addAggregation("pages",c,true);var r,d=this.getDomRef();if(d){r=sap.ui.getCore().createRenderManager();r.render(c,d);r.destroy();}};a.prototype.addCenterViewPort=a.prototype.addPages;a.prototype.removeCenterViewPort=function(i){this.removeAggregation("pages",i,true);};a.prototype.getCurrentCenterPage=function(){return this.getPages().reduce(function(c,p){return(p&&!p.hasStyleClass("hidden"))?p.getId():c;},null);};a.prototype.navTo=function(v,p){var t=sap.ui.getCore().byId(p),c=this.getCurrentCenterPage(),o=sap.ui.getCore().byId(c)||null,h=sap.ushell.Container.getRenderer("fiori2").byId("Shell-home-component-container"),H=h&&h.getId(),N=c&&(H===c),b=H===p;if(v!=="centerViewPort"){L.error("Navigation to "+v+" is not allowed in Fiori3");return;}if(this.getPages().indexOf(t)===-1){L.error("AppContainer: invalid navigation target");return;}if(D.system.desktop&&N){this._saveFocus();}if(c!==p){this.fireBeforeNavigate({toId:p,to:t,fromId:c,from:o});}this.getPages().forEach(function(P){if(P){P.toggleStyleClass("hidden",P.getId()!==p);}});if(D.system.desktop&&b){this._restoreFocus();}if(c!==p){this.fireAfterNavigate({toId:p,to:t,fromId:c,from:o});}};a.prototype._restoreFocus=function(){var c;if(this.sLastFocusId){A.registerAppKeysHandler(this.fnLastAppKeyHandler);c=sap.ui.getCore().byId(this.sLastFocusId);if(c){c.focus();}}};a.prototype._saveFocus=function(){var o=q(document.activeElement).control(0);this.sLastFocusId=o?o.getId():null;this.fnLastAppKeyHandler=A.getAppKeysHandler();};a.prototype.getViewPortControl=function(v,c){return this.getPages().reduce(function(o,p){return(v==="centerViewPort"&&p&&p.getId()===c)?p:o;},null);};var n=function(){};a.prototype.switchState=n;a.prototype._handleSizeChange=n;a.prototype.shiftCenterTransitionEnabled=n;a.prototype.shiftCenterTransition=n;a.prototype.addLeftViewPort=n;a.prototype.addRightViewPort=n;a.prototype.attachAfterSwitchState=n;a.prototype.detachAfterSwitchState=n;a.prototype.attachAfterSwitchStateAnimationFinished=n;a.prototype.detachAfterSwitchStateAnimationFinished=n;a.prototype.getCurrentState=function(){return"Center";};return a;});
