// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/Log","sap/ui/base/ManagedObject","sap/ui/core/Control","sap/ui/thirdparty/jquery","sap/ushell/library","sap/ushell/ui/launchpad/AccessibilityCustomData","./LinkTileWrapperRenderer"],function(L,M,C,q,u,A){"use strict";var a=C.extend("sap.ushell.ui.launchpad.LinkTileWrapper",{metadata:{library:"sap.ushell",properties:{uuid:{type:"string",group:"Misc",defaultValue:null},tileCatalogId:{type:"string",group:"Misc",defaultValue:null},target:{type:"string",group:"Misc",defaultValue:null},visible:{type:"boolean",group:"Misc",defaultValue:true},debugInfo:{type:"string",group:"Misc",defaultValue:null},animationRendered:{type:"boolean",group:"Misc",defaultValue:false},isLocked:{type:"boolean",group:"Misc",defaultValue:false},tileActionModeActive:{type:"boolean",group:"Misc",defaultValue:false},ieHtml5DnD:{type:"boolean",group:"Misc",defaultValue:false}},aggregations:{tileViews:{type:"sap.ui.core.Control",multiple:true,singularName:"tileView"},footItems:{type:"sap.ui.core.Control",multiple:true,singularName:"footItem"}},events:{press:{},coverDivPress:{},afterRendering:{},showActions:{}}}});a.prototype.destroy=function(s){this.destroyTileViews();C.prototype.destroy.call(this,s);};a.prototype.addTileView=function(o,s){o.setParent(null);o.addCustomData(new A({key:"tabindex",value:"-1",writeToDom:true}));M.prototype.addAggregation.call(this,"tileViews",o,s);};a.prototype.destroyTileViews=function(){if(this.mAggregations.tileViews){this.mAggregations.tileViews.length=0;}};a.prototype.onAfterRendering=function(){this.fireAfterRendering();};a.prototype.onclick=a.prototype._onPress;a.prototype.onsapenter=a.prototype._launchTileViaKeyboard;a.prototype.onsapspace=a.prototype._launchTileViaKeyboard;a.prototype._launchTileViaKeyboard=function(e){L.info("Tile pressed:",this.getDebugInfo(),"sap.ushell.ui.launchpad.LinkTileWrapper");sap.ui.getCore().getEventBus().publish("launchpad","dashboardTileLinkClick");if(this.getTileActionModeActive()){return;}else if(this._getTileState()==="Failed"){this._onFailedStatePress();}else if(e.target.tagName!=="BUTTON"){var t=this.getTileViews()[0],p=false;if(t.firePress){t.firePress();}else{while(t.getContent&&!p){t=t.getContent()[0];if(t.firePress){t.firePress();p=true;}}}}};a.prototype._onPress=function(e){L.info("Tile pressed:",this.getDebugInfo(),"sap.ushell.ui.launchpad.LinkTileWrapper");sap.ui.getCore().getEventBus().publish("launchpad","dashboardTileLinkClick");if(!this.getTileActionModeActive()&&(this._getTileState()==="Failed")){this._onFailedStatePress();}};a.prototype._onFailedStatePress=function(){if(!this.getTileActionModeActive()&&(this._getTileState()==="Failed")){if(!this.FailedTileDialog){sap.ui.require(["sap/ushell/ui/launchpad/FailedTileDialog"],function(F){this.FailedTileDialog=new F();this._onFailedStatePress();}.bind(this));}else{this.FailedTileDialog.openFor(this);}return;}};a.prototype._getTileState=function(){var t=this.getTileViews();var T;for(var i=0;(i<t.length)&&!T;++i){if(t[i].isA("sap.m.GenericTile")){T=t[i];}}if(!T){throw new Error("Could not find the wrapped Tile");}return T.getState();};a.prototype.setVisible=function(v){this.setProperty("visible",v,true);return this.toggleStyleClass("sapUshellHidden",!v);};a.prototype.setAnimationRendered=function(v){this.setProperty("animationRendered",v,true);};a.prototype._handleTileShadow=function(j,b){if(j.length){j.unbind("mouseenter mouseleave");var c,t=j.css("border").split("px")[0],m=this.getModel();if(t>0){c=j.css("border-color");}else{c=this.getRgba();}j.hover(function(){if(!m.getProperty("/tileActionModeActive")){var o=q(j).css("box-shadow"),T=o?o.split(") ")[1]:null,U;if(T){U=T+" "+c;q(this).css("box-shadow",U);}}},function(){q(this).css("box-shadow","");});}};a.prototype.setUuid=function(U){this.setProperty("uuid",U,true);return this;};return a;});
