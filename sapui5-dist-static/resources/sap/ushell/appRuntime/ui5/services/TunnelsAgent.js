// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.define(["sap/ushell/appRuntime/ui5/AppRuntimeService"],function(A){"use strict";function T(){var t={},a=this;this.reflectEvents=function(s){for(var S in s){if(s.hasOwnProperty(S)){this.reflectEventEntry(S,s[S]);}}};this.reflectEventEntry=function(s,S){var i=S.iInterface,f=S.sFuncName,b=s,c=S.fnSpy,p=S.fnProxy,e="",C=function(){var o=arguments,d=c.apply(undefined,arguments);if(p){o=p.apply(undefined,arguments);}if(d){a.callTunnel({tunnelName:b,oData:o});}};if(!S.iInterface){e+="strategy "+s+" is missing mandatory property 'iInterface'.\n";}if(!S.sFuncName){e+="strategy "+s+" is missing mandatory property 'sFuncName'.\n";}if(e){throw e;}this.replace({iInterface:i,sFuncName:f,fnCallback:C,sWrap:"after"});};this.getCallTunnelFunction=function(){var t={},a=this;return function(p){var f=p.tunnelName,o=p.oData;if(!t[f]){a.getTunnel(f).done(function(r){t[f]=r.endPoint;t[f].apply(undefined,o);});}else{t[f].apply(undefined,o);}};};this.callTunnel=function(p){var f=p.tunnelName,o=p.oData;return new Promise(function(r){if(!t[f]){a.getTunnel(f).done(function(R){t[f]=R.endPoint;t[f].apply(undefined,o).done(function(d){r(d);});});}else{t[f].apply(undefined,o).done(function(d){r(d);});}});};this.replace=function(p){var o=p.iInterface[p.sFuncName],w=p.sWrap;p.iInterface[p.sFuncName]=function(){if(w==="before"){o.apply(this,arguments);}p.fnCallback.apply(undefined,arguments);if(w==="after"){o.apply(this,arguments);}};return{getOriginal:function(){return o;}};};this.useInterface=function(d){var i=d.name,c=d.callback,p=d.params;var C="sap.ushell.tunnelRegistry."+i;A.sendMessageToOuterShell(C,p).done(c);};this.getTunnel=function(s){var c="sap.ushell.tunnelRegistry."+s;return A.sendMessageToOuterShell(c,{});};this.usePairedInterface=function(c){var s=c.sService,m=c.sMethodName,p=c.fnPackArgs,C=s+"."+m;var b=function(){var P=p.apply(undefined,arguments);return A.sendMessageToOuterShell(C,P);};b.getPairedInterface=function(){return[s,m].join('.');};return b;};}return new T();},true);
