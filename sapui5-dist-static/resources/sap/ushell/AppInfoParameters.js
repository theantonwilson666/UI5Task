// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/Log","sap/ushell/services/AppConfiguration","sap/base/util/restricted/_curry","sap/base/util/restricted/_zipObject","sap/ui/VersionInfo","sap/ushell/Config"],function(L,a,_,b,V,C){"use strict";function g(p){var A=p.applicationType;if(A==="TR"){A="GUI";}return A;}function c(){return a.getCurrentApplication().appCapabilities||{};}function d(p){function q(v){return(v.version||"")+(" ("+(v.buildTimestamp||"")+")")||"";}if(g(p)==="UI5"){return V.load().then(q).catch(function(){L.error("VersionInfo could not be loaded");});}return undefined;}function e(p){return Promise.resolve().then(function(){var q=p.componentInstance;if(q){var A=q.getManifestEntry("/sap.app/applicationVersion/version");return A;}return undefined;});}function f(p){var t=p.getTechnicalParameter("sap-ach");return t.then(function(A){var s=A&&A[0];if(s){return s;}return c().appSupportInfo;});}function h(p){function q(){var M=a.getMetadata();return M.technicalName;}var E={UI5:function(){var r=p.componentInstance;if(r){var s=r.getMetadata().getManifestEntry("/sap.ui5/componentName");if(!s){s=r.getMetadata().getComponentName();}return s;}return q();},TR:function(){return(q()||"").replace(/\s[(]TCODE[)]$/,"");},WDA:q,NWBC:q,URL:function(){return Promise.resolve().then(function(){var r=a.getCurrentApplication();if(r.appCapabilities.technicalAppComponentId){return r.appCapabilities.technicalAppComponentId;}return undefined;});}};var A=p.applicationType;if(E.hasOwnProperty(A)){return E[A]();}return undefined;}function i(p){return p.getTechnicalParameter("sap-fiori-id").then(function(F){if(F&&typeof F[0]==="string"){return F[0];}if(p.homePage){return"LAUNCHPAD";}return c().appId||p.inboundPermanentKey;});}function j(u){var r=sap.ushell.Container.getService("ReferenceResolver");return r.resolveReferences([u]).then(function(R){return R[u];});}function k(p){return Promise.resolve().then(function(){var q=a.getCurrentApplication();var A=g(p);if(A&&A!=="URL"){return A;}return q.appCapabilities&&q.appCapabilities.appFrameworkId;}).then(function(A){var q={NWBC:"WDA",TR:"GUI"};return q[A]||A;});}function l(p,q){return q.getSystemContext().then(function(s){return s.getProperty(p);});}function m(){var s=window.hasher&&window.hasher.getHash();if(!s){return Promise.reject("Could not identify current application hash");}return Promise.resolve().then(function(){return s;});}var H={theme:j.bind(null,"User.env.sap-theme-NWBC"),languageTag:j.bind(null,"User.env.sap-languagebcp47"),appIntent:m,appFrameworkId:k,appFrameworkVersion:d,appSupportInfo:f,technicalAppComponentId:h,appId:i,appVersion:e,productName:_(l)("productName")};function n(p){return!H[p]&&/[.]/.test(p);}function o(p,q){var P=p.map(function(s){if(n(s)){H[s]=_(l)(s);}if(!H[s]){L.error(s+" is not a valid app info parameter");return undefined;}return H[s](q);});return Promise.all(P).then(function(v){return b(p,v);});}return{getInfo:function(p,q){if(!q){return Promise.reject("Parameter application missing");}return o(["appFrameworkId"],q).then(function(){return o(p,q);});}};},false);
