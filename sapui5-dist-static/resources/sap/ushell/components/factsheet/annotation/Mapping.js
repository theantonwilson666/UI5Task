// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/Device"],function(D){"use strict";var M={};M.initialized=[];M.parse=function(m,a){var x={},A={},s={},o={},b={},c="",i,j,d,e,f,g,r,h,n,q,t,u,v,w,T,y,z,B,C,E,F,G,H,I,J,K,L,N,O,P,Q,R,S,U,V,W,X,Y;if(D.browser.internet_explorer){x={setNameSpace:function(k){k.setProperty("SelectionNamespaces","xmlns:edmx=\"http://docs.oasis-open.org/odata/ns/edmx\" xmlns:d=\"http://docs.oasis-open.org/odata/ns/edm\"");k.setProperty("SelectionLanguage","XPath");return k;},selectNodes:function(k,x,l){return l.selectNodes(x);},nextNode:function(k){return k.nextNode();},getNodeText:function(k){return k.text;}};}else{x={setNameSpace:function(k){return k;},nsResolver:function(p){var k={"edmx":"http://docs.oasis-open.org/odata/ns/edmx","d":"http://docs.oasis-open.org/odata/ns/edm"};return k[p]||null;},selectNodes:function(k,p,l){var i1=k.evaluate(p,l,this.nsResolver,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);i1.length=i1.snapshotLength;return i1;},nextNode:function(k,l){return k.snapshotItem(l);},getNodeText:function(k){return k.textContent;}};}var Z=function(k){var l;if(D.browser.internet_explorer){l=new ActiveXObject("Microsoft.XMLHTTP");l.open("GET",k,false);l.send(null);return l.responseXML;}l=jQuery.sap.sjax({url:k,dataType:"xml"});if(l.success){return l.data;}};var $=function(m){var i1={},j1={},k1={},l1=false,i,m1,n1,o1,p1={},j,q1={},r1={},s1=false,t1,l,k,u1,v1,w1,x1,p,y1;for(i=m.dataServices.schema.length-1;i>=0;i-=1){i1=m.dataServices.schema[i];if(i1.entityType){m1=i1.namespace;n1=i1.entityType;o1=i1.complexType;for(j in n1){if(n1.hasOwnProperty(j)){p1=n1[j];r1={};if(p1.hasStream&&p1.hasStream==="true"){continue;}q1={};for(k in p1.property){t1=p1.property[k];if(t1.type.substring(0,m1.length)===m1){for(l in o1){if(o1[l].name===t1.type.substring(m1.length+1)){for(k in o1[l].property){u1=o1[l].property[k];q1[o1[l].name+"/"+u1.name]=u1.type;}}}}else{v1=t1.name;w1=t1.type;for(p in t1.extensions){x1=t1.extensions[p];if((x1.name==="display-format")&&(x1.value==="Date")){w1="Edm.Date";}else{s1=true;if(!r1[v1]){r1[v1]={};}if(x1.namespace&&!r1[v1][x1.namespace]){r1[v1][x1.namespace]={};}r1[v1][x1.namespace][x1.name]=x1.value;}}q1[v1]=w1;}}if(!j1[m1+"."+p1.name]){j1[m1+"."+p1.name]={};}j1[m1+"."+p1.name]=q1;if(s1){if(!k1[m1+"."+p1.name]){l1=true;}k1[m1+"."+p1.name]={};k1[m1+"."+p1.name]=r1;}}}}}if(l1){y1={types:j1,extensions:k1};}else{y1={types:j1};}return y1;};var _=function(p,k,l,s){var i1,j1,k1="";for(i1 in p){if(p.hasOwnProperty(i1)){if(p[i1]){j1=p[i1];if(j1.Value&&j1.Value.Path){k1=a1(j1.Value.Path,k,l,s);if(k1){p[i1].EdmType=k1;}continue;}if(j1.Path){k1=a1(j1.Path,k,l,s);if(k1){p[i1].EdmType=k1;}continue;}if(j1.Facets){p[i1].Facets=_(j1.Facets,k,l,s);continue;}if(j1.Data){p[i1].Data=_(j1.Data,k,l,s);continue;}if(i1==="Data"){p.Data=_(j1,k,l,s);continue;}if(j1.Value&&j1.Value.Apply){p[i1].Value.Apply.Parameters=_(j1.Value.Apply.Parameters,k,l,s);continue;}if(j1.Value&&j1.Type&&(j1.Type==="Path")){k1=a1(j1.Value,k,l,s);if(k1){p[i1].EdmType=k1;}}}}}return p;};var a1=function(p,k,l,s){var i1;if((p.charAt(0)==="@")&&(p.indexOf(s.Alias)===1)){p=p.slice(s.Alias.length+2);}if(p.indexOf("/")>=0){if(k[p.slice(0,p.indexOf("/"))]){l=p.slice(0,p.indexOf("/"));p=p.slice(p.indexOf("/")+1);}}for(i1 in k[l]){if(k[l].hasOwnProperty(i1)){if(p===i1){return k[l][i1];}}}};var b1=function(k){var l="",p="",i,i1={};for(i=0;i<k.attributes.length;i+=1){if((k.attributes[i].name!=="Property")&&(k.attributes[i].name!=="Term")){l=k.attributes[i].name;p=k.attributes[i].value;}}if(l.length>0){i1[l]=h1(p);}return i1;};var c1=function(d,k){var l={},p,i1,j1,k1,l1,m1;if(k.hasChildNodes()){p=x.selectNodes(d,"./d:String",k);if(p.length>0){i1=x.nextNode(p,0);l.String=x.getNodeText(i1);}else{j1=x.selectNodes(d,"./d:Path",k);if(j1.length>0){k1=x.nextNode(j1,0);l.Path=x.getNodeText(k1);}else{l1=x.selectNodes(d,"./d:Apply",k);if(l1.length>0){m1=x.nextNode(l1,0);l.Apply=f1(d,m1);}}}}return l;};var d1=function(d,k,l){var p={},i1,j1,y,k1,l1,m1,n1,o1,p1={},E,C,K,q1,r1;if(k.hasChildNodes()){i1=x.selectNodes(d,"./d:Record | ./d:Collection/d:Record | ./d:Collection/d:If/d:Record",k);if(i1.length){j1=0;for(y=0;y<i1.length;y+=1){k1=x.nextNode(i1,y);l1=e1(d,k1,l);if(k1.getAttribute("Type")){l1.RecordType=h1(k1.getAttribute("Type"));}if(j1===0){if(k1.nextElementSibling||(k1.parentNode.nodeName==="Collection")||(k1.parentNode.nodeName==="If")){p=[];p.push(l1);}else{p=l1;}}else{p.push(l1);}j1+=1;}}else{m1=x.selectNodes(d,"./d:UrlRef",k);if(m1.length>0){for(y=0;y<m1.length;y+=1){n1=x.nextNode(m1,y);p.UrlRef=c1(d,n1);}}else{m1=x.selectNodes(d,"./d:Url",k);if(m1.length>0){for(y=0;y<m1.length;y+=1){n1=x.nextNode(m1,y);p.Url=c1(d,n1);}}else{r1=x.selectNodes(d,"./d:Collection/d:AnnotationPath | ./d:Collection/d:PropertyPath",k);if(r1.length>0){p=[];for(y=0;y<r1.length;y+=1){o1=x.nextNode(r1,y);p1={};p1[o1.nodeName]=x.getNodeText(o1);p.push(p1);}}else{p=b1(k);E=x.selectNodes(d,"./d:Annotation",k);C={};for(K=0;K<E.length;K+=1){C=x.nextNode(E,K);if(C.hasChildNodes()===false){q1=h1(C.getAttribute("Term"));p[q1]=b1(C);}}}}}}}else{p=b1(k);}return p;};var e1=function(d,k,l){var p={},C={},E,K,i1,j1,y,k1,l1,m1,n1,o1;E=x.selectNodes(d,"./d:Annotation",k);for(K=0;K<E.length;K+=1){C=x.nextNode(E,K);if(C.hasChildNodes()===false){i1=h1(C.getAttribute("Term"));p[i1]=b1(C);}}j1=x.selectNodes(d,"./d:PropertyValue",k);if(j1.length>0){for(y=0;y<j1.length;y+=1){k1=x.nextNode(j1,y);l1=k1.getAttribute("Property");p[l1]=d1(d,k1,l);m1=x.selectNodes(d,"./d:Apply",k1);n1=null;for(o1=0;o1<m1.length;o1+=1){n1=x.nextNode(m1,o1);if(n1){p[l1]={};p[l1].Apply=f1(d,n1);}}}}else{p=d1(d,k,l);}return p;};var f1=function(d,k){var l={},p,i1=null,j1=[],i;p=x.selectNodes(d,"./d:*",k);for(i=0;i<p.length;i+=1){i1=x.nextNode(p,i);switch(i1.nodeName){case"Apply":j1.push({"Type":"Apply","Value":f1(d,i1)});break;case"LabeledElement":j1.push({"Name":i1.getAttribute("Name"),"Value":c1(d,i1)});break;default:j1.push({"Type":i1.nodeName,"Value":x.getNodeText(i1)});break;}}l.Name=k.getAttribute("Function");l.Parameters=j1;return l;};var g1=function(l,p){var i1,i,j1,k1,j,k;for(i=m.dataServices.schema.length-1;i>=0;i-=1){i1=m.dataServices.schema[i];if(i1.entityType){j1=i1.namespace+".";k1=i1.entityType;for(k=k1.length-1;k>=0;k-=1){if(j1+k1[k].name===l&&k1[k].navigationProperty){for(j=0;j<k1[k].navigationProperty.length;j+=1){if(k1[k].navigationProperty[j].name===p){return true;}}}}}}return false;};var h1=function(k){for(f in A){if(A.hasOwnProperty(f)){if(k.indexOf(f+".")>=0){k=k.replace(f+".",A[f]+".");return k;}}}return k;};if(this.initialized[a]){return this.initialized[a];}d=Z(a);d=x.setNameSpace(d);e=x.selectNodes(d,"//d:Schema",d);for(i=0;i<e.length;i+=1){g=x.nextNode(e,i);s.Alias=g.getAttribute("Alias");s.Namespace=g.getAttribute("Namespace");}h=x.selectNodes(d,"//edmx:Reference",d);for(i=0;i<h.length;i+=1){r=x.nextNode(h,i);q=x.selectNodes(d,"./edmx:Include",r);if(q&&q.length>0){n=x.nextNode(q,0);if(n.getAttribute("Alias")){A[n.getAttribute("Alias")]=n.getAttribute("Namespace");}else{A[n.getAttribute("Namespace")]=n.getAttribute("Namespace");}}u=x.selectNodes(d,"./edmx:IncludeAnnotations",r);if(u.length>0){for(j=0;j<u.length;j+=1){t=x.nextNode(u,j);if(t.getAttribute("TargetNamespace")){c=t.getAttribute("TargetNamespace");if(!o[c]){o[c]={};}o[c][t.getAttribute("TermNamespace")]=r.getAttribute("Uri");}else{o[t.getAttribute("TermNamespace")]=r.getAttribute("Uri");}}}}if(o){b.annotationReferences=o;}b.aliasDefinitions=A;w=x.selectNodes(d,"//d:Term",d);if(w.length>0){T={};for(y=0;y<w.length;y+=1){v=x.nextNode(w,y);z=h1(v.getAttribute("Type"));T["@"+s.Alias+"."+v.getAttribute("Name")]=z;}b.termDefinitions=T;}B=$(m);if(B.extensions){b.propertyExtensions=B.extensions;}E=x.selectNodes(d,"//d:Annotations ",d);for(y=0;y<E.length;y+=1){C=x.nextNode(E,y);if(C.hasChildNodes()===false){continue;}F=C.getAttribute("Target");G=F.split(".")[0];if(G&&A[G]){F=F.replace(new RegExp(G,""),A[G]);}H=F;I=null;if(F.indexOf("/")>0){H=F.split("/")[0];I=F.replace(H+"/","");}if(!b[H]){b[H]={};}if(I){if(!b.propertyAnnotations){b.propertyAnnotations={};}if(!b.propertyAnnotations[H]){b.propertyAnnotations[H]={};}b.propertyAnnotations[H][I]={};J=x.selectNodes(d,"./d:Annotation",C);for(K=0;K<J.length;K+=1){L=x.nextNode(J,K);if(L.hasChildNodes()===false){N=h1(L.getAttribute("Term"));b.propertyAnnotations[H][I][N]=b1(L);}}}else{O=H.replace(A[G],G);J=x.selectNodes(d,"./d:Annotation",C);for(P=0;P<J.length;P+=1){L=x.nextNode(J,P);Q=L.getAttribute("Qualifier");R=h1(L.getAttribute("Term"));if(Q){R+="#"+Q;}S=d1(d,L,O);S=_(S,B.types,H,s);b[H][R]=S;}V=x.selectNodes(d,"//d:Annotations[contains(@Target, '"+O+"')]//d:PropertyValue[contains(@Path, '/')]//@Path",d);for(i=0;i<V.length;i+=1){U=x.nextNode(V,i);X=U.value;if(b.propertyAnnotations){if(b.propertyAnnotations[H]){if(b.propertyAnnotations[H][X]){continue;}}}W=X.split("/");if(g1(H,W[0],m)){if(!b.expand){b.expand={};}if(!b.expand[H]){b.expand[H]={};}b.expand[H][W[0]]=W[0];}}Y=x.selectNodes(d,"//d:Annotations[contains(@Target, '"+O+"')]//d:Path[contains(., '/')]",d);for(i=0;i<Y.length;i+=1){U=x.nextNode(Y,i);X=x.getNodeText(U);if(b.propertyAnnotations[H]){if(b.propertyAnnotations[H][X]){continue;}}if(!b.expand){b.expand={};}if(!b.expand[H]){b.expand[H]={};}W=X.split("/");if(g1(H,W[0],m)){if(!b.expand){b.expand={};}if(!b.expand[H]){b.expand[H]={};}b.expand[H][W[0]]=W[0];}}}this.initialized[a]=b;}return b;};return M;},true);
