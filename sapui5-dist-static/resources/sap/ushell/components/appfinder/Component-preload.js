//@ui5-bundle sap/ushell/components/appfinder/Component-preload.js
// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.predefine('sap/ushell/components/appfinder/AppFinder.controller',["sap/ui/core/library","sap/ui/core/mvc/Controller","sap/ui/core/Component","sap/ushell/ui/launchpad/AccessibilityCustomData","sap/ushell/ui5service/ShellUIService","sap/ushell/EventHub","sap/ushell/components/CatalogsManager","sap/ushell/components/appfinder/VisualizationOrganizerHelper","sap/ui/core/routing/HashChanger","sap/ui/thirdparty/jquery","sap/ui/model/json/JSONModel","sap/ui/Device"],function(c,C,a,A,S,E,b,V,H,q,J,D){"use strict";var d=c.mvc.ViewType;return C.extend("sap.ushell.components.appfinder.AppFinder",{onInit:function(){var o=a.getOwnerComponentFor(this.getView());this.oRouter=o.getRouter();var v=this.getView();var m=o.getModel();v.setModel(m);this.bEnableEasyAccessSAPMenu=m.getProperty("/enableEasyAccessSAPMenu");this.bEnableEasyAccessUserMenu=m.getProperty("/enableEasyAccessUserMenu");this.bShowEasyAccessMenu=(this.bEnableEasyAccessSAPMenu||this.bEnableEasyAccessUserMenu)&&(!D.system.phone&&!D.system.tablet||D.system.combi);sap.ushell.Container.getRenderer("fiori2").createExtendedShellState("appFinderExtendedShellState",function(){sap.ushell.Container.getRenderer("fiori2").showHeaderItem("backBtn",true);sap.ushell.Container.getRenderer("fiori2").showHeaderItem("homeBtn",true);});this.oCatalogsManager=new b("catalogsMgr",{model:m});this.oVisualizationOrganizerHelper=V.getInstance();this.getView().setModel(this._getSubHeaderModel(),"subHeaderModel");this.oConfig=o.getComponentData().config;this.oCatalogView=sap.ui.view("catalogView",{type:d.JS,viewName:"sap.ushell.components.appfinder.Catalog",height:"100%",viewData:{parentComponent:o,subHeaderModel:this._getSubHeaderModel()}}).addStyleClass("sapUiGlobalBackgroundColor sapUiGlobalBackgroundColorForce");this.oRouter.attachRouteMatched(this._handleAppFinderNavigation.bind(this));v.createSubHeader();if(!this.bShowEasyAccessMenu){v.oPage.addContent(this.oCatalogView);setTimeout(function(){q("#catalogSelect").focus();},0);}D.resize.attachHandler(this._resizeHandler.bind(this));this.oRouter.oHashChanger=H.getInstance();},onExit:function(){this.oCatalogView.destroy();},_resizeHandler:function(){var s=this._showOpenCloseSplitAppButton();var e=this.oSubHeaderModel.getProperty("/openCloseSplitAppButtonVisible");if(s!==e){this.oSubHeaderModel.setProperty("/openCloseSplitAppButtonVisible",s);if(s){this.oSubHeaderModel.setProperty("/openCloseSplitAppButtonToggled",false);}}this._toggleViewWithToggleButtonClass(s);},_handleAppFinderNavigation:function(e){var v=this.getView();this._preloadAppHandler();this._getPathAndHandleGroupContext(e);this._toggleViewWithToggleButtonClass(this._showOpenCloseSplitAppButton());if(this.bShowEasyAccessMenu){this.onShow(e);}else if(v._showSearch("catalog")){v.updateSubHeader("catalog",false);this._toggleViewWithSearchAndTagsClasses("catalog");}sap.ui.getCore().getEventBus().publish("showCatalog");E.emit("CenterViewPointContentRendered","appFinder");E.emit("showCatalog",{sId:"showCatalog",oData:Date.now()});sap.ui.getCore().getEventBus().publish("launchpad","contentRendered");},_showOpenCloseSplitAppButton:function(){return!D.orientation.landscape||D.system.phone||this.oView.getModel().getProperty("/isPhoneWidth");},_resetSubHeaderModel:function(){this.oSubHeaderModel.setProperty("/activeMenu",null);this.oSubHeaderModel.setProperty("/search",{searchMode:false,searchTerm:null});this.oSubHeaderModel.setProperty("/tag",{tagMode:false,selectedTags:[]});this.oSubHeaderModel.setProperty("/openCloseSplitAppButtonVisible",this._showOpenCloseSplitAppButton());this.oSubHeaderModel.setProperty("/openCloseSplitAppButtonToggled",false);},_getSubHeaderModel:function(){if(this.oSubHeaderModel){return this.oSubHeaderModel;}this.oSubHeaderModel=new J();this._resetSubHeaderModel();return this.oSubHeaderModel;},onTagsFilter:function(e){var t=e.getSource(),s=t.getModel("subHeaderModel"),f=e.getSource().getSelectedItems(),T=f.length>0,o={tagMode:T,selectedTags:[]};f.forEach(function(g){o.selectedTags.push(g.getText());});s.setProperty("/activeMenu",this.getCurrentMenuName());s.setProperty("/tag",o);this.oCatalogView.getController().onTag(o);},searchHandler:function(e){var o=sap.ushell.components.getCatalogsManager();o.loadCustomTilesKeyWords();var s=e.getSource().getValue(),f=false;if(s===null){return;}var g=this.oSubHeaderModel.getProperty("/search");var h=this.oSubHeaderModel.getProperty("/activeMenu");if(this.getCurrentMenuName()!==h){h=this.getCurrentMenuName();}if(!g.searchMode&&!e.getParameter("clearButtonPressed")){g.searchMode=true;}if(g.searchMode&&D.system.phone){this.oSubHeaderModel.setProperty("/openCloseSplitAppButtonToggled",false);}if(s!==g.searchTerm){if(this.containsOnlyWhitepaces(s)){s="*";}g.searchTerm=s;f=true;}this.oSubHeaderModel.setProperty("/search",g);this.oSubHeaderModel.setProperty("/activeMenu",h);this.oSubHeaderModel.refresh(true);if(f){this.oCatalogView.getController().onSearch(g);}},_preloadAppHandler:function(){setTimeout(function(){if(sap.ushell.Container){sap.ushell.Container.getRenderer("fiori2").applyExtendedShellState("appFinderExtendedShellState");}this._updateShellHeader(this.oView.oPage.getTitle());}.bind(this),0);},getCurrentMenuName:function(){return this.currentMenu;},_navigateTo:function(n){var s=this.oVisualizationOrganizerHelper.getNavigationContextAsText.apply(this);if(s){this.oRouter.navTo(n,{filters:s},true);}else{this.oRouter.navTo(n,{},true);}},getGroupNavigationContext:function(){var g=this.oView.getModel().getProperty("/groupContext");var G=g?g.path:null;if(G){return JSON.stringify({targetGroup:encodeURIComponent(G)});}return null;},getSystemsModels:function(){var t=this;if(this.getSystemsPromise){return this.getSystemsPromise;}var g=new q.Deferred();this.getSystemsPromise=g.promise();var m=["userMenu","sapMenu"].map(function(e){var s=new J();s.setProperty("/systemSelected",null);s.setProperty("/systemsList",[]);return t.getSystems(e).then(function(r){s.setProperty("/systemsList",r);return s;});});q.when.apply(q,m).then(function(u,s){g.resolve(u,s);});return this.getSystemsPromise;},onSegmentButtonClick:function(e){this.oSubHeaderModel.setProperty("/search/searchMode",false);this.oSubHeaderModel.setProperty("/search/searchTerm","");var n=e.getParameter("id");this._navigateTo(n);},onShow:function(e){var p=e.getParameter("name");if(p===this.getCurrentMenuName()){return;}var v=this.getView();v._updateSearchWithPlaceHolder(p);this._updateCurrentMenuName(p);this.getSystemsModels().then(function(u,s){var f=s.getProperty("/systemsList");var g=u.getProperty("/systemsList");v.oPage.removeAllContent();var h=(this.currentMenu==="sapMenu"?f:g);if(h&&h.length){v.updateSubHeader(this.currentMenu,true);}else if(v._showSearch(this.currentMenu)){v.updateSubHeader(this.currentMenu,false);}if(this.currentMenu==="catalog"){v.oPage.addContent(this.oCatalogView);}else if(this.currentMenu==="userMenu"){if(!this.userMenuView){this.userMenuView=new sap.ui.view("userMenuView",{type:d.JS,viewName:"sap.ushell.components.appfinder.EasyAccess",height:"100%",viewData:{menuName:"USER_MENU",easyAccessSystemsModel:u,parentComponent:a.getOwnerComponentFor(this.getView()),subHeaderModel:this._getSubHeaderModel(),enableSearch:this.getView()._showSearch("userMenu")}});}v.oPage.addContent(this.userMenuView);}else if(this.currentMenu==="sapMenu"){if(!this.sapMenuView){this.sapMenuView=new sap.ui.view("sapMenuView",{type:d.JS,viewName:"sap.ushell.components.appfinder.EasyAccess",height:"100%",viewData:{menuName:"SAP_MENU",easyAccessSystemsModel:s,parentComponent:a.getOwnerComponentFor(this.getView()),subHeaderModel:this._getSubHeaderModel(),enableSearch:this.getView()._showSearch("sapMenu")}});}v.oPage.addContent(this.sapMenuView);}this._setFocusToSegmentedButton(h);this.oSubHeaderModel.setProperty("/activeMenu",this.currentMenu);if(this.oSubHeaderModel.getProperty("/openCloseSplitAppButtonVisible")){this.oSubHeaderModel.setProperty("/openCloseSplitAppButtonToggled",false);}this.oSubHeaderModel.refresh(true);}.bind(this));},_updateCurrentMenuName:function(m){if(!this.bShowEasyAccessMenu||(m==="sapMenu"&&!this.bEnableEasyAccessSAPMenu)||(m==="userMenu"&&!this.bEnableEasyAccessUserMenu)){this.currentMenu="catalog";}else{this.currentMenu=m;}this._toggleViewWithSearchAndTagsClasses(m);},_toggleViewWithSearchAndTagsClasses:function(m){var v=this.getView();if(v._showSearch(m)){v.oPage.addStyleClass("sapUshellAppFinderSearch");}else{v.oPage.removeStyleClass("sapUshellAppFinderSearch");}if(v._showSearchTag(m)){v.oPage.addStyleClass("sapUshellAppFinderTags");}else{v.oPage.removeStyleClass("sapUshellAppFinderTags");}},_toggleViewWithToggleButtonClass:function(B){var v=this.getView();if(B){v.oPage.addStyleClass("sapUshellAppFinderToggleButton");}else{v.oPage.removeStyleClass("sapUshellAppFinderToggleButton");}},_setFocusToSegmentedButton:function(s){var v=this.getView();if(s&&s.length){var B=v.segmentedButton.getSelectedButton();setTimeout(function(){q("#"+B).focus();},0);}else{setTimeout(function(){q("#catalogSelect").focus();},0);}},_getPathAndHandleGroupContext:function(o){var p=o.getParameter("arguments");var s=p.filters;var f;try{f=JSON.parse(s);}catch(e){f=s;}this.oVisualizationOrganizerHelper.updateModelWithContext.apply(this,[f]);},_updateModelWithGroupContext:function(o){var l=sap.ushell.Container.getService("LaunchPage"),m=this.oView.getModel(),p=(o&&decodeURIComponent(o.targetGroup))||"";var g,G;p=p==="undefined"?undefined:p;G={path:p,id:"",title:""};if(p&&p!==""){var t=function(){var M=m.getProperty("/groups");if(M.length){g=m.getProperty(p);G.id=l.getGroupId(g.object);G.title=g.title||l.getGroupTitle(g.object);return;}setTimeout(t,100);};t();}m.setProperty("/groupContext",G);},getSystems:function(m){var o=new q.Deferred();var e=sap.ushell.Container.getService("ClientSideTargetResolution");if(!e){o.reject("cannot get ClientSideTargetResolution service");}else{e.getEasyAccessSystems(m).done(function(s){var f=[];var g=Object.keys(s);for(var i=0;i<g.length;i++){var h=g[i];f[i]={systemName:s[h].text,systemId:h};}o.resolve(f);}).fail(function(s){o.reject("An error occurred while retrieving the systems: "+s);});}return o.promise();},_initializeShellUIService:function(){this.oShellUIService=new S({scopeObject:this.getOwnerComponent(),scopeType:"component"});},_updateShellHeader:function(t){if(!this.oShellUIService){this._initializeShellUIService();}this.oShellUIService.setTitle(t);this.oShellUIService.setHierarchy();},containsOnlyWhitepaces:function(t){if(!t||t===""){return false;}return(!t.replace(/\s/g,"").length);}});});
sap.ui.predefine('sap/ushell/components/appfinder/AppFinder.view',["sap/ui/thirdparty/jquery","sap/ui/core/ListItem","sap/ui/model/Sorter","sap/m/MultiComboBox","sap/ui/model/BindingMode","sap/m/SearchField","sap/m/FlexBox","sap/m/SegmentedButton","sap/m/SegmentedButtonItem","sap/m/ToggleButton","sap/ushell/ui/launchpad/AccessibilityCustomData","sap/m/Toolbar","sap/m/Page","sap/ushell/resources","sap/ui/Device","sap/ui/core/Component","sap/ushell/renderers/fiori2/AccessKeysHandler"],function(q,L,S,M,B,a,F,b,c,T,A,d,P,r,D,C,e){"use strict";sap.ui.jsview("sap.ushell.components.appfinder.AppFinder",{createContent:function(){var R=r.i18n;this.oPage=new P("appFinderPage",{showHeader:false,showSubHeader:false,showFooter:false,showNavButton:false,enableScrolling:false,title:{parts:["/groupContext/title"],formatter:function(t){return!t?R.getText("appFinderTitle"):R.getText("appFinder_group_context_title",t);}}});return this.oPage;},_showSearch:function(m){var s="enableCatalogSearch";if(m==="userMenu"){s="enableEasyAccessUserMenuSearch";}else if(m==="sapMenu"){s="enableEasyAccessSAPMenuSearch";}return this.getModel().getProperty("/"+s);},_showSearchTag:function(m){if(m==="userMenu"||m==="sapMenu"){return false;}return this.getModel().getProperty("/enableCatalogTagFilter");},createSubHeader:function(){this.oToolbar=new d("appFinderSubHeader",{});if(D.system.desktop){this.oToolbar.addEventDelegate({onsapskipback:function(E){E.preventDefault();e.setIsFocusHandledByAnotherHandler(true);e.sendFocusBackToShell(E);},onsapskipforward:function(E){var o=sap.ui.getCore().byId("openCloseButtonAppFinderSubheader");if(o.getVisible()&&!o.getPressed()){E.preventDefault();sap.ushell.components.ComponentKeysHandler.setFocusOnCatalogTile();}},onAfterRendering:function(){q("#catalog-button").attr("accesskey","a");}});}this.oToolbar.addCustomData(new A({key:"role",value:"heading",writeToDom:true}));this.oToolbar.addCustomData(new A({key:"aria-level",value:"2",writeToDom:true}));this.oToolbar.addStyleClass("sapUshellAppFinderHeader");this.oPage.setSubHeader(this.oToolbar);this.oPage.setShowSubHeader(true);if(!this.openCloseSplitAppButton){this.openCloseSplitAppButton=new T("openCloseButtonAppFinderSubheader",{icon:"sap-icon://menu2",visible:"{/openCloseSplitAppButtonVisible}",pressed:"{/openCloseSplitAppButtonToggled}",press:function(E){this.getController().oSubHeaderModel.setProperty("/openCloseSplitAppButtonToggled",E.getSource().getPressed());this.openCloseSplitAppButton.setTooltip(E.getParameter("pressed")?r.i18n.getText("ToggleButtonHide"):r.i18n.getText("ToggleButtonShow"));}.bind(this),tooltip:r.i18n.getText("ToggleButtonShow")});if(D.system.desktop){this.openCloseSplitAppButton.addEventDelegate({onsaptabprevious:function(E){E.preventDefault();e.setIsFocusHandledByAnotherHandler(true);e.sendFocusBackToShell(E);}});}this.openCloseSplitAppButton.setModel(this.getController().oSubHeaderModel);this.oToolbar.addContent(this.openCloseSplitAppButton);}},updateSubHeader:function(m,E){var s,o;this.oToolbar.removeAllContent();this.oToolbar.addContent(this.openCloseSplitAppButton);if(E){s=this.createSegmentedButtons(m);this.oPage.addStyleClass("sapUshellAppFinderWithEasyAccess");this.oToolbar.addContent(s);}if(this._showSearch(m)){o=this.createSearchControl(m);this.oToolbar.addContent(o);}this.getController()._updateCurrentMenuName(m);},createSegmentedButtons:function(m){var o,R,s,f,g,i;if(this.segmentedButton){this.segmentedButton.setSelectedKey(m);return this.segmentedButton;}o=this.getController();R=r.i18n;s=[];s.push(new c("catalog",{text:R.getText("appFinderCatalogTitle"),key:"catalog",press:function(E){o.onSegmentButtonClick(E);}}));if(o.bEnableEasyAccessUserMenu){s.push(new c("userMenu",{text:R.getText("appFinderUserMenuTitle"),key:"userMenu",press:function(E){o.onSegmentButtonClick(E);}}));}if(o.bEnableEasyAccessSAPMenu){s.push(new c("sapMenu",{text:R.getText("appFinderSapMenuTitle"),key:"sapMenu",press:function(E){o.onSegmentButtonClick(E);}}));}this.segmentedButton=new b("appFinderSegmentedButtons",{items:s});if(D.system.desktop){this.segmentedButton.addEventDelegate({onsaptabprevious:function(E){var h=sap.ui.getCore().byId("openCloseButtonAppFinderSubheader");if(!h.getVisible()){E.preventDefault();e.setIsFocusHandledByAnotherHandler(true);e.sendFocusBackToShell(E);}}});}this.segmentedButton.setSelectedKey(m);f=this.segmentedButton.getItems();for(i=0;i<f.length;i++){g=f[i];g.addCustomData(new A({key:"aria-controls",value:g.getId()+"View",writeToDom:true}));}return this.segmentedButton;},_handleSearch:function(){this.getController().searchHandler.apply(this.getController(),arguments);q("#appFinderSearch input").select();},createSearchControl:function(m){if(!this.oAppFinderSearchContainer){this.oAppFinderSearchContainer=new F("appFinderSearchContainer");}this.oAppFinderSearchContainer.removeAllItems();if(m==="catalog"&&this._showSearchTag("catalog")){this.oAppFinderSearchContainer.addItem(this.createTagControl());}if(!this.oAppFinderSearchControl){this.oAppFinderSearchControl=new a("appFinderSearch",{search:this._handleSearch.bind(this),value:{path:"subHeaderModel>/search/searchTerm",mode:B.OneWay}}).addStyleClass("help-id-catalogSearch");this.oAppFinderSearchControl.addCustomData(new A({key:"aria-controls",value:"",writeToDom:true}));if(D.system.desktop){this.oAppFinderSearchControl.addEventDelegate({onsaptabnext:function(E){var o=sap.ui.getCore().byId("openCloseButtonAppFinderSubheader");if(o.getVisible()&&!o.getPressed()){E.preventDefault();e.setIsFocusHandledByAnotherHandler(true);sap.ushell.components.ComponentKeysHandler.setFocusOnCatalogTile();}}});}}this.oAppFinderSearchContainer.addItem(this.oAppFinderSearchControl);this._updateSearchWithPlaceHolder(m);return this.oAppFinderSearchContainer;},_updateSearchWithPlaceHolder:function(m){var s="";if(m==="catalog"){s="EasyAccessMenu_SearchPlaceHolder_Catalog";}else if(m==="userMenu"){s="EasyAccessMenu_SearchPlaceHolder_UserMenu";}else if(m==="sapMenu"){s="EasyAccessMenu_SearchPlaceHolder_SAPMenu";}if(s&&this.oAppFinderSearchControl){this.oAppFinderSearchControl.setPlaceholder(r.i18n.getText(s));this.oAppFinderSearchControl.setTooltip(r.i18n.getText(s));}},createTagControl:function(){if(this.oAppFinderTagFilter){return this.oAppFinderTagFilter;}var o=this.getController();this.oAppFinderTagFilter=new M("appFinderTagFilter",{selectedKeys:{path:"subHeaderModel>/tag/selectedTags"},tooltip:"{i18n>catalogTilesTagfilter_tooltip}",placeholder:"{i18n>catalogTilesTagfilter_HintText}",visible:{path:"/tagList",formatter:function(t){return t.length>0;}},items:{path:"/tagList",sorter:new S("tag",false,false),template:new L({text:"{tag}",key:"{tag}"})},selectionChange:[o.onTagsFilter,o]}).addStyleClass("help-id-catalogTagFilter");return this.oAppFinderTagFilter;},getControllerName:function(){return"sap.ushell.components.appfinder.AppFinder";}});});
sap.ui.predefine('sap/ushell/components/appfinder/Catalog.controller',["sap/ushell/components/_HomepageManager/PagingManager","sap/ui/core/UIComponent","sap/ui/thirdparty/jquery","sap/ushell/resources","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/library","sap/ui/Device","sap/ui/core/library","sap/ui/model/Context","sap/m/MessageToast","sap/ushell/Config","sap/ushell/services/AppType","sap/ushell/components/appfinder/VisualizationOrganizerHelper","sap/ushell/utils/WindowUtils"],function(P,U,q,r,F,a,m,D,c,C,M,b,A,V,W){"use strict";var d=c.mvc.ViewType;var S=m.SplitAppMode;sap.ui.controller("sap.ushell.components.appfinder.Catalog",{oPopover:null,onInit:function(){this.categoryFilter="";this.preCategoryFilter="";var v=this.getView();this.oMainModel=v.getModel();this.oSubHeaderModel=v.getModel("subHeaderModel");this.resetPage=false;this.bIsInProcess=false;this.oVisualizationOrganizerHelper=v.oVisualizationOrganizerHelper;this.oCatalogsContainer=v.oCatalogsContainer;sap.ui.getCore().byId("catalogSelect").addEventDelegate({onBeforeRendering:this.onBeforeSelectRendering},this);var R=U.getRouterFor(this);R.attachRouteMatched(this.onShow,this);this.timeoutId=0;document.subHeaderModel=this.oSubHeaderModel;document.mainModel=this.oMainModel;var t=this.oSubHeaderModel.bindProperty("/openCloseSplitAppButtonToggled");t.attachChange(this.handleToggleButtonModelChanged,this);v.oCatalogsContainer.setHandleSearchCallback(this.handleSearchModelChanged.bind(this));},onBeforeRendering:function(){sap.ui.getCore().getEventBus().publish("renderCatalog");},onAfterRendering:function(){this.wasRendered=true;if(!this.PagingManager){this._setPagingManager();}if(this.PagingManager.currentPageIndex===0){this.allocateNextPage();}q(window).resize(function(){var w=q(window).width();var e=q(window).height();this.PagingManager.setContainerSize(w,e);}.bind(this));this._handleAppFinderWithDocking();sap.ui.getCore().getEventBus().subscribe("launchpad","appFinderWithDocking",this._handleAppFinderWithDocking,this);sap.ui.getCore().getEventBus().subscribe("sap.ushell","appFinderAfterNavigate",this._handleAppFinderAfterNavigate,this);},_setPagingManager:function(){this.lastCatalogId=0;this.PagingManager=new P("catalogPaging",{supportedElements:{tile:{className:"sapUshellTile"}},containerHeight:window.innerHeight,containerWidth:window.innerWidth});this.oCatalogsContainer.setPagingManager(this.PagingManager);},_decodeUrlFilteringParameters:function(u){var o;try{o=JSON.parse(u);}catch(e){o=u;}var h=(o&&o.tagFilter&&o.tagFilter)||[];if(h){try{this.tagFilter=JSON.parse(h);}catch(e){this.tagFilter=[];}}else{this.tagFilter=[];}this.categoryFilter=(o&&o.catalogSelector&&o.catalogSelector)||this.categoryFilter;if(this.categoryFilter){this.categoryFilter=window.decodeURIComponent(this.categoryFilter);}this.searchFilter=(o&&o.tileFilter&&o.tileFilter)||null;if(this.searchFilter){this.searchFilter=window.decodeURIComponent(this.searchFilter);}},_applyFilters:function(w){var s=false;if(this.categoryFilter){this.categoryFilter=r.i18n.getText("all")===this.categoryFilter?"":this.categoryFilter;if(this.categoryFilter!==this.preCategoryFilter){s=true;}this.oView.setCategoryFilterSelection(this.categoryFilter,s);}else{s=true;this.oView.setCategoryFilterSelection("",s);}this.preCategoryFilter=this.categoryFilter;if(this.searchFilter&&this.searchFilter.length){this.searchFilter=this.searchFilter.replace(/\*/g,"");this.searchFilter=this.searchFilter.trim();this.oSubHeaderModel.setProperty("/search",{searchMode:true,searchTerm:this.searchFilter});}else if(w){this.oSubHeaderModel.setProperty("/search",{searchMode:false,searchTerm:""});this.resetPage=true;}if(this.tagFilter&&this.tagFilter.length){this.oSubHeaderModel.setProperty("/tag",{tagMode:true,selectedTags:this.tagFilter});}else if(w){this.oSubHeaderModel.setProperty("/tag",{tagMode:false,selectedTags:[]});this.resetPage=true;}this.handleSearchModelChanged();},_handleAppFinderAfterNavigate:function(){this.clearFilters();},clearFilters:function(){var s=false;if(this.categoryFilter!==this.preCategoryFilter){s=true;}var e=this.oSubHeaderModel.getProperty("/search/searchMode");var t=this.oSubHeaderModel.getProperty("/tag/tagMode");if(e){this.oSubHeaderModel.setProperty("/search",{searchMode:true,searchTerm:""});}if(t){this.oSubHeaderModel.setProperty("/tag",{tagMode:true,selectedTags:[]});}if(this.categoryFilter&&this.categoryFilter!==""){this.selectedCategoryId=undefined;this.categoryFilter=undefined;this.getView().getModel().setProperty("/categoryFilter","");this.oView.setCategoryFilterSelection("",s);}this.preCategoryFilter=this.categoryFilter;this.handleSearchModelChanged();},onShow:function(e){var u=e.getParameter("arguments").filters;q.extend(this.getView().getViewData(),e);this._decodeUrlFilteringParameters(u);if(this.wasRendered&&!u){this.clearFilters();}else{this._applyFilters(this.wasRendered);}},allocateNextPage:function(){if(!this.oCatalogsContainer.nAllocatedUnits||this.oCatalogsContainer.nAllocatedUnits===0){this.PagingManager.moveToNextPage();this.allocateTiles=this.PagingManager._calcElementsPerPage();this.oCatalogsContainer.applyPagingCategoryFilters(this.allocateTiles,this.categoryFilter);}},onBeforeSelectRendering:function(){var s=sap.ui.getCore().byId("catalogSelect");var i=q.grep(s.getItems(),function(I){return I.getBindingContext().getObject().title===this.categoryFilter;}.bind(this));if(!i.length&&s.getItems()[0]){i.push(s.getItems()[0]);}},setTagsFilter:function(f){var p={catalogSelector:this.categoryFilter?this.categoryFilter:"All",tileFilter:(this.searchFilter&&this.searchFilter.length)?encodeURIComponent(this.searchFilter):"",tagFilter:f.length?JSON.stringify(f):[]};this._addNavigationContextToFilter(p);this.getView().parentComponent.getRouter().navTo("catalog",{filters:JSON.stringify(p)});},setCategoryFilter:function(f){var p={catalogSelector:f,tileFilter:this.searchFilter?encodeURIComponent(this.searchFilter):"",tagFilter:this.tagFilter.length?JSON.stringify(this.tagFilter):[]};this._addNavigationContextToFilter(p);this.getView().parentComponent.getRouter().navTo("catalog",{filters:JSON.stringify(p)});},setSearchFilter:function(f){var p={catalogSelector:this.categoryFilter?this.categoryFilter:"All",tileFilter:f?encodeURIComponent(f):"",tagFilter:this.tagFilter.length?JSON.stringify(this.tagFilter):[]};this._addNavigationContextToFilter(p);this.getView().parentComponent.getRouter().navTo("catalog",{filters:JSON.stringify(p)});},_addNavigationContextToFilter:function(f){var o=this.oVisualizationOrganizerHelper.getNavigationContext.apply(this);if(o){Object.keys(o).forEach(function(k){f[k]=o[k];});}return f;},onSearch:function(s){var e=this.oSubHeaderModel.getProperty("/activeMenu");if(this.oView.getId().indexOf(e)!==-1){var f=s.searchTerm?s.searchTerm:"";this.setSearchFilter(f);}else{this._restoreSelectedMasterItem();}},onTag:function(t){var s=this.oSubHeaderModel.getProperty("/activeMenu");if(this.oView.getId().indexOf(s)!==-1){var e=t.selectedTags?t.selectedTags:[];this.setTagsFilter(e);}else{this._restoreSelectedMasterItem();}},getGroupContext:function(){var o=this.getView().getModel();var g=o.getProperty("/groupContext/path");return{targetGroup:encodeURIComponent(g||"")};},_isTagFilteringChanged:function(s){var e=s.length===this.tagFilter.length;var i=e;if(!i){return true;}s.some(function(t){i=this.tagFilter&&Array.prototype.indexOf.call(this.tagFilter,t)!==-1;return!i;}.bind(this));return i;},_setUrlWithTagsAndSearchTerm:function(s,e){var u={tileFilter:s&&s.length?encodeURIComponent(s):"",tagFilter:e.length?JSON.stringify(e):[]};this._addNavigationContextToFilter(u);this.getView().parentComponent.getRouter().navTo("catalog",{filters:JSON.stringify(u)});},handleSearchModelChanged:function(){var s=this.oSubHeaderModel.getProperty("/search/searchMode");var t=this.oSubHeaderModel.getProperty("/tag/tagMode");var e=this.oSubHeaderModel.getProperty("/search/searchTerm");var f=this.oSubHeaderModel.getProperty("/tag/selectedTags");var g=[];var T,o,h,p,i;if(!this.PagingManager){this._setPagingManager();}this.PagingManager.resetCurrentPageIndex();this.nAllocatedTiles=0;this.PagingManager.moveToNextPage();this.allocateTiles=this.PagingManager._calcElementsPerPage();this.oView.oCatalogsContainer.updateAllocatedUnits(this.allocateTiles);this.oView.oCatalogsContainer.resetCatalogPagination();var j=sap.ui.getCore().byId("catalogTilesDetailedPage");if(j){j.scrollTo(0,0);}if(s||t||this.resetPage){if(f&&f.length>0){T=new F("tags","EQ","v");T.fnTest=function(x){var y,z;if(f.length===0){return true;}for(y=0;y<f.length;y++){z=f[y];if(x.indexOf(z)===-1){return false;}}return true;};o=new F([T],true);}e=e?e.replace(/\*/g,""):e;if(e){var k=e.split(/[\s,]+/);var l=new F(q.map(k,function(x){return(x&&new F("keywords",a.Contains,x));}),true);var n=new F(q.map(k,function(x){return(x&&new F("title",a.Contains,x));}),true);var u=new F(q.map(k,function(x){return(x&&new F("subtitle",a.Contains,x));}),true);g.push(l);g.push(n);g.push(u);h=new F(g,false);}var v=this.oView.oCatalogsContainer.getCatalogs();this.oSearchResultsTotal=[];var w=this;if(o&&o.aFilters.length>0&&h){i=new F([h].concat([o]),true);}else if(o&&o.aFilters.length>0){i=new F([o],true);}else if(h&&h.aFilters.length>0){i=new F([h],true);}v.forEach(function(x){x.getBinding("customTilesContainer").filter(i);x.getBinding("appBoxesContainer").filter(i);});this.oView.oCatalogsContainer.bSearchResults=false;this.oView.oCatalogsContainer.applyPagingCategoryFilters(this.oView.oCatalogsContainer.nAllocatedUnits,this.categoryFilter);this.bSearchResults=this.oView.oCatalogsContainer.bSearchResults;this.oView.splitApp.toDetail(w.getView()._calculateDetailPageId());this.resetPage=false;}else{this.oView.oCatalogsContainer.applyPagingCategoryFilters(this.oView.oCatalogsContainer.nAllocatedUnits,this.categoryFilter);}p=this.getView()._calculateDetailPageId();this.oView.splitApp.toDetail(p);},_handleAppFinderWithDocking:function(){if(q(".sapUshellContainerDocked").length>0){if(q("#mainShell").width()<710){if(window.innerWidth<1024){this.oSubHeaderModel.setProperty("/openCloseSplitAppButtonVisible",false);this.oView.splitApp.setMode(S.ShowHideMode);}else{this.oView.splitApp.setMode(S.HideMode);this.oSubHeaderModel.setProperty("/openCloseSplitAppButtonVisible",true);}}else{this.oSubHeaderModel.setProperty("/openCloseSplitAppButtonVisible",false);this.oView.splitApp.setMode(S.ShowHideMode);}}},_restoreSelectedMasterItem:function(){var o=this.oView.splitApp.getMasterPage("catalogSelect");var O=sap.ui.getCore().byId(this.selectedCategoryId);if(O){this.categoryFilter=O.getTitle();}o.setSelectedItem(O);},handleToggleButtonModelChanged:function(){var B=this.oSubHeaderModel.getProperty("/openCloseSplitAppButtonVisible");var e=this.oSubHeaderModel.getProperty("/openCloseSplitAppButtonToggled");if((e!==this.bCurrentButtonToggled)&&B){if(!D.system.phone){if(e&&!this.oView.splitApp.isMasterShown()){this.oView.splitApp.showMaster();}else if(this.oView.splitApp.isMasterShown()){this.oView.splitApp.hideMaster();}}else if(this.oView.splitApp.isMasterShown()){var o=sap.ui.getCore().byId(this.getView()._calculateDetailPageId());this.oView.splitApp.toDetail(o);}else if(e){var f=sap.ui.getCore().byId("catalogSelect");this.oView.splitApp.toMaster(f,"show");}}this.bCurrentButtonToggled=e;},_handleCatalogListItemPress:function(e){this.onCategoryFilter(e);if(this.oSubHeaderModel.getProperty("/search/searchTerm")!==""){this.oSubHeaderModel.setProperty("/search/searchMode",true);}if(D.system.phone||D.system.tablet){this.oSubHeaderModel.setProperty("/openCloseSplitAppButtonToggled",!this.oSubHeaderModel.setProperty("/openCloseSplitAppButtonToggled"));}},onCategoryFilter:function(e){var o=e.getSource();var s=o.getSelectedItem();var f=s.getBindingContext();var g=f.getModel();if(g.getProperty("static",f)){g.setProperty("/showCatalogHeaders",true);this.setCategoryFilter();this.selectedCategoryId=undefined;this.categoryFilter=undefined;}else{g.setProperty("/showCatalogHeaders",false);this.setCategoryFilter(window.encodeURIComponent(s.getBindingContext().getObject().title));this.categoryFilter=s.getTitle();this.selectedCategoryId=s.getId();}},onTileAfterRendering:function(e){var j=q(e.oSource.getDomRef());var f=j.find(".sapMGT");f.attr("tabindex","-1");},catalogTilePress:function(){sap.ui.getCore().getEventBus().publish("launchpad","catalogTileClick");},onAppBoxPressed:function(e){var o=e.getSource();var t=o.getBindingContext().getObject();var p;if(e.mParameters.srcControl.$().closest(".sapUshellPinButton").length){return;}p=sap.ushell.Container.getService("LaunchPage").getAppBoxPressHandler(t);if(p){p(t);}else{var u=o.getProperty("url");if(u&&u.indexOf("#")===0){hasher.setHash(u);}else{var l=b.last("/core/shell/enableRecentActivity")&&b.last("/core/shell/enableRecentActivityLogging");if(l){var R={title:o.getProperty("title"),appType:A.URL,url:u,appId:u};sap.ushell.Container.getRenderer("fiori2").logRecentActivity(R);}W.openURL(u,"_blank");}}},onTilePinButtonClick:function(e){var l=sap.ushell.Container.getService("LaunchPage");var o=l.getDefaultGroup();o.done(function(f){var B=e.getSource();var s=B.getBindingContext();var g=this.getView().getModel();var G=g.getProperty("/groupContext/path");if(G){this._handleTileFooterClickInGroupContext(s,G);}else{var h=g.getProperty("/groups");var i=this.getCatalogTileDataFromModel(s);var t=i.tileData.associatedGroups;var j=[];var R=h.map(function(k){var n,u;n=l.getGroupId(k.object);u=!((t&&Array.prototype.indexOf.call(t,n)===-1));j.push({id:n,title:this._getGroupTitle(f,k.object),selected:u});return{selected:u,initiallySelected:u,oGroup:k};}.bind(this));var p=sap.ui.getCore().byId("sapUshellGroupsPopover");var T;if(!p){T=l.getCatalogTilePreviewTitle(g.getProperty(s.sPath).src);if(!T){T=l.getCatalogTileTitle(g.getProperty(s.sPath).src);}p=new sap.ui.view("sapUshellGroupsPopover",{type:d.JS,viewName:"sap.ushell.components.appfinder.GroupListPopover",viewData:{groupData:R,title:T,enableHideGroups:g.getProperty("/enableHideGroups"),enableHelp:g.getProperty("/enableHelp"),sourceContext:s,catalogModel:this.getView().getModel(),catalogController:this}});p.getController().setSelectedStart(j);p.open(B).then(this._handlePopoverResponse.bind(this,s,i));}}}.bind(this));},_getGroupTitle:function(o,g){var l=sap.ushell.Container.getService("LaunchPage");var t;if(o&&(l.getGroupId(o)===l.getGroupId(g))){t=r.i18n.getText("my_group");}else{t=l.getGroupTitle(g);}return t;},_handlePopoverResponse:function(s,e,f){if(!f.addToGroups.length&&!f.newGroups.length&&!f.removeFromGroups.length){return;}var o=this.getView().getModel();var g=o.getProperty("/groups");var p=[];f.addToGroups.forEach(function(h){var i=g.indexOf(h);var G=new C(o,"/groups/"+i);p.push(this._addTile(s,G));}.bind(this));f.removeFromGroups.forEach(function(h){var t=s.getModel().getProperty(s.getPath()).id;var i=g.indexOf(h);p.push(this._removeTile(t,i));}.bind(this));f.newGroups.forEach(function(h){var n=(h.length>0)?h:r.i18n.getText("new_group_name");p.push(this._createGroupAndSaveTile(s,n));}.bind(this));q.when.apply(q,p).then(function(){var R=Array.prototype.slice.call(arguments);this._handlePopoverGroupsActionPromises(e,f,R);}.bind(this));},_handlePopoverGroupsActionPromises:function(e,p,f){var E=f.filter(function(v){return!v.status;});if(E.length){var o=this.prepareErrorMessage(E,e.tileData.title);var g=sap.ushell.components.getCatalogsManager();g.resetAssociationOnFailure(o.messageId,o.parameters);return;}var t=[];var l=sap.ushell.Container.getService("LaunchPage");p.allGroups.forEach(function(v){if(v.selected){var G=l.getGroupId(v.oGroup.object);t.push(G);}});var h=this.getView().getModel();if(p.newGroups.length){var i=h.getProperty("/groups");var n=i.slice(i.length-p.newGroups.length);n.forEach(function(v){var G=l.getGroupId(v.object);t.push(G);});}h.setProperty(e.bindingContextPath+"/associatedGroups",t);var s=p.addToGroups[0]?p.addToGroups[0].title:"";if(s.length===0&&p.newGroups.length){s=p.newGroups[0];}var j=p.removeFromGroups[0]?p.removeFromGroups[0].title:"";var k=p.addToGroups.length+p.newGroups.length;var R=p.removeFromGroups.length;var u=this.prepareDetailedMessage(e.tileData.title,k,R,s,j);M.show(u,{duration:3000,width:"15em",my:"center bottom",at:"center bottom",of:window,offset:"0 -50",collision:"fit fit"});},_getCatalogTileIndexInModel:function(s){var t=s.sPath;var T=t.split("/");var i=T[T.length-1];return i;},_handleTileFooterClickInGroupContext:function(s,g){var l=sap.ushell.Container.getService("LaunchPage");var o=this.getView().getModel();var e=this.getCatalogTileDataFromModel(s);var f=e.tileData.associatedGroups;var G=o.getProperty(g);var h=l.getGroupId(G.object);var i=f?Array.prototype.indexOf.call(f,h):-1;var t=e.bindingContextPath;if(e.isBeingProcessed){return;}o.setProperty(t+"/isBeingProcessed",true);var T;var j;if(i===-1){var k=new C(s.getModel(),g);T=this._addTile(s,k);j=true;}else{var n=s.getModel().getProperty(s.getPath("id"));var p=parseInt(g.split("/")[2],10);T=this._removeTile(n,p);j=false;}T.done(function(u){if(u.status){this._groupContextOperationSucceeded(s,e,G,j);}else{this._groupContextOperationFailed(e,G,j);}}.bind(this));T.always(function(){o.setProperty(t+"/isBeingProcessed",false);});},_groupContextOperationSucceeded:function(s,o,g,t){var l=sap.ushell.Container.getService("LaunchPage");var G=l.getGroupId(g.object);var e=o.tileData.associatedGroups;var f;if(t){e.push(G);s.getModel().setProperty(o.bindingContextPath+"/associatedGroups",e);f=this.prepareDetailedMessage(o.tileData.title,1,0,g.title,"");}else{for(var i=0;i<e.length;i++){if(e[i]===G){e.splice(i,1);break;}}s.getModel().setProperty(o.bindingContextPath+"/associatedGroups",e);f=this.prepareDetailedMessage(o.tileData.title,0,1,"",g.title);}M.show(f,{duration:3000,width:"15em",my:"center bottom",at:"center bottom",of:window,offset:"0 -50",collision:"fit fit"});},_groupContextOperationFailed:function(o,g,t){var e=sap.ushell.components.getCatalogsManager();var E;if(t){E=r.i18n.getText({messageId:"fail_tile_operation_add_to_group",parameters:[o.tileData.title,g.title]});}else{E=r.i18n.getText({messageId:"fail_tile_operation_remove_from_group",parameters:[o.tileData.title,g.title]});}e.notifyOnActionFailure(E.messageId,E.parameters);},prepareErrorMessage:function(e,t){var g,s,f,h,i;var n=0;var N=0;var j=false;for(var k in e){g=e[k].group;s=e[k].action;if(s==="add"){n++;if(n===1){f=g.title;}}else if(s==="remove"){N++;if(N===1){h=g.title;}}else if(s==="addTileToNewGroup"){n++;if(n===1){f=g.title;}}else{j=true;}}if(j){if(e.length===1){i=r.i18n.getText({messageId:"fail_tile_operation_create_new_group"});}else{i=r.i18n.getText({messageId:"fail_tile_operation_some_actions"});}}else if(e.length===1){if(n){i=r.i18n.getText({messageId:"fail_tile_operation_add_to_group",parameters:[t,f]});}else{i=r.i18n.getText({messageId:"fail_tile_operation_remove_from_group",parameters:[t,h]});}}else if(N===0){i=r.i18n.getText({messageId:"fail_tile_operation_add_to_several_groups",parameters:[t]});}else if(n===0){i=r.i18n.getText({messageId:"fail_tile_operation_remove_from_several_groups",parameters:[t]});}else{i=r.i18n.getText({messageId:"fail_tile_operation_some_actions"});}return i;},prepareDetailedMessage:function(t,n,e,f,g){var s;if(n===0){if(e===1){s=r.i18n.getText("tileRemovedFromSingleGroup",[t,g]);}else if(e>1){s=r.i18n.getText("tileRemovedFromSeveralGroups",[t,e]);}}else if(n===1){if(e===0){s=r.i18n.getText("tileAddedToSingleGroup",[t,f]);}else if(e===1){s=r.i18n.getText("tileAddedToSingleGroupAndRemovedFromSingleGroup",[t,f,g]);}else if(e>1){s=r.i18n.getText("tileAddedToSingleGroupAndRemovedFromSeveralGroups",[t,f,e]);}}else if(n>1){if(e===0){s=r.i18n.getText("tileAddedToSeveralGroups",[t,n]);}else if(e===1){s=r.i18n.getText("tileAddedToSeveralGroupsAndRemovedFromSingleGroup",[t,n,g]);}else if(e>1){s=r.i18n.getText("tileAddedToSeveralGroupsAndRemovedFromSeveralGroups",[t,n,e]);}}return s;},getCatalogTileDataFromModel:function(s){var B=s.getPath();var o=s.getModel();var t=o.getProperty(B);return{tileData:t,bindingContextPath:B,isBeingProcessed:t.isBeingProcessed};},_addTile:function(t,g){var o=sap.ushell.components.getCatalogsManager();var e=q.Deferred();var p=o.createTile({catalogTileContext:t,groupContext:g});p.done(function(f){e.resolve(f);});return e;},_removeTile:function(t,i){var o=sap.ushell.components.getCatalogsManager();var e=q.Deferred();var p=o.deleteCatalogTileFromGroup({tileId:t,groupIndex:i});p.done(function(f){e.resolve(f);});return e;},_createGroupAndSaveTile:function(t,n){var o=sap.ushell.components.getCatalogsManager();var e=q.Deferred();var p=o.createGroupAndSaveTile({catalogTileContext:t,newGroupName:n});p.done(function(f){e.resolve(f);});return e;},onExit:function(){V.destroy();sap.ui.getCore().getEventBus().unsubscribe("launchpad","appFinderWithDocking",this._handleAppFinderWithDocking,this);sap.ui.getCore().getEventBus().unsubscribe("launchpad","appFinderAfterNavigate",this._handleAppFinderAfterNavigate,this);}});});
sap.ui.predefine('sap/ushell/components/appfinder/Catalog.view',["sap/ui/core/library","sap/ushell/ui/appfinder/AppBox","sap/ushell/ui/appfinder/PinButton","sap/ushell/ui/launchpad/CatalogEntryContainer","sap/ushell/ui/launchpad/CatalogsContainer","sap/ushell/ui/launchpad/Tile","sap/ui/thirdparty/jquery","sap/ui/performance/Measurement","sap/ushell/resources","sap/ushell/ui/launchpad/AccessibilityCustomData","sap/m/List","sap/m/StandardListItem","sap/ui/Device","sap/m/MessagePage","sap/m/Page","sap/m/PageAccessibleLandmarkInfo","sap/m/BusyIndicator","sap/m/SplitApp","sap/ushell/Config","sap/ushell/components/appfinder/VisualizationOrganizerHelper","sap/ushell/renderers/fiori2/AccessKeysHandler"],function(c,A,P,C,a,T,q,M,r,b,L,S,D,d,f,g,B,h,i,V,j){"use strict";var k=c.AccessibleLandmarkRole;sap.ui.jsview("sap.ushell.components.appfinder.Catalog",{oController:null,oVisualizationOrganizerHelper:V.getInstance(),formatPinButtonTooltip:function(G,o){var t;if(o.path){var e=G?Array.prototype.indexOf.call(G,o.id):-1;t=e!==-1?"removeAssociatedTileFromContextGroup":"addAssociatedTileToContextGroup";return r.i18n.getText(t,o.title);}t=G&&G.length?"EasyAccessMenu_PinButton_Toggled_Tooltip":"EasyAccessMenu_PinButton_UnToggled_Tooltip";return r.i18n.getText(t);},formatPinButtonSelectState:function(e,l,G,s){if(G){var m=e?Array.prototype.indexOf.call(e,s):-1;return m!==-1;}return!!l;},createContent:function(o){var t=this;this.oViewData=this.getViewData();this.parentComponent=this.oViewData.parentComponent;var m=this.parentComponent.getModel();this.setModel(m);this.setModel(this.oViewData.subHeaderModel,"subHeaderModel");this.oVisualizationOrganizerHelper.setModel(m);this.oController=o;function l(e){return((e!==null)&&(e==="1x2"||e==="2x2"))||false;}var n=new P({icon:{path:"id",formatter:this.oVisualizationOrganizerHelper.formatPinButtonIcon},type:{path:"id",formatter:this.oVisualizationOrganizerHelper.formatPinButtonType},selected:{parts:["associatedGroups","associatedGroups/length","/groupContext/path","/groupContext/id"],formatter:this.oVisualizationOrganizerHelper.formatPinButtonSelectState.bind(this)},tooltip:{parts:["associatedGroups","/groupContext","id"],formatter:this.oVisualizationOrganizerHelper.formatPinButtonTooltip.bind(this)},press:[this.oVisualizationOrganizerHelper.onTilePinButtonClick,this]});var p=new P({icon:{path:"id",formatter:this.oVisualizationOrganizerHelper.formatPinButtonIcon},type:{path:"id",formatter:this.oVisualizationOrganizerHelper.formatPinButtonType},selected:{parts:["associatedGroups","associatedGroups/length","/groupContext/path","/groupContext/id"],formatter:this.oVisualizationOrganizerHelper.formatPinButtonSelectState.bind(this)},tooltip:{parts:["associatedGroups","/groupContext","id"],formatter:this.oVisualizationOrganizerHelper.formatPinButtonTooltip.bind(this)},press:[this.oVisualizationOrganizerHelper.onTilePinButtonClick,this]});this.oAppBoxesTemplate=new A({title:"{title}",icon:"{icon}",subtitle:"{subtitle}",url:"{url}",navigationMode:"{navigationMode}",pinButton:p,press:[o.onAppBoxPressed,o]});var E=i.last("/core/shell/enablePersonalization");p.setVisible(E);p.addCustomData(new b({key:"tabindex",value:"-1",writeToDom:true}));p.addStyleClass("sapUshellPinButton");n.setVisible(E);n.addCustomData(new b({key:"tabindex",value:"-1",writeToDom:true}));n.addStyleClass("sapUshellPinButton");this.oTileTemplate=new T({tileViews:{path:"content",factory:function(I,e){return e.getObject();}},long:{path:"size",formatter:l},tileCatalogId:"{id}",pinButton:n,press:[o.catalogTilePress,o],afterRendering:o.onTileAfterRendering});this.oCatalogSelect=new L("catalogSelect",{visible:"{/enableCatalogSelection}",rememberSelections:true,mode:"SingleSelectMaster",items:{path:"/masterCatalogs",template:new S({type:"Active",title:"{title}"})},showNoData:false,itemPress:[o._handleCatalogListItemPress,o],selectionChange:[o._handleCatalogListItemPress,o]});this.getCatalogSelect=function(){return this.oCatalogSelect;};var s=this.oCatalogSelect.onAfterRendering;if(D.system.desktop){this.oCatalogSelect.addEventDelegate({onsaptabnext:function(G){try{G.preventDefault();j.setIsFocusHandledByAnotherHandler(true);sap.ushell.components.ComponentKeysHandler.setFocusOnCatalogTile();}catch(e){}},onsapskipforward:function(G){try{G.preventDefault();j.setIsFocusHandledByAnotherHandler(true);sap.ushell.components.ComponentKeysHandler.setFocusOnCatalogTile();}catch(e){}},onsapskipback:function(G){try{G.preventDefault();j.setIsFocusHandledByAnotherHandler(true);var H=sap.ui.getCore().byId("openCloseButtonAppFinderSubheader");if(H.getVisible()){H.focus();}else{sap.ushell.components.ComponentKeysHandler.appFinderFocusMenuButtons(G);}}catch(e){}}});}if(m.getProperty("/enableHelp")){this.oCatalogSelect.addStyleClass("help-id-catalogCategorySelect");}this.setCategoryFilterSelection=function(e,G){var H=t.getCatalogSelect();var I=H.getItems();var J=e;var K=0;if(!J||J===""){J=r.i18n.getText("all");}I.forEach(function(N,O){if(N.getTitle()===J){K=O;H.setSelectedItem(N);}});if(I.length!==0&&G){I[K].focus();}};this.oCatalogSelect.onAfterRendering=function(){var e=t.oController.categoryFilter||r.i18n.getText("all");t.setCategoryFilterSelection(e);if(s){s.apply(this,arguments);}if(!this.getSelectedItem()){this.setSelectedItem(this.getItems()[0]);}setTimeout(function(){var G=q("#catalog-button, #userMenu-button, #sapMenu-button").filter("[tabindex=0]");if(G.length){G.eq(0).focus();}else{q("#catalog-button").focus();}},0);};var u=this.oCatalogSelect._onAfterRenderingPopover;this.oCatalogSelect._onAfterRenderingPopover=function(){if(this._oPopover){this._oPopover.setFollowOf(false);}if(u){u.apply(this,arguments);}};var v=sap.ui.getCore().getEventBus();var w;var U=function(){this.splitApp.toMaster("catalogSelect","show");if(!D.system.phone){w=this._calculateDetailPageId();if(w!==this.splitApp.getCurrentDetailPage().getId()){this.splitApp.toDetail(w);}}}.bind(this);v.subscribe("launchpad","catalogContentLoaded",function(){setTimeout(U,500);},this);v.subscribe("launchpad","afterCatalogSegment",U,this);var x=new C({header:"{title}",customTilesContainer:{path:"customTiles",template:this.oTileTemplate,templateShareable:true},appBoxesContainer:{path:"appBoxes",template:this.oAppBoxesTemplate,templateShareable:true}});this.oMessagePage=new d({visible:true,showHeader:false,text:r.i18n.getText("EasyAccessMenu_NoAppsToDisplayMessagePage_Text"),description:""});this.oCatalogsContainer=new a("catalogTiles",{categoryFilter:"{/categoryFilter}",catalogs:{path:"/catalogs",templateShareable:true,template:x},busy:true}).addStyleClass("sapUiTinyMarginTop");this.oCatalogsContainer.addStyleClass("sapUshellCatalogTileContainer");this.oCatalogsContainer.addEventDelegate({onsaptabprevious:function(e){var G=sap.ui.getCore().byId("openCloseButtonAppFinderSubheader");var H=q(e.srcControl.getDomRef());if(G.getVisible()&&!G.getPressed()&&!H.hasClass("sapUshellPinButton")){e.preventDefault();var I=sap.ui.getCore().byId("appFinderSearch");I.focus();}},onsapskipback:function(e){var G=sap.ui.getCore().byId("openCloseButtonAppFinderSubheader");if(G.getVisible()&&!G.getPressed()){e.preventDefault();G.focus();}}});this.oCatalogsContainer.onAfterRendering=function(){var e=sap.ui.getCore().byId("catalogTilesDetailedPage");if(!this.getBusy()){e.setBusy(false);M.end("FLP:AppFinderLoadingStartToEnd");}else{e.setBusy(true);}q("#catalogTilesDetailedPage-cont").scroll(function(){var G=sap.ui.getCore().byId("catalogTilesDetailedPage");var H=G.getScrollDelegate();var I=H.getScrollTop();var J=H.getMaxScrollTop();if(J-I<=30+3*t.oController.PagingManager.getTileHeight()&&t.oController.bIsInProcess===false){t.oController.bIsInProcess=true;t.oController.allocateNextPage();setTimeout(function(){t.oController.bIsInProcess=false;},0);}});};var y=new f("catalogTilesDetailedPage",{showHeader:false,showFooter:false,showNavButton:false,content:[this.oCatalogsContainer.addStyleClass("sapUshellCatalogPage")],landmarkInfo:new g({contentLabel:r.i18n.getText("appFinderCatalogTitle"),contentRole:k.Region})});var z=new f("catalogMessagePage",{showHeader:false,showFooter:false,showNavButton:false,content:[this.oMessagePage]});var F=new B("catalogSelectBusyIndicator",{size:"1rem"});this.splitApp=new h("catalogViewMasterDetail",{masterPages:[F,this.oCatalogSelect],detailPages:[y,z],mode:"{= ${/isPhoneWidth} ? 'HideMode' : 'ShowHideMode'}"});return this.splitApp;},_calculateDetailPageId:function(){var s=this.getModel("subHeaderModel");var e=s.getProperty("/search/searchMode");var t=s.getProperty("/tag/tagMode");var n=!!this.getModel().getProperty("/catalogsNoDataText");var I;if(e||t){I=this.getController().bSearchResults?"catalogTilesDetailedPage":"catalogMessagePage";}else if(n){I="catalogMessagePage";}else{I="catalogTilesDetailedPage";}return I;},getControllerName:function(){return"sap.ushell.components.appfinder.Catalog";}});});
sap.ui.predefine('sap/ushell/components/appfinder/Component',["sap/ui/core/UIComponent","sap/ui/core/mvc/JSView","sap/ui/thirdparty/hasher","sap/ushell/components/CatalogsManager","sap/ushell/resources","sap/ushell/Config","sap/ushell/bootstrap/common/common.load.model","sap/ushell/components/SharedComponentUtils","sap/base/util/UriParameters"],function(U,J,h,C,r,a,m,s,b){"use strict";return U.extend("sap.ushell.components.appfinder.Component",{metadata:{manifest:"json",library:"sap.ushell"},parseOldCatalogParams:function(u){var p=new b(u).mParams;var v,k;for(k in p){if(p.hasOwnProperty(k)){v=p[k][0];p[k]=v.indexOf("/")!==-1?encodeURIComponent(v):v;}}return p;},handleNavigationFilter:function(n){var S=sap.ushell.Container.getService("URLParsing").parseShellHash(n);var p;if(S&&S.semanticObject==="shell"&&S.action==="catalog"){p=this.parseOldCatalogParams(n);setTimeout(function(){this.getRouter().navTo("catalog",{filters:JSON.stringify(p)});}.bind(this),0);return this.oShellNavigation.NavigationFilterStatus.Abandon;}return this.oShellNavigation.NavigationFilterStatus.Continue;},createContent:function(){this.oModel=m.getModel();this.setModel(this.oModel);var H,S,p,c;var P=a.last("/core/shell/enablePersonalization");if(P){s.getEffectiveHomepageSetting("/core/home/homePageGroupDisplay","/core/home/enableHomePageSettings");}this.oCatalogsManager=new C("dashboardMgr",{model:this.oModel});this.setModel(r.i18nModel,"i18n");s.toggleUserActivityLog();this.oShellNavigation=sap.ushell.Container.getService("ShellNavigation");H=h.getHash();S=sap.ushell.Container.getService("URLParsing").parseShellHash(H);if(S&&S.semanticObject==="shell"&&S.action==="catalog"){p=this.parseOldCatalogParams(H);c=this.getMetadata().getConfig();this.oShellNavigation.toExternal({target:{semanticObject:c.semanticObject,action:c.action}});this.getRouter().navTo("catalog",{filters:JSON.stringify(p)});}return sap.ui.view({id:"appFinderView",viewName:"sap.ushell.components.appfinder.AppFinder",type:"JS",async:true});},destroy:function(){U.prototype.destroy.apply(this);this.oCatalogsManager.destroy();}});});
sap.ui.predefine('sap/ushell/components/appfinder/EasyAccess.controller',["sap/base/Log","sap/ui/model/odata/ODataUtils","sap/ui/thirdparty/datajs","sap/ui/thirdparty/jquery","sap/ushell/resources","sap/ui/model/json/JSONModel","sap/ui/core/library","sap/ushell/ui/launchpad/AccessibilityCustomData"],function(L,O,a,q,r,J,c,A){"use strict";var V=c.mvc.ViewType;sap.ui.controller("sap.ushell.components.appfinder.EasyAccess",{DEFAULT_URL:"/sap/opu/odata/UI2",DEFAULT_NUMBER_OF_LEVELS:3,SEARCH_RESULTS_PER_REQUEST:100,onInit:function(){var t=this;this.translationBundle=r.i18n;this.oView=this.getView();var e=this.oView.getModel("easyAccessSystemsModel");var s=e.bindProperty("/systemSelected");s.attachChange(t.adjustUiOnSystemChange.bind(this));this.menuName=this.oView.getViewData().menuName;this.systemId=null;this.easyAccessCache={};this.easyAccessModel=new J();this.oView.hierarchyFolders.setModel(this.easyAccessModel,"easyAccess");this.oView.hierarchyApps.setModel(this.easyAccessModel,"easyAccess");var m=this.getView().getModel();if(!m.getProperty("/catalogs")){if(!m.getProperty("/groups")||m.getProperty("/groups").length===0){if(typeof sap.ushell.components.getHomepageManager==="function"){this.oHomepageManager=sap.ushell.components.getHomepageManager();this.oHomepageManager.loadPersonalizedGroups();}else{L.error("The homepage manager was not initialised. Tiles in user and sap menu cannot be added to groups.");}}}var S=this.oView.getModel("subHeaderModel");var T=S.bindProperty("/openCloseSplitAppButtonToggled");T.attachChange(t.handleToggleButtonModelChanged.bind(this));if(this.oView.getViewData().enableSearch){var o=S.bindProperty("/search");o.attachChange(t.handleSearchModelChanged.bind(this));}this.checkIfSystemSelectedAndLoadData();},onAfterRendering:function(){setTimeout(function(){this.oView.hierarchyApps.getController()._updateAppBoxedWithPinStatuses();}.bind(this),0);},checkIfSystemSelectedAndLoadData:function(){var s=this.oView.getModel("easyAccessSystemsModel").getProperty("/systemSelected");if(s){this.systemId=s.systemId;this.loadMenuItemsFirstTime(this.oView.getViewData().menuName,s);}},navigateHierarchy:function(p,f){this.oView.hierarchyFolders.setBusy(false);var e=this.easyAccessModel.getProperty(p||"/");if(typeof e.folders!=="undefined"){this.oView.hierarchyFolders.updatePageBindings(p,f);this.oView.hierarchyApps.getController().updatePageBindings(p);return;}this.oView.hierarchyFolders.setBusy(true);this.getMenuItems(this.menuName,this.systemId,e.id,e.level).then(function(p,b){this.easyAccessModel.setProperty(p+"/folders",b.folders);this.easyAccessModel.setProperty(p+"/apps",b.apps);this.oView.hierarchyFolders.updatePageBindings(p,f);this.oView.hierarchyApps.getController().updatePageBindings(p);this.oView.hierarchyFolders.setBusy(false);}.bind(this,p),function(b){this.handleGetMenuItemsError(b);}.bind(this));},handleSearch:function(s){var i=!this.hierarchyAppsSearchResults;if(i){this.hierarchyAppsSearchResults=new sap.ui.view(this.getView().getId()+"hierarchyAppsSearchResults",{type:V.JS,viewName:"sap.ushell.components.appfinder.HierarchyApps",height:"100%",viewData:{easyAccessSystemsModel:this.oView.getModel("easyAccessSystemsModel"),getMoreSearchResults:this.getMoreSearchResults.bind(this)}});this.easyAccessSearchResultsModel=new J();this.easyAccessSearchResultsModel.setSizeLimit(10000);this.hierarchyAppsSearchResults.setModel(this.easyAccessSearchResultsModel,"easyAccess");this.hierarchyAppsSearchResults.setBusyIndicatorDelay(this.getView().BUSY_INDICATOR_DELAY);this.hierarchyAppsSearchResults.addStyleClass(" sapUshellAppsView sapMShellGlobalInnerBackground");this.hierarchyAppsSearchResults.addCustomData(new A({key:"role",value:"region",writeToDom:true}));this.hierarchyAppsSearchResults.addCustomData(new A({key:"aria-label",value:this.oView.oResourceBundle.getText("easyAccessTileContainer"),writeToDom:true}));}this.searchResultFrom=0;this.oView.splitApp.getCurrentDetailPage().setBusy(true);this.easyAccessSearchResultsModel.setProperty("/apps",[]);this.easyAccessSearchResultsModel.setProperty("/total",0);this._getSearchResults(s,this.searchResultFrom).then(function(b){b.results.forEach(function(e){var d=sap.ushell.Container.getService("Bookmark");d.countBookmarks(e.url).then(function(f){e.bookmarkCount=f;});});this.easyAccessSearchResultsModel.setProperty("/apps",b.results);this.easyAccessSearchResultsModel.setProperty("/total",b.count);this.searchResultFrom=b.results.length;if(i){this.oView.splitApp.addDetailPage(this.hierarchyAppsSearchResults);}this.hierarchyAppsSearchResults.updateResultSetMessage(parseInt(b.count,10),true);this.oView.splitApp.getCurrentDetailPage().setBusy(false);if(this.oView.splitApp.getCurrentDetailPage()!==this.hierarchyAppsSearchResults){this.oView.splitApp.toDetail(this.getView().getId()+"hierarchyAppsSearchResults");}}.bind(this),function(e){this.handleGetMenuItemsError(e);this.oView.splitApp.getCurrentDetailPage().setBusy(false);}.bind(this));},getMoreSearchResults:function(){if(this.oView.splitApp.getCurrentDetailPage().setShowMoreResultsBusy){this.oView.splitApp.getCurrentDetailPage().setShowMoreResultsBusy(true);}var s=this.oView.getModel("subHeaderModel");var S=s.getProperty("/search/searchTerm");this._getSearchResults(S,this.searchResultFrom).then(function(b){var C=this.easyAccessSearchResultsModel.getProperty("/apps");var n=C.slice();Array.prototype.push.apply(n,b.results);this.easyAccessSearchResultsModel.setProperty("/apps",n);if(this.oView.splitApp.getCurrentDetailPage().setShowMoreResultsBusy){this.oView.splitApp.getCurrentDetailPage().setShowMoreResultsBusy(false);}this.searchResultFrom=n.length;}.bind(this),function(e){this.handleGetMenuItemsError(e);if(this.oView.splitApp.getCurrentDetailPage().setShowMoreResultsBusy){this.oView.splitApp.getCurrentDetailPage().setShowMoreResultsBusy(true);}}.bind(this));},_getSearchResults:function(s,f){var d=new q.Deferred();var S=this._getODataRequestForSearchUrl(this.menuName,this.systemId,s,f);var R={requestUri:S};var C=this._callODataService(R,this.handleSuccessOnReadFilterResults);C.done(function(b){d.resolve(b);});C.fail(function(e){d.reject(e);});return d.promise();},getSystemNameOrId:function(){var s=this.oView.getModel("easyAccessSystemsModel").getProperty("/systemSelected");if(s){return s.name||s.id;}},adjustUiOnSystemChange:function(){var C=this.easyAccessModel.getData();if(this.systemId&&C&&C.id){this.easyAccessCache[this.systemId]=C;}var s=this.oView.getModel("easyAccessSystemsModel").getProperty("/systemSelected");if(s){this.systemId=s.systemId;var n=this.easyAccessCache[this.systemId];if(n){this.easyAccessModel.setData(n);this.navigateHierarchy("",false);}else{this.oView.hierarchyFolders.setBusy(true);this.oView.hierarchyApps.setBusy(true);this.loadMenuItemsFirstTime(this.menuName,s);}}},handleToggleButtonModelChanged:function(){var s=this.oView.getModel("subHeaderModel");var b=s.getProperty("/openCloseSplitAppButtonVisible");var B=s.getProperty("/openCloseSplitAppButtonToggled");var S=this.getView().splitApp;if(b){if(B&&!S.isMasterShown()){S.showMaster();}else if(S.isMasterShown()){S.hideMaster();}}},handleSearchModelChanged:function(){var s=this.oView.getModel("subHeaderModel");var b=s.getProperty("/activeMenu");if(this.getView().getId().indexOf(b)===-1){return;}var S=s.getProperty("/search/searchTerm");var d=s.getProperty("/search/searchMode");if(d){sap.ui.getCore().byId("appFinderSearch").getCustomData()[0].setValue(this.getView().getId()+"hierarchyAppsSearchResults");if(S){this.handleSearch(S);}}else{sap.ui.getCore().byId("appFinderSearch").getCustomData()[0].setValue("");this.oView.splitApp.toDetail(this.getView().getId()+"hierarchyApps");}},loadMenuItemsFirstTime:function(m,s){return this.getMenuItems(m,s.systemId,"",0).then(function(b){b.text=s.systemName||s.systemId;this.easyAccessModel.setData(b);this.oView.hierarchyFolders.setBusy(false);this.oView.hierarchyApps.setBusy(false);this.navigateHierarchy("",false);}.bind(this),function(e){this.handleGetMenuItemsError(e);this.oView.hierarchyFolders.updatePageBindings("/",false);this.oView.hierarchyApps.getController().updatePageBindings("/");}.bind(this));},handleGetMenuItemsError:function(e){var E=this.getErrorMessage(e);sap.ui.require(["sap/m/MessageBox"],function(M){M.error(E);});this.easyAccessModel.setData("");this.oView.hierarchyFolders.setBusy(false);this.oView.hierarchyApps.setBusy(false);},getErrorMessage:function(e){var m="";if(this.menuName==="SAP_MENU"){m=this.translationBundle.getText("easyAccessSapMenuNameParameter");}else if(this.menuName==="USER_MENU"){m=this.translationBundle.getText("easyAccessUserMenuNameParameter");}if(e){if(e.message){return this.translationBundle.getText("easyAccessErrorGetDataErrorMsg",[m,e.message]);}return this.translationBundle.getText("easyAccessErrorGetDataErrorMsg",[m,e]);}return this.translationBundle.getText("easyAccessErrorGetDataErrorMsgNoReason",m);},getMenuItems:function(m,s,e,b,n){var d=new q.Deferred();if(m!=="SAP_MENU"&&m!=="USER_MENU"){d.reject("Invalid menuType parameter");return d.promise();}if(typeof s!=="string"||s===""){d.reject("Invalid systemId parameter");return d.promise();}if(typeof e!=="string"){d.reject("Invalid entityId parameter");return d.promise();}if(typeof b!=="number"){d.reject("Invalid entityLevel parameter");return d.promise();}if(n&&typeof n!=="number"){d.reject("Invalid numberOfNextLevels parameter");return d.promise();}if(e===""){b=0;}var N;var M=this.getView().getModel();var C=M.getProperty("/easyAccessNumbersOfLevels");if(C){N=C;}else if(n){N=n;}else{N=this.DEFAULT_NUMBER_OF_LEVELS;}var l=b+N+1;var S=this._getODataRequestUrl(m,s,e,l);var R={requestUri:S};var o=this._callODataService(R,this.handleSuccessOnReadMenuItems,{systemId:s,entityId:e,iLevelFilter:l});o.done(function(f){d.resolve(f);});o.fail(function(f){d.reject(f);});return d.promise();},_callODataService:function(R,s,S){var l,i;var t=this;var d=new q.Deferred();if(!S){S={};}if(sap.ushell.Container){l=sap.ushell.Container&&sap.ushell.Container.getUser().getLanguage();if((l)&&(R.requestUri.indexOf("sap-language=")===-1)){R.requestUri=R.requestUri+(R.requestUri.indexOf("?")>=0?"&":"?")+"sap-language="+l;}i=sap.ushell.Container.getLogonSystem()?sap.ushell.Container.getLogonSystem().getClient():"";}sap.ui.require(["sap/ui/thirdparty/datajs"],function(){a.read({requestUri:R.requestUri,headers:{"Cache-Control":"no-cache, no-store, must-revalidate","Pragma":"no-cache","Expires":"0","Accept-Language":(sap.ui&&sap.ui.getCore().getConfiguration().getLanguage())||"","sap-client":(i||""),"sap-language":(l||"")}},function(o,b){if(o&&o.results&&b&&b.statusCode===200){var e=s.bind(t,o,S)();d.resolve(e);}},function(m){d.reject(m);});});return d.promise();},handleSuccessOnReadMenuItems:function(R,p){var o=this._oDataResultFormatter(R.results,p.systemId,p.entityId,p.iLevelFilter);return o;},handleSuccessOnReadFilterResults:function(R){var u;R.results.forEach(function(o,i){u=this._appendSystemToUrl(o,this.systemId);o.url=u;}.bind(this));return{results:R.results,count:R.__count};},_appendSystemToUrl:function(d,s){if(d.url){return d.url+(d.url.indexOf("?")>0?"&":"?")+"sap-system="+s;}},_oDataResultFormatter:function(R,s,e,l){var f={};var o={};if(e===""){o={id:"root",text:"root",level:0,folders:[],apps:[]};f.root=o;}else{o={id:e,folders:[],apps:[]};f[e]=o;}var b;for(var i=0;i<R.length;i++){b=R[i];var p;if(b.level==="01"){p=f.root;}else{p=f[b.parentId];}var m={id:b.Id,text:b.text,subtitle:b.subtitle,icon:b.icon,level:parseInt(b.level,10)};if(b.type==="FL"){m.folders=[];m.apps=[];if(b.level==l-1){m.folders=undefined;m.apps=undefined;}if(p&&p.folders){p.folders.push(m);}f[b.Id]=m;}else{m.url=this._appendSystemToUrl(b,s);if(p&&p.apps){p.apps.push(m);}}}return o;},_getODataRequestUrl:function(m,s,e,l){var S=this._getServiceUrl(m);var b;if(l<10){b="0"+l;}else{b=l.toString();}var d="";if(e){if(decodeURIComponent(e)===e){e=encodeURIComponent(e);}d="('"+e+"')/AllChildren";}S=S+";o="+s+"/MenuItems"+d+"?$filter=level lt '"+b+"'&$orderby=level,text";return S;},_getODataRequestForSearchUrl:function(m,s,t,f){var S=this._getServiceUrl(m);var n=this.SEARCH_RESULTS_PER_REQUEST;t=this._removeWildCards(t);f=!f?0:f;t=O.formatValue(t,"Edm.String");S=S+";o="+s+"/MenuItems?$filter=type ne 'FL' and substringof("+t+", text) or substringof("+t+", subtitle) or substringof("+t+", url)&$orderby=text,subtitle,url&$inlinecount=allpages&$skip="+f+"&$top="+n;return S;},_getServiceUrl:function(m){var s;var M=this.getView().getModel();if(m==="SAP_MENU"){var S=M.getProperty("/sapMenuServiceUrl");if(S){s=S;}else{s=this.DEFAULT_URL+"/EASY_ACCESS_MENU";}}else if(m==="USER_MENU"){var u=M.getProperty("/userMenuServiceUrl");if(u){s=u;}else{s=this.DEFAULT_URL+"/USER_MENU";}}return s;},_removeWildCards:function(t){return t.replace(/\*/g,"");}});});
sap.ui.predefine('sap/ushell/components/appfinder/EasyAccess.view',["sap/ui/core/library","sap/m/SplitApp","sap/ushell/resources"],function(c,S,r){"use strict";var V=c.mvc.ViewType;sap.ui.jsview("sap.ushell.components.appfinder.EasyAccess",{BUSY_INDICATOR_DELAY:1000,createContent:function(C){this.oResourceBundle=r.i18n;this.setModel(this.getViewData().easyAccessSystemsModel,"easyAccessSystemsModel");this.setModel(this.getViewData().subHeaderModel,"subHeaderModel");this.setModel(this.getViewData().parentComponent.getModel());this.hierarchyFolders=sap.ui.view({type:V.JS,viewName:"sap.ushell.components.appfinder.HierarchyFolders",height:"100%",viewData:{navigateHierarchy:this.oController.navigateHierarchy.bind(C),easyAccessSystemsModel:this.getModel("easyAccessSystemsModel"),subHeaderModel:this.getModel("subHeaderModel")}});this.hierarchyFolders.setBusyIndicatorDelay(this.BUSY_INDICATOR_DELAY);this.hierarchyFolders.addStyleClass("sapUshellHierarchyFolders");var v=this.getViewData();this.hierarchyApps=new sap.ui.view(this.getId()+"hierarchyApps",{type:V.JS,viewName:"sap.ushell.components.appfinder.HierarchyApps",height:"100%",viewData:{navigateHierarchy:this.oController.navigateHierarchy.bind(C),menuName:v.menuName}});this.hierarchyApps.setBusyIndicatorDelay(this.BUSY_INDICATOR_DELAY);this.splitApp=new S({masterPages:this.hierarchyFolders,detailPages:this.hierarchyApps});this.splitApp.setInitialMaster(this.hierarchyFolders);this.splitApp.setInitialDetail(this.hierarchyApps);return this.splitApp;},getControllerName:function(){return"sap.ushell.components.appfinder.EasyAccess";}});});
sap.ui.predefine('sap/ushell/components/appfinder/GroupListPopover.controller',["sap/ui/thirdparty/jquery","sap/m/MessageToast","sap/ushell/resources","sap/ui/Device","sap/ui/model/Context","sap/ui/model/json/JSONModel"],function(q,M,r,D,C,J){"use strict";sap.ui.controller("sap.ushell.components.appfinder.GroupListPopover",{onInit:function(){var v=this.getView();this.oPopoverModel=new J({userGroupList:v.getViewData().groupData});this.oPopoverModel.setSizeLimit(9999);v.oPopover.setModel(this.oPopoverModel);},onExit:function(){var v=this.getView();if(v._oListContainer){v._oListContainer.destroy();}if(v._oNewGroupItem){v._oNewGroupItem.destroy();}if(v._oNewGroupNameInput){v._oNewGroupNameInput.destroy();}if(v._oNewGroupHeader){v._oNewGroupHeader.destroy();}},onGroupListSelectionChange:function(e){var l=e.getSource();if(l.getMode()==="SingleSelectMaster"){var L=e.getParameter("listItem");if(L.data("newGroupItem")){this._navigateToCreateNewGroupPane();}else{this.okButtonHandler(e);}}else{this.checkboxClickHandler(e);}},okButtonHandler:function(e){e.preventDefault();e._bIsStopHandlers=true;var v=this.getView();var u=this.oPopoverModel.getProperty("/userGroupList");var c={addToGroups:[],removeFromGroups:[],newGroups:[],allGroups:u};u.forEach(function(g){if(g.selected===g.initiallySelected){return;}if(g.selected){c.addToGroups.push(g.oGroup);}else{c.removeFromGroups.push(g.oGroup);}});if(v.newGroupInput&&v.newGroupInput.getValue().length){c.newGroups.push(v.newGroupInput.getValue());}v.oPopover.close();v.deferred.resolve(c);},_closeButtonHandler:function(e){e._bIsStopHandlers=true;var v=this.getView();v.oPopover.close();v.deferred.reject();},_createGroupAndSaveTile:function(t,n){var c=sap.ushell.components.getCatalogsManager();var d=q.Deferred();var p=c.createGroupAndSaveTile({catalogTileContext:t,newGroupName:n});p.done(function(a){d.resolve(a);});return d;},groupListItemClickHandler:function(e){var l=e.getParameter("listItem");if(l.data("newGroupItem")){this._navigateToCreateNewGroupPane();return;}l.setSelected(!l.getSelected());var i=l.getBindingContextPath();var p=l.getModel();var s=!!l.getSelected();this.addRemoveTileFromGroup(i,p,s);},getGroupsBeforeChanges:function(p){var m=this.getView().getViewData().sourceContext.oModel;return m.getProperty(p+"/associatedGroups");},getGroupsAfterChanges:function(){var g=sap.ui.getCore().byId("groupsPopover");return g.getModel().getProperty("/userGroupList");},checkboxClickHandler:function(e){var v=this.getView();var p=v.getViewData().sourceContext.sPath;var g=this.getGroupsBeforeChanges(p);var G=this.getGroupsAfterChanges();var l=sap.ushell.Container.getService("LaunchPage");var P=e.getSource().getModel();var s=e.getParameter("selected");var a=0;var i=0;var d=false;var b;while(l.isGroupLocked(G[i].oGroup.object)===true){i++;}for(i;i<G.length;i++){var c=false;if(d===true){break;}for(a=0;a<g.length;a++){if(l.getGroupId(G[i].oGroup.object)===g[a]){c=true;if(G[i].selected===false){d=true;b=("/userGroupList/"+i);this.addRemoveTileFromGroup(b,P,s);break;}}}if(G[i].selected===true&&c===false){b=("/userGroupList/"+i);this.addRemoveTileFromGroup(b,P,s);break;}}},addRemoveTileFromGroup:function(i,p,t){var v=this.getView();var c=this.getView().getViewData().catalogController;var a=this.getView().getViewData().catalogModel;var T=this.getView().getViewData().sourceContext;var g=a.getProperty("/groups");var b=g.indexOf(p.getProperty(i).oGroup);var G=new C(a,"/groups/"+b);var l=sap.ushell.Container.getService("LaunchPage");var s=l.getGroupId(a.getProperty("/groups/"+b).object);if(t){var A=c._addTile(T,G);A.done(function(e){var f=v.getViewData().sourceContext;var h=a.getProperty(f+"/associatedGroups");h.push(s);a.setProperty(f+"/associatedGroups",h);});}else{var d=T.getModel().getProperty(T.getPath()).id;var R=c._removeTile(d,b);R.done(function(e){var f=v.getViewData().sourceContext;var h=a.getProperty(f+"/associatedGroups");var j=h?Array.prototype.indexOf.call(h,s):-1;if(j>=0){h.splice(j,1);}a.setProperty(f+"/associatedGroups",h);});}},_switchGroupsPopoverButtonPress:function(){var g="groupsPopover-popover";if(D.system.phone){g="groupsPopover-dialog";}var v=this.getView();if(sap.ui.getCore().byId(g).getContent()[0]===v._getNewGroupInput()){var u=this.oPopoverModel.getProperty("/userGroupList");var c={addToGroups:[],removeFromGroups:[],newGroups:[],allGroups:u};var n=v._getNewGroupInput();var N=n.getValue();if(N.length>0){c.newGroups.push(N);}v.oPopover.close();v.deferred.resolve(c);}else{this._closeButtonHandler(this);}},_navigateToCreateNewGroupPane:function(){var v=this.getView();var n=v._getNewGroupHeader();var N=v._getNewGroupInput();v.oPopover.removeAllContent();v.oPopover.addContent(N);v.oPopover.setCustomHeader(n);v.oPopover.setContentHeight("");setTimeout(function(){v.oPopover.getBeginButton().setText(r.i18n.getText("okDialogBtn"));},0);if(v.oPopover.getEndButton()){v.oPopover.getEndButton().setVisible(true);}if(sap.ui.getCore().byId("groupsPopover-popover")&&(sap.ui.getCore().byId("groupsPopover-popover").getContent()[0]===v._getNewGroupInput())&&!v.oPopover.getEndButton()){v.oPopover.setEndButton(v._getCancelButton());}setTimeout(function(){v.oPopover.getEndButton().setText(r.i18n.getText("cancelBtn"));},0);if(v.getViewData().singleGroupSelection){this._setFooterVisibility(true);}setTimeout(function(){N.focus();},0);},setSelectedStart:function(s){this.start=s;},_afterCloseHandler:function(){var v=this.getView();var c=this.getView().getViewData().catalogModel;if(c){var g=c.getProperty(this.getView().getViewData().sourceContext+"/associatedGroups");this.showToastMessage(g,this.start);}v.destroy();},showToastMessage:function(e,s){var a=0;var b=0;var f,c;var d={};e.forEach(function(g){d[g]=g;});s.forEach(function(g){if(d[g.id]){if(g.selected===false){a++;f=g.title;}}else if(g.selected===true){b++;c=g.title;}});var m=this.getView().getViewData().catalogController.prepareDetailedMessage(this.getView().getViewData().title,a,b,f,c);if(m){M.show(m,{duration:6000,width:"15em",my:"center bottom",at:"center bottom",of:window,offset:"0 -50",collision:"fit fit"});}},_backButtonHandler:function(){var v=this.getView();v.oPopover.removeAllContent();if(v.getViewData().singleGroupSelection){this._setFooterVisibility(false);}if(!D.system.phone){v.oPopover.setContentHeight("192px");}else{v.oPopover.setContentHeight("100%");}v.oPopover.setVerticalScrolling(true);v.oPopover.setHorizontalScrolling(false);v.oPopover.addContent(v._getListContainer());v.oPopover.setTitle(r.i18n.getText("addTileToGroups_popoverTitle"));v.oPopover.setCustomHeader();v._getNewGroupInput().setValue("");if(v.oPopover.getContent()[0]!==v._getNewGroupInput()){v.oPopover.getEndButton().setVisible(false);}setTimeout(function(){v.oPopover.getBeginButton().setText(r.i18n.getText("close"));},0);},_setFooterVisibility:function(v){var f=sap.ui.getCore().byId("groupsPopover-footer");if(f){f.setVisible(v);}}});});
sap.ui.predefine('sap/ushell/components/appfinder/GroupListPopover.view',["sap/ushell/Config","sap/ui/thirdparty/jquery","sap/base/Log","sap/m/ResponsivePopover","sap/ushell/resources","sap/m/ScrollContainer","sap/ui/Device","sap/m/StandardListItem","sap/m/List","sap/m/Input","sap/ui/core/library","sap/m/Button","sap/ui/core/IconPool","sap/m/Bar","sap/m/Label","sap/m/DisplayListItem","sap/m/library","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(C,q,L,R,r,S,D,a,b,I,c,B,d,e,f,g,m,F,h){"use strict";var i=m.ListMode;var j=m.ListType;sap.ui.jsview("sap.ushell.components.appfinder.GroupListPopover",{getControllerName:function(){return"sap.ushell.components.appfinder.GroupListPopover";},createContent:function(k){this.oLaunchPageService=sap.ushell.Container.getService("LaunchPage");this.oPopover=new R({id:"groupsPopover",placement:"Auto",title:r.i18n.getText("addTileToGroups_popoverTitle"),contentWidth:"20rem",beginButton:this._getCloseButton(),content:this._getListContainer(),afterClose:[k._afterCloseHandler,k]}).addStyleClass("sapContrastPlus");this.addDependent(this.oPopover);this.oPopover.setInitialFocus(this._getNewGroupListItem());},open:function(o){if(document.body.clientHeight-o.getDomRef().getBoundingClientRect().bottom>=310){this.oPopover.setPlacement("Bottom");}this.oPopover.openBy(o);if(this.getViewData().singleGroupSelection){this.getController()._setFooterVisibility(false);}this.deferred=q.Deferred();return this.deferred.promise();},_getListContainer:function(){if(!this._oListContainer){var G=this._getGroupList();this._oListContainer=new S({id:"popoverContainer",horizontal:false,vertical:true,content:[G],height:D.system.phone?"100%":"190px"});}return this._oListContainer;},_getNewGroupInput:function(){if(!this._oNewGroupNameInput){this._oNewGroupNameInput=new I("newGroupNameInput",{type:"Text",placeholder:r.i18n.getText("new_group_name")});}return this._oNewGroupNameInput;},_getNewGroupHeader:function(){if(!this._oNewGroupHeader){var o=this.getController();var k=new B({icon:d.getIconURI("nav-back"),press:[o._backButtonHandler,o],tooltip:r.i18n.getText("newGroupGoBackBtn_tooltip")});k.addStyleClass("sapUshellCatalogNewGroupBackButton");this._oNewGroupHeader=new e("oHeadBar",{contentLeft:[k],contentMiddle:[new f({text:r.i18n.getText("newGroup_popoverTitle")})]});}return this._oNewGroupHeader;},_getGroupList:function(){if(!this._oGroupList){var o=this.getController();var l=new g({label:"{oGroup/title}",selected:"{selected}",tooltip:"{oGroup/title}",type:j.Active});var u=[new F("oGroup/isGroupLocked",h.EQ,false)];var v=this.getViewData();if(v.enableHideGroups){u.push(new F("oGroup/isGroupVisible",h.EQ,true));}this._oGroupList=new b({mode:v.singleGroupSelection?i.SingleSelectMaster:i.MultiSelect,items:{path:"/userGroupList",template:l,filters:u,templateShareable:false},itemPress:[o.groupListItemClickHandler,o],selectionChange:[o.onGroupListSelectionChange,o]});var n=this._getNewGroupListItem();this._oGroupList.addEventDelegate({onBeforeRendering:function(){this._oGroupList.insertAggregation("items",n,0,true);}.bind(this),onAfterRendering:function(){this._oGroupList.removeAggregation("items",n,true);}.bind(this)});}return this._oGroupList;},_getNewGroupListItem:function(){if(!this._oNewGroupItem){this._oNewGroupItem=new a("newGroupItem",{title:r.i18n.getText("newGroup_listItemText"),type:j.Navigation});this._oNewGroupItem.data("newGroupItem",true);this._oNewGroupItem.getList=function(){return this._oGroupList;}.bind(this);this._oNewGroupItem.getModeControl=function(){return null;};this._oNewGroupItem.onsapspace=function(k){k.preventDefault();k.isMarked();};this._oNewGroupItem.addEventDelegate({onsaptabnext:function(E){E.preventDefault();E._bIsStopHandlers=true;this._getCloseButton().focus();}});}return this._oNewGroupItem;},_getCancelButton:function(){if(!this._oCancelButton){this._oCancelButton=new B("cancelButton",{press:this.getController()._closeButtonHandler.bind(this.getController()),text:r.i18n.getText("cancelBtn")});}return this._oCancelButton;},_getCloseButton:function(){if(!this._oCloseButton){var o=this.getController();this._oCloseButton=new B("closeButton",{press:[o._switchGroupsPopoverButtonPress,o],text:r.i18n.getText("closeBtn")});}return this._oCloseButton;}});});
sap.ui.predefine('sap/ushell/components/appfinder/HierarchyApps.controller',["sap/ui/thirdparty/jquery","sap/ui/core/library","sap/m/MessageToast","sap/ushell/resources"],function(q,c,M,r){"use strict";var V=c.mvc.ViewType;sap.ui.controller("sap.ushell.components.appfinder.HierarchyApps",{onInit:function(){var e=this.getView().getViewData().easyAccessSystemsModel;if(e){this.getView().setModel(e,"easyAccessSystems");}},getCrumbsData:function(p,m){var a=p.split("/");a.splice(a.length-2,2);var n=[];while(a.length){var P=a.join("/");var t=m.getProperty(P+"/text");n.unshift({text:t,path:P});a.splice(a.length-2,2);}return n;},_updateAppBoxedWithPinStatuses:function(p){var v=this.getView();if(!p){p=v.layout.getBinding("items").getPath();}var e=v.getModel("easyAccess");var a=e.getProperty(p)?e.getProperty(p):[];this.getView().oVisualizationOrganizerHelper.updateBookmarkCount.call(this,a).then(function(u){e.setProperty(p,u);});},updateBookmarkCount:function(a){return sap.ushell.Container.getServiceAsync("Bookmark").then(function(B){var b=a.map(function(d){return B.countBookmarks(d.url).then(function(e){d.bookmarkCount=e;return d;});});return new Promise(function(R){q.when.apply(q,b).then(function(){var u=Array.prototype.slice.call(arguments);R(u);});});});},updatePageBindings:function(p){this.getView().layout.bindAggregation("items","easyAccess>"+p+"/apps",this.getView().oItemTemplate);this._updateAppBoxedWithPinStatuses(p+"/apps");this.getView().breadcrumbs.bindProperty("currentLocationText","easyAccess>"+p+"/text");var a=this.getCrumbsData(p,this.getView().getModel("easyAccess"));this.getView().crumbsModel.setProperty("/crumbs",a);var n=this.getView().getModel("easyAccess").getProperty(p+"/apps");this.getView().updateResultSetMessage(n.length,false);},onAppBoxPressed:function(e){if(e.mParameters.srcControl.$().closest(".sapUshellPinButton").length){return;}var u=e.getSource().getProperty("url");if(u&&u.indexOf("#")===0){hasher.setHash(u);}},_handleSuccessMessage:function(a,p){var m;var n=p.addToGroups?p.addToGroups.length:0;var b=p.newGroups?p.newGroups.length:0;var t=n+b;if(t===1){var g;if(n===1){g=p.addToGroups[0].title;}else{g=p.newGroups[0];}m=r.i18n.getText("appAddedToSingleGroup",[a.text,g]);}else{m=r.i18n.getText("appAddedToSeveralGroups",[a.text,t]);}if(t>0){M.show(m,{duration:3000,width:"15em",my:"center bottom",at:"center bottom",of:window,offset:"0 -50",collision:"fit fit"});}return m;},_prepareErrorMessage:function(e,a){var g,A,f,n=0,C=false,m;for(var i in e){g=e[i].group;A=e[i].action;if(A==="addBookmark_ToExistingGroup"){n++;if(n===1){f=g.title;}}else if(A==="addBookmark_ToNewGroup"){n++;if(n===1){f=g;}}else{C=true;}}if(C){if(e.length===1){m=r.i18n.getText({messageId:"fail_tile_operation_create_new_group"});}else{m=r.i18n.getText({messageId:"fail_tile_operation_some_actions"});}}else if(e.length===1){m=r.i18n.getText({messageId:"fail_app_operation_add_to_group",parameters:[a,f]});}else{m=r.i18n.getText({messageId:"fail_app_operation_add_to_several_groups",parameters:[a]});}return m;},_handleBookmarkAppPopoverResponse:function(a,p){var b=[];p.newGroups.forEach(function(g){b.push(this._createGroupAndAddBookmark(g,a));}.bind(this));p.addToGroups.forEach(function(g){b.push(this._addBookmark(g,a));}.bind(this));q.when.apply(q,b).then(function(){var d=Array.prototype.slice.call(arguments);this._handlePopoverGroupsActionPromises(a,p,d);}.bind(this));},_handlePopoverGroupsActionPromises:function(a,p,b){var e=b.filter(function(f,i,b){return!f.status;});if(e.length){var E=this._prepareErrorMessage(e,a.text);var d=sap.ushell.components.getCatalogsManager();d.notifyOnActionFailure(E.messageId,E.parameters);return;}this._updateAppBoxedWithPinStatuses();this._handleSuccessMessage(a,p);},_createGroupAndAddBookmark:function(n,a){var b=sap.ushell.components.getCatalogsManager();var d=q.Deferred(),R={};var e=b.createGroup(n);e.done(function(f){var g=this._addBookmark(f.getObject(),a,true);g.done(function(h){d.resolve(h);}).fail(function(){R={group:n,status:0,action:"addBookmark_ToNewGroup"};d.resolve(R);});}.bind(this)).fail(function(){R={group:n,status:0,action:"addBookmark_NewGroupCreation"};d.resolve(R);});return d.promise();},_addBookmark:function(g,a,i){var b=sap.ushell.Container.getService("Bookmark");var d=q.Deferred(),R={};var e=b.addBookmark({url:a.url,title:a.text,subtitle:a.subtitle,icon:a.icon},g.object);var f=i?"addBookmark_ToNewGroup":"addBookmark_ToExistingGroup";e.done(function(){R={group:g,status:1,action:f};d.resolve(R);}).fail(function(){R={group:g,status:0,action:f};d.resolve(R);});return d.promise();},showSaveAppPopover:function(e){this.getView().oVisualizationOrganizerHelper.onHierarchyAppsPinButtonClick.call(this,e).then(function(u){if(u){this._updateAppBoxedWithPinStatuses();}}.bind(this));},showGroupListPopover:function(e){var m=this.getView().getModel();var a=e.oSource.getParent().getBinding("title").getContext().getObject();if(m.getProperty("/groupContext").path){var g=m.getProperty("/groupContext").path;var G=m.getProperty(g);var b={newGroups:[],addToGroups:[G]};this._handleBookmarkAppPopoverResponse(a,b);return;}var d=m.getProperty("/groups").map(function(h){return{selected:false,initiallySelected:false,oGroup:h};});var p=new sap.ui.view({type:V.JS,viewName:"sap.ushell.components.appfinder.GroupListPopover",viewData:{groupData:d,enableHideGroups:m.getProperty("/enableHideGroups"),enableHelp:m.getProperty("/enableHelp"),singleGroupSelection:true}});var f=p.open(e.oSource);f.then(this._handleBookmarkAppPopoverResponse.bind(this,a));},resultTextFormatter:function(s,t){var R=r.i18n;if(s){var S=s.systemName?s.systemName:s.systemId;var a="";if(t){a=R.getText("search_easy_access_results",[t,S]);}return a;}return"";},showMoreResultsVisibilityFormatter:function(a,t){if(a&&a.length<t){return true;}return false;},showMoreResultsTextFormatter:function(a,t){if(!a||!t){return"";}var b=a.length;return r.i18n.getText("EasyAccessSearchResults_ShowMoreResults",[b,t]);}});},true);
sap.ui.predefine('sap/ushell/components/appfinder/HierarchyApps.view',["sap/ui/core/library","sap/ushell/ui/appfinder/AppBox","sap/ushell/ui/appfinder/PinButton","sap/ushell/resources","sap/ushell/ui/launchpad/AccessibilityCustomData","sap/m/FlexBox","sap/m/library","sap/m/Page","sap/m/PageAccessibleLandmarkInfo","sap/m/MessagePage","sap/ui/model/json/JSONModel","sap/m/Link","sap/m/Breadcrumbs","sap/m/Text","sap/m/Title","sap/m/Button","sap/ushell/components/appfinder/VisualizationOrganizerHelper"],function(c,A,P,r,a,F,m,b,d,M,J,L,B,T,f,g,V){"use strict";var h=m.ButtonType;var i=m.FlexWrap;var j=c.TitleLevel;var k=c.AccessibleLandmarkRole;sap.ui.jsview("sap.ushell.components.appfinder.HierarchyApps",{oVisualizationOrganizerHelper:V.getInstance(),createContent:function(C){this.oController=C;var p=new P({icon:{path:"easyAccess>bookmarkCount",formatter:this.oVisualizationOrganizerHelper.formatBookmarkPinButtonIcon},type:{path:"easyAccess>bookmarkCount",formatter:this.oVisualizationOrganizerHelper.formatBookmarkPinButtonType},selected:{path:"easyAccess>bookmarkCount",formatter:this.oVisualizationOrganizerHelper.formatBookmarkPinButtonSelectState.bind(this)},tooltip:{parts:["associatedGroups","easyAccess>bookmarkCount","/groupContext/path","/groupContext/id","/groupContext/title"],formatter:this.oVisualizationOrganizerHelper.formatBookmarkPinButtonTooltip.bind(this)},press:C.showSaveAppPopover.bind(C)});p.addCustomData(new a({key:"tabindex",value:"-1",writeToDom:true}));p.addStyleClass("sapUshellPinButton");this.oItemTemplate=new A({title:"{easyAccess>text}",subtitle:"{easyAccess>subtitle}",url:"{easyAccess>url}",icon:"{easyAccess>icon}",pinButton:p,tabindex:{path:"easyAccess>text"},press:[C.onAppBoxPressed,C]});this.oItemTemplate.addCustomData(new a({key:"tabindex",value:"-1",writeToDom:true}));this.layout=new F(this.getId()+"_hierarchyAppsLayout",{items:{path:"easyAccess>/apps",template:this.oItemTemplate},wrap:i.Wrap});this.layout.addDelegate({onAfterRendering:function(){var e=this.getItems();var u=function(l){if(l.getKey()==="tabindex"){l.setValue("0");}};if(e.length){e[0].getCustomData().forEach(u);e[0].getPinButton().getCustomData().forEach(u);}}.bind(this.layout)});this.oMessagePage=new M({visible:false,showHeader:false,text:r.i18n.getText("EasyAccessMenu_NoAppsToDisplayMessagePage_Text"),description:""});var v=this.getViewData();var s=v.menuName==="USER_MENU"?"appFinderUserMenuTitle":"appFinderSapMenuTitle";var o=new b({showHeader:false,landmarkInfo:new d({contentLabel:r.i18n.getText(s),contentRole:k.Region})}).addStyleClass("sapUshellAppsView sapUiContentPadding");if(v&&v.navigateHierarchy){this.crumbsModel=new J({crumbs:[]});this.linkTemplate=new L({text:"{crumbs>text}",press:function(e){var l=e.oSource.getBinding("text").getContext().getObject();v.navigateHierarchy(l.path,false);}});this.breadcrumbs=new B({links:{path:"crumbs>/crumbs",template:this.linkTemplate},currentLocationText:"{/text}"});this.breadcrumbs.setModel(this.crumbsModel,"crumbs");o.addContent(this.breadcrumbs);}else{this.resultText=new f({text:{parts:[{path:"easyAccessSystemsModel>/systemSelected"},{path:"easyAccess>/total"}],formatter:C.resultTextFormatter.bind(C)},level:j.H3}).addStyleClass("sapUiTinyMarginTop sapUiSmallMarginBottom sapUshellEasyAccessSearchResultText");o.addContent(this.resultText);this.showMoreResultsLink=new g({text:{parts:[{path:"easyAccess>/apps"},{path:"easyAccess>/total"}],formatter:C.showMoreResultsTextFormatter.bind(C)},press:v.getMoreSearchResults,visible:{parts:[{path:"easyAccess>/apps"},{path:"easyAccess>/total"}],formatter:C.showMoreResultsVisibilityFormatter.bind(C)},type:h.Transparent});}o.addContent(this.oMessagePage);o.addContent(this.layout);if(this.showMoreResultsLink){o.addContent(this.showMoreResultsLink);}return o;},formatPinButtonTooltip:function(G,e,s,l,n){var R=r.i18n,t;if(s){var C=G?Array.prototype.indexOf.call(G,l):-1;var o=C!==-1?"removeAssociatedTileFromContextGroup":"addAssociatedTileToContextGroup";t=R.getText(o,n);}else{t=e?R.getText("EasyAccessMenu_PinButton_Toggled_Tooltip"):R.getText("EasyAccessMenu_PinButton_UnToggled_Tooltip");}return t;},updateResultSetMessage:function(I,e){var E;if(e){E="noFilteredItems";}else{E="EasyAccessMenu_NoAppsToDisplayMessagePage_Text";}if(I){if(e){this.resultText.updateProperty("text");this.resultText.setVisible(true);}this.layout.setVisible(true);this.oMessagePage.setVisible(false);}else{if(e){this.resultText.setVisible(false);}this.layout.setVisible(false);this.oMessagePage.setVisible(true);var s=r.i18n.getText(E);this.oMessagePage.setText(s);}},setShowMoreResultsBusy:function(e){if(this.showMoreResultsLink){this.showMoreResultsLink.setBusy(e);}},getControllerName:function(){return"sap.ushell.components.appfinder.HierarchyApps";}});},true);
sap.ui.predefine('sap/ushell/components/appfinder/HierarchyFolders.controller',["sap/base/Log","sap/ui/thirdparty/jquery","sap/ui/model/FilterOperator","sap/ui/model/Filter","sap/m/StandardListItem","sap/m/SelectDialog","sap/ui/core/Component"],function(L,q,F,a,S,b,C){"use strict";sap.ui.controller("sap.ushell.components.appfinder.HierarchyFolders",{onInit:function(){this.oDialog=null;this.getView().setModel(this.getView().getViewData().easyAccessSystemsModel,"easyAccessSystems");this.getView().setModel(this.getView().getViewData().subHeaderModel,"subHeaderModel");this.getSelectedSystem().then(function(s){if(s){this.setSystemSelected(s);}else{this.setSystemSelected(undefined);this.onSystemSelectionPress();}}.bind(this),function(){this.setSystemSelected(undefined);this.onSystemSelectionPress();});},onExit:function(){if(this.oDialog){this.destroyDialog();}},onAfterRendering:function(){var j=q("#"+this.getView().getId());j.on("click",function(){this.exitSearchMode();}.bind(this));},getPersonalizer:function(){if(this.oPersonalizer){return this.oPersonalizer;}var p=sap.ushell.Container.getService("Personalization"),c=C.getOwnerComponentFor(this),s={keyCategory:p.constants.keyCategory.FIXED_KEY,writeFrequency:p.constants.writeFrequency.LOW,clientStorageAllowed:true},P={container:"appfinder.HierarchyFolders",item:"lastSelectedSystem"};this.oPersonalizer=p.getPersonalizer(P,s,c);return this.oPersonalizer;},getSelectedSystem:function(){var d=new q.Deferred(),s=this.getView().getModel("easyAccessSystems").getProperty("/systemsList");if(s&&s.length&&s.length===1){var e=s[0];this.setSystemSelectedInPersonalization(e);d.resolve(e);}else{this.getSelectedSystemInPersonalization().then(function(p){if(p){var c=false;for(var i=0;i<s.length;i++){if((s[i].systemName&&s[i].systemName===p.systemName)||(s[i].systemId===p.systemId)){c=true;d.resolve(p);}}if(!c){d.resolve();this.setSystemSelectedInPersonalization();}}else{d.resolve();}}.bind(this));}return d.promise();},setSystemSelected:function(s){this.getView().getModel("easyAccessSystems").setProperty("/systemSelected",s);this.setSystemSelectedInPersonalization(s);},getSelectedSystemInPersonalization:function(){var d=new q.Deferred();this.getPersonalizer().getPersData().then(function(p){if(p){d.resolve(p);}else{d.resolve();}},function(e){L.error("Failed to get selected system from the personalization",e,"sap.ushell.components.appfinder.HierarchyFolders");d.reject();});return d.promise();},setSystemSelectedInPersonalization:function(s){this.getPersonalizer().setPersData(s).fail(function(e){L.error("Failed to save selected system in the personalization",e,"sap.ushell.components.appfinder.HierarchyFolders");});},onSystemSelectionPress:function(){var s=this.getView().getModel("easyAccessSystems").getProperty("/systemsList");if(s&&s.length&&s.length<=1){return;}var d=this.createDialog();d.open();},createDialog:function(){var t=this;if(!this.oDialog){this.oDialog=new b({id:"systemSelectionDialog",title:t.getView().translationBundle.getText("easyAccessSelectSystemDialogTitle"),multiSelect:false,contentHeight:"20rem",items:{path:"/systemsList",template:new S({adaptTitleSize:false,title:{parts:["systemName","systemId"],formatter:t.titleFormatter},description:{parts:["systemName","systemId"],formatter:t.descriptionFormatter},selected:{parts:["systemName","systemId"],formatter:t.selectedFormatter.bind(this)}})},confirm:t.systemConfirmHandler.bind(t),search:t.systemSearchHandler.bind(t),cancel:t.destroyDialog.bind(t)});this.oDialog.setModel(this.getView().getModel("easyAccessSystems"));}return this.oDialog;},destroyDialog:function(){this.oDialog.destroyItems();this.oDialog.destroy();this.oDialog=null;},systemConfirmHandler:function(e){var i=e.getParameters().selectedItem,s=i.getBindingContext().getObject();this.setSystemSelected(s);this.destroyDialog();},systemSearchHandler:function(e){var v=e.getParameter("value"),f=new sap.ui.model.Filter("systemName",F.Contains,v),o=new sap.ui.model.Filter("systemId",F.Contains,v),s=new a({filters:[o,f],and:false}),B=e.getSource().getBinding("items");B.filter(s);},titleFormatter:function(s,c){return s||c;},descriptionFormatter:function(s,c){if(s){return c;}return null;},selectedFormatter:function(s,c){var u=this.getView().getModel("easyAccessSystems").getProperty("/systemSelected");if(!u){return false;}if(s){return(u.systemName===s&&u.systemId===c);}return(u.systemId===c);},systemSelectorTextFormatter:function(s){if(s){if(s.systemName){return s.systemName;}return s.systemId;}return this.getView().translationBundle.getText("easyAccessSelectSystemTextWithoutSystem");},exitSearchMode:function(){var s=this.getView().getModel("subHeaderModel");s.setProperty("/search/searchMode",false);s.refresh(true);}});},true);
sap.ui.predefine('sap/ushell/components/appfinder/HierarchyFolders.view',["sap/m/Button","sap/m/Label","sap/m/Bar","sap/m/Page","sap/m/library","sap/m/List","sap/m/StandardListItem","sap/m/Text","sap/ushell/resources"],function(B,L,a,P,m,b,S,T,r){"use strict";var c=m.ButtonType;var d=m.ListSeparators;sap.ui.jsview("sap.ushell.components.appfinder.HierarchyFolders",{createContent:function(C){var t=this;this.translationBundle=r.i18n;this.treePath="";this.lastFocusID=document.URL.substring(document.URL.lastIndexOf("&/")+2)+"-button";this.systemSelectorText=new T({text:{path:"easyAccessSystemsModel>/systemSelected",formatter:C.systemSelectorTextFormatter.bind(C)}});this.oItemTemplate=new S({title:"{easyAccess>text}",type:"Navigation",press:function(){var e=t.pageMenu.$().find(".sapMBarLeft button");if(!e.length){t.lastFocusID=document.activeElement.getAttribute("id");}var p=this.getBindingContextPath();t.getViewData().navigateHierarchy(p,true);}});this.oList=new b({showSeparators:d.None,items:{path:"easyAccess>"+this.treePath+"/folders",template:this.oItemTemplate},updateFinished:function(){var l=this.getItems();t.finishEasyAccessAnimation(true);l.forEach(function(o){o.onsapspace=o.onsapenter;});},noDataText:{path:"easyAccessSystemsModel>/systemSelected",formatter:function(s){if(s){return t.translationBundle.getText("easyAccessFolderWithNoItems");}}}});this._navBackButton=new B({tooltip:sap.ui.getCore().getLibraryResourceBundle("sap.m").getText("PAGE_NAVBUTTON_TEXT"),type:c.Back,visible:false,press:function(){var p=this.treePath.split("/");var n=p.slice(0,p.length-2);this.getViewData().navigateHierarchy(n.join("/"),false);}.bind(this)});this.pageMenu=new P({enableScrolling:true,headerContent:new a({contentLeft:[this._navBackButton,new L({text:{parts:["easyAccessSystemsModel>/systemSelected"],formatter:C.systemSelectorTextFormatter.bind(C)}})],contentRight:[new B({text:this.translationBundle.getText("easyAccessSelectSystemDialogTitle"),type:c.Transparent,visible:{path:"easyAccessSystemsModel>/systemsList",formatter:function(s){return s.length>1;}},press:[C.onSystemSelectionPress,C]})]}).addStyleClass("sapUshellEasyAccessMasterPageHeader"),content:this.oList});return this.pageMenu;},getControllerName:function(){return"sap.ushell.components.appfinder.HierarchyFolders";},finishEasyAccessAnimation:function(){if(!this.jqFolderClone){return;}if(this.forwardAnimation){this.pageMenu.$().addClass("forwardToViewAnimation");this.jqFolderClone.addClass("forwardOutOfViewAnimation");}else{this.pageMenu.$().addClass("backToViewAnimation");this.jqFolderClone.addClass("backOutOfViewAnimation");}this.jqFolderClone.on("animationend",function(){this.pageMenu.$().removeClass("forwardToViewAnimation backToViewAnimation");var e=this.pageMenu.$().find(".sapMBarLeft button");if(e.length){e.focus();}else{setTimeout(function(){document.querySelector("#"+this.lastFocusID).focus();}.bind(this));}if(this.jqFolderClone){this.jqFolderClone.remove();}}.bind(this));},prepareEasyAccessAnimation:function(f){this.forwardAnimation=f;this.jqFolderClone=this.pageMenu.$().clone().removeAttr("data-sap-ui").css("z-index","1");this.jqFolderClone.find("*").removeAttr("id");this.pageMenu.$().parent().append(this.jqFolderClone);},updatePageBindings:function(p,f){var s=p.split("/").length>2;this.treePath=p;this._navBackButton.setVisible(s);this.pageMenu.setShowSubHeader(!s);this.prepareEasyAccessAnimation(f);this.oList.bindItems("easyAccess>"+p+"/folders",this.oItemTemplate);}});},true);
sap.ui.predefine('sap/ushell/components/appfinder/VisualizationOrganizerHelper',["sap/m/library","sap/ushell/Config","sap/ushell/EventHub","sap/ushell/resources"],function(m,C,E,r){"use strict";var B=m.ButtonType;var i;function g(){return sap.ui.getCore().byId("catalogView");}function V(){var v,o,s=null;function a(){return C.last("/core/spaces/enabled");}function l(){if(v){return Promise.resolve(v);}o=o||new Promise(function(b){sap.ui.require(["sap/ushell/components/visualizationOrganizer/Component"],function(c){v=new c();b(v);});});return o;}if(a()){this.oDoable=E.on("trackHashChange").do(function(h){if(a()&&(h==="Shell-appFinder")){var c=g();if(!c){return;}c.setBusy(true);l().then(function(b){return b.requestData();}).then(function(){if(this.oModel){this.oModel.updateBindings(true);}}.bind(this)).finally(function(){c.setBusy(false);});}}.bind(this));}this.setModel=function(b){this.oModel=b;};this.formatPinButtonTooltip=function(G,b,c){if(!a()){return this.formatPinButtonTooltip(G,b);}return v.formatPinButtonTooltip(c,s);};this.formatPinButtonSelectState=function(){if(!a()){return this.formatPinButtonSelectState.apply(this,arguments);}return false;};this.formatPinButtonIcon=function(b){if(!a()){return"sap-icon://pushpin-off";}return v.formatPinButtonIcon(b,!!s);};this.formatPinButtonType=function(b){if(!a()){return B.Default;}return v.formatPinButtonType(b,!!s);};this.onTilePinButtonClick=function(e){if(!a()){this.getController().onTilePinButtonClick(e);return;}v.onTilePinButtonClick(e,s);};this.getNavigationContext=function(){if(!a()){return this.getGroupContext.apply(this,arguments);}if(s){return{pageID:encodeURIComponent(s.pageID),sectionID:encodeURIComponent(s.sectionID)};}return null;};this.getNavigationContextAsText=function(){if(!a()){return this.getGroupNavigationContext.apply(this,arguments);}if(s){return JSON.stringify({pageID:encodeURIComponent(s.pageID),sectionID:encodeURIComponent(s.sectionID)});}return null;};this.updateModelWithContext=function(d){if(!a()){this._updateModelWithGroupContext.apply(this,arguments);return Promise.resolve();}return l().then(function(){return v.loadSectionContext(d);}).then(function(c){s=c;this.oView.getModel().updateBindings(true);if(s){var t=r.i18n.getText("VisualizationOrganizer.AppFinderSectionContextTitle",s.sectionTitle);this.oView.oPage.setTitle(t);if(this._updateShellHeader){this._updateShellHeader(t);}}}.bind(this));};this._loadVisualizationOrganizer=l;this._setSectionContext=function(c){s=c;};this.exit=function(){if(this.oDoable){this.oDoable.off();this.oDoable=null;}};this.onHierarchyAppsPinButtonClick=function(e){if(!a()){this.showGroupListPopover(e);return Promise.resolve(false);}return v.onHierarchyAppsPinButtonClick(e,s);};this.formatBookmarkPinButtonTooltip=function(G,b,c,d,e){if(!a()){return this.formatPinButtonTooltip(G,b,c,d,e);}return v.formatBookmarkPinButtonTooltip(b,s);};this.formatBookmarkPinButtonSelectState=function(b){if(!a()){return!!b;}return false;};this.formatBookmarkPinButtonIcon=function(b){if(!a()){return"sap-icon://pushpin-off";}return b>0?"sap-icon://accept":"sap-icon://add";};this.formatBookmarkPinButtonType=function(b){if(!a()){return B.Default;}return b>0?B.Emphasized:B.Default;};this.updateBookmarkCount=function(A){if(!a()){return this.updateBookmarkCount(A);}return v.updateBookmarkCount(A,s);};}return{getInstance:function(){if(!i){i=new V();}return i;},destroy:function(){if(i){i.exit();}i=null;}};});
sap.ui.require.preload({
	"sap/ushell/components/appfinder/manifest.json":'{"_version":"1.21.0","sap.app":{"id":"sap.ushell.components.appfinder","applicationVersion":{"version":"1.88.1"},"i18n":{"bundleUrl":"../../renderers/fiori2/resources/resources.properties","supportedLocales":["","ar","bg","ca","cs","da","de","el","en","en_US","en_US_sappsd","en_US_saptrc","es","et","fi","fr","hi","hr","hu","it","iw","ja","kk","ko","lt","lv","ms","nl","no","pl","pt","ro","ru","sh","sk","sl","sv","th","tr","uk","vi","zh_CN","zh_TW"],"fallbackLocale":"en"},"ach":"CA-FLP-FE-COR","type":"component","title":"{{Component.AppFinder.Title}}","resources":"resources.json"},"sap.ui":{"fullWidth":true,"hideLightBackground":true,"technology":"UI5","deviceTypes":{"desktop":true,"tablet":true,"phone":true}},"sap.ui5":{"componentName":"sap.ushell.components.appfinder","dependencies":{"minUI5Version":"1.30","libs":{"sap.ui.core":{},"sap.m":{}}},"routing":{"config":{"routerClass":"sap.m.routing.Router","viewType":"JS","controlId":"catalogViewMasterDetail","controlAggregation":"detailPages","clearAggregation":false,"async":true},"routes":[{"name":"userMenu","pattern":"userMenu/:filters:"},{"name":"sapMenu","pattern":"sapMenu/:filters:"},{"name":"catalog","pattern":["catalog/:filters:","",":filters:"]}]},"contentDensities":{"compact":true,"cozy":true}}}'
},"sap/ushell/components/appfinder/Component-preload"
);
//# sourceMappingURL=Component-preload.js.map