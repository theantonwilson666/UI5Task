// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.define(["sap/m/Button","sap/m/Label","sap/m/Bar","sap/m/Page","sap/m/library","sap/m/List","sap/m/StandardListItem","sap/m/Text","sap/ushell/resources"],function(B,L,a,P,m,b,S,T,r){"use strict";var c=m.ButtonType;var d=m.ListSeparators;sap.ui.jsview("sap.ushell.components.appfinder.HierarchyFolders",{createContent:function(C){var t=this;this.translationBundle=r.i18n;this.treePath="";this.lastFocusID=document.URL.substring(document.URL.lastIndexOf("&/")+2)+"-button";this.systemSelectorText=new T({text:{path:"easyAccessSystemsModel>/systemSelected",formatter:C.systemSelectorTextFormatter.bind(C)}});this.oItemTemplate=new S({title:"{easyAccess>text}",type:"Navigation",press:function(){var e=t.pageMenu.$().find(".sapMBarLeft button");if(!e.length){t.lastFocusID=document.activeElement.getAttribute("id");}var p=this.getBindingContextPath();t.getViewData().navigateHierarchy(p,true);}});this.oList=new b({showSeparators:d.None,items:{path:"easyAccess>"+this.treePath+"/folders",template:this.oItemTemplate},updateFinished:function(){var l=this.getItems();t.finishEasyAccessAnimation(true);l.forEach(function(o){o.onsapspace=o.onsapenter;});},noDataText:{path:"easyAccessSystemsModel>/systemSelected",formatter:function(s){if(s){return t.translationBundle.getText("easyAccessFolderWithNoItems");}}}});this._navBackButton=new B({tooltip:sap.ui.getCore().getLibraryResourceBundle("sap.m").getText("PAGE_NAVBUTTON_TEXT"),type:c.Back,visible:false,press:function(){var p=this.treePath.split("/");var n=p.slice(0,p.length-2);this.getViewData().navigateHierarchy(n.join("/"),false);}.bind(this)});this.pageMenu=new P({enableScrolling:true,headerContent:new a({contentLeft:[this._navBackButton,new L({text:{parts:["easyAccessSystemsModel>/systemSelected"],formatter:C.systemSelectorTextFormatter.bind(C)}})],contentRight:[new B({text:this.translationBundle.getText("easyAccessSelectSystemDialogTitle"),type:c.Transparent,visible:{path:"easyAccessSystemsModel>/systemsList",formatter:function(s){return s.length>1;}},press:[C.onSystemSelectionPress,C]})]}).addStyleClass("sapUshellEasyAccessMasterPageHeader"),content:this.oList});return this.pageMenu;},getControllerName:function(){return"sap.ushell.components.appfinder.HierarchyFolders";},finishEasyAccessAnimation:function(){if(!this.jqFolderClone){return;}if(this.forwardAnimation){this.pageMenu.$().addClass("forwardToViewAnimation");this.jqFolderClone.addClass("forwardOutOfViewAnimation");}else{this.pageMenu.$().addClass("backToViewAnimation");this.jqFolderClone.addClass("backOutOfViewAnimation");}this.jqFolderClone.on("animationend",function(){this.pageMenu.$().removeClass("forwardToViewAnimation backToViewAnimation");var e=this.pageMenu.$().find(".sapMBarLeft button");if(e.length){e.focus();}else{setTimeout(function(){document.querySelector("#"+this.lastFocusID).focus();}.bind(this));}if(this.jqFolderClone){this.jqFolderClone.remove();}}.bind(this));},prepareEasyAccessAnimation:function(f){this.forwardAnimation=f;this.jqFolderClone=this.pageMenu.$().clone().removeAttr("data-sap-ui").css("z-index","1");this.jqFolderClone.find("*").removeAttr("id");this.pageMenu.$().parent().append(this.jqFolderClone);},updatePageBindings:function(p,f){var s=p.split("/").length>2;this.treePath=p;this._navBackButton.setVisible(s);this.pageMenu.setShowSubHeader(!s);this.prepareEasyAccessAnimation(f);this.oList.bindItems("easyAccess>"+p+"/folders",this.oItemTemplate);}});},true);
