// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.define(["sap/m/library","sap/ushell/Config","sap/ushell/EventHub","sap/ushell/resources"],function(m,C,E,r){"use strict";var B=m.ButtonType;var i;function g(){return sap.ui.getCore().byId("catalogView");}function V(){var v,o,s=null;function a(){return C.last("/core/spaces/enabled");}function l(){if(v){return Promise.resolve(v);}o=o||new Promise(function(b){sap.ui.require(["sap/ushell/components/visualizationOrganizer/Component"],function(c){v=new c();b(v);});});return o;}if(a()){this.oDoable=E.on("trackHashChange").do(function(h){if(a()&&(h==="Shell-appFinder")){var c=g();if(!c){return;}c.setBusy(true);l().then(function(b){return b.requestData();}).then(function(){if(this.oModel){this.oModel.updateBindings(true);}}.bind(this)).finally(function(){c.setBusy(false);});}}.bind(this));}this.setModel=function(b){this.oModel=b;};this.formatPinButtonTooltip=function(G,b,c){if(!a()){return this.formatPinButtonTooltip(G,b);}return v.formatPinButtonTooltip(c,s);};this.formatPinButtonSelectState=function(){if(!a()){return this.formatPinButtonSelectState.apply(this,arguments);}return false;};this.formatPinButtonIcon=function(b){if(!a()){return"sap-icon://pushpin-off";}return v.formatPinButtonIcon(b,!!s);};this.formatPinButtonType=function(b){if(!a()){return B.Default;}return v.formatPinButtonType(b,!!s);};this.onTilePinButtonClick=function(e){if(!a()){this.getController().onTilePinButtonClick(e);return;}v.onTilePinButtonClick(e,s);};this.getNavigationContext=function(){if(!a()){return this.getGroupContext.apply(this,arguments);}if(s){return{pageID:encodeURIComponent(s.pageID),sectionID:encodeURIComponent(s.sectionID)};}return null;};this.getNavigationContextAsText=function(){if(!a()){return this.getGroupNavigationContext.apply(this,arguments);}if(s){return JSON.stringify({pageID:encodeURIComponent(s.pageID),sectionID:encodeURIComponent(s.sectionID)});}return null;};this.updateModelWithContext=function(d){if(!a()){this._updateModelWithGroupContext.apply(this,arguments);return Promise.resolve();}return l().then(function(){return v.loadSectionContext(d);}).then(function(c){s=c;this.oView.getModel().updateBindings(true);if(s){var t=r.i18n.getText("VisualizationOrganizer.AppFinderSectionContextTitle",s.sectionTitle);this.oView.oPage.setTitle(t);if(this._updateShellHeader){this._updateShellHeader(t);}}}.bind(this));};this._loadVisualizationOrganizer=l;this._setSectionContext=function(c){s=c;};this.exit=function(){if(this.oDoable){this.oDoable.off();this.oDoable=null;}};this.onHierarchyAppsPinButtonClick=function(e){if(!a()){this.showGroupListPopover(e);return Promise.resolve(false);}return v.onHierarchyAppsPinButtonClick(e,s);};this.formatBookmarkPinButtonTooltip=function(G,b,c,d,e){if(!a()){return this.formatPinButtonTooltip(G,b,c,d,e);}return v.formatBookmarkPinButtonTooltip(b,s);};this.formatBookmarkPinButtonSelectState=function(b){if(!a()){return!!b;}return false;};this.formatBookmarkPinButtonIcon=function(b){if(!a()){return"sap-icon://pushpin-off";}return b>0?"sap-icon://accept":"sap-icon://add";};this.formatBookmarkPinButtonType=function(b){if(!a()){return B.Default;}return b>0?B.Emphasized:B.Default;};this.updateBookmarkCount=function(A){if(!a()){return this.updateBookmarkCount(A);}return v.updateBookmarkCount(A,s);};}return{getInstance:function(){if(!i){i=new V();}return i;},destroy:function(){if(i){i.exit();}i=null;}};});
