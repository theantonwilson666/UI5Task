//@ui5-bundle sap/ushell/components/homepage/Component-preload.js
// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.predefine('sap/ushell/components/homepage/ActionMode',["sap/ushell/resources","sap/m/library","sap/m/Button","sap/ui/thirdparty/jquery","sap/ushell/utils/WindowUtils"],function(r,m,B,q,W){"use strict";var P=m.PlacementType;var A=function(){this.oEventBus=sap.ui.getCore().getEventBus();this.init=function(M){this.oModel=M;};};A.prototype._activate=function(){this.oModel.setProperty("/tileActionModeActive",true);this.aOrigHiddenGroupsIds=this.getHomepageManager().getCurrentHiddenGroupIds(this.oModel);var d=sap.ui.getCore().byId("dashboardGroups");d.addLinksToUnselectedGroups();var t=sap.ui.getCore().byId("ActionModeBtn");if(t){t.setTooltip(r.i18n.getText("exitEditMode"));t.setText(r.i18n.getText("exitEditMode"));if(t.setSelected){t.setSelected(true);}}this.oEventBus.publish("launchpad","actionModeActive");};A.prototype._deactivate=function(){this.oModel.setProperty("/tileActionModeActive",false);this.oEventBus.publish("launchpad","actionModeInactive",this.aOrigHiddenGroupsIds);var t=sap.ui.getCore().byId("TileActions");if(t!==undefined){t.destroy();}sap.ui.require(["sap/m/MessageToast"],function(M){M.show(r.i18n.getText("savedChanges"),{duration:4000});});var T=sap.ui.getCore().byId("ActionModeBtn");if(T){T.setTooltip(r.i18n.getText("activateEditMode"));T.setText(r.i18n.getText("activateEditMode"));if(T.setSelected){T.setSelected(false);}}};A.prototype.toggleActionMode=function(M,s,d){d=d||[];var v=d.filter(function(g){return g.getVisible();});var D={group:v[M.getProperty("/topGroupInViewPortIndex")],restoreLastFocusedTile:true};if(M.getProperty("/tileActionModeActive")){this._deactivate();var j=q(".sapUshellTileContainerHeader[tabindex=0]");if(j.length){var a=q(j[0]).closest(".sapUshellTileContainer");if(a.length){D.restoreLastFocusedTileContainerById=a[0].id;}}}else{this._activate();}this.oEventBus.publish("launchpad","scrollToGroup",D);};A.prototype.activateGroupEditMode=function(g){var j=q(g.getDomRef()).find(".sapUshellTileContainerContent");j.addClass("sapUshellTileContainerEditMode");};A.prototype.getHomepageManager=function(){if(!this.oHomepageManager){this.oHomepageManager=sap.ushell.components.getHomepageManager();}return this.oHomepageManager;};A.prototype._openActionsMenu=function(e,v){var t=this,T=v||e.getSource(),a=[],o=sap.ui.getCore().byId("TileActions"),b,c,d=[],n,f,g,h,H,j;if(T){h=T.getBindingContext().getObject().object;a=this.getHomepageManager().getTileActions(h);}t.oTileControl=T;q(".sapUshellTileActionLayerDivSelected").removeClass("sapUshellTileActionLayerDivSelected");j=q(e.getSource().getDomRef()).find(".sapUshellTileActionLayerDiv");j.addClass("sapUshellTileActionLayerDivSelected");var k=T.getModel();var G=T.getParent().getBindingContext().getPath();if(a.length&&k.getProperty(G+"/isGroupLocked")){["tileSettingsBtn","linkSettingsBtn","ConvertToTile","ConvertToLink","moveTileDialog_action"].forEach(function(s){var l=r.i18n.getText(s);for(var i=0;i<a.length;i++){if(a[i].text===l){a.splice(i,1);break;}}});}if(a.length===0){n=new B({text:r.i18n.getText("tileHasNoActions"),enabled:false});d.push(n);}else{for(c=0;c<a.length;c++){g=a[c];H=(function(g){return function(){t._handleActionPress(g,T);};}(g));f=new B({text:g.text,icon:g.icon,press:H});d.push(f);}}b=e.getSource().getActionSheetIcon?e.getSource().getActionSheetIcon():undefined;if(!b){var M=sap.ui.getCore().byId(e.getSource().getId()+"-action-more");if(M){b=M;}else{b=e.getSource();}}if(!o){sap.ui.require(["sap/m/ActionSheet"],function(i){o=new i("TileActions",{placement:P.Bottom,afterClose:function(){q(".sapUshellTileActionLayerDivSelected").removeClass("sapUshellTileActionLayerDivSelected");var E=sap.ui.getCore().getEventBus();E.publish("dashboard","actionSheetClose",t.oTileControl);}});t._openActionSheet(o,d,b);});}else{t._openActionSheet(o,d,b);}};A.prototype._openActionSheet=function(a,b,t){b=b||[];a.destroyButtons();b.forEach(function(o){a.addButton(o);});a.openBy(t);};A.prototype._handleActionPress=function(a,t){if(a.press){a.press.call(a,t);}else if(a.targetURL){if(a.targetURL.indexOf("#")===0){hasher.setHash(a.targetURL);}else{W.openURL(a.targetURL,"_blank");}}else{sap.ui.require(["sap/m/MessageToast"],function(M){M.show("No Action");});}};return new A();},true);
sap.ui.predefine('sap/ushell/components/homepage/Component',["sap/ui/core/UIComponent","sap/ushell/bootstrap/common/common.load.model","sap/ushell/components/HomepageManager","sap/ushell/components/SharedComponentUtils","sap/ushell/Config","sap/ushell/resources"],function(U,m,H,s,C,r){"use strict";return U.extend("sap.ushell.components.homepage.Component",{metadata:{manifest:"json",library:"sap.ushell"},init:function(){this.oModel=m.getModel();this.setModel(this.oModel);U.prototype.init.apply(this,arguments);var d={model:this.oModel,view:this.oDashboardView};this.oHomepageManager=new H("dashboardMgr",d);this.setModel(r.i18nModel,"i18n");sap.ui.getCore().getEventBus().subscribe("sap.ushell.services.UsageAnalytics","usageAnalyticsStarted",function(){sap.ui.require(["sap/ushell/components/homepage/FLPAnalytics"]);});s.toggleUserActivityLog();s.getEffectiveHomepageSetting("/core/home/homePageGroupDisplay","/core/home/enableHomePageSettings");C.on("/core/home/homePageGroupDisplay").do(function(n){this.oHomepageManager.handleDisplayModeChange(n);}.bind(this));s.getEffectiveHomepageSetting("/core/home/sizeBehavior","/core/home/sizeBehaviorConfigurable");C.on("/core/home/sizeBehavior").do(function(S){var M=this.oHomepageManager.getModel();M.setProperty("/sizeBehavior",S);}.bind(this));},createContent:function(){this.oDashboardView=sap.ui.view({viewName:"sap.ushell.components.homepage.DashboardContent",type:"JS",async:true});return this.oDashboardView;},exit:function(){this.oHomepageManager.destroy();}});});
sap.ui.predefine('sap/ushell/components/homepage/DashboardContent.controller',["sap/ui/thirdparty/jquery","./DashboardUIActions","sap/ushell/utils","sap/ushell/EventHub","sap/ui/Device","sap/ushell/resources","sap/ushell/Layout","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/base/Log","sap/ui/core/mvc/Controller"],function(q,D,u,E,a,r,L,F,b,c,C){"use strict";return C.extend("sap.ushell.components.homepage.DashboardContent",{onInit:function(){var e=sap.ui.getCore().getEventBus();this.handleDashboardScroll=this._handleDashboardScroll.bind(this);e.subscribe("sap.ushell","appOpened",this._appOpenedHandler,this);e.subscribe("launchpad","dashboardModelContentLoaded",this._modelLoaded,this);e.subscribe("launchpad","actionModeInactive",this._handleGroupVisibilityChanges,this);e.subscribe("launchpad","switchTabBarItem",this._handleTabBarItemPressEventHandler,this);window.document.addEventListener("visibilitychange",u.handleTilesVisibility,false);},onExit:function(){var e=sap.ui.getCore().getEventBus();e.unsubscribe("launchpad","contentRefresh",this._webkitMobileRenderFix,this);e.unsubscribe("sap.ushell","appOpened",this._appOpenedHandler,this);e.unsubscribe("launchpad","dashboardModelContentLoaded",this._modelLoaded,this);e.unsubscribe("launchpad","switchTabBarItem",this._handleTabBarItemPressEventHandler,this);window.document.removeEventListener("visibilitychange",u.handleTilesVisibility,false);if(this.oDashboardUIActionsModule){this.oDashboardUIActionsModule.destroy();delete this.oDashboardUIActionsModule;}window.removeEventListener("resize",this._resizeHandler.bind(this));},onAfterRendering:function(){u.setPerformanceMark("FLP - dashboard after rendering");var h=sap.ushell.components.getHomepageManager();if(!h.getPreparedGroupModel()){h.loadPersonalizedGroups();}else{E.once("firstSegmentCompleteLoaded").do(h.handleFirstSegmentLoaded.bind(h));}var e=sap.ui.getCore().getEventBus(),m,t,g,i;e.unsubscribe("launchpad","scrollToGroup",this._scrollToGroup,this);e.unsubscribe("launchpad","scrollToGroupByName",this._scrollToGroupByName,this);e.subscribe("launchpad","scrollToGroup",this._scrollToGroup,this);e.subscribe("launchpad","scrollToGroupByName",this._scrollToGroupByName,this);a.orientation.attachHandler(function(){var j=q("#dashboardGroups").find(".sapUshellTileContainer").filter(":visible");if(j.length){m=this.getView().getModel();t=m.getProperty("/topGroupInViewPortIndex");if(j.get(t)){g=sap.ui.getCore().byId(j.get(t).id);i=m.getProperty("/editTitle");this._publishAsync("launchpad","scrollToGroup",{group:g,isInEditTitle:i});}}},this);window.addEventListener("resize",this._resizeHandler.bind(this));this._updateTopGroupInModel();},_resizeHandler:function(){clearTimeout(this._resizeTimer);this._resizeTimer=setTimeout(this.resizeHandler.bind(this),300);},_dashboardDeleteTileHandler:function(e){var t=e.getSource(),T=t.getBindingContext().getObject(),d={tileId:T.uuid};sap.ui.getCore().getEventBus().publish("launchpad","deleteTile",d,this);},dashboardTilePress:function(e){var t=e.getSource();if(!t){return;}if(a.system.desktop){var s=document.activeElement.id.indexOf("feedTile")!==-1;if(document.activeElement.tagName!=="INPUT"&&s!==true){if(sap.ui.getCore().byId(t.getId())){sap.ushell.components.ComponentKeysHandler.setTileFocus(t.$());}}}sap.ui.getCore().getEventBus().publish("launchpad","dashboardTileClick",{uuid:t.getUuid()});},_updateTopGroupInModel:function(){var m=this.getView().getModel(),t=this._getIndexOfTopGroupInViewPort();var s=this._getModelGroupFromVisibleIndex(t);m.setProperty("/iSelectedGroup",s);m.setProperty("/topGroupInViewPortIndex",t);},_getIndexOfTopGroupInViewPort:function(){var v=this.getView(),d=v.getDomRef(),s=d.getElementsByTagName("section"),j=q(s).find(".sapUshellTileContainer"),o=j.not(".sapUshellHidden").eq(0).offset(),f=(o&&o.top)||0,t=[],n=s[0].scrollTop,e=0;if(!j||!o){return e;}j.each(function(){if(!q(this).hasClass("sapUshellHidden")){var m=q(this).parent().offset().top;t.push([m,m+q(this).parent().height()]);}});var g=n+f;var h;for(var i=0;i<t.length;i++){h=t[i];var k=h[0],l=h[1];if(k-24<=g&&g<=l){e=i;break;}}return e;},_handleDashboardScroll:function(){var v=this.getView(),m=v.getModel(),n=400;var h=m.getProperty("/homePageGroupDisplay"),e=h!=="tabs",t=m.getProperty("/tileActionModeActive");function H(){u.handleTilesVisibility();}clearTimeout(this.timeoutId);this.timeoutId=setTimeout(H,n);if(!a.system.phone){v.oAnchorNavigationBar.closeOverflowPopup();}if(e||t){this._updateTopGroupInModel();}v.oAnchorNavigationBar.reArrangeNavigationBarElements();},_handleGroupDeletion:function(g){sap.ui.require(["sap/m/MessageBox"],function(M){var e=sap.ui.getCore().getEventBus(),G=g.getObject(),i=G.removable,s=G.title,d=G.groupId,R=r.i18n,A=M.Action,m=(i?A.DELETE:R.getText("ResetGroupBtn"));sap.ushell.Container.getServiceAsync("Message").then(function(o){o.confirm(R.getText(i?"delete_group_msg":"reset_group_msg",s),function(f){if(f===m){e.publish("launchpad",i?"deleteGroup":"resetGroup",{groupId:d});}},R.getText(i?"delete_group":"reset_group"),[m,A.CANCEL]);});});},_modelLoaded:function(){this.bModelInitialized=true;L.getInitPromise().then(function(){this._initializeUIActions();}.bind(this));},_initializeUIActions:function(){if(!this.oDashboardUIActionsModule){this.oDashboardUIActionsModule=new D();}this.oDashboardUIActionsModule.initializeUIActions(this);},resizeHandler:function(){u.recalculateBottomSpace();u.handleTilesVisibility();if(E.last("AppRendered")!==undefined){E.emit("AppRendered",undefined);}if(L&&q("#dashboardGroups").is(":visible")){L.reRenderGroupsLayout(null);this._initializeUIActions();}},_appOpenedHandler:function(s,e,d){var p,P,m=this.getView().getModel();p=this.getOwnerComponent();P=p.getMetadata().getComponentName();if(d.additionalInformation&&d.additionalInformation.indexOf(P)===-1){u.setTilesNoVisibility();}if(m.getProperty("/tileActionModeActive")&&sap.ushell.components.homepage.ActionMode){sap.ushell.components.homepage.ActionMode.toggleActionMode(m,"Menu Item");}if(this.oDashboardUIActionsModule){this.oDashboardUIActionsModule.disableAllDashboardUiAction();}},_scrollToGroupByName:function(s,e,d){var g=this.getView().getModel().getProperty("/groups"),G=d.groupName;sap.ushell.Container.getServiceAsync("LaunchPage").then(function(l){g.forEach(function(o){if(l.getGroupTitle(o.object)===G){this._scrollToGroup(s,e,{groupId:o.groupId});}}.bind(this));}.bind(this));},_scrollToGroup:function(s,e,d){var g=d.group?d.group.getGroupId():d.groupId;var G;if(this.oView.oDashboardGroupsBox.getGroups()){G=this.oView.oDashboardGroupsBox.getGroups().reduce(function(i,k){return k&&k.getGroupId()===g?k:i;},null);}var o=G&&G.getDomRef();if(!o){return;}var t=o.querySelector(".sapUshellTileContainerEditMode")||o.querySelector(".sapUshellTilesContainer-sortable");if(!t){return;}var f=document.getElementById("dashboardGroups"),y=t.getBoundingClientRect().top-f.getBoundingClientRect().top;document.getElementById("sapUshellDashboardPage-cont").scrollTop=y;if(a.system.desktop){var j=G.$();if(d.restoreLastFocusedTile){var l=false;if(d.restoreLastFocusedTileContainerById){j=q("#"+d.restoreLastFocusedTileContainerById);l=true;}sap.ushell.components.ComponentKeysHandler.goToLastVisitedTile(j,l);}else if(d.groupChanged){var h=j.find(".sapUshellTile, .sapMGTLineMode, .sapFCard").filter(":visible").eq(0);if(h.length){sap.ushell.components.ComponentKeysHandler.moveScrollDashboard(h);}}}if(d.isInEditTitle){G.setEditMode(true);}u.handleTilesVisibility();},_handleDrop:function(e,d){var l=L.getLayoutEngine(),t=l.layoutEndCallback(),i=!t.dstArea,o=sap.ui.getCore().getEventBus(),n,f,T,g=q.Deferred(),v=this.getView(),m=v.getModel(),h=m.getProperty("/homePageGroupDisplay")&&m.getProperty("/homePageGroupDisplay")==="tabs",j=m.getProperty("/tileActionModeActive"),I=true,k=!!(m.getProperty("/personalization")&&(a.browser.msie||a.browser.edge)&&a.browser.version>=11&&(a.system.combi||a.system.tablet)),p;if(!t.tile){o.publish("launchpad","sortableStop");return null;}L.getLayoutEngine()._toggleAnchorItemHighlighting(false);if(t.dstGroup){var s=t.dstGroup.getBindingContext(),w=s.getProperty(s.sPath).isGroupLocked;I=i&&w;}p=t.tile.getBindingContext().getObject().isLinkPersonalizationSupported;if(!t.tileMovedFlag||(k&&l.isTabBarCollision())||I||(!p&&t.dstArea==="links")){o.publish("launchpad","sortableStop");return null;}if(!j&&!h&&t.dstArea==="links"&&!t.dstGroupData.getLinks().length){o.publish("launchpad","sortableStop");return null;}n=true;f=true;if((t.srcGroup!==t.dstGroup)){n=f=false;}else if(t.tile!==t.dstGroup.getTiles()[t.dstTileIndex]){f=false;}T=this._getTileUuid(t.tile);if(t.srcGroup&&t.srcGroup.removeAggregation&&t.srcArea){t.srcGroup.removeAggregation("tiles",t.tile,n);}var S=t.dstGroupData&&t.dstGroupData.insertAggregation&&t.dstArea===t.srcArea;if(S){t.tile.sParentAggregationName=t.dstArea;t.dstGroupData.insertAggregation(t.dstArea,t.tile,t.dstTileIndex,f);g=this._handleSameTypeDrop(t,T,S);}else if(i){g=this._handleShortDrop(t,T,S);}else{g=this._handleConvertDrop(t,S,d);}if(this.getView().getModel()){this.getView().getModel().setProperty("/draggedTileLinkPersonalizationSupported",true);}o.publish("launchpad","sortableStop");return g.promise();},_handleSameTypeDrop:function(t,T,s){var e=sap.ui.getCore().getEventBus(),d=q.Deferred();t.tile._getBindingContext().oModel.setProperty(t.tile._getBindingContext().sPath+"/draggedInTabBarToSourceGroup",false);e.publish("launchpad","movetile",{sTileId:T,sToItems:t.dstArea?t.dstArea:"tiles",sFromItems:t.srcArea?t.srcArea:"tiles",sTileType:t.dstArea?t.dstArea.substr(0,t.dstArea.length-1):undefined,toGroupId:t.dstGroupData.getGroupId?t.dstGroupData.getGroupId():t.dstGroupData.groupId,toIndex:t.dstTileIndex,longDrop:s,callBack:function(){d.resolve();}});return d.promise();},_handleShortDrop:function(t,T,s){var e=sap.ui.getCore().getEventBus(),d=q.Deferred();e.publish("launchpad","movetile",{sTileId:T,sToItems:t.srcArea||"tiles",sFromItems:t.srcArea||"tiles",sTileType:t.srcArea?t.srcArea.substr(0,t.srcArea.length-1):undefined,toGroupId:t.dstGroupData.getGroupId?t.dstGroupData.getGroupId():t.dstGroupData.groupId,toIndex:t.dstTileIndex,longDrop:s,callBack:function(){d.resolve();}});return d.promise();},_handleConvertDrop:function(t,s,d){var e=sap.ui.getCore().getEventBus(),o=q.Deferred();e.publish("launchpad","convertTile",{toGroupId:t.dstGroupData.getGroupId?t.dstGroupData.getGroupId():t.dstGroupData.groupId,toIndex:t.dstTileIndex,tile:sap.ui.getCore().byId(d.id),srcGroupId:t.srcGroup.getGroupId?t.srcGroup.getGroupId():t.srcGroup.groupId,longDrop:s,callBack:function(){o.resolve();}});return o.promise();},_getTileUuid:function(t){if(t.getUuid){return t.getUuid();}var T=t.getBindingContext().getObject();if(T.getParent){return T.getParent().getUuid();}return T.uuid;},_handleDrag:function(e,d){var t=L.getLayoutEngine().layoutEndCallback(),T=t.tile.getBindingContext().getObject(),m=this.getView().getModel();if(m){m.setProperty("/draggedTileLinkPersonalizationSupported",T.isLinkPersonalizationSupported);}},_handleTabBarItemPressEventHandler:function(s,e,d){var v=this.getView(),m=v.getModel(),g=m.getProperty("/groups"),G=d.iGroupIndex;for(var i=0;i<g.length;i++){m.setProperty("/groups/"+i+"/isGroupSelected",false);}m.setProperty("/groups/"+G+"/isGroupSelected",true);this._handleTabBarItemPress(s,e,G);},_handleTabBarItemPress:function(s,e,g,o){var v=this.getView(),d,f;if(o){d=o.getParameter("group").getIndex();}else{d=g;}sap.ui.getCore().getEventBus().publish("launchpad","tabSelected",{iSelectedGroup:d});f=this._getVisibleGroupIndex(d);v.oDashboardGroupsBox.removeLinksFromUnselectedGroups();v.oDashboardGroupsBox.getBinding("groups").filter([v.oFilterSelectedGroup]);v.oAnchorNavigationBar.setSelectedItemIndex(f);v.oAnchorNavigationBar.reArrangeNavigationBarElements();setTimeout(function(){u.handleTilesVisibility();},0);},_getVisibleGroupIndex:function(s){var g=this.getView().getModel().getProperty("/groups");var h=0;for(var i=0;i<s;i++){if(!g[i].isGroupVisible||!g[i].visibilityModes[0]){h++;}}return s-h;},_getModelGroupFromVisibleIndex:function(s){var g=this.getView().getModel().getProperty("/groups"),v=0;for(var i=0;i<g.length;i++){if(g[i].isGroupVisible&&g[i].visibilityModes[0]){v++;if(v>s){return i;}}}return 0;},_handleAnchorItemPress:function(e){var v=this.getView(),m=v.getModel(),g=m.getProperty("/groups");if(a.system.phone&&e.getParameter("manualPress")){e.oSource.openOverflowPopup();}for(var i=0;i<g.length;i++){if(m.getProperty("/groups/"+i+"/isGroupSelected")===true){m.setProperty("/groups/"+i+"/isGroupSelected",false);}}m.setProperty("/groups/"+e.getParameter("group").getIndex()+"/isGroupSelected",true);m.setProperty("/iSelectedGroup",e.getParameter("group").getIndex());if(m.getProperty("/homePageGroupDisplay")&&m.getProperty("/homePageGroupDisplay")==="tabs"&&!m.getProperty("/tileActionModeActive")){this._handleTabBarItemPress(undefined,undefined,undefined,e);}else{if(!m.getProperty("/tileActionModeActive")){v.oDashboardGroupsBox.getBinding("groups").filter([new F("isGroupVisible",b.EQ,true)]);}else{v.oDashboardGroupsBox.getBinding("groups").filter([]);}this._scrollToGroup("launchpad","scrollToGroup",{group:e.getParameter("group"),groupChanged:true,focus:(e.getParameter("action")==="sapenter")});}},_addGroupHandler:function(d){var i,p=d.getSource().getBindingContext().getPath(),e=p.split("/");i=window.parseInt(e[e.length-1],10);if(d.getSource().sParentAggregationName==="afterContent"){i=i+1;}sap.ui.getCore().getEventBus().publish("launchpad","createGroupAt",{title:"",location:i,isRendered:true});},_publishAsync:function(s,e,d){var B=sap.ui.getCore().getEventBus();window.setTimeout(q.proxy(B.publish,B,s,e,d),1);},_changeGroupVisibility:function(g){var B=g.getPath(),m=g.getModel(),G=m.getProperty(B+"/isGroupVisible");if(m.getProperty(B+"/isDefaultGroup")||m.getProperty(B+"/isGroupLocked")){return;}m.setProperty(B+"/isGroupVisible",!G);},_handleGroupVisibilityChanges:function(s,e,o){var m=this.getView().getModel(),h=sap.ushell.components.getHomepageManager(),d=h.getCurrentHiddenGroupIds(m),S=d.length===o.length,i=S,p;d.some(function(H,I){if(!i){return true;}i=o&&Array.prototype.indexOf.call(o,H)!==-1;return!i;});if(!i){sap.ushell.Container.getServiceAsync("LaunchPage").then(function(l){p=l.hideGroups(d);p.done(function(){m.updateBindings("groups");});p.fail(function(){sap.ushell.Container.getServiceAsync("Message").then(function(f){f.error(r.i18n.getText("hideGroups_error"));});});});}window.setTimeout(function(){u.recalculateBottomSpace();},0);},_updateShellHeader:function(){if(!this.oShellUIService){this._initializeShellUIService();}else{this.oShellUIService.setTitle();this.oShellUIService.setHierarchy();}},_initializeShellUIService:function(){return sap.ui.require(["sap/ushell/ui5service/ShellUIService"],function(S){this.oShellUIService=new S({scopeObject:this.getOwnerComponent(),scopeType:"component"});this.oShellUIService.setTitle();this.oShellUIService.setHierarchy();return this.oShellUIService;}.bind(this));},_deactivateActionModeInTabsState:function(){var v=this.getView(),m=v.getModel(),i;var g=m.getProperty("/groups");for(i=0;i<g.length;i++){m.setProperty("/groups/"+i+"/isGroupSelected",false);}var s=v.oAnchorNavigationBar.getSelectedItemIndex();var h=0;if(!this._isGroupVisible(s)){for(i=0;i<g.length;i++){if(!this._isGroupVisible(i)){h++;}else{s=i;break;}}}else{for(i=0;i<s;i++){if(!this._isGroupVisible(i)){h++;}}}var f=s-h;v.oAnchorNavigationBar.setSelectedItemIndex(f);v.oAnchorNavigationBar.adjustItemSelection();m.setProperty("/groups/"+s+"/isGroupSelected",true);v.oDashboardGroupsBox.removeLinksFromAllGroups();var G=m.getProperty("/homePageGroupDisplay");if(G&&G==="tabs"){v.oDashboardGroupsBox.getBinding("groups").filter([v.oFilterSelectedGroup]);var n=v.oDashboardGroupsBox.getGroups&&v.oDashboardGroupsBox.getGroups();var o=Array.isArray(n)&&n[0];if(o&&o.updateLinks){o.updateLinks();}}},_isGroupVisible:function(g){var G=this.getView().getModel().getProperty("/groups");return(G[g].isGroupVisible&&G[g].visibilityModes[0]);}});});
sap.ui.predefine('sap/ushell/components/homepage/DashboardContent.view',["sap/ui/thirdparty/jquery","sap/m/library","sap/m/Page","sap/ui/core/AccessibleLandmarkRole","sap/ui/core/mvc/View","sap/ui/Device","sap/ui/model/Filter","sap/ushell/components/homepage/DashboardGroupsBox","sap/ushell/Config","sap/ushell/EventHub","sap/ushell/resources","sap/ushell/ui/launchpad/AnchorItem","sap/ushell/ui/launchpad/AnchorNavigationBar","sap/ushell/utils","sap/ui/core/Component","sap/ui/model/FilterOperator","sap/ushell/renderers/fiori2/AccessKeysHandler","sap/m/MessageStrip"],function(q,m,P,A,V,D,F,a,C,E,r,b,c,u,d,e,f,M){"use strict";sap.ui.jsview("sap.ushell.components.homepage.DashboardContent",{createContent:function(o){this.oModel=this.getModel();var g=this.oModel.getProperty("/personalization"),h=this.oModel.getProperty("/enableTileActionsIcon"),H=sap.ushell.components.getHomepageManager?sap.ushell.components.getHomepageManager():undefined;this.isCombi=D.system.combi;this.isTouch=this.isCombi?false:(D.system.phone||D.system.tablet);this.parentComponent=d.getOwnerComponentFor(this);this.addStyleClass("sapUshellDashboardView");this.ieHtml5DnD=g&&H&&H.isIeHtml5DnD();this.oRenderer=sap.ushell.Container.getRenderer("fiori2");this.bIsHomeIntentRootIntent=u.isFlpHomeIntent(this.oRenderer.getShellConfig().rootIntent);sap.ui.getCore().getEventBus().subscribe("launchpad","actionModeInactive",this._handleEditModeChange,this);sap.ui.getCore().getEventBus().subscribe("launchpad","actionModeActive",this._handleEditModeChange,this);sap.ui.getCore().getEventBus().subscribe("launchpad","contentRefresh",this._onDashboardShown,this);sap.ui.getCore().getEventBus().subscribe("launchpad","dashboardModelContentLoaded",this._onDashboardShown,this);this.oDoable=E.once("CoreResourcesComplementLoaded").do(function(){this.oAnchorNavigationBar.setOverflowEnabled(true);if(g||h){sap.ui.require(["sap/ushell/components/homepage/ActionMode"],function(k){k.init(this.oModel);}.bind(this));}if(g){this._createFooter();this._createActionModeButton();}}.bind(this));this.oFilterSelectedGroup=new F("isGroupSelected",e.EQ,true);this.oRenderer.getRouter().getRoute("home").attachMatched(this._onHomeNavigation,this);this.oAnchorNavigationBar=this._getAnchorNavigationBar(o);var p=[];if(C.last("/core/home/gridContainer")){var i=new M({type:"Warning",text:r.i18n.getText("gridModeWarning"),showIcon:true,showCloseButton:true});i.addStyleClass("sapUiMediumMarginBeginEnd");i.addStyleClass("sapUiMediumMarginTopBottom");p.push(i);}var j=new a();this.oDashboardGroupsBox=j.createGroupsBox(o,this.oModel);p.push(this.oDashboardGroupsBox);this.oPage=new P("sapUshellDashboardPage",{customHeader:this.oAnchorNavigationBar,landmarkInfo:{headerRole:A.Navigation,headerLabel:r.i18n.getText("Dashboard.Page.Header.AriaLabel"),contentRole:sap.ui.core.AccessibleLandmarkRole.Region,contentLabel:r.i18n.getText("Dashboard.Page.Content.AriaLabel"),rootRole:A.None},floatingFooter:true,content:p});this.oPage.addEventDelegate({onAfterRendering:function(){var k=this.getDomRef(),s=k.getElementsByTagName("section");q(s[0]).off("scrollstop",o.handleDashboardScroll);q(s[0]).on("scrollstop",o.handleDashboardScroll);}.bind(this)});return this.oPage;},getAnchorItemTemplate:function(){var t=this;var o=new b({index:"{index}",title:"{title}",groupId:"{groupId}",defaultGroup:"{isDefaultGroup}",helpId:"{helpId}",selected:false,isGroupRendered:"{isRendered}",visible:{parts:["/tileActionModeActive","isGroupVisible","visibilityModes"],formatter:function(g,i,v){if(!v[g?1:0]){return false;}return i||g;}},locked:"{isGroupLocked}",isGroupDisabled:{parts:["isGroupLocked","/isInDrag","/homePageGroupDisplay"],formatter:function(i,I,s){return i&&I&&s==="tabs";}},press:function(g){t.oAnchorNavigationBar.handleAnchorItemPress(g);}});o.attachBrowserEvent("focus",function(){this.setNavigationBarItemsVisibility();}.bind(this.oAnchorNavigationBar));return o;},_getAnchorNavigationBar:function(o){var g=new c("anchorNavigationBar",{selectedItemIndex:"{/topGroupInViewPortIndex}",itemPress:[function(h){this._handleAnchorItemPress(h);},o],overflowEnabled:false});if(D.system.desktop){g.addEventDelegate({onBeforeFastNavigationFocus:this._handleBeforeFastNavigationFocus,onsapenter:function(h){h.srcControl.getDomRef().click();},onsapspace:function(h){h.srcControl.getDomRef().click();}});}g.addStyleClass("sapContrastPlus");return g;},_handleBeforeFastNavigationFocus:function(o){if(q(".sapUshellAnchorItem").is(":visible")){o.preventDefault();sap.ushell.components.ComponentKeysHandler.goToSelectedAnchorNavigationItem();}},_actionModeButtonPress:function(){this.oDashboardGroupsBox.getBinding("groups").filter([]);var g=this.oDashboardGroupsBox.getGroups();sap.ushell.components.homepage.ActionMode.toggleActionMode(this.oModel,"Menu Item",g);this._updateAnchorNavigationBarVisibility();if(this.oModel.getProperty("/homePageGroupDisplay")==="tabs"){if(this.oModel.getProperty("/tileActionModeActive")){var G=this.oModel.getProperty("/groups"),s;for(var i=0;i<G.length;i++){if(G[i].isGroupSelected){s=i;break;}}this.getController()._scrollToGroup("launchpad","scrollToGroup",{group:{getGroupId:function(){return G[s].groupId;}},groupChanged:false,focus:true});}else{this.getController()._deactivateActionModeInTabsState();}}},_createActionModeButton:function(){var o={id:"ActionModeBtn",text:r.i18n.getText("activateEditMode"),tooltip:r.i18n.getText("activateEditMode"),icon:"sap-icon://edit",press:this._actionModeButtonPress.bind(this)};var g=this.oRenderer.getShellConfig().moveEditHomePageActionToShellHeader;if(g){this._createActionModeButtonInHeader(o);}else{this._createActionModeButtonInUserMenu(o);}},_createActionModeButtonInHeader:function(o){sap.ui.require(["sap/ushell/ui/shell/ShellHeadItem"],function(S){this.oTileActionsButton=new S(o);if(C.last("/core/extension/enableHelp")){this.oTileActionsButton.addStyleClass("help-id-ActionModeBtn");}if(!this.bIsHomeIntentRootIntent){this.oRenderer.showHeaderEndItem(this.oTileActionsButton.getId(),true);}else{this.oRenderer.showHeaderEndItem(this.oTileActionsButton.getId(),false,["home"]);}}.bind(this));},_createActionModeButtonInUserMenu:function(o){var g={controlType:"sap.ushell.ui.launchpad.ActionItem",oControlProperties:o,bIsVisible:true,aStates:["home"]};if(!this.bIsHomeIntentRootIntent){g.aStates=null;g.bCurrentState=true;}this.oRenderer.addUserAction(g).done(function(h){this.oTileActionsButton=h;if(C.last("/core/extension/enableHelp")){this.oTileActionsButton.addStyleClass("help-id-ActionModeBtn");}}.bind(this));},_handleEditModeChange:function(){if(this.oTileActionsButton){this.oTileActionsButton.toggleStyleClass("sapUshellAcionItemActive");}},_createFooter:function(){sap.ui.require(["sap/m/Bar","sap/m/Button","sap/m/ToolbarSpacer"],function(B,g,T){var o=new B("sapUshellDashboardFooter",{visible:"{/tileActionModeActive}",contentRight:[new T()]});var h=new g("sapUshellDashboardFooterDoneBtn",{type:m.ButtonType.Emphasized,text:r.i18n.getText("closeEditMode"),tooltip:r.i18n.getText("exitEditMode"),press:this._actionModeButtonPress.bind(this)});if(D.system.desktop){h.addEventDelegate({onsapskipforward:function(i){i.preventDefault();f.setIsFocusHandledByAnotherHandler(true);f.sendFocusBackToShell(i);},onsapskipback:function(i){i.preventDefault();f.setIsFocusHandledByAnotherHandler(true);sap.ushell.components.ComponentKeysHandler.goToFirstVisibleTileContainer();},onsaptabprevious:function(i){i.preventDefault();f.setIsFocusHandledByAnotherHandler(true);sap.ushell.components.ComponentKeysHandler.goToFirstVisibleTileContainer();},onsaptabnext:function(i){i.preventDefault();f.setIsFocusHandledByAnotherHandler(true);f.sendFocusBackToShell(i);}});}o.addContentRight(h);this.oPage.setFooter(o);}.bind(this));},_onDashboardShown:function(){var i=this.oRenderer&&this.oRenderer.getCurrentCoreView()==="home";if(i){if(!D.system.phone){this.oRenderer.showRightFloatingContainer(false);}this._updateAnchorNavigationBarVisibility();this.getController().resizeHandler();u.refreshTiles();if(D.system.desktop&&sap.ushell.components.ComponentKeysHandler){sap.ushell.components.ComponentKeysHandler.goToTileContainer();}if(E.last("firstSegmentCompleteLoaded")){E.emit("CloseFesrRecord",Date.now());}}},_onHomeNavigation:function(){this._onDashboardShown();if(!this.bIsHomeIntentRootIntent){if(this.oRenderer.getShellConfig().moveEditHomePageActionToShellHeader){this.oRenderer.showHeaderEndItem(this.oTileActionsButton.getId(),true);}else{this.oRenderer.showActionButton(this.oTileActionsButton.getId(),true);}}},_updateAnchorNavigationBarVisibility:function(){var o=this.oPage.getShowHeader(),g=this.getModel().getObject("/tileActionModeActive"),v=this.getModel().getProperty("/groups").filter(function(j){if(g){return j.isGroupVisible&&j.visibilityModes[1];}else{return j.isGroupVisible&&j.visibilityModes[0];}}),h=v.length>1;this.oPage.setShowHeader(h);if(h&&!o){var G=this.getModel().getProperty("/groups"),s=this.getModel().getProperty("/iSelectedGroup");for(var i=0;i<v.length;i++){if(v[i].getGroupId&&v[i].getGroupId()===G[s].groupId){this.oAnchorNavigationBar.setSelectedItemIndex(i);break;}}}},getControllerName:function(){return"sap.ushell.components.homepage.DashboardContent";},exit:function(){V.prototype.exit.apply(this,arguments);if(this.oAnchorNavigationBar){this.oAnchorNavigationBar.handleExit();this.oAnchorNavigationBar.destroy();}if(this.oTileActionsButton){this.oTileActionsButton.destroy();}if(this.oDoable){this.oDoable.off();}if(this.oDoneBtnLabel){this.oDoneBtnLabel.destroy();}sap.ui.getCore().getEventBus().unsubscribe("launchpad","actionModeInactive",this._handleEditModeChange,this);sap.ui.getCore().getEventBus().unsubscribe("launchpad","actionModeActive",this._handleEditModeChange,this);sap.ui.getCore().getEventBus().unsubscribe("launchpad","contentRefresh",this._onDashboardShown,this);sap.ui.getCore().getEventBus().unsubscribe("launchpad","dashboardModelContentLoaded",this._onDashboardShown,this);}});},false);
sap.ui.predefine('sap/ushell/components/homepage/DashboardGroupsBox',["sap/ushell/Layout","sap/ui/base/Object","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ushell/ui/launchpad/Tile","sap/ushell/ui/launchpad/DashboardGroupsContainer","sap/ushell/Config","sap/ushell/EventHub","sap/ui/core/Component","sap/ui/core/InvisibleMessage","sap/ui/core/library","sap/m/GenericTile","sap/ui/Device","sap/ushell/ui/launchpad/PlusTile","sap/ushell/resources","sap/ushell/ui/launchpad/TileContainer","sap/ushell/ui/launchpad/LinkTileWrapper","sap/m/Button","sap/ushell/ui/launchpad/AccessibilityCustomData","sap/ushell/ui/launchpad/GroupHeaderActions","sap/base/util/isEmptyObject","sap/ui/thirdparty/jquery","sap/ui/performance/Measurement","sap/ushell/renderers/fiori2/AccessKeysHandler"],function(L,b,F,a,c,D,C,E,d,I,e,G,f,P,r,T,g,B,A,h,j,q,M,k){"use strict";var l=e.InvisibleMessageMode;var m=b.extend("sap.ushell.components.homepage.DashboardGroupsBox",{metadata:{publicMethods:["createGroupsBox"]},constructor:function(){if(sap.ushell.components.homepage.getDashboardGroupsBox&&sap.ushell.components.homepage.getDashboardGroupsBox()){return sap.ushell.components.homepage.getDashboardGroupsBox();}sap.ushell.components.homepage.getDashboardGroupsBox=(function(v){return function(){return v;};}(this.getInterface()));this.oController=undefined;this.oGroupsContainer=undefined;this.isLinkPersonalizationSupported=sap.ushell.Container.getService("LaunchPage").isLinkPersonalizationSupported();this._oInvisibleMessageInstance=I.getInstance();sap.ui.getCore().getEventBus().subscribe("launchpad","actionModeActive",this._handleActionModeChange,this);sap.ui.getCore().getEventBus().subscribe("launchpad","actionModeInactive",this._handleActionModeChange,this);sap.ui.getCore().getEventBus().subscribe("launchpad","GroupHeaderVisibility",this._updateGroupHeaderVisibility,this);},destroy:function(){sap.ui.getCore().getEventBus().unsubscribe("launchpad","actionModeActive",this._handleActionModeChange,this);sap.ui.getCore().getEventBus().unsubscribe("launchpad","actionModeInactive",this._handleActionModeChange,this);sap.ui.getCore().getEventBus().unsubscribe("launchpad","GroupHeaderVisibility",this._updateGroupHeaderVisibility,this);if(this.oGroupsContainer){this.oGroupsContainer.destroy();}sap.ushell.components.homepage.getDashboardGroupsBox=undefined;},calculateFilter:function(){var i=[];var o;var s=this.oModel.getProperty("/homePageGroupDisplay"),n=this.oModel.getProperty("/tileActionModeActive");if(!n){if(s&&s==="tabs"){o=new F("isGroupSelected",a.EQ,true);}else{o=new F("isGroupVisible",a.EQ,true);}i.push(o);}return i;},createGroupsBox:function(o,i){this.oController=o;var t=this,n,p,s=function(w){var x,y;if(w&&(x=w.getDomRef())){y=x.querySelector(".sapUshellPlusTile");if(y){return y;}}return null;},u=function(w){var x=s(w.currentGroup),y=s(w.endGroup),z=(w.tiles[w.tiles.length-2]===w.item)||(w.endGroup.getTiles().length===0);if(z){t._hidePlusTile(y);}else{t._showPlusTile(y);}if(w.currentGroup!==w.endGroup){t._showPlusTile(x);}};n=function(){L.getLayoutEngine().setExcludedControl(P);L.getLayoutEngine().setReorderTilesCallback.call(L.layoutEngine,u);};p=function(){if(!L.isInited){L.init({getGroups:this.getGroups.bind(this),getAllGroups:t.getAllGroupsFromModel.bind(t),isTabBarActive:t.isTabBarActive.bind(t)}).done(n);f.media.attachHandler(function(){if(!this.bIsDestroyed){L.reRenderGroupsLayout(null);}},this,f.media.RANGESETS.SAP_STANDARD);var w=this.getDomRef();o.getView().sDashboardGroupsWrapperId=!j(w)&&w.parentNode?w.parentNode.id:"";}E.emit("CenterViewPointContentRendered");sap.ui.getCore().getEventBus().publish("launchpad","contentRendered");sap.ui.getCore().getEventBus().publish("launchpad","contentRefresh");this.getBinding("groups").filter(t.calculateFilter());};this.isTabBarActive=function(){return this.oModel.getProperty("/homePageGroupDisplay")==="tabs";};this.oModel=i;var v=this.calculateFilter(),U=C.last("/core/home/gridContainer");this.oGroupsContainer=new D("dashboardGroups",{displayMode:"{/homePageGroupDisplay}",afterRendering:p});if(U){sap.ui.require(["sap/ushell/ui/launchpad/GridContainer"],function(){t.oGroupsContainer.bindAggregation("groups",{filters:v,path:"/groups",factory:function(){var S=C.last("/core/home/sizeBehavior");var w=t._createGridContainer(o,i);w.setTileSizeBehavior(S);return w;}});});C.on("/core/home/sizeBehavior").do(function(w){t.oGroupsContainer.getAggregation("groups").forEach(function(x){x.setTileSizeBehavior(w);});});}else{this.oGroupsContainer.bindAggregation("groups",{filters:v,path:"/groups",factory:function(){return t._createTileContainer(o,i);}});}if(f.system.desktop){this.oGroupsContainer.addEventDelegate({onBeforeFastNavigationFocus:this._handleBeforeFastNavigationFocus,onsapskipback:this._handleSkip.bind(this,false),onsapskipforward:this._handleSkip.bind(this,true),onsaptabnext:function(w){if(t.oModel.getProperty("/tileActionModeActive")){if(q(document.activeElement).closest(".sapUshellTileContainerHeader").length){var x=q(document.activeElement).closest(".sapUshellTileContainer");var y=q(document.activeElement).hasClass("sapUshellContainerTitle");var z=x.find(".sapUshellHeaderActionButton");if(y&&!z.length||document.activeElement.id===z.last()[0].id){if(x.find(".sapUshellTile, .sapUshellLink, .sapFCard").is(":visible")){w.preventDefault();sap.ushell.components.ComponentKeysHandler.goToLastVisitedTile(x,true);return;}}if(z.length&&document.activeElement.id!==z.last()[0].id){return;}}var H=window.document.getElementById("sapUshellDashboardFooterDoneBtn");if(H){w.preventDefault();H.focus();return;}}w.preventDefault();if(q("#sapUshellFloatingContainerWrapper").is(":visible")&&(w.originalEvent.srcElement.id)!==""){sap.ui.getCore().getEventBus().publish("launchpad","shellFloatingContainerIsAccessible");}else{k.setIsFocusHandledByAnotherHandler(true);k.sendFocusBackToShell(w);}},onsaptabprevious:function(w){k.setIsFocusHandledByAnotherHandler(true);var x=q(":focus");if(t.oModel.getProperty("/tileActionModeActive")&&!x.hasClass("sapUshellTileContainerHeader")){var y=q(document.activeElement);if(y.hasClass("sapUshellTile")||y.hasClass("sapFCard")){w.preventDefault();var z=y.closest(".sapUshellTileContainer");var H=z.find(".sapUshellHeaderActionButton").filter(":visible").last();if(H.length>0){H.focus();}else{z.find(".sapUshellContainerTitle").focus();}}}}});}return this.oGroupsContainer;},_handleSkip:function(i,o){var n=window.document.getElementById("sapUshellDashboardFooterDoneBtn");if(n){if(n===document.activeElement&&!i){o.preventDefault();sap.ushell.components.ComponentKeysHandler.goToTileContainer();}else if(n!==document.activeElement&&i){o.preventDefault();n.focus();}}},_handleBeforeFastNavigationFocus:function(o){o.preventDefault();var i=window.document.getElementById("sapUshellDashboardFooterDoneBtn");if(i&&!o.forward){i.focus();}else{sap.ushell.components.ComponentKeysHandler.goToTileContainer();}},getAllGroupsFromModel:function(){return this.oModel.getProperty("/groups");},_createTileContainer:function(o){var t=this,i=new F("isTileIntentSupported",a.EQ,true),n=new T({headerText:"{title}",showEmptyLinksArea:{parts:["/tileActionModeActive","links/length","isGroupLocked","/isInDrag","/homePageGroupDisplay"],formatter:function(p,s,u,v,w){if(s){return true;}else if(u){return false;}return p||v&&w==="tabs";}},showMobileActions:{parts:["/tileActionModeActive"],formatter:function(p){return p&&!this.getDefaultGroup();}},showIcon:{parts:["/isInDrag","/tileActionModeActive"],formatter:function(p,s){return(this.getIsGroupLocked()&&(p||s));}},deluminate:{parts:["/isInDrag"],formatter:function(p){return this.getIsGroupLocked()&&p;}},transformationError:{parts:["/isInDrag","/draggedTileLinkPersonalizationSupported"],formatter:function(p,s){return p&&!s;}},showBackground:"{/tileActionModeActive}",tooltip:"{title}",tileActionModeActive:"{/tileActionModeActive}",ieHtml5DnD:o.getView().ieHtml5DnD,enableHelp:C.last("/core/extension/enableHelp"),groupId:"{groupId}",defaultGroup:"{isDefaultGroup}",isLastGroup:"{isLastGroup}",isGroupLocked:"{isGroupLocked}",isGroupSelected:"{isGroupSelected}",showHeader:true,showGroupHeader:"{showGroupHeader}",homePageGroupDisplay:"{/homePageGroupDisplay}",editMode:"{editMode}",supportLinkPersonalization:this.isLinkPersonalizationSupported,titleChange:function(p){sap.ui.getCore().getEventBus().publish("launchpad","changeGroupTitle",{groupId:p.getSource().getGroupId(),newTitle:p.getParameter("newTitle")});},showEmptyLinksAreaPlaceHolder:{parts:["links/length","/isInDrag","/homePageGroupDisplay"],formatter:function(p,s,u){return s&&u==="tabs"&&!p;}},showPlaceholder:{parts:["/tileActionModeActive","tiles/length"],formatter:function(p){return p&&!this.getIsGroupLocked();}},visible:{parts:["/tileActionModeActive","isGroupVisible","visibilityModes"],formatter:function(p,s,v){if(!v[p?1:0]){return false;}return s||p;}},hidden:{parts:["/tileActionModeActive","isGroupVisible"],formatter:function(p,s){return p&&!s;}},links:this._getLinkTemplate(),tiles:{path:"tiles",factory:this._itemFactory.bind(this),filters:[i]},add:function(p){t._handleAddTileToGroup(p);}});return n;},_createGridContainer:function(o){var i=sap.ui.require("sap/ushell/ui/launchpad/GridContainer"),n=new F("isTileIntentSupported",a.EQ,true);return new i({groupId:"{groupId}",showHeader:true,defaultGroup:"{isDefaultGroup}",isLastGroup:"{isLastGroup}",headerText:"{title}",showGroupHeader:"{showGroupHeader}",homePageGroupDisplay:"{/homePageGroupDisplay}",visible:{parts:["/tileActionModeActive","isGroupVisible","visibilityModes"],formatter:function(t,p,v){if(!v[t?1:0]){return false;}return p||t;}},isGroupLocked:"{isGroupLocked}",isGroupSelected:"{isGroupSelected}",editMode:"{editMode}",showBackground:"{/tileActionModeActive}",showIcon:{parts:["/isInDrag","/tileActionModeActive"],formatter:function(p,s){return(this.getIsGroupLocked()&&(p||s));}},tileActionModeActive:"{/tileActionModeActive}",supportLinkPersonalization:this.isLinkPersonalizationSupported,ieHtml5DnD:o.getView().ieHtml5DnD,enableHelp:C.last("/core/extension/enableHelp"),showEmptyLinksAreaPlaceHolder:{parts:["links/length","/isInDrag","/homePageGroupDisplay"],formatter:function(p,s,t){return s&&t==="tabs"&&!p;}},showEmptyLinksArea:{parts:["/tileActionModeActive","links/length","isGroupLocked","/isInDrag","/homePageGroupDisplay"],formatter:function(t,p,s,u,v){if(p){return true;}else if(s){return false;}return t||u&&v==="tabs";}},titleChange:function(p){sap.ui.getCore().getEventBus().publish("launchpad","changeGroupTitle",{groupId:p.getSource().getGroupId(),newTitle:p.getParameter("newTitle")});},tooltip:"{title}",links:this._getLinkTemplate(),tiles:{path:"tiles",factory:this._itemFactory.bind(this),filters:[n]}});},_getLinkTemplate:function(){var o=new F("isTileIntentSupported",a.EQ,true);if(!this.isLinkPersonalizationSupported){return{path:"links",templateShareable:true,template:new g({uuid:"{uuid}",tileCatalogId:"{tileCatalogId}",target:"{target}",isLocked:"{isLocked}",tileActionModeActive:"{/tileActionModeActive}",debugInfo:"{debugInfo}",ieHtml5DnD:this.oController.getView().ieHtml5DnD,tileViews:{path:"content",factory:function(i,n){return n.getObject();}},afterRendering:function(i){var n=q(this.getDomRef().getElementsByTagName("a"));n.attr("tabindex",-1);}}),filters:[o]};}return{path:"links",factory:function(i,n){var p=n.getObject().content[0];if(p&&p.bIsDestroyed){p=p.clone();n.getModel().setProperty(n.getPath()+"/content/0",p);}return p;},filters:[o]};},_itemFactory:function(i,o){var t=o.getProperty(o.sPath),n,p,s,u;if(t){if(t.isCard){n=t&&t.content;p=n&&n.length&&n[0];if(p&&p["sap.card"]){u=p;}else if(t.manifest){u={"sap.flp":t.manifest&&t.manifest["sap.flp"],"sap.card":{"type":"List"}};}else{return this._createErrorTile();}sap.ui.getCore().loadLibrary("sap.ui.integration");var v=sap.ui.requireSync("sap/ui/integration/widgets/Card");s=new v({manifest:u});}else{s=this._createTile();}t.controlId=s&&s.getId&&s.getId();}return s;},_createErrorTile:function(){return new c({tileViews:{path:"content",factory:function(){return new G({state:"Failed"});}}});},_createTile:function(){var t=new c({"long":"{long}",isDraggedInTabBarToSourceGroup:"{draggedInTabBarToSourceGroup}",uuid:"{uuid}",tileCatalogId:"{tileCatalogId}",isCustomTile:"{isCustomTile}",target:"{target}",isLocked:"{isLocked}",navigationMode:"{navigationMode}",tileActionModeActive:"{/tileActionModeActive}",showActionsIcon:"{showActionsIcon}",rgba:"{rgba}",debugInfo:"{debugInfo}",ieHtml5DnD:this.oController.getView().ieHtml5DnD,tileViews:{path:"content",factory:function(i,o){return o.getObject();}},coverDivPress:function(o){if(!o.oSource.getBindingContext().getObject().tileIsBeingMoved&&sap.ushell.components.homepage.ActionMode){sap.ushell.components.homepage.ActionMode._openActionsMenu(o);}},showActions:function(o){if(sap.ushell.components.homepage.ActionMode){sap.ushell.components.homepage.ActionMode._openActionsMenu(o);}},deletePress:[this.oController._dashboardDeleteTileHandler,this.oController],press:[this.oController.dashboardTilePress,this.oController]});var v=sap.ui.getCore().byId("viewPortContainer");t.addEventDelegate({onclick:function(){M.start("FLP:DashboardGroupsBox.onclick","Click on tile","FLP");M.start("FLP:OpenApplicationonClick","Open Application","FLP");function i(){M.end("FLP:DashboardGroupsBox.onclick");v.detachAfterNavigate(i);}v.attachAfterNavigate(i);}});return t;},_updateGroupHeaderVisibility:function(){var n=this.oGroupsContainer.getGroups(),o=this.oModel.getProperty("/tileActionModeActive"),p=this.oController.getView().oPage.getShowHeader(),s,v=0;for(var i=0;i<n.length;i++){if(n[i].getProperty("visible")){v++;if(s===undefined){s=i;}else{n[i].setShowGroupHeader(true);}}}if(s!==undefined){var V=o||(v===1&&!p);n[s].setShowGroupHeader(V);}},_handleActionModeChange:function(){var i=this.oModel.getProperty("/tileActionModeActive");if(i){this._addTileContainersContent();}else{L.reRenderGroupsLayout(null);}},_addTileContainersContent:function(){var n=this.oGroupsContainer.getGroups();for(var i=0;i<n.length;i++){var o=n[i];if(!o.getBeforeContent().length){o.addBeforeContent(this._getBeforeContent());}if(!o.getAfterContent().length){o.addAfterContent(this._getAfterContent());}if(!o.getHeaderActions().length){o.addHeaderAction(this._getGroupHeaderAction());}}},_handleAddGroupButtonPress:function(o){this.oController._addGroupHandler(o);this._addTileContainersContent();},_getBeforeContent:function(){var o=new B({icon:"sap-icon://add",text:r.i18n.getText("add_group_at"),visible:"{= !${isGroupLocked} && !${isDefaultGroup} && ${/tileActionModeActive}}",enabled:"{= !${/editTitle}}",press:[this._handleAddGroupButtonPress.bind(this)]});o.addStyleClass("sapUshellAddGroupButton");o.addCustomData(new A({key:"tabindex",value:"-1",writeToDom:true}));return o;},_getAfterContent:function(){var o=new B({icon:"sap-icon://add",text:r.i18n.getText("add_group_at"),visible:"{= ${isLastGroup} && ${/tileActionModeActive}}",enabled:"{= !${/editTitle}}",press:[this._handleAddGroupButtonPress.bind(this)]}).addStyleClass("sapUshellAddGroupButton");o.addStyleClass("sapUshellAddGroupButton");o.addCustomData(new A({key:"tabindex",value:"-1",writeToDom:true}));return o;},_getGroupHeaderAction:function(){return new h({content:this._getHeaderActions(),tileActionModeActive:"{/tileActionModeActive}",isOverflow:"{/isPhoneWidth}"}).addStyleClass("sapUshellOverlayGroupActionPanel");},_getHeaderActions:function(){var H=[];if(C.last("/core/home/gridContainer")){var o=new B({text:r.i18n.getText("AddTileBtn"),visible:"{= !${isGroupLocked}}",enabled:"{= !${/editTitle}}",press:this._handleAddTileToGroup.bind(this)}).addStyleClass("sapUshellHeaderActionButton");if(f.system.phone){o.setIcon("sap-icon://add");}H.push(o);}H.push(new B({text:{path:"isGroupVisible",formatter:function(i){return r.i18n.getText(i?"HideGroupBtn":"ShowGroupBtn");}},icon:{path:"isGroupVisible",formatter:function(i){if(f.system.phone){return i?"sap-icon://hide":"sap-icon://show";}return"";}},visible:"{= ${/enableHideGroups} && !${isGroupLocked} && !${isDefaultGroup}}",enabled:"{= !${/editTitle}}",press:function(i){var s=i.getSource(),n=s.getBindingContext(),p=n.getModel(),t=n.getPath(),v=p.getProperty(t+"/isGroupVisible");var u=sap.ui.getCore().getLibraryResourceBundle("sap.m");this._oInvisibleMessageInstance.announce([r.i18n.getText(v?"Group.nowBeingHidden":"Group.nowBeingShown"),r.i18n.getText("Section.ButtonLabelChanged"),r.i18n.getText(v?"ShowGroupBtn":"HideGroupBtn"),u.getText("ACC_CTR_TYPE_BUTTON")].join(" "),l.Polite);this.oController._changeGroupVisibility(n);}.bind(this)}).addStyleClass("sapUshellHeaderActionButton"));H.push(new B({text:{path:"removable",formatter:function(i){return r.i18n.getText(i?"DeleteGroupBtn":"ResetGroupBtn");}},icon:{path:"removable",formatter:function(i){if(f.system.phone){return i?"sap-icon://delete":"sap-icon://refresh";}return"";}},visible:"{= !${isDefaultGroup}}",enabled:"{= !${/editTitle}}",press:function(i){var s=i.getSource(),n=s.getBindingContext();this.oController._handleGroupDeletion(n);}.bind(this)}).addStyleClass("sapUshellHeaderActionButton"));return H;},_handleAddTileToGroup:function(o){if(document.toDetail){document.toDetail();}d.getOwnerComponentFor(this.oController.getView().parentComponent).getRouter().navTo("appfinder",{"innerHash*":"catalog/"+JSON.stringify({targetGroup:encodeURIComponent(o.getSource().getBindingContext().sPath)})});},_hidePlusTile:function(p){if(p){p.classList.add("sapUshellHidePlusTile");}},_showPlusTile:function(p){if(p){p.classList.remove("sapUshellHidePlusTile");}}});return m;});
sap.ui.predefine('sap/ushell/components/homepage/DashboardUIActions',["sap/ui/base/Object","sap/ushell/Layout","sap/ui/Device","sap/ui/thirdparty/jquery","sap/base/Log"],function(b,L,D,q,a){"use strict";var c=b.extend("sap.ushell.components.homepage.DashboardUIActions",{metadata:{publicMethods:["initializeUIActions"]},constructor:function(){this.aTabBarItemsLocation=[];if(sap.ushell.components.homepage.getDashboardUIActions&&sap.ushell.components.homepage.getDashboardUIActions()){return sap.ushell.components.homepage.getDashboardUIActions();}sap.ushell.components.homepage.getDashboardUIActions=(function(v){return function(){return v;};}(this.getInterface()));this.oTileUIActions=undefined;this.oLinkUIActions=undefined;this.oGroupUIActions=undefined;this.oController=undefined;this.UIActionsInitialized=false;sap.ui.getCore().getEventBus().subscribe("launchpad","actionModeActive",this._enableGroupUIActions,this);sap.ui.getCore().getEventBus().subscribe("launchpad","actionModeInactive",this._disableGroupUIActions,this);},destroy:function(){sap.ui.getCore().getEventBus().unsubscribe("launchpad","actionModeActive",this._enableGroupUIActions,this);sap.ui.getCore().getEventBus().unsubscribe("launchpad","actionModeInactive",this._disableGroupUIActions,this);sap.ushell.components.homepage.getDashboardUIActions=undefined;this.oGroupUIActions=null;this.oTileUIActions=null;this.oLinkUIActions=null;},initializeUIActions:function(C){this.oController=C;if(C.getView().getModel().getProperty("/homePageGroupDisplay")==="tabs"){this._fillTabBarItemsArray();}var i=sap.ushell.Container?sap.ushell.Container.getService("LaunchPage").isLinkPersonalizationSupported():null;var p=q("#sapUshellDashboardPage").width();var d=C.getView().sDashboardGroupsWrapperId,A,r=sap.ui.getCore().getConfiguration().getRTL(),o={containerSelector:"#dashboardGroups",wrapperSelector:d?"#"+d:undefined,rootSelector:"#shell"},e=q.extend(true,{},o,{switchModeDelay:1000,isTouch:C.getView().isTouch,isCombi:C.getView().isCombi,debug:false}),l={draggableSelector:".sapUshellLinkTile",placeHolderClass:"sapUshellLinkTile-placeholder",cloneClass:"sapUshellLinkTile-clone",startCallback:this._handleTileUIStart.bind(this),endCallback:this._handleLinkDrop.bind(this),dragCallback:this._handleStartDragTile.bind(this),onBeforeCreateClone:this._onBeforeCreateLinkClone.bind(this),dragAndScrollCallback:this._handleTileDragMove.bind(this),endDragAndScrollCallback:this._handleTileDragAndScrollContinuation.bind(this),moveTolerance:C.getView().isTouch||C.getView().isCombi?10:3,isLayoutEngine:true,disabledDraggableSelector:"sapUshellLockedTile",onDragStartUIHandler:this._markDisableGroups.bind(this),onDragEndUIHandler:this._endUIHandler.bind(this),offsetLeft:r?p:-p,defaultMouseMoveHandler:function(){}},t={draggableSelector:".sapUshellTile",draggableSelectorExclude:".sapUshellPlusTile",placeHolderClass:"sapUshellTile-placeholder",cloneClass:"sapUshellTile-clone",deltaTop:-44,scrollContainerSelector:undefined,startCallback:this._handleTileUIStart.bind(this),endCallback:this._handleTileDrop.bind(this),dragCallback:this._handleStartDragTile.bind(this),dragAndScrollCallback:this._handleTileDragMove.bind(this),endDragAndScrollCallback:this._handleTileDragAndScrollContinuation.bind(this),moveTolerance:C.getView().isTouch||C.getView().isCombi?10:3,isLayoutEngine:true,disabledDraggableSelector:"sapUshellLockedTile",onDragStartUIHandler:this._markDisableGroups.bind(this),onDragEndUIHandler:this._endUIHandler.bind(this),offsetLeft:r?p:-p,defaultMouseMoveHandler:function(){}},g={draggableSelector:".sapUshellDashboardGroupsContainerItem:not(.sapUshellDisableDragAndDrop)",draggableSelectorBlocker:".sapUshellTilesContainer-sortable, .sapUshellTileContainerBeforeContent, .sapUshellTileContainerAfterContent",draggableSelectorExclude:".sapUshellHeaderActionButton",placeHolderClass:"sapUshellDashboardGroupsContainerItem-placeholder",cloneClass:"sapUshellDashboardGroupsContainerItem-clone",startCallback:this._handleGroupsUIStart.bind(this),endCallback:this._handleGroupDrop.bind(this),dragCallback:this._handleGroupStartDrag.bind(this),moveTolerance:C.getView().isTouch||C.getView().isCombi?10:0.1,isLayoutEngine:false,isVerticalDragOnly:true,draggableElement:".sapUshellTileContainerHeader"},w={type:"tiles",draggableSelector:".sapUshellTile",placeHolderClass:"sapUshellTile-placeholder",cloneClass:"sapUshellTile-clone",startCallback:this._handleTileUIStart.bind(this),endCallback:this._handleTileDrop.bind(this),dragCallback:this._handleStartDragTile.bind(this),dragAndScrollCallback:this._handleTileDragMove.bind(this),onDragStartUIHandler:this._markDisableGroups.bind(this),onDragEndUIHandler:this._endUIHandler.bind(this),offsetLeft:r?p:-p},W={type:"links",draggableSelector:".sapUshellLinkTile",placeHolderClass:"sapUshellLinkTile-placeholder",startCallback:this._handleTileUIStart.bind(this),endCallback:this._handleLinkDrop.bind(this),dragCallback:this._handleStartDragTile.bind(this),dragAndScrollCallback:this._handleTileDragMove.bind(this),onBeforeCreateClone:this._onBeforeCreateLinkClone.bind(this),onDragStartUIHandler:this._markDisableGroups.bind(this),onDragEndUIHandler:this._endUIHandler.bind(this),offsetLeft:r?p:-p},f={type:"groups",draggableSelector:".sapUshellTileContainerHeader",placeHolderClass:"sapUshellDashboardGroupsContainerItem-placeholder",_publishAsync:C._publishAsync};if(C.getView().oDashboardGroupsBox.getGroups().length){if(C.getView().getModel().getProperty("/personalization")){if(!C.getView().ieHtml5DnD){sap.ui.require(["sap/ushell/UIActions"],function(U){this._disableTileUIActions();this._disableGroupUIActions();this._disableLinkUIActions();this.oTileUIActions=new U(q.extend(true,{},e,t)).enable();this.oGroupUIActions=new U(q.extend(true,{},e,g));if(i){this.oLinkUIActions=new U(q.extend(true,{},e,l)).enable();}A=C.getView().getModel().getProperty("/tileActionModeActive");if(A){this.oGroupUIActions.enable();}}.bind(this));}else{sap.ui.require(["sap/ushell/UIActionsWin8"],function(U){this._disableTileUIActions();this._disableGroupUIActions();this._disableLinkUIActions();this.oTileUIActions=U.getInstance(q.extend(true,{},o,w)).enable();this.oLinkUIActions=U.getInstance(q.extend(true,{},o,W)).enable();this.oGroupUIActions=U.getInstance(q.extend(true,{},o,f)).enable();}.bind(this));}}}},_enableGroupUIActions:function(){if(this.oGroupUIActions){this.oGroupUIActions.enable();}},disableAllDashboardUiAction:function(){this._disableTileUIActions();this._disableLinkUIActions();this._disableGroupUIActions();},_disableTileUIActions:function(){if(this.oTileUIActions){this.oTileUIActions.disable();}},_disableLinkUIActions:function(){if(this.oLinkUIActions){this.oLinkUIActions.disable();}},_disableGroupUIActions:function(){if(this.oGroupUIActions){this.oGroupUIActions.disable();}},_handleTileDragMove:function(d){if(!d.isScrolling){L.getLayoutEngine().moveDraggable(d.moveX,d.moveY,this.aTabBarItemsLocation);}},_handleTileDragAndScrollContinuation:function(m){var A=q("#anchorNavigationBar").offset(),i=A?A.top:0;if(m<i){L.getLayoutEngine()._cancelLongDropTimmer();}return L.getLayoutEngine()._isTabBarCollision(m);},_fillTabBarItemsArray:function(){var i=q(".sapUshellAnchorItem"),l=i.length,d,B=10,t=0,T,e=[],I,o,f,n;for(d=0;d<l;d++){I=i[d];o=I.getBoundingClientRect();e[d]=o.width;}for(d=0;d<l;d++){f=e[d];if(f===0){continue;}n=Math.round(f/B);for(T=t;T<t+n;T++){this.aTabBarItemsLocation[T]=d;}t=T;}},_handleTileUIStart:function(e,u){if((D.browser.msie)&&((navigator.msMaxTouchPoints>0)||(navigator.maxTouchPoints>0))){this.titleElement=u.querySelector("[title]");if(this.titleElement){this.titleElement.setAttribute("data-title",this.titleElement.getAttribute("title"));this.titleElement.removeAttribute("title");}}},_preventTextSelection:function(){if(window.getSelection){var s=window.getSelection();try{s.removeAllRanges();}catch(e){}}},_handleStartDragTile:function(e,t){this._preventTextSelection();L.getLayoutEngine().layoutStartCallback(t);L.initDragMode();q(t).find("a").removeAttr("href");this.oController._handleDrag.call(this.oController,e,t);sap.ui.getCore().getEventBus().publish("launchpad","sortableStart");},_onBeforeCreateLinkClone:function(e,d){L.getLayoutEngine().saveLinkBoundingRects(d);},_handleLinkDrop:function(e,t,A){var d=q.Deferred(),p;if(L.isTabBarActive()){L.tabBarTileDropped();}if(A&&A.clone){q(A.clone).css({opacity:0});}if((D.browser.msie)&&((navigator.msMaxTouchPoints>0)||(navigator.maxTouchPoints>0))&&this.titleElement){this.titleElement.setAttribute("title",this.titleElement.getAttribute("data-title"));}if(D.desktop){q("body").removeClass("sapUshellDisableUserSelect");}if(L.getLayoutEngine().isLinkIntersected()||L.getLayoutEngine().isOriginalAreaChanged()){p=this.oController._handleDrop.call(this.oController,e,t);}if(p){p.then(function(){q("#dashboardGroups .sapUshellHidePlusTile").removeClass("sapUshellHidePlusTile");setTimeout(function(){d.resolve();},300);});}else{setTimeout(function(){d.resolve();},0);}return d.promise();},_handleTileDrop:function(e,t,A){if(L.getLayoutEngine().isOriginalAreaChanged()){return this._handleTileToLinkDrop(e,t,A);}return this._handleTileToTileDrop(e,t,A);},_handleTileToLinkDrop:function(e,t,A){return this._handleLinkDrop(e,t,A);},_handleTileToTileDrop:function(e,t,A){var C,h,T,d=function(e,t){L.endDragMode();q("#dashboardGroups .sapUshellHidePlusTile").removeClass("sapUshellHidePlusTile");if((D.browser.msie)&&((navigator.msMaxTouchPoints>0)||(navigator.maxTouchPoints>0))&&this.titleElement){this.titleElement.setAttribute("title",this.titleElement.getAttribute("data-title"));}this.oController._handleDrop.call(this.oController,e,t);if(D.desktop){q("body").removeClass("sapUshellDisableUserSelect");}};h=q(".sapUshellTabBarHoverOn");h.removeClass("sapUshellTabBarHoverOn");T=q(".sapUshellTileDragOpacity");T.removeClass("sapUshellTileDragOpacity");if(L.isTabBarActive()){L.tabBarTileDropped();}var o;if(L.isTabBarActive()&&L.isOnTabBarElement()){if(A&&A.clone){o=q.Deferred();C=q(A.clone);C.css("display","none");setTimeout(function(){o.resolve();d.call(this,e,t);}.bind(this),300);return o.promise();}d.apply(this,arguments);}if(A&&A.clone){o=q.Deferred();C=q(A.clone);var f=A.clone.getBoundingClientRect();var p=t.getBoundingClientRect();var s=C.css("transform").split(",");var g=p.top-f.top;var i=p.left-f.left;var j=parseInt(s[4],10)+i;var k=parseInt(s[5],10)+g;C.css({transform:"translate3d("+j+"px, "+k+"px, 0px)",transition:"transform 300ms cubic-bezier(0.46, 0, 0.44, 1)"});setTimeout(function(){o.resolve();d.call(this,e,t);}.bind(this),300);return o.promise();}setTimeout(function(){d.call(this,e,t);}.bind(this),300);},_getTileTopOffset:function(t,p,d){var i=0,T=i+d;T+=t.closest(".sapUshellDashboardGroupsContainerItem").position().top;T+=p.top;return T;},_markDisableGroups:function(){if(this.oController.getView().getModel()){this.oController.getView().getModel().setProperty("/isInDrag",true);}},_endUIHandler:function(){L.endDragMode();if(this.oController.getView().getModel()){this.oController.getView().getModel().setProperty("/isInDrag",false);}},_handleGroupStartDrag:function(e,u){this.oTileUIActions.disable();if(this.oLinkUIActions){this.oLinkUIActions.disable();}var g=q(".sapUshellDashboardGroupsContainerItem-clone"),d=g.find(".sapUshellContainerTitle"),t=d.height(),f=d.width(),h,i,j,s,r=sap.ui.getCore().getConfiguration().getRTL();if(!D.system.phone){g.find(".sapUshellTileContainerEditMode").offset({top:this.oGroupUIActions.getMove().y-t,left:r?q("#sapUshellDashboardPage").width()+this.oGroupUIActions.getMove().x+f:this.oGroupUIActions.getMove().x-(f/2)});q(".sapUshellTileContainerBeforeContent").addClass("sapUshellTileContainerHidden");}else{q(".sapUshellTilesContainer-sortable").addClass("sapUshellTileContainerRemoveContent");q(".sapUshellLineModeContainer, .sapUshellLinksContainer").addClass("sapUshellTileContainerRemoveContent");q(".sapUshellTileContainerBeforeContent").addClass("sapUshellTileContainerRemoveContent");q(".sapUshellContainerHeaderActions").addClass("sapUshellTileContainerHidden");}q(".sapUshellTileContainerAfterContent").addClass("sapUshellTileContainerRemoveContent");q(u).find(".sapUshellContainerHeaderActions").addClass("sapUshellTileContainerHidden");this.oController.getView().getModel().setProperty("/isInDrag",true);q(u).attr("startPos",q(u).index());a.info("startPos - "+q(u).index());setTimeout(function(){sap.ui.getCore().getEventBus().publish("launchpad","sortableStart");},0);h=q("#dashboardGroups").offset().top;i=q(".sapUshellDashboardGroupsContainerItem-placeholder").offset().top;j=q(".sapUshellDashboardGroupsContainerItem-clone").offset().top;s=i-h-j;q(".sapUshellDashboardView section").css({scrollTop:s});},_handleGroupsUIStart:function(e,u){q(u).find(".sapUshellTileContainerContent").css("outline-color","transparent");},_handleGroupDrop:function(e,u){var B=sap.ui.getCore().getEventBus(),Q=q(u),f=q(Q.children()[0]).attr("id"),g=sap.ui.getCore().byId(f),d=sap.ui.getCore().byId("dashboardGroups"),o={group:g,groupChanged:false,focus:false},n=Q.index();Q.startPos=window.parseInt(Q.attr("startPos"),10);d.removeAggregation("groups",g,true);d.insertAggregation("groups",g,n,true);this._handleGroupMoved(e,{item:Q});Q.removeAttr("startPos");sap.ui.getCore().getEventBus().publish("launchpad","sortableStop");setTimeout(function(){q(".sapUshellContainerHeaderActions").removeClass("sapUshellTileContainerHidden");q(".sapUshellTileContainerBeforeContent").removeClass("sapUshellTileContainerHidden");q(".sapUshellTileContainerBeforeContent").removeClass("sapUshellTileContainerRemoveContent");q(".sapUshellTileContainerAfterContent").removeClass("sapUshellTileContainerRemoveContent");q(".sapUshellTilesContainer-sortable").removeClass("sapUshellTileContainerRemoveContent");q(".sapUshellLineModeContainer, .sapUshellLinksContainer").removeClass("sapUshellTileContainerRemoveContent");},0);window.setTimeout(q.proxy(B.publish,B,"launchpad","scrollToGroup",o),1);this.oTileUIActions.enable();if(this.oLinkUIActions){this.oLinkUIActions.enable();}},_handleGroupMoved:function(e,u){var f=u.item.startPos,t=u.item.index(),m=this.oController.getView().getModel();if(t!==-1){this.oController._publishAsync("launchpad","moveGroup",{fromIndex:f,toIndex:t});setTimeout(function(){m.setProperty("/isInDrag",false);},100);}},_setController:function(C){this.oController=C;}});return c;});
sap.ui.predefine('sap/ushell/components/homepage/FLPAnalytics',["sap/ushell/services/AppConfiguration","sap/base/Log","sap/ui/thirdparty/jquery"],function(A,L,q){"use strict";var o=["deleteTile","actionModeActive","catalogTileClick","dashboardTileClick","dashboardTileLinkClick"],E=sap.ui.getCore().getEventBus(),t=this,l={};function s(c){var m=sap.ushell.services.AppConfiguration.getMetadata();l[c]={};l[c].startTime=new Date();l[c].title=m.title;}function a(c){var d=0;try{d=(new Date()-l[c].startTime)/1000;sap.ushell.Container.getService("UsageAnalytics").logCustomEvent("FLP: Time in Application (sec)",d,[l[c].title]);}catch(e){L.warning("Duration in application "+c+" could not be calculated",null,"sap.ushell.components.homepage.FLPAnalytics");}}function h(c,d,D){var f=hasher.getHash(),g;window.swa.custom1={ref:f};switch(d){case"appOpened":s(f);sap.ushell.Container.getService("UsageAnalytics").logCustomEvent("FLP: Application Opened","Direct Launch",[l[f].title]);E.unsubscribe("sap.ushell","appOpened",h);break;case"bookmarkTileAdded":g=window.document.title;sap.ushell.Container.getService("UsageAnalytics").logCustomEvent("FLP: Personalization","Save as Tile",[g,D&&D.group&&D.group.title?D.group.title:"",D&&D.group&&D.group.id?D.group.id:"",D&&D.tile&&D.tile.title?D.tile.title:g]);break;case"actionModeActive":sap.ushell.Container.getService("UsageAnalytics").logCustomEvent("FLP: Personalization","Enter Action Mode",[D.source]);break;case"catalogTileClick":sap.ushell.Container.getService("UsageAnalytics").logCustomEvent("FLP: Application Launch point","Catalog",[]);break;case"dashboardTileClick":sap.ushell.Container.getService("UsageAnalytics").logCustomEvent("FLP: Application Launch point","Homepage",[]);break;case"dashboardTileLinkClick":sap.ushell.Container.getService("UsageAnalytics").logCustomEvent("FLP: Application Launch point","Tile Group Link",[]);break;default:break;}}function b(c){var f,T,d;if(c.getParameter("from")&&c.getParameter("to")){f=c.getParameter("from").getId().replace("application-","").replace("applicationShellPage-","");window.swa.custom1={ref:f};a(f);d=c.getParameter("to");T=d.getId().replace("application-","").replace("applicationShellPage-","");s(T);window.swa.custom1={ref:T};sap.ushell.Container.getService("UsageAnalytics").logCustomEvent("FLP: Application Opened","Fiori Navigation",[l[T].title]);}}q(window).on("unload",function(c){var d=window.location.hash.substr(1);a(d);});try{sap.ui.getCore().byId("viewPortContainer").attachAfterNavigate(b,t);}catch(e){L.warning("Failure when subscribing to viewPortContainer 'AfterNavigate' event",null,"sap.ushell.components.homepage.FLPAnalytics");}E.subscribe("sap.ushell.services.Bookmark","bookmarkTileAdded",h,t);o.forEach(function(i){E.subscribe("launchpad",i,h,t);});E.subscribe("sap.ushell","appOpened",h,t);},false);
sap.ui.require.preload({
	"sap/ushell/components/homepage/manifest.json":'{"_version":"1.21.0","sap.app":{"id":"sap.ushell.components.homepage","applicationVersion":{"version":"1.88.1"},"i18n":{"bundleUrl":"../../renderers/fiori2/resources/resources.properties","supportedLocales":["","ar","bg","ca","cs","da","de","el","en","en_US","en_US_sappsd","en_US_saptrc","es","et","fi","fr","hi","hr","hu","it","iw","ja","kk","ko","lt","lv","ms","nl","no","pl","pt","ro","ru","sh","sk","sl","sv","th","tr","uk","vi","zh_CN","zh_TW"],"fallbackLocale":"en"},"ach":"CA-FLP-FE-COR","type":"component","title":"{{Component.Homepage.Title}}","resources":"resources.json"},"sap.ui":{"fullWidth":true,"hideLightBackground":true,"technology":"UI5","deviceTypes":{"desktop":true,"tablet":true,"phone":true}},"sap.ui5":{"componentName":"sap.ushell.components.homepage","dependencies":{"minUI5Version":"1.30","libs":{"sap.ui.core":{},"sap.m":{}}},"contentDensities":{"compact":true,"cozy":true}}}'
},"sap/ushell/components/homepage/Component-preload"
);
//# sourceMappingURL=Component-preload.js.map