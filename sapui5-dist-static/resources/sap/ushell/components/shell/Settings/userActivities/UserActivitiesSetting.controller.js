// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/ushell/components/SharedComponentUtils","sap/ushell/Config","sap/base/Log","sap/ushell/resources"],function(C,J,S,a,L,r){"use strict";return C.extend("sap.ushell.components.shell.Settings.userActivities.UserActivitiesSetting",{onInit:function(){var t=a.last("/core/shell/model/enableTrackingActivity")!==undefined?a.last("/core/shell/model/enableTrackingActivity"):true;this.oModel=new J({checkboxIsChecked:t});this.getView().setModel(this.oModel);this.getView().setModel(r.getTranslationModel(),"i18n");},onCancel:function(){var t=a.last("/core/shell/model/enableTrackingActivity")!==undefined?a.last("/core/shell/model/enableTrackingActivity"):true;this.oModel.setProperty("/checkboxIsChecked",t);},onSave:function(){if(a.last("/core/shell/model/enableTrackingActivity")!==this.oModel.getProperty("/checkboxIsChecked")){return this._setTrackingToEnabled(this.oModel.getProperty("/checkboxIsChecked"));}return Promise.resolve();},_setTrackingToEnabled:function(e){var R=sap.ushell.Container.getRenderer("fiori2");return new Promise(function(b,c){S.getPersonalizer("userActivitesTracking",R).setPersData(e).done(function(){a.emit("/core/shell/model/enableTrackingActivity",e);b();}).fail(function(d){L.error("Failed to save the user activities tracking in personalization",d,"sap.ushell.components.ushell.settings.userActivities.UserActivitiesSetting");c();});});},onClearHistory:function(){sap.ushell.Container.getServiceAsync("UserRecents").then(function(s){s.clearRecentActivities();this._showClearHistoryMessageToast();}.bind(this));},_showClearHistoryMessageToast:function(){sap.ui.require(["sap/m/MessageToast"],function(M){var m=r.i18n.getText("historyCleared");M.show(m,{width:"15em",my:"center bottom",at:"center bottom",of:window,offset:"0 -50",collision:"fit fit"});});}});});
