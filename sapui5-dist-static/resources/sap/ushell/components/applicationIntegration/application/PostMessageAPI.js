// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.define(["sap/ushell/utils","sap/ui/core/Popup","sap/ui/core/library","sap/ui/thirdparty/jquery","sap/base/Log","sap/ui/core/UIComponent","sap/ushell/services/AppConfiguration","sap/ushell/ui/footerbar/AddBookmarkButton","sap/ushell/services/_AppState/AppStatePersistencyMethod","sap/ushell/EventHub","sap/ushell/components/applicationIntegration/application/PostMessageAPIInterface","sap/ui/thirdparty/URI","sap/base/util/ObjectPath","sap/ushell/Config","sap/base/util/UriParameters"],function(u,P,c,q,L,U,A,a,b,E,d,f,O,C,g){"use strict";var S="sap.ushell.";var D=new U(),p={};var o={"sap.ushell.services.CrossApplicationNavigation":{oServiceCalls:{"hrefForExternal":{executeServiceCallFn:function(e){return new q.Deferred().resolve(sap.ushell.Container.getService("CrossApplicationNavigation").hrefForExternal(e.oMessageData.body.oArgs)).promise();}},"getSemanticObjectLinks":{executeServiceCallFn:function(e){return sap.ushell.Container.getService("CrossApplicationNavigation").getSemanticObjectLinks(e.oMessageData.body.sSemanticObject,e.oMessageData.body.mParameters,e.oMessageData.body.bIgnoreFormFactors,undefined,undefined,e.oMessageData.body.bCompactIntents);}},"isIntentSupported":{executeServiceCallFn:function(e){return sap.ushell.Container.getService("CrossApplicationNavigation").isIntentSupported(e.oMessageData.body.aIntents);}},"isNavigationSupported":{executeServiceCallFn:function(e){return sap.ushell.Container.getService("CrossApplicationNavigation").isNavigationSupported(e.oMessageData.body.aIntents);}},"backToPreviousApp":{executeServiceCallFn:function(){sap.ushell.Container.getService("CrossApplicationNavigation").backToPreviousApp();return new q.Deferred().resolve().promise();}},"historyBack":{executeServiceCallFn:function(e){sap.ushell.Container.getService("CrossApplicationNavigation").historyBack(e.oMessageData.body.iSteps);return new q.Deferred().resolve().promise();}},"getAppStateData":{executeServiceCallFn:function(e){return sap.ushell.Container.getService("CrossApplicationNavigation").getAppStateData(e.oMessageData.body.sAppStateKey);}},"toExternal":{executeServiceCallFn:function(e){var k=u.clone(e.oMessageData.body.oArgs);u.storeSapSystemToLocalStorage(k);return new q.Deferred().resolve(sap.ushell.Container.getService("CrossApplicationNavigation").toExternal(k)).promise();}},"registerBeforeAppCloseEvent":{executeServiceCallFn:function(e){e.oContainer.setProperty("beforeAppCloseEvent",{enabled:true,params:e.oMessageData.body},true);return new q.Deferred().resolve().promise();}},"expandCompactHash":{executeServiceCallFn:function(e){return sap.ushell.Container.getService("CrossApplicationNavigation").expandCompactHash(e.oMessageData.body.sHashFragment);}},"getDistinctSemanticObjects":{executeServiceCallFn:function(){return sap.ushell.Container.getService("CrossApplicationNavigation").getDistinctSemanticObjects();}},"getLinks":{executeServiceCallFn:function(e){return sap.ushell.Container.getService("CrossApplicationNavigation").getLinks(e.oMessageData.body);}},"getPrimaryIntent":{executeServiceCallFn:function(e){return sap.ushell.Container.getService("CrossApplicationNavigation").getPrimaryIntent(e.oMessageData.body.sSemanticObject,e.oMessageData.body.mParameters);}},"hrefForAppSpecificHash":{executeServiceCallFn:function(e){return sap.ushell.Container.getService("CrossApplicationNavigation").hrefForAppSpecificHash(e.oMessageData.body.sAppHash);}},"isInitialNavigation":{executeServiceCallFn:function(){return sap.ushell.Container.getService("CrossApplicationNavigation").hrefForAppSpecificHash();}},"getAppState":{executeServiceCallFn:function(e){var k=new q.Deferred();sap.ushell.Container.getService("CrossApplicationNavigation").getAppState(D,e.oMessageData.body.sAppStateKey).done(function(l){delete l._oServiceInstance;k.resolve(l);});return k.promise();}},"setInnerAppRoute":{executeServiceCallFn:function(e){var k=sap.ushell.Container.getService("URLParsing"),H=k.parseShellHash(window.hasher.getHash()),n;if(H.appSpecificRoute===e.oMessageData.body.appSpecificRoute){return new q.Deferred().resolve().promise();}H.appSpecificRoute=e.oMessageData.body.appSpecificRoute;n="#"+k.constructShellHash(H);window.hasher.changed.active=false;window.hasher.replaceHash(n);window.hasher.changed.active=true;return new q.Deferred().resolve().promise();}},"setInnerAppStateData":{executeServiceCallFn:function(e){var k=h.prototype._setInnerAppStateData(e);return new q.Deferred().resolve(k).promise();}},"resolveIntent":{executeServiceCallFn:function(e){return sap.ushell.Container.getService("CrossApplicationNavigation").resolveIntent(e.oMessageData.body.sHashFragment);}}}},"sap.ushell.ui5service.ShellUIService":{oServiceCalls:{"setTitle":{executeServiceCallFn:function(e){return new q.Deferred().resolve(e.oContainer.getShellUIService().setTitle(e.oMessageData.body.sTitle)).promise();}},"setBackNavigation":{executeServiceCallFn:function(e){return e.executeSetBackNavigationService(e.oMessage,e.oMessageData);}}}},"sap.ushell.services.ShellUIService":{oServiceCalls:{"setTitle":{executeServiceCallFn:function(e){return new q.Deferred().resolve(e.oContainer.getShellUIService().setTitle(e.oMessageData.body.sTitle)).promise();}},"setHierarchy":{executeServiceCallFn:function(e){return new q.Deferred().resolve(e.oContainer.getShellUIService().setHierarchy(e.oMessageData.body.aHierarchyLevels)).promise();}},"setRelatedApps":{executeServiceCallFn:function(e){return new q.Deferred().resolve(e.oContainer.getShellUIService().setRelatedApps(e.oMessageData.body.aRelatedApps)).promise();}},"setDirtyFlag":{executeServiceCallFn:function(e){sap.ushell.Container.setDirtyFlag(e.oMessageData.body.bIsDirty);return new q.Deferred().resolve().promise();}},"showShellUIBlocker":{executeServiceCallFn:function(e){s(e.oMessageData.body.bShow);return new q.Deferred().resolve().promise();}},"getFLPUrl":{executeServiceCallFn:function(e){var I=false;if(e.oMessageData.body&&e.oMessageData.body.bIncludeHash===true){I=true;}return new q.Deferred().resolve(sap.ushell.Container.getFLPUrl(I)).promise();}},"getShellGroupIDs":{executeServiceCallFn:function(e){return sap.ushell.Container.getService("Bookmark").getShellGroupIDs((e.oMessageData.body?e.oMessageData.body.bGetAll:undefined));}},"addBookmark":{executeServiceCallFn:function(e){return sap.ushell.Container.getService("Bookmark").addBookmarkByGroupId(e.oMessageData.body.oParameters,e.oMessageData.body.groupId);}},"addBookmarkDialog":{executeServiceCallFn:function(e){var k=new a();k.firePress({});return new q.Deferred().resolve().promise();}},"getShellGroupTiles":{executeServiceCallFn:function(e){return sap.ushell.Container.getService("LaunchPage").getTilesByGroupId(e.oMessageData.body.groupId);}},"sendUrlAsEmail":{executeServiceCallFn:function(e){var k=C.last("/core/shellHeader/application").title;var l=(k===undefined)?sap.ushell.resources.i18n.getText("linkToApplication"):sap.ushell.resources.i18n.getText("linkTo")+" '"+k+"'";h.prototype._sendEmail("",l,document.URL,"","",document.URL,true);return new q.Deferred().resolve().promise();}},"sendEmailWithFLPButton":{executeServiceCallFn:function(e){var k=C.last("/core/shellHeader/application").title;var l=(k===undefined)?sap.ushell.resources.i18n.getText("linkToApplication"):sap.ushell.resources.i18n.getText("linkTo")+" '"+k+"'";h.prototype._sendEmail("",l,document.URL,"","",document.URL,e.oMessageData.body.bSetAppStateToPublic);return new q.Deferred().resolve().promise();}},"sendEmail":{executeServiceCallFn:function(e){h.prototype._sendEmail(e.oMessageData.body.sTo,e.oMessageData.body.sSubject,e.oMessageData.body.sBody,e.oMessageData.body.sCc,e.oMessageData.body.sBcc,e.oMessageData.body.sIFrameURL,e.oMessageData.body.bSetAppStateToPublic);}},"processHotKey":{executeServiceCallFn:function(e){var k;try{k=new KeyboardEvent('keydown',e.oMessageData.body);}catch(l){var I=document.createEvent("KeyboardEvent"),m="";if(e.oMessageData.body.altKey){m+="Alt ";}if(e.oMessageData.body.ctrlKey){m+="Control ";}if(e.oMessageData.body.shiftKey){m+="Shift ";}I.initKeyboardEvent("keydown",false,false,null,e.oMessageData.body.key,e.oMessageData.body.keyCode,m,0,false);k=I;}document.dispatchEvent(k);return new q.Deferred().resolve().promise();}}}},"sap.ushell.services.Container":{oServiceCalls:{"setDirtyFlag":{executeServiceCallFn:function(e){sap.ushell.Container.setDirtyFlag(e.oMessageData.body.bIsDirty);return new q.Deferred().resolve().promise();}},"getFLPUrl":{executeServiceCallFn:function(e){var I=false;if(e.oMessageData.body&&e.oMessageData.body.bIncludeHash===true){I=true;}return new q.Deferred().resolve(sap.ushell.Container.getFLPUrl(I)).promise();}},"getFLPConfig":{executeServiceCallFn:function(e){var k=new q.Deferred();sap.ushell.Container.getFLPConfig().then(function(F){k.resolve(F);});return k.promise();}}}},"sap.ushell.services.AppState":{oServiceCalls:{"getAppState":{executeServiceCallFn:function(e){var k=new q.Deferred();sap.ushell.Container.getService("AppState").getAppState(e.oMessageData.body.sKey).done(function(l){delete l._oServiceInstance;k.resolve(l);}).fail(function(l){delete l._oServiceInstance;k.resolve(l);});return k.promise();}},"_saveAppState":{executeServiceCallFn:function(e){return sap.ushell.Container.getService("AppState")._saveAppState(e.oMessageData.body.sKey,e.oMessageData.body.sData,e.oMessageData.body.sAppName,e.oMessageData.body.sComponent,e.oMessageData.body.bTransient,e.oMessageData.body.iPersistencyMethod,e.oMessageData.body.oPersistencySettings);}},"_loadAppState":{executeServiceCallFn:function(e){return sap.ushell.Container.getService("AppState")._loadAppState(e.oMessageData.body.sKey);}},"deleteAppState":{executeServiceCallFn:function(e){return sap.ushell.Container.getService("AppState").deleteAppState(e.oMessageData.body.sKey);}},"makeStatePersistent":function(e){return sap.ushell.Container.getService("AppState").makeStatePersistent(e.oMessageData.body.sKey,e.oMessageData.body.iPersistencyMethod,e.oMessageData.body.oPersistencySettings);}}},"sap.ushell.services.Bookmark":{oServiceCalls:{"addBookmarkUI5":{executeServiceCallFn:function(e){return sap.ushell.Container.getService("Bookmark").addBookmark(e.oMessageData.body.oParameters,e.oMessageData.body.vContainer);}},"addBookmark":{executeServiceCallFn:function(e){return sap.ushell.Container.getService("Bookmark").addBookmarkByGroupId(e.oMessageData.body.oParameters,e.oMessageData.body.groupId);}},"getShellGroupIDs":{executeServiceCallFn:function(){return sap.ushell.Container.getService("Bookmark").getShellGroupIDs();}},"addCatalogTileToGroup":{executeServiceCallFn:function(e){return sap.ushell.Container.getService("Bookmark").addCatalogTileToGroup(e.oMessageData.body.sCatalogTileId,e.oMessageData.body.sGroupId,e.oMessageData.body.oCatalogData);}},"countBookmarks":{executeServiceCallFn:function(e){return sap.ushell.Container.getService("Bookmark").countBookmarks(e.oMessageData.body.sUrl);}},"deleteBookmarks":{executeServiceCallFn:function(e){return sap.ushell.Container.getService("Bookmark").deleteBookmarks(e.oMessageData.body.sUrl);}},"updateBookmarks":{executeServiceCallFn:function(e){return sap.ushell.Container.getService("Bookmark").updateBookmarks(e.oMessageData.body.sUrl,e.oMessageData.body.oParameters);}},"getContentNodes":{executeServiceCallFn:function(){var e=q.Deferred();sap.ushell.Container.getService("Bookmark").getContentNodes().then(function(n){e.resolve(n);});return e.promise();}},"addCustomBookmark":{executeServiceCallFn:function(e){var k=q.Deferred();sap.ushell.Container.getService("Bookmark").addCustomBookmark(e.oMessageData.body.sVizType,e.oMessageData.body.oConfig,e.oMessageData.body.vContentNodes).then(function(){k.resolve();});return k.promise();}},"countCustomBookmarks":{executeServiceCallFn:function(e){var k=q.Deferred();sap.ushell.Container.getService("Bookmark").countCustomBookmarks(e.oMessageData.body.oIdentifier).then(function(l){k.resolve(l);});return k.promise();}},"updateCustomBookmarks":{executeServiceCallFn:function(e){var k=q.Deferred();sap.ushell.Container.getService("Bookmark").updateCustomBookmarks(e.oMessageData.body.oIdentifier,e.oMessageData.body.oConfig).then(function(l){k.resolve(l);});return k.promise();}},"deleteCustomBookmarks":{executeServiceCallFn:function(e){var k=q.Deferred();sap.ushell.Container.getService("Bookmark").deleteCustomBookmarks(e.oMessageData.body.oIdentifier).then(function(l){k.resolve(l);});return k.promise();}}}},"sap.ushell.services.AppLifeCycle":{oServiceCalls:{"getFullyQualifiedXhrUrl":{executeServiceCallFn:function(e){var r="",x="",k=new q.Deferred(),l=e.oMessageData.body.path;if(l!=""&&l!=undefined&&l!=null){sap.ushell.Container.getService("AppLifeCycle").getCurrentApplication().getSystemContext().then(function(m){x=m.getFullyQualifiedXhrUrl(l);var H="",n="",t="",F=sap.ushell.Container.getFLPUrl(true),v=new f(F);if(v.protocol()!=null&&v.protocol()!=undefined&&v.protocol()!=""){n=v.protocol()+"://";}if(v.hostname()!=null&&v.hostname()!=undefined&&v.hostname()!=""){H=v.hostname();}if(v.port()!=null&&v.port()!=undefined&&v.port()!=""){t=":"+v.port();}r=n+H+t+x;k.resolve(r);});}return k.promise();}},"getSystemAlias":{executeServiceCallFn:function(e){var k=e.oContainer.getSystemAlias();if(k===null||k===undefined){k="";}return new q.Deferred().resolve(k).promise();}}}},"sap.ushell.services.AppConfiguration":{oServiceCalls:{"setApplicationFullWidth":{executeServiceCallFn:function(e){A.setApplicationFullWidth(e.oMessageData.body.bValue);return new q.Deferred().resolve().promise();}}}},"sap.ushell.appRuntime":{oRequestCalls:{"innerAppRouteChange":{isActiveOnly:true,distributionType:["all"]},"hashChange":{isActiveOnly:true,distributionType:["URL"]},"setDirtyFlag":{isActiveOnly:true,distributionType:["URL"]},"themeChange":{isActiveOnly:false,distributionType:["all"]},"uiDensityChange":{isActiveOnly:false,distributionType:["all"]}},oServiceCalls:{"hashChange":{executeServiceCallFn:function(e){window.hasher.disableBlueBoxHashChangeTrigger=true;window.hasher.replaceHash(e.oMessageData.body.newHash);window.hasher.disableBlueBoxHashChangeTrigger=false;return new q.Deferred().resolve().promise();}}}},"sap.ushell.services.UserInfo":{oServiceCalls:{"getThemeList":{executeServiceCallFn:function(e){return sap.ushell.Container.getService("UserInfo").getThemeList();}},"openThemeManager":{executeServiceCallFn:function(e){E.emit("openThemeManager",Date.now());return new q.Deferred().resolve().promise();}}}},"sap.ushell.services.ShellNavigation":{oServiceCalls:{"toExternal":{executeServiceCallFn:function(e){sap.ushell.Container.getService("ShellNavigation").toExternal(e.oMessageData.body.oArgs,undefined,e.oMessageData.body.bWriteHistory);return new q.Deferred().resolve().promise();}},"toAppHash":{executeServiceCallFn:function(e){sap.ushell.Container.getService("ShellNavigation").toAppHash(e.oMessageData.body.sAppHash,e.oMessageData.body.bWriteHistory);return new q.Deferred().resolve().promise();}}}},"sap.ushell.services.NavTargetResolution":{oServiceCalls:{"getDistinctSemanticObjects":{executeServiceCallFn:function(){return sap.ushell.Container.getService("NavTargetResolution").getDistinctSemanticObjects();}},"expandCompactHash":{executeServiceCallFn:function(e){return sap.ushell.Container.getService("NavTargetResolution").expandCompactHash(e.oMessageData.body.sHashFragment);}},"resolveHashFragment":{executeServiceCallFn:function(e){return sap.ushell.Container.getService("NavTargetResolution").resolveHashFragment(e.oMessageData.body.sHashFragment);}},"isNavigationSupported":{executeServiceCallFn:function(e){return sap.ushell.Container.getService("NavTargetResolution").isNavigationSupported(e.oMessageData.body.aIntents);}}}},"sap.ushell.services.Renderer":{oServiceCalls:{"addHeaderItem":{executeServiceCallFn:function(e){j("addHeaderItem",e);return new q.Deferred().resolve().promise();}},"addHeaderEndItem":{executeServiceCallFn:function(e){j("addHeaderEndItem",e);return new q.Deferred().resolve().promise();}},"showHeaderItem":{executeServiceCallFn:function(e){sap.ushell.Container.getRenderer("fiori2").showHeaderItem(e.oMessageData.body.aIds,e.oMessageData.body.bCurrentState||true,e.oMessageData.body.aStates);return new q.Deferred().resolve().promise();}},"showHeaderEndItem":{executeServiceCallFn:function(e){sap.ushell.Container.getRenderer("fiori2").showHeaderEndItem(e.oMessageData.body.aIds,e.oMessageData.body.bCurrentState||true,e.oMessageData.body.aStates);return new q.Deferred().resolve().promise();}},"hideHeaderItem":{executeServiceCallFn:function(e){sap.ushell.Container.getRenderer("fiori2").hideHeaderItem(e.oMessageData.body.aIds,e.oMessageData.body.bCurrentState||true,e.oMessageData.body.aStates);return new q.Deferred().resolve().promise();}},"hideHeaderEndItem":{executeServiceCallFn:function(e){sap.ushell.Container.getRenderer("fiori2").hideHeaderEndItem(e.oMessageData.body.aIds,e.oMessageData.body.bCurrentState||true,e.oMessageData.body.aStates);return new q.Deferred().resolve().promise();}},"setHeaderTitle":{executeServiceCallFn:function(e){sap.ushell.Container.getRenderer("fiori2").setHeaderTitle(e.oMessageData.body.sTitle);return new q.Deferred().resolve().promise();}},"setHeaderVisibility":{executeServiceCallFn:function(e){sap.ushell.Container.getRenderer("fiori2").setHeaderVisibility(e.oMessageData.body.bVisible,e.oMessageData.body.bCurrentState||true,e.oMessageData.body.aStates);return new q.Deferred().resolve().promise();}},"createShellHeadItem":{executeServiceCallFn:function(e){var k=e.oMessageData.body.params;k.press=function(){e.oContainer.postMessageRequest("sap.ushell.appRuntime.buttonClick",{buttonId:k.id});};new sap.ushell.ui.shell.ShellHeadItem(k);return new q.Deferred().resolve().promise();}},"showActionButton":{executeServiceCallFn:function(e){sap.ushell.Container.getRenderer("fiori2").showActionButton(e.oMessageData.body.aIds,e.oMessageData.body.bCurrentState,e.oMessageData.body.aStates);return new q.Deferred().resolve().promise();}},"hideActionButton":{executeServiceCallFn:function(e){sap.ushell.Container.getRenderer("fiori2").hideActionButton(e.oMessageData.body.aIds,e.oMessageData.body.bCurrentState,e.oMessageData.body.aStates);return new q.Deferred().resolve().promise();}},"addUserAction":{executeServiceCallFn:function(e){e.oMessageData.body.oParameters.oControlProperties.press=function(){e.oContainer.postMessageRequest("sap.ushell.appRuntime.buttonClick",{buttonId:e.oMessageData.body.oParameters.oControlProperties.id});};sap.ushell.Container.getRenderer("fiori2").addUserAction(e.oMessageData.body.oParameters);return new q.Deferred().resolve().promise();}},"addOptionsActionSheetButton":{executeServiceCallFn:function(e){new sap.m.Button({id:e.oMessageData.body.id,text:e.oMessageData.body.text,icon:e.oMessageData.body.icon,tooltip:e.oMessageData.tooltip,press:function(){e.oContainer.postMessageRequest("sap.ushell.appRuntime.buttonClick",{buttonId:e.oMessageData.body.id});}});sap.ushell.Container.getRenderer("fiori2").showActionButton([e.oMessageData.body.id],false,e.oMessageData.body.aStates);return new q.Deferred().resolve().promise();}},"removeOptionsActionSheetButton":{executeServiceCallFn:function(e){var B=sap.ui.getCore().byId(e.oMessageData.body.id);sap.ushell.Container.getRenderer("fiori2").hideActionButton(e.oMessageData.body.id,false,e.oMessageData.body.aStates);B.destroy();return new q.Deferred().resolve().promise();}}}},"sap.ushell.services.LaunchPage":{oServiceCalls:{"getGroupsForBookmarks":{executeServiceCallFn:function(){return sap.ushell.Container.getService("LaunchPage").getGroupsForBookmarks();}}}}};function h(){this._getBrowserURL=function(){return document.URL;};Object.keys(o).forEach(function(k){if(k.indexOf(S)!=0){throw new Error("All Post Message APIs must start with '"+S+"' - "+k);}});d.init(true,h.prototype.registerShellCommunicationHandler.bind(this));}h.prototype.getAPIs=function(){return o;};function i(k,e){var l=o[k],n;if(l){if(e.oServiceCalls){Object.keys(e.oServiceCalls).forEach(function(m){l.oServiceCalls[m]=e.oServiceCalls[m];});}if(e.oRequestCalls){Object.keys(e.oRequestCalls).forEach(function(m){l.oRequestCalls[m]=e.oRequestCalls[m];});}return;}n={oRequestCalls:{},oServiceCalls:{}};if(e.oServiceCalls){Object.keys(e.oServiceCalls).forEach(function(m){n.oServiceCalls[m]=e.oServiceCalls[m];});}if(e.oRequestCalls){Object.keys(e.oRequestCalls).forEach(function(m){n.oRequestCalls[m]=e.oRequestCalls[m];});}o[k]=n;}h.prototype._getPostMesageInterface=function(e,I){var k,l=this.getAPIs();if(l[e]){k=l[e];if(k&&k.oRequestCalls&&k.oRequestCalls[I]){return k.oRequestCalls[I];}}return undefined;};h.prototype.registerShellCommunicationHandler=function(e){Object.keys(e).forEach(function(k){i(k,e[k]);});};h.prototype.isActiveOnly=function(e,I){var k=this._getPostMesageInterface(e,I);if(k){return k.isActiveOnly;}return undefined;};h.prototype.getResponseHandler=function(e,I){var k=this._getPostMesageInterface(e,I);if(k){return k.fnResponseHandler;}return undefined;};h.prototype._createNewInnerAppState=function(k){var l=sap.ushell.Container.getService("AppState"),n,H,m,N,v;n=l.createEmptyAppState(undefined,false);if(k.oMessageData.body.sData!==undefined){try{v=JSON.parse(k.oMessageData.body.sData);}catch(e){v=k.oMessageData.body.sData;}}else{v="";}n.setData(v);n.save();N=n.getKey();H=window.hasher.getHash();if(H.indexOf("&/")>0){if(H.indexOf("sap-iapp-state=")>0){m=/(?:sap-iapp-state=)([^&/]+)/.exec(H)[1];H=H.replace(m,N);}else{H=H+"/sap-iapp-state="+N;}}else{H=H+"&/sap-iapp-state="+N;}window.hasher.changed.active=false;window.hasher.replaceHash(H);window.hasher.changed.active=true;return N;};h.prototype._setInnerAppStateData=function(e){return h.prototype._createNewInnerAppState(e);};function s(e){if(e===true&&p.oDlg===undefined){if(q("#canvas")&&q("#canvas").hasClass("sapUshellShellBG")){q("#canvas").removeClass("sapUshellShellBG");p.bClassRemoved=true;}p.oDlg=new P();p.oDlg.setShadow(true);p.oDlg.setModal(true,"sapMDialogBlockLayerInit");p.oDlg.setNavigationMode("SCOPE");p.oDlg.eOpenState=c.OpenState.OPEN;q("#shell-cntnt").css("zIndex",40);p.oDlg._iZIndex=30;p.oDlg._duringOpen();}else if(e===false&&p.oDlg!==undefined){p.oDlg._oLastPosition=p.oDlg._oDefaultPosition;p.oDlg.destroy();if(p.bClassRemoved===true){q("#canvas").addClass("sapUshellShellBG");}p.oDlg=undefined;p.bClassRemoved=false;q("#shell-cntnt").css("zIndex","auto");}}function j(e,k){sap.ushell.Container.getRenderer("fiori2")[e]("sap.ushell.ui.shell.ShellHeadItem",{id:k.oMessageData.body.sId,tooltip:k.oMessageData.body.sTooltip,icon:k.oMessageData.body.sIcon,press:function(){k.oContainer.postMessageRequest("sap.ushell.appRuntime.buttonClick",{buttonId:k.oMessageData.body.sId});}},k.oMessageData.body.bVisible,k.oMessageData.body.bCurrentState||true,k.oMessageData.body.aStates);}h.prototype._sendEmail=function(t,e,B,k,l,I,m){var F=this._getBrowserURL();function r(I,F){if(I&&I.length>0&&((e&&e.includes(I))||(B&&B.includes(I)))){if(B&&B.includes(I)){B=B.replace(I,F);}if(e&&e.includes(I)){e=e.replace(I,F);}}}if(m){sap.ushell.Container.getService("AppState").setAppStateToPublic(I).done(function(n,x,v,X,w){if(X!==undefined){F=F.replace(x,X);}if(w!==undefined){F=F.replace(v,w);}r(I,F);sap.m.URLHelper.triggerEmail(t,e,B,k,l);}).fail(L.error);}else{r(I,F);sap.m.URLHelper.triggerEmail(t,e,B,k,l);}};return new h();},false);
