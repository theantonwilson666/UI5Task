//@ui5-bundle sap/ushell/components/pages/Component-preload.js
//Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.predefine('sap/ushell/components/pages/ActionMode',["sap/ui/core/library","sap/m/MessageBox","sap/m/MessageToast","sap/ushell/resources","sap/ushell/EventHub","sap/base/Log","sap/ushell/renderers/fiori2/AccessKeysHandler"],function(c,M,a,r,E,L,A){"use strict";var b={};b.start=function(C){this.oController=C;C.getView().getModel("viewSettings").setProperty("/actionModeActive",true);E.emit("enableMenuBarNavigation",false);var o=sap.ui.getCore().byId("ActionModeBtn");var s=r.i18n.getText("PageRuntime.EditMode.Exit");o.setTooltip(s);o.setText(s);A.attachEvent("editModeDone",this.save,this);};b.cancel=function(){this._cleanup();};b.save=function(){L.info("store actions in pages service");this._cleanup();};b._cleanup=function(){this.oController.getView().getModel("viewSettings").setProperty("/actionModeActive",false);E.emit("enableMenuBarNavigation",true);var o=sap.ui.getCore().byId("ActionModeBtn");var s=r.i18n.getText("PageRuntime.EditMode.Activate");o.setTooltip(s);o.setText(s);A.detachEvent("editModeDone",this.save,this);};b.addVisualization=function(e,s){var m=s.getBindingContext().getModel();var p=s.getBindingContext().getPath();var P=p.split("/");var i=parseInt(P[2],10);var d=m.getProperty("/pages/"+i+"/id");var S=m.getProperty(p+"/id");sap.ushell.Container.getServiceAsync("CrossApplicationNavigation").then(function(C){var f="Shell-appfinder?&/catalog/"+JSON.stringify({pageID:encodeURIComponent(d),sectionID:encodeURIComponent(S)});C.toExternal({target:{shellHash:f}});});};b.addSection=function(e,s,p){var S=p.index;var P=s.getBindingContext().getPath();var d=P.split("/");var i=parseInt(d[2],10);return this.oController.getOwnerComponent().getPagesService().then(function(o){o.addSection(i,S);var D={onAfterRendering:function(){setTimeout(function(){s.getSections()[S].byId("title-edit").focus();},0);s.removeEventDelegate(D);}};s.addEventDelegate(D);});};b.deleteSection=function(e,s){return sap.ushell.Container.getServiceAsync("Message").then(function(m){var t=s.getTitle();var d=t?r.i18n.getText("PageRuntime.Message.Section.Delete",t):r.i18n.getText("PageRuntime.Message.Section.DeleteNoTitle");var f=r.i18n.getText("PageRuntime.Dialog.Title.Delete");function C(o){if(o===M.Action.DELETE){this.oController.getOwnerComponent().getPagesService().then(function(p){var P=s.getBindingContext().getPath(),g=s.getParent(),h=P.split("/"),i=parseInt(h[2],10),S=parseInt(h[4],10);p.deleteSection(i,S);a.show(r.i18n.getText("PageRuntime.MessageToast.SectionDeleted"));var j=g.getSections();if(j.length){var k=j[S!==0?S-1:S];k.focus();var l={onAfterRendering:function(){k.focus();k.removeEventDelegate(l);}};k.addEventDelegate(l);}else{var n={onAfterRendering:function(){g.focus();g.removeEventDelegate(n);}};g.addEventDelegate(n);}});}}m.confirm(d,C.bind(this),f,[M.Action.DELETE,M.Action.CANCEL]);}.bind(this));};b.resetSection=function(e,s){var p=s.getBindingContext().getPath();var P=p.split("/");var i=parseInt(P[2],10);var S=parseInt(P[4],10);return this.oController.getOwnerComponent().getPagesService().then(function(o){o.resetSection(i,S);a.show(r.i18n.getText("PageRuntime.MessageToast.SectionReset"));});};b.changeSectionTitle=function(e,s,p){var P=s.getBindingContext().getPath();var n=s.getProperty("title");var d=P.split("/");var i=parseInt(d[2],10);var S=parseInt(d[4],10);return this.oController.getOwnerComponent().getPagesService().then(function(o){o.renameSection(i,S,n);});};b.moveSection=function(e,s,p){var S=p.draggedControl.getBindingContext().getPath();var t=p.droppedControl.getBindingContext().getPath();var d=p.dropPosition;var T=t.split("/");var f=S.split("/");var P=parseInt(f[2],10);var i=parseInt(f[4],10);var g=parseInt(T[4],10);if(i===g-1&&d==="Before"||i===g+1&&d==="After"){return Promise.resolve();}if(d==="After"){g=g+1;}var C=this.oController.getOwnerComponent();return C.getPagesService().then(function(o){return o.moveSection(P,i,g);}).then(function(){s.announceMove();});};b.changeSectionVisibility=function(e,s,p){if(this.oController===undefined||p.visible===undefined){return Promise.resolve();}var P=s.getBindingContext().getPath();var v=p.visible;var d=P.split("/");var i=parseInt(d[2],10);var S=parseInt(d[4],10);return this.oController.getOwnerComponent().getPagesService().then(function(o){o.setSectionVisibility(i,S,v);});};return b;});
sap.ui.predefine('sap/ushell/components/pages/Component',["sap/ui/core/InvisibleMessage","sap/ui/core/UIComponent","sap/ushell/components/SharedComponentUtils","sap/ushell/resources"],function(I,U,S,r){"use strict";return U.extend("sap.ushell.components.pages.Component",{metadata:{manifest:"json",library:"sap.ushell"},init:function(){U.prototype.init.apply(this,arguments);S.toggleUserActivityLog();S.getEffectiveHomepageSetting("/core/home/sizeBehavior","/core/home/sizeBehaviorConfigurable");this.setModel(r.i18nModel,"i18n");this._oPagesService=sap.ushell.Container.getServiceAsync("Pages");this._oInvisibleMessageInstance=I.getInstance();},getPagesService:function(){return this._oPagesService;},getInvisibleMessageInstance:function(){return this._oInvisibleMessageInstance;},getComponentData:function(){return{};}});});
sap.ui.predefine('sap/ushell/components/pages/StateManager',["sap/ushell/utils","sap/ushell/EventHub"],function(S,E){"use strict";var a={};a.init=function(p,b){this.oPagesVisibility={};this.oPagesRuntimeNavContainer=p;this.oPagesNavContainer=b;this._oURLParsingService=sap.ushell.Container.getServiceAsync("URLParsing");this.oPagesRuntimeNavContainer.attachNavigate(this._onErrorPageNavigated,this);this.oPagesNavContainer.attachNavigate(this._onPageNavigated,this);this._onTabNavigatedBind=this._onTabNavigated.bind(this);document.addEventListener("visibilitychange",this._onTabNavigatedBind);this.oEventBus=sap.ui.getCore().getEventBus();this.oEventBus.subscribe("launchpad","setConnectionToServer",this._onEnableRequests,this);this.oEventBus.subscribe("sap.ushell","navigated",this._onShellNavigated,this);this.oEventHubListener=E.once("PagesRuntimeRendered").do(function(){this._setCurrentPageVisibility(true);}.bind(this));};a._onEnableRequests=function(c,e,d){if(!d||d.active===undefined){return;}this._setCurrentPageVisibility(d.active);};a._setCurrentPageVisibility=function(v,r,n){if(this.oPagesRuntimeNavContainer.getCurrentPage().isA("sap.m.MessagePage")&&!n){return;}var c=this.oPagesNavContainer.getCurrentPage();if(c){this._setPageVisibility(c,v,r);}};a._setPageVisibility=function(p,v,r){if(!p){return;}var P=p.getBindingContext().getPath();this.oPagesVisibility[P]=v;this._visitVisualizations(p,function(b){b.setActive(v,r);});};a._visitVisualizations=function(p,v){if(!v){return;}p.getContent()[0].getSections().forEach(function(s){s.getVisualizations().forEach(v);});};a._onShellNavigated=function(){return this._oURLParsingService.then(function(u){var h=window.hasher.getHash();var H=u.parseShellHash(h);if(h==="Shell-home"||(H.semanticObject==="Launchpad"&&H.action==="openFLPPage")){this._setCurrentPageVisibility(true,true);}else{this._setCurrentPageVisibility(false,false);}}.bind(this));};a._onTabNavigated=function(){return this._oURLParsingService.then(function(u){var h=window.hasher.getHash();var H=u.parseShellHash(h);if(h==="Shell-home"||(H.semanticObject==="Launchpad"&&H.action==="openFLPPage")){this._setCurrentPageVisibility(!document.hidden);}}.bind(this));};a._onPageNavigated=function(e){var p=e.getParameters();this._setPageVisibility(p.from,false,false);this._setPageVisibility(p.to,true,true);};a._onErrorPageNavigated=function(e){var t=e.getParameter("to");this._setCurrentPageVisibility(!t.isA("sap.m.MessagePage"),undefined,true);};a.getPageVisibility=function(p){return this.oPagesVisibility[p];};a.exit=function(){this.oEventBus.unsubscribe("sap.ushell","navigated",this._onPageNavigated,this);document.removeEventListener("visibilitychange",this._onTabNavigatedBind);this.oPagesNavContainer.detachNavigate(this._onPageNavigated,this);this.oPagesRuntimeNavContainer.detachNavigate(this._onErrorPageNavigated,this);this.oEventBus.unsubscribe("launchpad","setConnectionToServer",this._onEnableRequests,this);this.oEventHubListener.off();};return a;});
sap.ui.predefine('sap/ushell/components/pages/controller/PageRuntime.controller',["sap/ui/core/library","sap/ushell/library","sap/ui/core/mvc/Controller","sap/ui/events/KeyCodes","sap/m/GenericTile","sap/ushell/resources","sap/ui/model/json/JSONModel","sap/ushell/Config","sap/m/library","sap/m/MessageToast","sap/ushell/components/pages/StateManager","sap/ushell/EventHub","sap/ushell/utils","sap/m/Button","sap/base/strings/capitalize","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(c,u,C,K,G,r,J,a,l,M,s,E,U,B,b,F,d){"use strict";var I=c.InvisibleMessageMode;var L=l.LoadState;var D=u.DisplayFormat;return C.extend("sap.ushell.components.pages.controller.Pages",{onInit:function(){var p=a.last("/core/shell/enablePersonalization");this._oVisualizationInstantiationServicePromise=sap.ushell.Container.getServiceAsync("VisualizationInstantiation");this._oURLParsingService=sap.ushell.Container.getServiceAsync("URLParsing");this._oViewSettingsModel=new J({sizeBehavior:a.last("/core/home/sizeBehavior"),actionModeActive:false,showHideButton:a.last("/core/catalog/enableHideGroups"),personalizationEnabled:p,showPageTitle:false});this.getView().setModel(this._oViewSettingsModel,"viewSettings");this._aConfigListeners=a.on("/core/home/sizeBehavior").do(function(S){this._oViewSettingsModel.setProperty("/sizeBehavior",S);}.bind(this));this._oErrorPageModel=new J({icon:"sap-icon://documents",text:"",description:"",details:""});this.getView().setModel(this._oErrorPageModel,"errorPage");this.oInitFinishedPromise=Promise.all([this._oVisualizationInstantiationServicePromise,this.getOwnerComponent().getPagesService()]).then(function(S){this._oVisualizationInstantiationService=S[0];this.getView().setModel(S[1].getModel());}.bind(this));this.sCurrentTargetPageId="";this._openFLPPage();var R=sap.ushell.Container.getRenderer();this.oContainerRouter=R.getRouter();this.oContainerRouter.getRoute("home").attachMatched(this._onPageComponentNavigation,this);this.oContainerRouter.getRoute("openFLPPage").attachMatched(this._onPageComponentNavigation,this);this.bIsHomeIntentRootIntent=U.isFlpHomeIntent(R.getShellConfig().rootIntent);this.oErrorPage=this.byId("errorPage");this.oPagesNavContainer=this.byId("pagesNavContainer");this.oPagesRuntimeNavContainer=this.byId("pagesRuntimeNavContainer");s.init(this.oPagesRuntimeNavContainer,this.oPagesNavContainer);this.oEventHubListener=E.once("PagesRuntimeRendered").do(function(){if(p){this._createActionModeButton();}E.emit("firstSegmentCompleteLoaded",true);}.bind(this));this._oEventBus=sap.ui.getCore().getEventBus();this._oEventBus.subscribe("launchpad","shellFloatingContainerIsDocked",this._handleUshellContainerDocked,this);this._oEventBus.subscribe("launchpad","shellFloatingContainerIsUnDocked",this._handleUshellContainerDocked,this);this.oVisualizationInstantiationListener=E.on("VizInstanceLoaded").do(function(){this._setPerformanceMark();if(!this.oVisualizationInstantiationListenerTimeout){this.oVisualizationInstantiationListenerTimeout=setTimeout(function(){this.oVisualizationInstantiationListener.off();}.bind(this),5000);}}.bind(this));},_onPageComponentNavigation:function(){this._openFLPPage();var A=sap.ui.getCore().byId("ActionModeBtn");if(A&&!this.bIsHomeIntentRootIntent){var R=sap.ushell.Container.getRenderer("fiori2");if(R.getShellConfig().moveEditHomePageActionToShellHeader){R.showHeaderEndItem(A.getId(),true);}else{R.showActionButton(A.getId(),true);}}},_setPerformanceMark:function(){U.setPerformanceMark("FLP-TTI-Homepage",{bUseUniqueMark:true,bUseLastMark:true});},_getPageAndSpaceId:function(){return this._oURLParsingService.then(function(e){var h=e.parseShellHash(window.hasher.getHash());var i={semanticObject:h.semanticObject||"",action:h.action||""};var H=h.params||{};var p=H.pageId||[];var S=H.spaceId||[];return this._parsePageAndSpaceId(p,S,i);}.bind(this));},_parsePageAndSpaceId:function(p,e,i){if(p.length<1&&e.length<1){if(i.semanticObject==="Shell"&&i.action==="home"){return this._getUserDefaultPage();}return Promise.reject(r.i18n.getText("PageRuntime.NoPageIdAndSpaceIdProvided"));}if(p.length===1&&e.length===0){return Promise.reject(r.i18n.getText("PageRuntime.OnlyPageIdProvided"));}if(p.length===0&&e.length===1){return Promise.reject(r.i18n.getText("PageRuntime.OnlySpaceIdProvided"));}if(p.length>1||e.length>1){return Promise.reject(r.i18n.getText("PageRuntime.MultiplePageOrSpaceIdProvided"));}if(p[0]===""){return Promise.reject(r.i18n.getText("PageRuntime.InvalidPageId"));}if(e[0]===""){return Promise.reject(r.i18n.getText("PageRuntime.InvalidSpaceId"));}return Promise.resolve({pageId:p[0],spaceId:e[0]});},_getUserDefaultPage:function(){return sap.ushell.Container.getServiceAsync("Menu").then(function(m){return m.getSpacesPagesHierarchy();}).then(function(S){if(S.spaces.length===0){return Promise.reject(r.i18n.getText("PageRuntime.NoAssignedSpace"));}var o=S.spaces.find(function(e){return(!!(e.id&&e.pages&&e.pages[0]&&e.pages[0].id));});if(!o){return Promise.reject(r.i18n.getText("PageRuntime.NoAssignedPage"));}return{spaceId:o.id,pageId:o.pages[0].id};});},_openFLPPage:function(){var p,S;return this._getPageAndSpaceId().then(function(i){p=i.pageId;S=i.spaceId;this.sCurrentTargetPageId=p;return this.oInitFinishedPromise.then(function(){return this.getOwnerComponent().getPagesService();}.bind(this)).then(function(e){return e.loadPage(p);}).then(function(){this._showActionModeButton();if(this.sCurrentTargetPageId===p){return this._navigate(p,S);}return Promise.resolve();}.bind(this)).then(this._notifyOnPageRuntimeRendered).catch(function(e){if(e instanceof Error){this._oErrorPageModel.setProperty("/text",r.i18n.getText("PageRuntime.GeneralError.Text"));}else{var f=r.i18n.getText("PageRuntime.CannotLoadPage.Description")+JSON.stringify(e);this._oErrorPageModel.setProperty("/icon","sap-icon://documents");this._oErrorPageModel.setProperty("/text",r.i18n.getText("PageRuntime.CannotLoadPage.Text",[p,S]));this._oErrorPageModel.setProperty("/description","");this._oErrorPageModel.setProperty("/details",f);}this.oPagesRuntimeNavContainer.to(this.oErrorPage);this._hideActionModeButton();this._cancelActionMode();this._notifyOnPageRuntimeRendered();}.bind(this));}.bind(this)).catch(function(e){this._oErrorPageModel.setProperty("/icon","sap-icon://documents");this._oErrorPageModel.setProperty("/text",e||"");this._oErrorPageModel.setProperty("/description","");this._oErrorPageModel.setProperty("/details","");this.oPagesRuntimeNavContainer.to(this.oErrorPage);this._hideActionModeButton();this._cancelActionMode();this._notifyOnPageRuntimeRendered();}.bind(this));},_navigate:function(t,e){var p=this.oPagesNavContainer.getPages().find(function(o){return t===o.data("pageId");});if(!p){return Promise.reject();}return sap.ushell.Container.getServiceAsync("Menu").then(function(m){return m.hasMultiplePages(e);}).then(function(h){var S=this.oPagesNavContainer.getCurrentPage()===p;this._oViewSettingsModel.setProperty("/showPageTitle",h);this.oPagesNavContainer.to(p);this.oPagesRuntimeNavContainer.to(this.oPagesNavContainer);if(!S){this._cancelActionMode();}}.bind(this));},_notifyOnPageRuntimeRendered:function(){E.emit("PagesRuntimeRendered");if(E.last("AppRendered")!==undefined){E.emit("AppRendered",undefined);}},_pressViewDetailsButton:function(){var e=this._oErrorPageModel.getProperty("/details")||"";this._oErrorPageModel.setProperty("/description",e);},_copyToClipboard:function(){var t=document.createElement("textarea");try{t.contentEditable=true;t.readonly=false;t.textContent=this._oErrorPageModel.getProperty("/description");document.documentElement.appendChild(t);t.select();document.execCommand("copy");M.show(r.i18n.getText("PageRuntime.CannotLoadPage.CopySuccess"),{closeOnBrowserNavigation:false});}catch(e){M.show(r.i18n.getText("PageRuntime.CannotLoadPage.CopyFail"),{closeOnBrowserNavigation:false});}finally{t.parentNode.removeChild(t);}},_visualizationFactory:function(i,e){if(this._oVisualizationInstantiationService){var o=e.getObject();var p=e.getPath();var S=p.replace(/\/visualizations\/\d*\/?$/,"");var f=e.getModel().getProperty(S);var v=e.getModel().getProperty("/vizTypes/"+o.vizType);var V=this._oVisualizationInstantiationService.instantiateVisualization(o,v);V.attachPress(this.onVisualizationPress,this);V.bindEditable("viewSettings>/actionModeActive");if(!f.default){this._addTileActions(V);}var P=e.getPath().split("/")[2];var A=!!s.getPageVisibility("/pages/"+P);V.setActive(A);return V;}return new G({state:L.Failed});},_addTileActions:function(v){var A=v.getAvailableDisplayFormats();for(var i=0;i<A.length;i++){v.addTileAction(new B({text:r.i18n.getText("VisualizationInstance.ConvertTo"+b(A[i])+"Action"),press:[A[i],this._updateVisualizationDisplayFormat,this]}));}v.addTileAction(new B({text:r.i18n.getText("moveTileDialog_action"),press:[v,this._openMoveVisualizationDialog,this]}));},_openMoveVisualizationDialog:function(e,v){this._oVizInstanceToBeMoved=v;var V=v.getBindingContext().getPath();var f=V.split("/");var g="/pages/"+f[2]+"/sections";if(!this._oMoveVisualizationDialog){sap.ui.require(["sap/ui/core/Fragment"],function(h){h.load({name:"sap.ushell.components.pages.MoveVisualization",controller:this}).then(function(o){this._oMoveVisualizationDialog=o;this.getView().addDependent(o);o.bindObject({path:g});o.open();}.bind(this));}.bind(this));}else{this._oMoveVisualizationDialog.bindObject({path:g});this._oMoveVisualizationDialog.open();}},_confirmSelect:function(e){var o=new F("default",d.EQ,false);var i=e.getSource().getBinding("items");i.filter([o]);var v=this._oVizInstanceToBeMoved.getBindingContext().getPath();var V=v.split("/");var p=V[2];var f=V[4];var g=V[6];var t=e.getParameter("selectedItem").getBindingContext().getPath();var T=t.split("/");var h=T[4];var S=this._getAncestorControl(this._oVizInstanceToBeMoved,"sap.ushell.ui.launchpad.Section");var P=this._getAncestorControl(this._oVizInstanceToBeMoved,"sap.ushell.ui.launchpad.Page");var j=P.getSections();var k=j[h];var A=S.getItemPosition(this._oVizInstanceToBeMoved).area;this._oVizInstanceToBeMoved=null;var m=this.getOwnerComponent();return m.getPagesService().then(function(n){return n.moveVisualization(p,f,g,h,-1);}).then(function(R){var n=k.getVisualizations()[R.visualizationIndex];if(n){k.focusVisualization(n);}var q=this._getVizMoveAnnouncement(A,A);m.getInvisibleMessageInstance().announce(q,I.Polite);}.bind(this));},_onMoveTileSearch:function(e){var v=e.getParameter("value");var f=new F("title",d.Contains,v);var o=new F("default",d.EQ,false);var g=e.getParameter("itemsBinding");g.filter([f,o]);},_onMoveTileDialogClose:function(e){this._oVizInstanceToBeMoved=null;var o=new F("default",d.EQ,false);e.getSource().getBinding("items").filter([o]);},_updateVisualizationDisplayFormat:function(e,n){var o=e.getSource().getBindingContext();var p=o.getPath();var P=p.split("/");var O;var f=this.getOwnerComponent();return f.getPagesService().then(function(g){O=g.getModel().getProperty(p).displayFormatHint;var v={displayFormatHint:n};return g.updateVisualization(P[2],P[4],P[6],v);}).then(function(){var i=this._getVizMoveAnnouncement(O,n);f.getInvisibleMessageInstance().announce(i,I.Polite);}.bind(this));},onVisualizationPress:function(e){var S=e.getParameter("scope");var A=e.getParameter("action");var v=e.getSource();var o=v.getBindingContext();var p=o.getPath();var P=p.split("/");var f=this._getAncestorControl(v,"sap.ushell.ui.launchpad.Section");if(S==="Actions"&&A==="Remove"){return this.getOwnerComponent().getPagesService().then(function(g){var O=f.getItemPosition(v);g.deleteVisualization(P[2],P[4],P[6]);M.show(r.i18n.getText("PageRuntime.MessageToast.TileRemoved"));f._focusItem(O);});}return Promise.resolve();},onExit:function(){this.oContainerRouter.getRoute("home").detachMatched(this._openFLPPage,this);this.oContainerRouter.getRoute("openFLPPage").detachMatched(this._openFLPPage,this);this._aConfigListeners.off();this.oEventHubListener.off();this._oEventBus.unsubscribe("launchpad","shellFloatingContainerIsDocked",this._handleUshellContainerDocked,this);this._oEventBus.unsubscribe("launchpad","shellFloatingContainerIsUnDocked",this._handleUshellContainerDocked,this);s.exit();var A=sap.ui.getCore().byId("ActionModeBtn");if(A){A.destroy();}},_hideActionModeButton:function(){var A=sap.ui.getCore().byId("ActionModeBtn");if(A){A.setVisible(false);}},_showActionModeButton:function(){var A=sap.ui.getCore().byId("ActionModeBtn");if(A){A.setVisible(true);}},_createActionModeButton:function(){var A={id:"ActionModeBtn",text:r.i18n.getText("PageRuntime.EditMode.Activate"),tooltip:r.i18n.getText("PageRuntime.EditMode.Activate"),icon:"sap-icon://edit",press:[this.pressActionModeButton,this]};var R=sap.ushell.Container.getRenderer("fiori2");var m=R.getShellConfig().moveEditHomePageActionToShellHeader;if(m){this._createHeaderActionModeButton(A);}else{this._createUserActionModeButton(A);}},_createHeaderActionModeButton:function(A){sap.ui.require(["sap/ushell/ui/shell/ShellHeadItem"],function(S){var t=new S(A);if(a.last("/core/extension/enableHelp")){t.addStyleClass("help-id-ActionModeBtn");}var R=sap.ushell.Container.getRenderer("fiori2");if(this.bIsHomeIntentRootIntent){R.showHeaderEndItem(t.getId(),false,["home"]);}else{R.showHeaderEndItem(t.getId(),true);}}.bind(this));},_createUserActionModeButton:function(A){var o={controlType:"sap.ushell.ui.launchpad.ActionItem",oControlProperties:A,bIsVisible:true,aStates:["home"]};if(!this.bIsHomeIntentRootIntent){o.aStates=null;o.bCurrentState=true;}sap.ushell.Container.getRenderer("fiori2").addUserAction(o).done(function(e){if(a.last("/core/extension/enableHelp")){e.addStyleClass("help-id-ActionModeBtn");}});},pressActionModeButton:function(){var A=this.getView().getModel("viewSettings").getProperty("/actionModeActive");sap.ui.require(["sap/ushell/components/pages/ActionMode"],function(e){if(A){e.cancel();}else{e.start(this);}}.bind(this));},_cancelActionMode:function(){var A=this.getView().getModel("viewSettings").getProperty("/actionModeActive");if(A){sap.ui.require(["sap/ushell/components/pages/ActionMode"],function(e){e.cancel();});}},handleEditModeAction:function(h,e,S,p){sap.ui.require(["sap/ushell/components/pages/ActionMode"],function(A){A[h](e,S,p);});},_getAncestorControl:function(e,f){if(e&&e.isA&&e.isA(f)){return e;}else if(e&&e.getParent){return this._getAncestorControl(e.getParent(),f);}return null;},moveVisualization:function(e){var o=e.getParameter("draggedControl"),f=e.getParameter("droppedControl"),g=e.getParameter("dropPosition"),h=e.getParameter("browserEvent"),k=h&&h.keyCode,p=this._getAncestorControl(o,"sap.ushell.ui.launchpad.Page"),P=parseInt(o.getBindingContext().getPath().split("/")[2],10),i=this._getAncestorControl(o,"sap.ushell.ui.launchpad.Section"),j=p.indexOfSection(i),m=i.indexOfVisualization(o),n=i.getVisualizations()[m],q=i.getItemPosition(n),t,T,v,w,x;if(!f){var y=e.mParameters.browserEvent.keyCode===K.ARROW_UP,S=p.getSections();T=j;while(true){T=y?--T:++T;t=S[T];if(!t||t.getDefault()){n.invalidate();return Promise.resolve();}if(t.getShowSection()||t.getEditable()){v=t.getClosestCompactItemIndex(o.getDomRef(),y);w=t.getVisualizations()[v];x=t.getItemPosition(w);if(x.area!==q.area){x=q;}break;}}}else{if(f.isA("sap.ushell.ui.launchpad.section.CompactArea")){var z=f.getItems();if(z.length){f=z[z.length-1];g="After";}}t=this._getAncestorControl(f,"sap.ushell.ui.launchpad.Section");T=p.indexOfSection(t);if(t.getDefault()&&!i.getDefault()){n.invalidate();return Promise.resolve();}v=t.indexOfVisualization(f);w=t.getVisualizations()[v];x=t.getItemPosition(w);if(x.index===-1){x.area=q.area;}if(j===T){if(g==="Before"&&m<v){v--;}else if(g==="After"&&m>v){v++;}if(m===v&&x.area===q.area){n.invalidate();return Promise.resolve();}}else if(g==="After"){v++;}}if((j!==T)&&(k===K.ARROW_UP||k===K.ARROW_DOWN)&&(q.index>x.index)){v++;}var A;var H=this.getOwnerComponent();return H.getPagesService().then(function(N){A=N;A.enableImplicitSave(false);return A.moveVisualization(P,j,m,T,v);}).then(function(R){v=R.visualizationIndex;if(q.area!==x.area){var V={displayFormatHint:x.area};return A.updateVisualization(P,T,v,V);}return Promise.resolve();}).then(function(){return A.savePersonalization();}).then(function(){var V=t.getVisualizations()[v];if(V){t.focusVisualization(V);V.invalidate();}var N=this._getVizMoveAnnouncement(q.area,x.area);H.getInvisibleMessageInstance().announce(N,I.Polite);}.bind(this)).finally(function(){A.enableImplicitSave(true);});},_getVizMoveAnnouncement:function(f,t){if(f===t){if(t===D.Compact){return r.i18n.getText("PageRuntime.Message.LinkMoved");}return r.i18n.getText("PageRuntime.Message.TileMoved");}else if(f===D.Compact){return r.i18n.getText("PageRuntime.Message.LinkConverted");}return r.i18n.getText("PageRuntime.Message.TileConverted");},onDragEnter:function(e){var t=e.getParameter("dragSession").getDropControl();if(t.getDefault()){e.preventDefault();}},onAreaDragEnter:function(e){var S=e.getParameter("sourceArea");var t=e.getParameter("targetArea");if(S===t){return;}var v=e.getParameter("dragControl");var A=v.getAvailableDisplayFormats();if(A.indexOf(t)===-1){e.getParameter("originalEvent").preventDefault();}},_handleUshellContainerDocked:function(e,f){this._oViewSettingsModel.setProperty("/ushellContainerDocked",f==="shellFloatingContainerIsDocked");}});});
sap.ui.require.preload({
	"sap/ushell/components/pages/MoveVisualization.fragment.xml":'<core:FragmentDefinition xmlns="sap.m" xmlns:core="sap.ui.core"><SelectDialog items="{path:\'\',filters:[{path:\'default\',operator:\'EQ\',value1:false}]}" search="_onMoveTileSearch" title="{i18n&gt;PageRuntime.Dialog.Title.MoveVisualization}" confirm="_confirmSelect" cancel="_onMoveTileDialogClose" contentWidth="400px" contentHeight="auto"><StandardListItem title="{title}"/></SelectDialog></core:FragmentDefinition>',
	"sap/ushell/components/pages/manifest.json":'{"_version":"1.21.0","sap.app":{"id":"sap.ushell.components.pages","applicationVersion":{"version":"1.88.1"},"i18n":{"bundleUrl":"../../renderers/fiori2/resources/resources.properties","supportedLocales":["","ar","bg","ca","cs","da","de","el","en","en_US","en_US_sappsd","en_US_saptrc","es","et","fi","fr","hi","hr","hu","it","iw","ja","kk","ko","lt","lv","ms","nl","no","pl","pt","ro","ru","sh","sk","sl","sv","th","tr","uk","vi","zh_CN","zh_TW"],"fallbackLocale":"en"},"ach":"CA-FLP-FE-COR","type":"component","title":"","resources":"resources.json"},"sap.ui":{"technology":"UI5","deviceTypes":{"desktop":true,"tablet":true,"phone":true}},"sap.ui5":{"componentName":"sap.ushell.components.pages","rootView":{"viewName":"sap.ushell.components.pages.view.PageRuntime","type":"XML","async":true},"dependencies":{"minUI5Version":"1.72","libs":{"sap.ui.core":{},"sap.m":{},"sap.f":{}}},"contentDensities":{"compact":true,"cozy":true}}}',
	"sap/ushell/components/pages/view/PageRuntime.view.xml":'<mvc:View xmlns="sap.m" xmlns:core="sap.ui.core" xmlns:mvc="sap.ui.core.mvc" xmlns:dnd="sap.ui.core.dnd" xmlns:data="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1" xmlns:launchpad="sap.ushell.ui.launchpad" controllerName="sap.ushell.components.pages.controller.PageRuntime" height="100%"><NavContainer id="pagesRuntimeNavContainer"><NavContainer id="pagesNavContainer" pages="{/pages}"><pages><Page data:pageId="{id}" showHeader="false" backgroundDesign="Transparent" floatingFooter="true"><content><launchpad:Page edit="{viewSettings&gt;/actionModeActive}" dataHelpId="Page-{id}" showTitle="{viewSettings&gt;/showPageTitle}" title="{title}" sections="{path:\'sections\',templateShareable:false,key:\'id\'}" addSectionButtonPressed=".handleEditModeAction(\'addSection\', $event, ${$source&gt;/}, ${$parameters&gt;/})" enableSectionReordering="{viewSettings&gt;/actionModeActive}" sectionDrop=".handleEditModeAction(\'moveSection\', $event, ${$source&gt;/}, ${$parameters&gt;/})"><launchpad:sections><launchpad:Section title="{title}" class="sapContrastPlus" sizeBehavior="{viewSettings&gt;/sizeBehavior}" dataHelpId="Section-{id}" default="{default}" visualizations="{path:\'visualizations\',factory:\'._visualizationFactory\',key:\'id\'}" enableGridBreakpoints="false" enableGridContainerQuery="{viewSettings&gt;/ushellContainerDocked}" editable="{viewSettings&gt;/actionModeActive}" add=".handleEditModeAction(\'addVisualization\', $event, ${$source&gt;/}, ${$parameters&gt;/})" delete=".handleEditModeAction(\'deleteSection\', $event, ${$source&gt;/}, ${$parameters&gt;/})" reset=".handleEditModeAction(\'resetSection\', $event, ${$source&gt;/}, ${$parameters&gt;/})" sectionVisibilityChange=".handleEditModeAction(\'changeSectionVisibility\', $event, ${$source&gt;/}, ${$parameters&gt;/})" titleChange=".handleEditModeAction(\'changeSectionTitle\', $event, ${$source&gt;/}, ${$parameters&gt;/})" enableVisualizationReordering="{viewSettings&gt;/personalizationEnabled}" areaDragEnter=".onAreaDragEnter" visualizationDrop=".moveVisualization($event, ${$source&gt;/}, ${$parameters&gt;/})" showSection="{= ${visible} &amp;&amp; (!!${visualizations}.length || ${viewSettings&gt;/actionModeActive})}" enableResetButton="{preset}" enableDeleteButton="{= !${preset}}" enableShowHideButton="{viewSettings&gt;/showHideButton}"/></launchpad:sections><launchpad:dragDropConfig><dnd:DropInfo groupName="Section" targetAggregation="sections" dragEnter=".onDragEnter" drop=".moveVisualization($event, ${$source&gt;/}, ${$parameters&gt;/})"/></launchpad:dragDropConfig></launchpad:Page></content><footer><Bar class="sapUshellDashboardFooter" visible="{viewSettings&gt;/actionModeActive}"><contentRight><Button text="{i18n&gt;closeEditMode}" type="Emphasized" press=".handleEditModeAction(\'save\', $event, ${$source&gt;/}, ${$parameters&gt;/})"/></contentRight><customData><core:CustomData key="sap-ui-fastnavgroup" value="true" writeToDom="true"/></customData></Bar></footer><landmarkInfo><PageAccessibleLandmarkInfo rootRole="Region" rootLabel="{i18n&gt;PageSectionRegion}" headerRole="None" contentRole="None" footerRole="None"/></landmarkInfo></Page></pages><customData><core:CustomData key="help-id" value="{= ${viewSettings&gt;/personalizationEnabled} ? \'general-page-id-pers-allowed\' : \'general-page-id-no-pers-allowed\'}" writeToDom="true"/></customData></NavContainer><MessagePage id="errorPage" showHeader="false" icon="{errorPage&gt;/icon}" text="{errorPage&gt;/text}" description="{errorPage&gt;/description}"><buttons><Button text="{i18n&gt;PageRuntime.CannotLoadPage.DetailsButton}" visible="{= !!${errorPage&gt;/details} &amp;&amp; !${errorPage&gt;/description}}" press="._pressViewDetailsButton"/><Button text="{i18n&gt;PageRuntime.CannotLoadPage.CopyButton}" visible="{= !!${errorPage&gt;/details}}" press="._copyToClipboard"/></buttons></MessagePage></NavContainer></mvc:View>'
},"sap/ushell/components/pages/Component-preload"
);
//# sourceMappingURL=Component-preload.js.map