// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.define(["sap/ushell/components/tiles/utils","sap/ui/core/library","sap/m/MessageBox"],function(u,c,M){"use strict";var V=c.ValueState;sap.ui.controller("sap.ushell.components.tiles.action.Configuration",{sEnterValuePlaceHolder:"",sDuplicateErrorMsg:"",sDuplicateErrorTitle:"",sInvalidParmMsg:"",aDefaultObjects:[{obj:"",name:""},{obj:"*",name:"*"}],onConfigurationInputChange:function(C){u.checkTMInput(this.getView(),C);},onInit:function(){var v=this.getView();var s=v.byId("semantic_objectInput");var r=v.byId("navigation_provider_roleInput");var i=v.byId("navigation_provider_instanceInput");var a=v.byId("target_application_aliasInput");var A=v.byId("semantic_actionInput");var t=v.byId("targetTypeInput");var R=u.getResourceBundleModel();v.setModel(R,"i18n");v.setViewName("sap.ushell.components.tiles.action.Configuration");u.createSemanticObjectModel(this,s,this.aDefaultObjects);u.createRoleModel(this,r,i);u.createAliasModel(this,a);u.createActionModel(this,A);u.createNavigationProviderModel(this,t);s.attachChange(function(C){var d=C.getSource().getValue();v.getModel().setProperty("/config/semantic_object",d);});r.attachChange(function(C){var d=C.getSource().getValue();v.getModel().setProperty("/config/navigation_provider_role",d);u.updateAliasModel(v,a);});i.attachChange(function(C){var d=C.getSource().getValue();v.getModel().setProperty("/config/navigation_provider_instance",d);});a.attachChange(function(C){var d=C.getSource().getValue();v.getModel().setProperty("/config/target_application_alias",d);});var b=R.getResourceBundle();this.sEnterValuePlaceHolder=b.getText("configuration.signature.table.valueFieldLbl");this.sDuplicateErrorMsg=b.getText("configuration.signature.uniqueParamMessage.text");this.sDuplicateErrorTitle=b.getText("configuration.signature.uniqueParamMessage.title");this.sInvalidParmMsg=b.getText("configuration.signature.invalidParamMessage.text");},handleMandatoryChange:function(m){var i=m.getParameter("id");var p=sap.ui.getCore().byId(i).getParent().getCells();var I=m.getParameter("checked");if(I){p[2].setEnabled(true);p[2].setPlaceholder(this.sEnterValuePlaceHolder);p[4].setEnabled(false);p[4].setValue("");p[4].setPlaceholder("");p[3].setEnabled(true);}else{p[2].setEnabled(false);p[2].setValue("");p[2].setPlaceholder("");p[4].setEnabled(true);p[4].setPlaceholder(this.sEnterValuePlaceHolder);p[3].setEnabled(false);p[3].setChecked(false);}},addRow:function(){var v=this.getView();var m=v.getModel();var r=m.getProperty("/config/rows");var n=u.getEmptyRowObj();r.push(n);m.setProperty("/config/rows",r);},deleteRow:function(){var v=this.getView();var m=v.getModel();var r=m.getProperty("/config/rows");var t=v.byId("mappingSignatureTable");var s=t.getSelectedIndices();var S=s.sort(function(a,b){return b-a;}).slice();for(var i=0;i<S.length;i++){t.removeSelectionInterval(S[i],S[i]);r.splice(S[i],1);}m.setProperty("/config/rows",r);},checkDuplicateNames:function(a){var m=this.getView().getModel();var r=m.getProperty("/config/rows");var n=sap.ui.getCore().byId(a.getParameter("id"));var N=a.getParameter("newValue");if(N!=""&&!(/^[\w-/]+$/.test(N))){n.setValueState(V.Error);M.alert(this.sInvalidParmMsg,this.focusNameField.bind(n),this.sDuplicateErrorTitle);}if(u.tableHasDuplicateParameterNames(r)){n.setValueState(V.Error);M.alert(this.sDuplicateErrorMsg,this.focusNameField.bind(n),this.sDuplicateErrorTitle);}else{n.setValueState(V.None);}},focusNameField:function(){this.focus();},onValueHelpRequest:function(e){u.objectSelectOnValueHelpRequest(this,e,false);},onActionValueHelpRequest:function(e){u.actionSelectOnValueHelpRequest(this,e);},onRoleValueHelpRequest:function(e){u.roleSelectOnValueHelpRequest(this,e);},onInstanceValueHelpRequest:function(e){u.instanceSelectOnValueHelpRequest(this,e);},instanceSuggest:function(e){u.instanceSuggest(this,e);},aliasSuggest:function(e){u.aliasSuggest(this,e);},onAliasValueHelpRequest:function(e){u.applicationAliasSelectOnValueHelpRequest(this,e);},onFormFactorChange:function(){var m=this.getView().getModel();m.setProperty("/config/formFactorConfigDefault",false);},onApplicationTypeChange:function(e){var p=e.getParameters();if(p.selectedItem){u.displayApplicationTypeFields(p.selectedItem.getKey(),this.getView());}}});},true);
