// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.define(["sap/ushell/services/_VisualizationInstantiation/VizInstance","sap/m/library","sap/ui/core/Component","sap/base/util/ObjectPath","sap/base/util/deepExtend","sap/ui/core/ComponentContainer"],function(V,m,C,O,d,a){"use strict";var L=m.LoadState;var b=V.extend("sap.ushell.ui.launchpad.VizInstanceCdm",{metadata:{library:"sap.ushell"},fragment:"sap.ushell.services._VisualizationInstantiation.VizInstanceCdm"});b.prototype.load=function(){var c=this._getComponentConfiguration();return C.create(c).then(function(o){this._oComponent=o;var e=new a({component:o});o.setParent(this);this._setContent(e);this._setComponentTileVisible(this.getActive());}.bind(this)).catch(function(e){this.setState(L.Failed);return Promise.reject(e);}.bind(this));};b.prototype._getComponentConfiguration=function(){var v=this.getInstantiationData().vizType;var o=this.getVizConfig();var c=O.get(["sap.platform.runtime","componentProperties"],v);c=d({},this._getComponentProperties(),c);var e={name:v["sap.ui5"].componentName,componentData:{properties:c},url:O.get(["sap.platform.runtime","componentProperties","url"],v),manifest:O.get(["sap.platform.runtime","componentProperties","manifest"],v),asyncHints:O.get(["sap.platform.runtime","componentProperties","asyncHints"],v)};var i=O.get(["sap.platform.runtime","includeManifest"],v);var I=O.get(["sap.platform.runtime","includeManifest"],o);if(i||I){e.manifest=d({},v,o);}if(typeof e.manifest==="object"&&c.manifest===true){c.manifest=e.manifest;}return e;};b.prototype._getComponentProperties=function(){return{title:this.getTitle(),subtitle:this.getSubtitle(),icon:this.getIcon(),info:this.getInfo(),indicatorDataSource:this.getIndicatorDataSource(),dataSource:this.getDataSource(),contentProviderId:this.getContentProviderId(),targetURL:this.getTargetURL(),displayFormat:this.getDisplayFormat(),numberUnit:this.getNumberUnit()};};b.prototype._setComponentTileVisible=function(v){if(this._oComponent&&typeof this._oComponent.tileSetVisible==="function"){this._oComponent.tileSetVisible(v);}};b.prototype.setActive=function(c,r){this._setComponentTileVisible(c);if(r){this.refresh();}return this.setProperty("active",c,false);};b.prototype.refresh=function(){if(this._oComponent&&typeof this._oComponent.tileRefresh==="function"){this._oComponent.tileRefresh();}};return b;});
