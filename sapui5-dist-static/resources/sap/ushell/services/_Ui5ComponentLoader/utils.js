// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/thirdparty/jquery","sap/base/util/UriParameters","sap/ui/core/util/AsyncHintsHelper","sap/base/Log"],function(q,U,a,L){"use strict";var i=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getLogonSystem().getPlatform()==="abap";var O={name:"core-ext-light",count:4,debugName:"core-ext-light",path:i?"sap/ushell_abap/bootstrap/evo/":"sap/fiori/"};function c(C,t){var D=new q.Deferred();C.componentData=t;C.async=true;sap.ui.component(C).then(function(w){D.resolve(w);},function(E){D.reject(E);});return D.promise();}function s(S){var A=(S&&S.hasOwnProperty("amendedLoading"))?S.amendedLoading:true;return A;}function b(A){var t=true;if(A.hasOwnProperty("loadCoreExt")){t=A.loadCoreExt;}return t;}function d(A,S,t){var w=true;if(A.hasOwnProperty("loadDefaultDependencies")){w=A.loadDefaultDependencies;}if(S&&S.hasOwnProperty("loadDefaultDependencies")){w=w&&S.loadDefaultDependencies;}w=w&&t;return w;}function e(P){var S=P.semanticObject||null;var A=P.action||null;if(!S||!A){return null;}return"application-"+S+"-"+A+"-component";}function u(t){return t&&t.indexOf("?")>=0;}function r(t){var w=new RegExp("[/]~[\\w-]+~[A-Z0-9]?");return t.replace(w,"");}function f(t){if(!t){return t;}var I=t.indexOf("?");if(I>=0){return t.slice(0,I);}return t;}function g(){return q.sap.isDeclared("sap.fiori.core",true)||q.sap.isDeclared("sap.fiori.core-ext-light",true);}function l(A,E,t,w,C){var x="The issue is most likely caused by application "+A,y="Failed to load UI5 component with properties: '"+C+"'.";if(w){y+=" Error likely caused by:\n"+w;}else{y+=" Error: '"+E+"'";}if(t==="parsererror"){x+=", as one or more of its resources could not be parsed";}x+=". Please create a support incident and assign it to the support component of the respective application.";L.error(x,y,A);}function h(t){var P=new U(t||window.location.href).mParams,x=P["sap-xapp-state"],R;delete P["sap-xapp-state"];R={startupParameters:P};if(x){R["sap-xapp-state"]=x;}return R;}function j(A,M){if(!Array.isArray(M)){return;}M.forEach(function(t){var S=String.prototype.toLowerCase.call(t.severity||"");S=["trace","debug","info","warning","error","fatal"].indexOf(S)!==-1?S:"error";L[S](t.text,t.details,A);});}function p(C){var B,t={name:"CoreResourcesComplement"};if(v(C)){B=C;}else{B=O;}if(window["sap-ui-debug"]===true){t.aResources=[B.path+B.debugName+".js"];}else{t.aResources=k(B.name,B.path,B.count);}return t;}function k(B,P,R){var t=arguments[3]||[],w=P;if(typeof B!=="string"||typeof w!=="string"||typeof R!=="number"){L.error("Ui5ComponentLoader: _buildBundleResourcesArray called with invalid arguments");return null;}if(w.substr(-1)!=="/"){w+="/";}if(R===1){t.push(w+B+".js");}if(t.length>=R){return t;}t.push(w+B+"-"+t.length+".js");return k(B,w,R,t);}function v(C){var t=true;if(!C){return false;}if(!C.name||typeof C.name!=="string"){L.error("Ui5ComponentLoader: Configured CoreResourcesComplement Bundle has incorrect 'name' property");t=false;}if(!C.count||typeof C.count!=="number"){L.error("Ui5ComponentLoader: Configured CoreResourcesComplement Bundle has incorrect 'count' property");t=false;}if(!C.debugName||typeof C.debugName!=="string"){L.error("Ui5ComponentLoader: Configured CoreResourcesComplement Bundle has incorrect 'debugName' property");t=false;}if(!C.path||typeof C.path!=="string"){L.error("Ui5ComponentLoader: Configured CoreResourcesComplement Bundle has incorrect 'path' property");t=false;}return t;}function m(B){if(!B||!Array.isArray(B.aResources)||!B.name){L.error("Ui5ComponentLoader: loadBundle called with invalid arguments");return null;}var P=[],D=new q.Deferred();B.aResources.forEach(function(R){P.push(q.sap._loadJSResourceAsync(R));});Promise.all(P).then(function(){D.resolve();}).catch(function(){L.error("Ui5ComponentLoader: failed to load bundle: "+B.name);D.reject();});return D.promise();}function n(A,t,N,w,x,y,C,z,B){var D=q.extend(true,{},x);if(!D.asyncHints){D.asyncHints=t?{libs:["sap.ca.scfld.md","sap.ca.ui","sap.me","sap.ui.unified"]}:{};}if(A){D.asyncHints.preloadBundles=D.asyncHints.preloadBundles||[];D.asyncHints.preloadBundles=D.asyncHints.preloadBundles.concat(B.aResources);}if(w){D.asyncHints.waitFor=w;}if(!D.name){D.name=y;}if(C){D.url=f(C);}if(z){D.id=z;}if(N&&D.asyncHints){a.modifyUrls(D.asyncHints,r);}return D;}function o(B,C,A,t){var w=q.extend(true,{startupParameters:{}},B);if(A){w.config=A;}if(t){w.technicalParameters=t;}if(u(C)){var x=h(C);w.startupParameters=x.startupParameters;if(x["sap-xapp-state"]){w["sap-xapp-state"]=x["sap-xapp-state"];}}return w;}return{constructAppComponentId:e,getParameterMap:h,isCoreExtAlreadyLoaded:g,logAnyApplicationDependenciesMessages:j,logInstantiateComponentError:l,shouldLoadCoreExt:b,shouldLoadDefaultDependencies:d,shouldUseAmendedLoading:s,urlHasParameters:u,removeParametersFromUrl:f,createUi5Component:c,prepareBundle:p,loadBundle:m,createComponentProperties:n,createComponentData:o,buildBundleResourcesArray:k};},false);
