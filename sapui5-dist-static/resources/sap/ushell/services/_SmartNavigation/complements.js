// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
(function(){"use strict";var i=null,c={STATISTIC_COLLECTION_WINDOW_DAYS:90,PERS_CONTAINER_KEY_PREFIX:"ushell.smartnav.",ONE_DAY_IN_MILLISECOND:24*60*60*1000},h={"":0|0};sap.ui.define([],function(){if(!i){i={getHashCode:g,getBaseHashPart:b,getHashFromOArgs:d,getPersContainerKey:e,getNavigationOccurrences:f,prepareLinksForSorting:p,mapClickCountsIntoLinkItems:m,recordNavigationOccurrences:r,updateHistoryEntryWithCurrentUsage:u,isTrackingEnabled:a};Object.keys(c).forEach(function(n){Object.defineProperty(i,n,{value:c[n]});});}return i;});function a(C,U){return U.isDefined(C)&&U.isDefined(C.config)&&U.isDefined(C.config.isTrackingEnabled)?C.config.isTrackingEnabled:false;}function g(v){var s=v+"";return h[s]||(function(j){var H=0|0;while(j--){H=(H<<5)-H+(s.charCodeAt(j)|0);H|=0;}h[s]=H;return H;})(s.length);}function b(U,I){var t=U.parseShellHash(I);if(t&&t.semanticObject&&t.action){return t.semanticObject+"-"+t.action;}throw"Invalid intent `"+I+"`";}function d(o,U){if(!o){return null;}if(o.shellHash&&U.parseShellHash(o.shellHash)){return b(U,o.shellHash);}if(o.semanticObject&&o.action){return o.semanticObject+"-"+o.action;}return null;}function e(s){return c.PERS_CONTAINER_KEY_PREFIX+g(s);}function f(F,P,C){var s=e(F);return P.getContainer(s,{keyCategory:P.constants.keyCategory.FIXED_KEY,writeFrequency:P.constants.writeFrequency.HIGH,clientStorageAllowed:true},C).then(function(o){return o.getItemKeys().map(function(j){var k=o.getItemValue(j);return Object.keys(k.actions).map(function(l){var n=k.actions[l];return{intent:j+"-"+l,clickCount:n.dailyFrequency.reduce(function(q,t){return q+t;},0)};});}).reduce(function(E,j){Array.prototype.push.apply(E,j);return E;},[]);});}function p(l,n,U){return m(l,n,U);}function m(l,n,U){var N={};n.forEach(function(o){N[o.intent]=o;});l.forEach(function(L){var B=b(U,L.intent),o=N[B];L.clickCount=o?o.clickCount:0;});return l;}function r(F,t,P,C,U){var T=U.parseShellHash(t),s=e(F),j=T.semanticObject,o;return P.getContainer(s,{keyCategory:P.constants.keyCategory.FIXED_KEY,writeFrequency:P.constants.writeFrequency.HIGH,clientStorageAllowed:true},C).then(function(k){o=k;return o.getItemValue(j);}).then(function(k){var l,n=T.action;if(!k){k=new S();}l=k.actions[n];if(!l){l=new A();k.actions[n]=l;}u(k);u(l);return k;}).then(function(k){o.setItemValue(j,k);return o.save();});}function u(H){var n=Date.now(),t=n-H.latestVisit,D=Math.floor(t/c.ONE_DAY_IN_MILLISECOND);while(D--){H.dailyFrequency.unshift(0);if(H.dailyFrequency.length>c.STATISTIC_COLLECTION_WINDOW_DAYS){H.dailyFrequency.pop();}}++H.dailyFrequency[0];H.latestVisit=n;return H;}function S(){return{actions:{},latestVisit:Date.now(),dailyFrequency:[0]};}function A(){return{latestVisit:Date.now(),dailyFrequency:[0]};}})();
