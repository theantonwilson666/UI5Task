// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.define(["sap/ushell/library","sap/ushell/renderers/fiori2/search/controls/SearchFieldGroup"],function(u,S){"use strict";return sap.m.Page.extend("sap.ushell.renderers.fiori2.search.inputhelp.SearchInputHelpWizard",{metadata:{properties:{dataSource:"string",displayAttribute:"string",selectedItems:"array"}},constructor:function(o){var t=this;o=jQuery.extend({},{showHeader:false,content:[]},o);t.displayAttribute=o.displayAttribute;sap.m.Page.prototype.constructor.apply(t,[o]);t.addStyleClass("sapUshellSearchInputHelpWizard");sap.ui.require(["sap/ushell/renderers/fiori2/search/container/ComponentService"],function(C){C.init();sap.ui.require(["sap/ushell/renderers/fiori2/search/personalization/PersonalizationStorage","sap/ushell/renderers/fiori2/search/SearchModel"],function(P,a){P.getInstance();var s=t.getModel("searchModel");if(!s){s=sap.ushell.renderers.fiori2.search.getModelSingleton();t.setModel(s,"searchModel");}s.isSearchInputHelpWizard=true;s.preventUpdateURL=true;s.config.searchScopeWithoutAll=true;t.setModel(s);t.setModel(sap.ushell.resources.i18nModel,"i18n");t.createContent();t.getModel().initBusinessObjSearch().then(function(){t.selectDataSource();t.oSearchFieldGroup.select.setEnabled(false);var b="*";t.getModel().setSearchBoxTerm(b,false);t.getModel()._firePerspectiveQuery();});});});},renderer:"sap.m.PageRenderer",createContent:function(){var t=this;t.oSearchFieldGroup=new sap.ushell.renderers.fiori2.search.controls.SearchFieldGroup("SearchInputHelpWizardSearchFieldGroup");t.oSearchFieldGroup.setCancelButtonActive(false);t.oSearchFieldGroup.addStyleClass("sapUshellSearchInputHelpWizardSearchFieldGroup");t.oSearchFieldGroup.input.setShowValueHelp(false);t.getModel().setProperty("/inputHelp",t.oSearchFieldGroup.input);t.oSearchResults=sap.ui.view({id:"searchContainerResultsView",viewName:"sap.ushell.renderers.fiori2.search.container.Search",type:sap.ui.core.mvc.ViewType.JS});t.oSearchBar=new sap.m.Bar({visible:{parts:[{path:"/count"},{path:"/facetVisibility"}],formatter:function(c,f){if(f){return c!==0;}return c!==0;}},contentLeft:[t.oSearchResults.assembleFilterButton()],contentRight:t.oSearchResults.assembleSearchToolbar(true)});t.oSearchBar.addStyleClass("sapUshellSearchBar");t.oFilterBar=new sap.ushell.renderers.fiori2.search.controls.SearchFilterBar({visible:{parts:[{path:"/facetVisibility"},{path:"/uiFilter/rootCondition"}],formatter:function(f,r){if(!f&&r&&r.hasFilters()){return true;}return false;}}});t.oSearchPage=new sap.m.Page({id:"searchPage",customHeader:this.oSearchBar,subHeader:this.oFilterBar,content:[t.oSearchResults],enableScrolling:true,showFooter:{parts:["/errors/length"],formatter:function(n){return n>0;}},showHeader:true,showSubHeader:{parts:[{path:"/facetVisibility"},{path:"/uiFilter/rootCondition"}],formatter:function(f,r){if(!f&&r&&r.hasFilters()){return true;}return false;}}});t.oSearchPage.addStyleClass("sapUshellSearchInputHelpWizardSearchPage");t.addContent(t.oSearchFieldGroup);t.addContent(t.oSearchPage);},selectDataSource:function(){var m=this.getModel();var d=this.getDataSource();var a=m.getProperty("/dataSources");if(a[0]===m.allDataSource){a.shift();m.setDataSource(a[0]);}if(m.getDataSource().id!==d){for(var i=0;i<a.length;i++){var b=a[i];if(d===b.id){m.setDataSource(b,false);break;}}}},selectItems:function(){var t=this;var s=[];var r=t.getModel().getProperty("/results");for(var i=0;i<r.length;i++){var a=r[i];if(a.selected){s.push(a);}}t.setSelectedItems(s);t.getModel().setProperty("/inputHelpSelectedItems",s);}});});
