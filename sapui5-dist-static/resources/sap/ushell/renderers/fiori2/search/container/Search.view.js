// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.define(['sap/ushell/renderers/fiori2/search/SearchConfiguration','sap/ushell/renderers/fiori2/search/controls/SearchLayout','sap/ushell/renderers/fiori2/search/controls/SearchResultListContainer','sap/ushell/renderers/fiori2/search/controls/SearchResultList','sap/ushell/renderers/fiori2/search/controls/SearchResultTable','sap/ushell/renderers/fiori2/search/controls/SearchResultGrid','sap/ushell/renderers/fiori2/search/controls/SearchSpreadsheet','sap/ushell/renderers/fiori2/search/controls/SearchNoResultScreen','sap/ushell/renderers/fiori2/search/SearchHelper','sap/ushell/renderers/fiori2/search/controls/SearchLabel','sap/ushell/renderers/fiori2/search/controls/SearchLink','sap/ushell/renderers/fiori2/search/controls/SearchResultMap','sap/ushell/renderers/fiori2/search/controls/SearchResultListItem','sap/ushell/renderers/fiori2/search/controls/CustomSearchResultListItem','sap/ushell/renderers/fiori2/search/controls/SearchFacetFilter','sap/ushell/renderers/fiori2/search/controls/DivContainer','sap/ushell/renderers/fiori2/search/controls/SearchTilesContainer','sap/ushell/renderers/fiori2/search/controls/SearchFilterBar','sap/ushell/services/Personalization','sap/m/TablePersoController','sap/ui/vbm/AnalyticMap','sap/ui/vbm/Spot','sap/m/BusyDialog'],function(S,a,b,c,d,f,g,h,j,k,m,n,o,C){"use strict";return sap.ui.jsview("sap.ushell.renderers.fiori2.search.container.Search",{createContent:function(e){var t=this;t.totalCountHiddenElement=t.assembleCountHiddenElement();t.centerArea=t.assembleCenterArea();var r=new b({centerArea:t.centerArea,totalCountBar:t.assembleCountLabel(),noResultScreen:new h({searchBoxTerm:{parts:[{path:'/queryFilter/searchTerm'}],formatter:function(s){return s;}},visible:{parts:[{path:'/count'},{path:'/isBusy'},{path:'/firstSearchWasExecuted'}],formatter:function(i,l,p){return i===0&&!l&&p;}}}),totalCountHiddenElement:t.totalCountHiddenElement});t.searchLayout=new a({resultListContainer:r,busyIndicator:new sap.m.BusyDialog(),isBusy:'{/isBusy}',busyDelay:'{/busyDelay}',showFacets:{parts:[{path:'/count'},{path:'/facetVisibility'},{path:'/uiFilter/rootCondition'},{path:'/isBusy'}],formatter:function(i,l,p,q){if(!l){return false;}var s=p&&p.conditions&&p.conditions.length>0;if(i===0&&!s&&!q){return false;}return true;}},vertical:false,facets:new sap.ushell.renderers.fiori2.search.controls.SearchFacetFilter()});t.searchLayout.addStyleClass('sapUshellSearchLayout');t.searchContainer=new sap.ushell.renderers.fiori2.search.controls.DivContainer({content:[t.searchLayout],cssClass:'sapUshellSearchContainer'});t.oFocusHandler=new j.SearchFocusHandler(t);return t.searchContainer;},assembleFilterButton:function(){var t=this;var e=new sap.m.ToggleButton({icon:sap.ui.core.IconPool.getIconURI("filter"),tooltip:{parts:[{path:'/facetVisibility'}],formatter:function(i){return i?sap.ushell.resources.i18n.getText("hideFacetBtn_tooltip"):sap.ushell.resources.i18n.getText("showFacetBtn_tooltip");}},pressed:'{/facetVisibility}',press:function(){if(this.getPressed()){t.searchLayout.setAnimateFacetTransition(true);t.getModel().setFacetVisibility(true);t.searchLayout.setAnimateFacetTransition(false);}else{t.searchLayout.setAnimateFacetTransition(true);t.getModel().setFacetVisibility(false);t.searchLayout.setAnimateFacetTransition(false);}},visible:{parts:[{path:'/businessObjSearchEnabled'},{path:'/count'}],formatter:function(i,l){if(l===0){return false;}return!sap.ui.Device.system.phone&&i;}}});e.addStyleClass('searchBarFilterButton');return e;},searchToolbarEntryVisibility:{parts:[{path:'/count'}],formatter:function(e){return e!==0&&!sap.ui.Device.system.phone;}},assembleCountLabel:function(){var l=new sap.m.Label({visible:{parts:[{path:'/count'}],formatter:function(e){return e!==0;}},text:{parts:[{path:'/count'},{path:'/nlqSuccess'},{path:'/nlqDescription'}],formatter:function(e,i,p){if(i){return p;}if(typeof e!=='number'){return"";}var q=j.formatInteger(e);return sap.ushell.resources.i18n.getText("results")+' ('+q+')';}}});l.addStyleClass('sapUshellSearchTotalCountSelenium');return l;},assembleCountHiddenElement:function(){var t=new sap.ui.core.InvisibleText({text:{parts:[{path:'/count'},{path:'/nlqSuccess'},{path:'/nlqDescription'}],formatter:function(e,i,l){if(i){return l;}if(typeof e!=='number'){return"";}return sap.ushell.resources.i18n.getText("results_count_for_screenreaders",[e]);}}});return t;},assembleSearchToolbar:function(w){var t=this;var e=t.assembleDisplaySwitchTapStrips();var i=new sap.m.Button({icon:"sap-icon://sort",tooltip:"{i18n>sortTable}",type:sap.m.ButtonType.Transparent,visible:{parts:[{path:'/displaySwitchVisibility'},{path:'/count'},{path:'/tableSortableColumns'}],formatter:function(q,r,u){return q&&r!==0&&u.length>1;}},press:function(q){t.tableSortDialog.open();}});e.addEventDelegate({onAfterRendering:function(E){var D=E.srcControl;var q=t.getModel().config.gridView?3:2;if(D.getItems().length===q&&t.determineIfMaps(t)){D.addItem(new sap.m.SegmentedButtonItem({icon:"sap-icon://map",tooltip:sap.ushell.resources.i18n.getText("displayMap"),key:"map"}));}else if(D.getItems().length===(q+1)&&!t.determineIfMaps(t)){D.removeItem(D.getItems()[q]);if(t.getModel().getProperty('/resultToDisplay')==="searchResultMap"){t.getModel().setProperty('/resultToDisplay',"searchResultList");}}}});e.addStyleClass("sapUshellSearchResultDisplaySwitch");i.addStyleClass("sapUshellSearchTableSortButton");var l=new sap.m.Button("tablePersonalizeButton",{icon:"sap-icon://action-settings",tooltip:"{i18n>personalizeTable}",type:sap.m.ButtonType.Transparent,visible:{parts:[{path:'/resultToDisplay'}],formatter:function(r){return r==="searchResultTable";}},press:function(q){t.oTablePersoController.openDialog();}});l.addStyleClass("sapUshellSearchTablePersonalizeButton");var p=new sap.m.Button("dataExportButton",{icon:"sap-icon://download",tooltip:"{i18n>exportData}",type:sap.m.ButtonType.Transparent,visible:{parts:[{path:'/displaySwitchVisibility'},{path:'/count'}],formatter:function(q,r){return q&&r!==0;}},press:function(){if(t.searchSpreadsheet===undefined){t.searchSpreadsheet=new g("ushell-search-spreadsheet");}t.searchSpreadsheet.onExport();}});if(!w){var s=this.assembleShareButton();return[p,l,i,s,e];}return[p,l,i,e];},assembleShareButton:function(){var t=this;var B=new sap.ushell.ui.footerbar.AddBookmarkButton({beforePressHandler:function(){var i={url:document.URL,title:t.getModel().getDocumentTitle(),icon:sap.ui.core.IconPool.getIconURI("search")};B.setAppData(i);}});B.setWidth('auto');var e=new sap.m.Button();e.setIcon("sap-icon://email");e.setText(sap.ushell.resources.i18n.getText("eMailFld"));e.attachPress(function(){sap.m.URLHelper.triggerEmail(null,t.getModel().getDocumentTitle(),document.URL);});e.setWidth('auto');var A=new sap.m.ActionSheet({placement:'Bottom',buttons:[B,e]});var s=new sap.m.Button({icon:'sap-icon://action',tooltip:sap.ushell.resources.i18n.getText('shareBtn'),press:function(){A.openBy(s);}});return s;},assembleDataSourceTapStrips:function(){var t=this;var e=new sap.m.OverflowToolbar({design:sap.m.ToolbarDesign.Transparent,visible:{parts:[{path:'/facetVisibility'},{path:'/count'},{path:'/businessObjSearchEnabled'}],formatter:function(i,p,q){return!i&&p>0&&q;}}});e.data("sap-ui-fastnavgroup","false",true);e.addStyleClass('searchTabStrips');t.tabBar=e;var l=new sap.ui.core.InvisibleText({text:"Data Sources"}).toStatic();e.addDependent(l);e.addAriaLabelledBy(l);e.bindAggregation('content','/tabStrips/strips',function(I,p){var q=new sap.m.ToggleButton({text:'{labelPlural}',type:{parts:[{path:'/tabStrips/selected'}],formatter:function(s){var i=this.getBindingContext().getObject();if(i===s){return sap.m.ButtonType.Transparent;}return sap.m.ButtonType.Transparent;}},pressed:{parts:[{path:'/tabStrips/selected'}],formatter:function(s){var i=this.getBindingContext().getObject();return i===s;}},press:function(s){if(t.getModel().config.searchScopeWithoutAll){return;}this.setType(sap.m.ButtonType.Transparent);if(this.getBindingContext().getObject()===t.getModel().getProperty('/tabStrips/selected')){this.setPressed(true);return;}var B=t.tabBar.getContent();for(var i=0;i<B.length;i++){if(B[i].getId()!==this.getId()){B[i].setType(sap.m.ButtonType.Transparent);if(B[i].getPressed()===true){B[i].setPressed(false);}}}t.getModel().setDataSource(this.getBindingContext().getObject());}});var r=new sap.ui.core.InvisibleText({text:p.getProperty("labelPlural")+", "+sap.ushell.resources.i18n.getText("dataSource")}).toStatic();q.addAriaLabelledBy(r);q.addDependent(r);return q;});e._setupItemNavigation=function(){if(!this.theItemNavigation){this.theItemNavigation=new sap.ui.core.delegate.ItemNavigation();this.addDelegate(this.theItemNavigation);}this.theItemNavigation.setCycling(false);this.theItemNavigation.setRootDomRef(this.getDomRef());var p=[];var q=this.getContent();for(var i=0;i<q.length;i++){if(!$(q[i].getDomRef()).attr("tabindex")){var r="-1";if(q[i].getPressed&&q[i].getPressed()){r="0";}$(q[i].getDomRef()).attr("tabindex",r);}p.push(q[i].getDomRef());}var s=this.getAggregation("_overflowButton");if(s&&s.getDomRef){var _=s.getDomRef();p.push(_);$(_).attr("tabindex","-1");}this.theItemNavigation.setItemDomRefs(p);};e.addEventDelegate({onAfterRendering:function(E){var t=this;t.getAggregation("_overflowButton").addEventDelegate({onAfterRendering:function(E){t._setupItemNavigation();}},t.getAggregation("_overflowButton"));var i=$(t.getDomRef());i.attr("role","tablist");i.children("button").attr("role","tab");t._setupItemNavigation();}},e);return e;},reorgTabBarSequence:function(){if(!this.tabBar){return;}var e=new sap.m.OverflowToolbarLayoutData({priority:sap.m.OverflowToolbarPriority.High});var l=new sap.m.OverflowToolbarLayoutData({priority:sap.m.OverflowToolbarPriority.NeverOverflow});var B=this.tabBar.getContent();for(var i=0;i<B.length;i++){if(this.getModel().getProperty('/tabStrips/selected')===B[i].getBindingContext().getObject()){B[i].setLayoutData(l);}else{B[i].setLayoutData(e);}}},determineIfMaps:function(e){var I=false;if(e.getModel()){var l=e.getModel().getDataSource();if(typeof l!=='undefined'&&l.attributesMetadata){var p=l.attributesMetadata;for(var i=0;i<p.length;i++){var t=p[i].type;if(t==="GeoJson"){I=true;break;}}}if(e.getModel().config.maps===true){I=true;}else if(e.getModel().config.maps===false){I=false;}}return I;},assembleDisplaySwitchTapStrips:function(){var t=this;var i=[new sap.m.SegmentedButtonItem({icon:"sap-icon://list",tooltip:sap.ushell.resources.i18n.getText("displayList"),key:"list"}),new sap.m.SegmentedButtonItem({icon:"sap-icon://table-view",tooltip:sap.ushell.resources.i18n.getText("displayTable"),key:"table"})];var e=S.getInstance();if(e.gridView){i.push(new sap.m.SegmentedButtonItem({icon:"sap-icon://grid",tooltip:sap.ushell.resources.i18n.getText("displayGrid"),key:"grid"}));}if(t.determineIfMaps(t)){i.push(new sap.m.SegmentedButtonItem({icon:"sap-icon://map",tooltip:sap.ushell.resources.i18n.getText("displayMap"),key:"map"}));}var s=new sap.m.SegmentedButton('ResultViewType',{selectedKey:{parts:[{path:'/resultToDisplay'}],formatter:function(r){var l="list";if(r==="searchResultTable"){l="table";}else if(r==="searchResultGrid"){l="grid";}else if(r==="searchResultList"){l="list";}else if(r==="searchResultMap"){l="map";}return l;}},items:i,visible:{parts:[{path:'/displaySwitchVisibility'},{path:'/count'}],formatter:function(l,p){return l&&p!==0;}},select:function(l){var p=l.mParameters.key;var q=t.getModel();switch(p){case"list":q.setProperty('/resultToDisplay',"searchResultList");t.showMoreFooter.setVisible(t.isShowMoreFooterVisible());t.searchResultMap.setVisible(false);break;case"table":q.setProperty('/resultToDisplay',"searchResultTable");t.showMoreFooter.setVisible(t.isShowMoreFooterVisible());t.searchResultMap.setVisible(false);break;case"grid":q.setProperty('/resultToDisplay',"searchResultGrid");t.showMoreFooter.setVisible(t.isShowMoreFooterVisible());t.searchResultMap.setVisible(false);break;case"map":q.setProperty('/resultToDisplay',"searchResultMap");t.showMoreFooter.setVisible(t.isShowMoreFooterVisible());break;default:q.setProperty('/resultToDisplay',"searchResultList");t.showMoreFooter.setVisible(t.isShowMoreFooterVisible());}q.enableOrDisableMultiSelection();}.bind(this)});s.addStyleClass("sapUshellSearchDisplaySwitchTapStrips");return s;},isShowMoreFooterVisible:function(){var e=this.getModel();return e.getProperty("/boCount")>e.getProperty("/boResults").length;},assembleCenterArea:function(){var t=this;t.tableSortDialog=t.assembleSearchResultSortDialog();var s=t.assembleSearchResultList();t.searchResultTable=t.assembleSearchResultTable();t.searchResultTable.addDelegate({onBeforeRendering:function(){t.updateTableLayout();},onAfterRendering:function(){var e=$(t.searchResultTable.getDomRef()).find("table > thead > tr:first");if(e){e.attr("aria-labelledby",t.totalCountHiddenElement.getId());}}});t.searchResultGrid=t.assembleSearchResultGrid();t.searchResultMap=t.assembleSearchResultMap();t.searchResultMap.setVisible(false);t.appSearchResult=t.assembleAppSearch();t.showMoreFooter=t.assembleShowMoreFooter();return[t.tableSortDialog,s,t.searchResultTable,t.searchResultGrid,t.searchResultMap,t.appSearchResult,t.showMoreFooter,t.totalCountHiddenElement];},assembleSearchResultSortDialog:function(){var t=this;var e=new sap.m.ViewSettingsDialog({sortDescending:{parts:[{path:"/orderBy"}],formatter:function(i){return jQuery.isEmptyObject(i)||i.sortOrder==="DESC";}},confirm:function(i){var p=[];p=i.getParameters();if(p.sortItem){var l=t.getModel();if(p.sortItem.getKey()==="searchSortableColumnKeyDefault"){l.resetOrderBy();e.setSortDescending(true);}else{l.setOrderBy({orderBy:p.sortItem.getBindingContext().getObject().attributeId,sortOrder:p.sortDescending===true?"DESC":"ASC"});}}},cancel:function(i){var l=t.getModel().getOrderBy().orderBy===undefined?"searchSortableColumnKeyDefault":t.getModel().getOrderBy().orderBy;this.setSelectedSortItem(l);}});e.bindAggregation("sortItems","/tableSortableColumns",function(p,D){return new sap.m.ViewSettingsItem({key:"{key}",text:"{name}",selected:"{selected}"});});return e;},assembleSearchResultGrid:function(){var l=new sap.f.GridContainerSettings({rowSize:"11rem",columnSize:"11rem",gap:"0.5rem"});var r=new f("ushell-search-result-grid",{layout:l,snapToRow:true,visible:{parts:[{path:'/resultToDisplay'},{path:'/count'}],formatter:function(e,i){return e==="searchResultGrid"&&i!==0;}}});return r;},assembleSearchResultTable:function(){var t=this;var r=new d("ushell-search-result-table",{mode:{parts:[{path:'/multiSelectionEnabled'}],formatter:function(e){return e===true?sap.m.ListMode.MultiSelect:sap.m.ListMode.None;}},noDataText:'{i18n>noCloumnsSelected}',visible:{parts:[{path:'/resultToDisplay'},{path:'/count'}],formatter:function(e,i){return e==="searchResultTable"&&i!==0;}},popinLayout:sap.m.PopinLayout.GridLarge,rememberSelections:false});r.bindAggregation("columns","/tableColumns",function(p,D){var e=D.getObject();var i=new sap.m.Column(e.key,{header:new sap.m.Label({text:"{name}",tooltip:"{name}"}),visible:{parts:[{path:'index'}],formatter:function(l){return l<6;}}});return i;});r.bindAggregation("items","/tableResults",function(p,D){return t.assembleTableItems(D);});r.addEventDelegate({onAfterRendering:function(){t.updatePersoServiceAndController();var e=$(this.getDomRef());e.find("table tbody tr").each(function(){var i=$(this);var l=sap.ui.getCore().byId(i.attr("id"));if(l){var p=l.getAriaLabelledBy();if($.inArray(t.totalCountHiddenElement.getId(),p)===-1){l.addAriaLabelledBy(t.totalCountHiddenElement);}}return false;});}.bind(r)});return r;},assembleTableItems:function(D){var t=this;var e=D.getObject();if(e.type==='footer'){return new sap.m.CustomListItem({visible:false});}return t.assembleTableMainItems(e,D.getPath());},assembleTableMainItems:function(D,p){var s=p+"/cells";var e=new sap.m.ColumnListItem({selected:"{selected}"});e.bindAggregation("cells",s,function(s,l){if(l.getObject().isTitle){var t="";var q;var r=l.getObject().titleNavigation;if(r){t=r.getHref();q=r.getTarget();}var u=!!((t&&t.length>0));var v=new m({text:"{value}",enabled:u,href:t,press:function(){var r=l.getObject().titleNavigation;if(r){r.performNavigation({trackingOnly:true});}}});v.setTooltip(v.getText());v.addStyleClass("sapUshellSearchResultListItem-MightOverflow");if(q){v.setTarget(q);}return v;}else if((l.getObject().isRelatedApps)){var w=l.getObject().navigationObjects;var x=[];var y={};var z=function(B,A){A.performNavigation();};for(var i=0;i<w.length;i++){var A=w[i];y=new sap.m.Button({text:A.getText(),tooltip:A.getText()});y.attachPress(A,z);x.push(y);}return new sap.m.Button({icon:"sap-icon://action",press:function(){var B=new sap.m.ActionSheet({buttons:x,placement:sap.m.PlacementType.Auto});B.openBy(this);}});}return new k({text:"{value}"}).addStyleClass("sapUshellSearchResultListItem-MightOverflow");});return e;},onRegionClick:function(e){},onRegionContextMenu:function(e){},assembleSearchResultMap:function(){var s=new n({visible:{parts:[{path:'/resultToDisplay'},{path:'/count'}],formatter:function(r,e){return r==="searchResultMap"&&e!==0;}}});return s;},assembleShowMoreFooter:function(){var t=this;var e=new sap.m.Button({text:"{i18n>showMore}",type:sap.m.ButtonType.Transparent,press:function(){var l=t.getModel();l.setProperty('/focusIndex',l.getTop());var p=l.getTop()+l.pageSize;l.setTop(p);l.eventLogger.logEvent({type:l.eventLogger.SHOW_MORE});}});e.addStyleClass('sapUshellResultListMoreFooter');var i=new sap.m.FlexBox({visible:{parts:[{path:'/boCount'},{path:'/boResults'}],formatter:function(l,p){return p.length<l;}},justifyContent:sap.m.FlexJustifyContent.Center});i.addStyleClass('sapUshellResultListMoreFooterContainer');i.addItem(e);return i;},assembleSearchResultList:function(){var t=this;t.resultList=new c({mode:sap.m.ListMode.None,width:"auto",showNoData:false,visible:{parts:[{path:'/resultToDisplay'},{path:'/count'}],formatter:function(r,e){return r==="searchResultList"&&e!==0;}}});t.resultList.bindAggregation("items","/results",function(p,e){return t.assembleListItem(e);});return t.resultList;},assembleAppSearch:function(){var t=this;var e=new sap.ushell.renderers.fiori2.search.controls.SearchTilesContainer("AppSearchContainer",{addAccInformation:true,maxRows:99999,totalLength:'{/appCount}',visible:{parts:[{path:'/resultToDisplay'},{path:'/count'}],formatter:function(r,i){return r==="appSearchResult"&&i!==0;}},highlightTerms:'{/uiFilter/searchTerm}',showMore:function(){var i=t.getModel();i.setProperty('/focusIndex',e.getNumberDisplayedTiles()-1);var l=i.getTop()+i.pageSize*e.getTilesPerRow();i.setTop(l);}});e.bindAggregation('tiles','/appResults',function(i,l){if(t.getModel().getResultToDisplay()==="appSearchResult"){return l.getObject().getView();}return new sap.m.Text({text:""});});e.addStyleClass('sapUshellSearchTileResultList');return e;},assembleTitleItem:function(D){var i=new sap.m.CustomListItem();var t=new sap.m.Label({text:"{title}"});t.addStyleClass('bucketTitle');i.addStyleClass('bucketTitleContainer');i.addContent(new sap.m.HBox({items:[t]}));return i;},assembleAppContainerResultListItem:function(D,p){var t=this;var e=new sap.ushell.renderers.fiori2.search.controls.SearchTilesContainer("AppSearchContainerResultListItem",{maxRows:sap.ui.Device.system.phone?2:1,totalLength:'{/appCount}',highlightTerms:'{/uiFilter/searchTerm}',enableKeyHandler:false,resultList:t.resultList,showMore:function(){var i=t.getModel();i.setDataSource(i.appDataSource);}});e.bindAggregation('tiles','tiles',function(i,q){if(t.getModel().getResultToDisplay()!=="appSearchResult"){return q.getObject().getView();}return new sap.m.Text({text:""});});var l=new sap.m.CustomListItem({content:e});l.addStyleClass('sapUshellSearchResultListItem');l.addStyleClass('sapUshellSearchResultListItemApps');l.addEventDelegate({onAfterRendering:function(E){var i=$(l.getDomRef());i.removeAttr("tabindex");i.removeAttr("role");i.attr("aria-hidden","true");}},l);return l;},assembleResultListItem:function(D,p){var t=this;var e=this.getModel().config.getDataSourceConfig(D.dataSource);var s={dataSource:D.dataSource,title:"{title}",titleDescription:"{titleDescription}",titleNavigation:"{titleNavigation}",type:"{dataSourceName}",imageUrl:"{imageUrl}",imageFormat:"{imageFormat}",imageNavigation:"{imageNavigation}",geoJson:"{geoJson}",attributes:"{itemattributes}",navigationObjects:"{navigationObjects}",selected:"{selected}",expanded:"{expanded}",positionInList:"{positionInList}",resultSetId:"{resultSetId}",layoutCache:"{layoutCache}"};var i;if(e.searchResultListItemControl){i=new e.searchResultListItemControl(s);}else if(e.searchResultListItemContentControl){s.content=new e.searchResultListItemContentControl();i=new C(s);}else{i=new o(s);}if(i.setTotalCountHiddenElement){i.setTotalCountHiddenElement(t.totalCountHiddenElement);}var l=new sap.m.CustomListItem({content:i,type:sap.m.ListType.Inactive});l.addStyleClass('sapUshellSearchResultListItem');if(i.setParentListItem){i.setParentListItem(l);}return l;},assembleListItem:function(e){var t=this;var D=e.getObject();if(D.type==='title'){return t.assembleTitleItem(D);}else if(D.type==='footer'){return new sap.m.CustomListItem();}else if(D.type==='appcontainer'){return t.assembleAppContainerResultListItem(D,e.getPath());}return t.assembleResultListItem(D,e.getPath());},onAllSearchStarted:function(){},onAllSearchFinished:function(){var t=this;t.reorgTabBarSequence();t.oFocusHandler.setFocus();var v=sap.ui.getCore().byId('viewPortContainer');if(v&&v.switchState){v.switchState('Center');}},updatePersoServiceAndController:function(){var t=this;var e=t.getModel();var i=e.getDataSource().id;var s='search-result-table-state-'+i;if(!t.oTablePersoController){var p=e.getPersonalizationStorageInstance();t.oTablePersoController=new sap.m.TablePersoController({table:sap.ui.getCore().byId("ushell-search-result-table"),persoService:p.getPersonalizer(s)}).activate();t.oTablePersoController.refresh();}if(t.oTablePersoController&&t.oTablePersoController.getPersoService().getKey()!==s){t.oTablePersoController.setPersoService(e.getPersonalizationStorageInstance().getPersonalizer(s));t.oTablePersoController.refresh();}},updateTableLayout:function(){var t=this;if(t.searchResultTable&&t.oTablePersoController){var e=t.getModel().getDataSource().id;var s='search-result-table-state-'+e;t.oTablePersoController.getPersoService(s).getPersData().then(function(p){if(p&&p.aColumns){var l=p.aColumns;var q=this.searchResultTable.getColumns();var v=0;for(var i=0;i<l.length;i++){var r=l[i].id.split('table-searchColumnKey').pop();var u=q[parseInt(r,10)];if(u){u.setDemandPopin(false);if(l[i].visible){v++;u.setDemandPopin(true);u.setPopinDisplay(sap.m.PopinDisplay.Inline);var w=12*v;u.setMinScreenWidth(w+"rem");}}}if(v<=3){this.searchResultTable.setFixedLayout(false);}else{this.searchResultTable.setFixedLayout(true);}}}.bind(this));}},setAppView:function(A){var t=this;t.oAppView=A;if(t.oTilesContainer){t.oTilesContainer.setAppView(A);}},getControllerName:function(){return"sap.ushell.renderers.fiori2.search.container.Search";}});});
