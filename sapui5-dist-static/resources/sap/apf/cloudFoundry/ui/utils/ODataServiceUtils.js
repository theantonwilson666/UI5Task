sap.ui.define(["sap/ui/model/odata/v2/ODataModel"],function(O){'use strict';var D="/destination/";var C="/sap/opu/odata/iwfnd/catalogservice;v=2/";var M="/$metadata";var a="/odata/v2/";var b={CATALOG:"CATALOG",SERVICE:"SERVICE",OTHER:"OTHER"};var S={PENDING:"PENDING",ANALYTICAL_SERVICE:"ANALYTICAL_SERVICE",NOT_ANALYTICAL_SERVICE:"NOT_ANALYTICAL_SERVICE",WRONG_ODATA_VERSION:"WRONG_ODATA_VERSION",NOT_ACCESSIBLE:"NOT_ACCESSIBLE"};function g(d){return D+d+C;}function c(s){var m=(s||"").match(new RegExp("https?:\\/\\/[^\\/]+\\/(.+)"));return m?("/"+m[1]):"";}function e(u,B){if(!u||typeof(u)!=="string"||!B||typeof(B)!=="string"){return undefined;}else if(!B.includes("://")){return undefined;}var r;if(u.startsWith(B)){r=u.slice(B.length);}else if(u.includes("://")){return undefined;}else{r=u;}if(r.startsWith("/")){return r;}return"/"+r;}function f(d,s){return D+d+s;}function p(d){var k=function(o,r){jQuery.ajax(D+o.name+M).then(function(){r(b.SERVICE);}).fail(function(){if(o.proxyType=="OnPremise"){jQuery.ajax(D+o.name+C).then(function(){r(b.CATALOG);}).fail(function(){r(b.OTHER);});}else{r(b.OTHER);}});};return d.map(function(o){return new Promise(function(r){k(o,r);});}).reduce(function(A,P,i){A[d[i].name]=P;return A;},{});}function h(d,s){return new Promise(function(r,i){var k=f(d,s);var o=new O(k);o.attachMetadataFailed(function(E){var l=E.getParameter("response");if(l&&l.headers["odata-version"]&&!l.headers["odata-version"].startsWith("2")){i(S.WRONG_ODATA_VERSION);}else{i(S.NOT_ACCESSIBLE);}});var m=o.getMetaModel();m.loaded().then(function(){var I=m.getODataEntityContainer().entitySet.some(function(l){return m.getODataEntityType(l.entityType).property.some(function(n){return n["sap:aggregation-role"]==="measure";});});r(I?S.ANALYTICAL_SERVICE:S.NOT_ANALYTICAL_SERVICE);});});}function j(s){return new Promise(function(r,k){jQuery.ajax(D+s+a).done(function(l,m,n){if(n.status===200&&jQuery(l).filter("h1").text().trim()==="OData endpoints:"){var E=jQuery(l).filter('a').map(function(i,d){return{Url:c(d.href)};}).toArray();r(E);}else{k();}}).fail(function(){k();});});}return{DESTINATION_TYPE:b,SERVICE_STATUS:S,getCatalogURL:g,getRelativeServiceURL:c,getFullServiceURL:f,getRelativeURL:e,pingDestinations:p,isAnalyticalService:h,discoverServices:j};},true);
