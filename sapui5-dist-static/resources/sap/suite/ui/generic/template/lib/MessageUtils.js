sap.ui.define(["sap/ui/generic/app/util/MessageUtil","sap/suite/ui/generic/template/genericUtilities/controlHelper","sap/suite/ui/generic/template/genericUtilities/FeLogger"],function(G,c,F){"use strict";var l=new F("lib.MessageUtils").getLogger();function h(o,C,S,e,p,m){p=p||{};var E=G.parseErrorResponse(e);var M=E.messageText;var b;var d=false;var i=false;var j=C&&C.getOwnerComponent();var r=p.resourceBundle||j.getModel("i18n").getResourceBundle();var k=p.navigationController||S.oNavigationController;var q=p.model||j.getModel();l.debug("handleError has been called with operation "+o+" and HTTP response status code "+E.httpStatusCode);var t=m&&m[E.httpStatusCode];if(t){t(E.httpStatusCode);}var H=E.httpStatusCode;switch(H){case 400:switch(o){case G.operations.modifyEntity:break;case G.operations.callAction:M=r.getText("ST_GENERIC_BAD_REQUEST_ACTION");break;case G.operations.deleteEntity:M=r.getText("ST_GENERIC_BAD_REQUEST_DELETE");break;case G.operations.editEntity:M=r.getText("ST_GENERIC_BAD_REQUEST_EDIT");break;case G.operations.saveEntity:case G.operations.activateDraftEntity:if(S&&S.oTemplateCapabilities&&S.oTemplateCapabilities.oMessageButtonHelper&&S.oTemplateCapabilities.oMessageButtonHelper.showMessagePopover){S.oTemplateCapabilities.oMessageButtonHelper.showMessagePopover();i=true;}else{l.info("A MessageButtonHelper class instance could not be found as one of the services' template capabilities.");}break;default:M=r.getText("ST_GENERIC_BAD_REQUEST");break;}break;case 401:d=true;M=r.getText("ST_GENERIC_ERROR_AUTHENTICATED_FAILED");b=r.getText("ST_GENERIC_ERROR_AUTHENTICATED_FAILED_DESC");break;case 403:switch(o){case G.operations.callAction:M=r.getText("ST_GENERIC_ERROR_NOT_AUTORIZED_ACTION");break;case G.operations.addEntry:M=r.getText("ST_GENERIC_ERROR_NOT_AUTORIZED_CREATE");break;case G.operations.deleteEntity:M=r.getText("ST_GENERIC_ERROR_NOT_AUTORIZED_DELETE");break;case G.operations.editEntity:M=r.getText("ST_GENERIC_ERROR_NOT_AUTORIZED_EDIT");break;default:M=r.getText("ST_GENERIC_ERROR_NOT_AUTORIZED");b=r.getText("ST_GENERIC_ERROR_NOT_AUTORIZED_DESC");d=true;break;}break;case 404:switch(o){case G.operations.callAction:M=r.getText("ST_GENERIC_BAD_REQUEST_ACTION");break;default:M=r.getText("ST_GENERIC_BAD_REQUEST");break;}break;case 409:case 412:if((o===G.operations.activateDraftEntity||o===G.operations.deleteEntity)&&e.response&&e.response.headers&&e.response.headers["preference-applied"]==="handling=strict"){return;}break;case 422:break;case 423:if(o===G.operations.activateDraftEntity||o===G.operations.saveEntity||o===G.operations.deleteEntity){return;}break;case 500:case 501:case 502:case 503:case 504:case 505:d=!Object.keys(G.operations).some(function(u){return u===o;});switch(o){case G.operations.callAction:M=r.getText("ST_GENERIC_ERROR_SYSTEM_UNAVAILABLE_FOR_ACTION");break;default:M=r.getText("ST_GENERIC_ERROR_SYSTEM_UNAVAILABLE");break;}b=r.getText("ST_GENERIC_ERROR_SYSTEM_UNAVAILABLE_DESC");break;case 0:d=false;i=true;break;default:d=true;M=r.getText("ST_GENERIC_ERROR_SYSTEM_UNAVAILABLE");b=r.getText("ST_GENERIC_ERROR_SYSTEM_UNAVAILABLE_DESC");break;}if(d){var v;if(j){var T=j.getModel("_templPriv");v=T.getProperty("/generic/viewLevel");}k.navigateToMessagePage({title:r.getText("ST_GENERIC_ERROR_TITLE"),text:M,description:b,icon:"sap-icon://message-error",viewLevel:v});}else{if(!E.containsTransientMessage&&!i){G.addTransientErrorMessage(M,b,q);}}}function n(C,m){var i=C.getPositionableControlId(m.controlIds,true);c.focusControl(i);}function g(o,S){if(S){var b=o.getSections();var d;for(var i=0;i<b.length;i++){if(b[i].getVisible()&&b[i].getTitle()===S){d=b[i];break;}}return d;}}function N(o,S){var u=o.getUseIconTabBar();if(u){var b=g(o,S);var d=o.getSelectedSection();if(b&&d!==b.getId()){o.setSelectedSection(b.getId());}}}function f(C,e,o){var m=e.getParameter("item");var O=o?o.byId("objectPage"):undefined;if(O){var S=m.getGroupName();N(O,S);}var M=m.getBindingContext("msg").getObject();n(C,M);}function s(b,S){var m=sap.ui.getCore().getMessageManager().getMessageModel().getData();var M=m.some(function(o){return o.persistent;});if(!M){S.oApplication.showMessageToast(b);}}function a(m){var t=m.getTechnicalDetails();return!!t&&t.statusCode==="412"&&!t.headers["preference-applied"];}return{operations:G.operations,handleTransientMessages:G.handleTransientMessages,handleError:h,navigateFromMessageTitleEvent:f,removeTransientMessages:G.removeTransientMessages,getTransientMessages:G.getTransientMessages,showSuccessMessageIfRequired:s,parseError:G.parseErrorResponse,isMessageETagMessage:a};});
