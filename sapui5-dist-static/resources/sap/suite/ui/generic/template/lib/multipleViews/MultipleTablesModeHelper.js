sap.ui.define(["sap/ui/base/Object","sap/ui/Device","sap/ui/model/Filter","sap/suite/ui/generic/template/genericUtilities/testableHelper","sap/base/util/extend"],function(B,D,F,t,e){"use strict";function h(f,H){if(Array.isArray(f)){var o=true;var a;for(var i=0;i<f.length;i++){var b=h(f[i],H);if(o){if(b===f[i]){continue;}o=false;a=f.slice(0,i);}if(b){a.push(b);}}return o?f:a;}if(f.aFilters){var n=h(f.aFilters,H);if(n===f.aFilters){return f;}if(n.length===0){return null;}if(n.length===1){return n[0];}return new F({filters:n,and:f.bAnd});}return H(f);}function g(c,T,C){var s;var o=T.oComponentUtils.getTemplatePrivateModel();var p=C.pathInTemplatePrivateModel+'/implementingHelper';var I=p+"/ignoredFilters";o.setProperty(p,{ignoredFilters:[]});function G(i,j){return i;}function f(){var i;for(var j in s){var V=s[j];var K=V.smartControl.getEntitySet();if(i&&i!==K){return true;}i=K;}return false;}function a(i,V,j,K){if(j&&K){r(i,j);}var L=C.smartFilterBar;if(!L){return i;}var M=L.getFilters();if(M.length<1){if(!K){o.setProperty(I,[]);V.implementingHelperAttributes.ignoredLabels=[];}return i;}var N=!K&&Object.create(null);M=d(V,M,N);return M.concat(i);}function b(P){var i,j;if(P.indexOf("/")!==-1){i=P.split("/");j=i.pop();}else{j=P;}return j;}function d(V,i,j){var K=V.smartControl;var M=K.getModel().getMetaModel();var L=T.oCommonUtils.getMetaModelEntityType(K);var N=L.navigationProperty;var P=function(X){var Y=X.sPath;var Z=false;var $=b(Y);var _=k(Y,K,M,L,N,V);_.some(function(a1){var b1;if(a1.name===$){b1=a1["com.sap.vocabularies.UI.v1.Hidden"];Z=b1?b1.Bool!=="true":true;return Z;}return false;});if(Z){return X;}if(j){j[Y]=true;}return null;};var Q=h(i,P);if(j){var U=Object.keys(j);var W=U.map(function(X){var Y=q(X,V.smartControl);return Y["sap:label"]||(Y["com.sap.vocabularies.Common.v1.Label"]?Y["com.sap.vocabularies.Common.v1.Label"].String:Y.name);});o.setProperty(I,W);V.implementingHelperAttributes.ignoredLabels=W;}return Q;}function k(P,K,M,L,N,V){var Q,U,W,X,Y;if(P.indexOf("/")!==-1){Q=P.split("/");for(var i=0;i<Q.length-1;i++){U=Q[i];for(var j in N){if(N[j].name===U){W=true;break;}}if(!W){return[];}X=M.getODataAssociationEnd(L,U);L=X&&M.getODataEntityType(X.type);N=L&&L.navigationProperty;}Y=L&&L.property;}else{Y=V.implementingHelperAttributes.entityTypeProperty;}return Y;}function r(K,L){for(var i in L){var M=L[i];for(var j=K.length;j--;j>=0){if(JSON.stringify(K[j])===JSON.stringify(M)){K.splice(j,1);break;}}}}function l(V){var i=T.oCommonUtils.getMetaModelEntityType(V.smartControl);return{entityTypeProperty:i.property,dirtyState:0,activeObjectEnabled:false};}function m(i,R,j){s=i;for(var K in s){var V=s[K];V.implementingHelperAttributes=l(V);}if(C.smartFilterBar){C.smartFilterBar.attachSearch(function(M){R(3);});}if(C.pathToActiveObjectEnabled){var L=o.bindProperty(C.pathToActiveObjectEnabled);L.attachChange(function(M){var N=j();N.implementingHelperAttributes.activeObjectEnabled=o.getProperty(C.pathToActiveObjectEnabled);});}}function n(i,j){if(!j){return"";}var K="";var L=s[j].text;if(i&&i.length>0){if((D.system.tablet||D.system.phone)&&!D.system.desktop){if(i.length>1){K=T.oCommonUtils.getText("MESSAGE_MULTIPLE_VALUES_S_FORM",[i.join(", "),L]);}else{K=T.oCommonUtils.getText("MESSAGE_SINGLE_VALUE_S_FORM",[i[0],L]);}}else if(i.length>1){K=T.oCommonUtils.getText("MESSAGE_MULTIPLE_VALUES_L_FORM",[i.join(", "),L]);}else{K=T.oCommonUtils.getText("MESSAGE_SINGLE_VALUE_L_FORM",[i[0],L]);}}return K;}function q(P,i){var U;var j=v(i);for(var K in j){U=u(j[K],P);if(U){break;}}return U;}function u(i,P){return i.filter(function(j){return j.name===P;})[0];}function v(i){var P=[];for(var K in s){var V=s[K];if(V.smartControl!==i){P.push(V.implementingHelperAttributes.entityTypeProperty);}}return P;}function O(N){var V=s[N];var i=V.implementingHelperAttributes.ignoredLabels||[];o.setProperty(I,i);if(C.pathToActiveObjectEnabled){o.setProperty(C.pathToActiveObjectEnabled,V.implementingHelperAttributes.activeObjectEnabled);}}function w(i){var j,V;if(i){if(i.tableVariantIds){for(var K in s){j=s[K].smartControl;V=i.tableVariantIds[j.getId()];if(V){j.setCurrentVariantId(V);}}}if(C.pathToActiveObjectEnabled&&i.mEditButtonState){for(var L in s){s[L].implementingHelperAttributes.activeObjectEnabled=!!i.mEditButtonState[L];}}O(i.selectedTab);return i.selectedTab;}return null;}function x(i){var K,j,V={};for(K in s){j=s[K].smartControl;V[j.getId()]=j.getCurrentVariantId()||"";}var L={selectedTab:i,tableVariantIds:V};if(C.pathToActiveObjectEnabled){var M=Object.create(null);for(var N in s){M[N]=s[N].implementingHelperAttributes.activeObjectEnabled;}L.mEditButtonState=M;}return L;}function R(i,j,K,L,M,N,P){var Q=function(U){if(U===L&&N){P(i);return;}var V=s[U];if(V.implementingHelperAttributes.dirtyState>0&&V.implementingHelperAttributes.dirtyState!==i){V.implementingHelperAttributes.dirtyState=3;}else{V.implementingHelperAttributes.dirtyState=i;}};if(j){if(M){j.forEach(Q);return;}Q(j);return;}for(var U in s){if(!K||K[s[U].smartControl.getEntitySet()]){Q(U);}}}function y(){return"multi";}function z(N){var V=s[N];var M=V.implementingHelperAttributes.dirtyState;V.implementingHelperAttributes.dirtyState=0;return M;}function S(V){var i=V.smartControl;var o=T.oComponentUtils.getTemplatePrivateModel();var j=A(i);var K=JSON.parse(j.getValue());if(j){i.removeCustomData(j);}i.addCustomData(new sap.ui.core.CustomData({"key":"activeButtonTableState","value":!K}));o.setProperty("/listReport/activeObjectEnabled",!K);}function A(i){var j;var K=i.getCustomData();for(var L=0;L<K.length;L++){if(K[L].getKey()&&K[L].getKey()==="activeButtonTableState"){j=K[L];break;}}return j;}function E(V){var i=V.smartControl;var o=T.oComponentUtils.getTemplatePrivateModel();var j=o.getProperty("/listReport/activeObjectEnabled");var K=A(i);if(K){i.removeCustomData(K);}i.addCustomData(new sap.ui.core.CustomData({"key":"activeButtonTableState","value":j}));}function H(i,j,P){for(var K in s){var L=s[K].smartControl;if((j||P)&&L.getTable){L.setCurrentVariantId(j||P);}else if((i||P)&&L.getChart){L.setCurrentVariantId(i||P);}}}function J(i){var j=i.getEntitySet();for(var K in s){var V=s[K];var L=V.smartControl;if(L!==i&&L.getEntitySet()===j&&V.implementingHelperAttributes.dirtyState<2){V.implementingHelperAttributes.dirtyState+=2;}}}var d=t.testable(d,"fnCleanupIrrelevantFilters");return{init:m,getCustomDataHost:G,getDefaultShowCounts:f,getFiltersAdaptedFromItem:a,formatMessageStrip:n,onSelectedKeyChanged:O,getContentForIappState:x,getSelectedKeyAndRestoreFromIappState:w,refreshOperation:R,getMode:y,getRefreshMode:z,setActiveButtonState:S,restoreActiveButtonState:E,getActiveButtonStateCustomData:A,setControlVariant:H,refreshSiblingControls:J};}return B.extend("sap.suite.ui.generic.template.lib.multipleViews.MultipleTablesModeHelper",{constructor:function(c,T,C){e(this,g(c,T,C));}});});
