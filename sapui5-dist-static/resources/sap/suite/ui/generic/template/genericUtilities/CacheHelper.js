/*
* SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
*/
sap.ui.define(["sap/suite/ui/generic/template/genericUtilities/FeLogger"],function(F){"use strict";var f=new F("genericUtilities.CacheHelper");var l=f.getLogger();var L=f.Level;l.setLevel(L.ALL);var S="####";var c={writeToLocalStorage:function(k,v){try{if(window.localStorage){window.localStorage.removeItem(k.key);v=k.timestamp+S+v;window.localStorage.setItem(k.key,v);return true;}}catch(e){l.error("Locale Storage access resulted into an error");}return false;},readFromLocalStorage:function(k){var v;if(window.localStorage){v=window.localStorage.getItem(k.key);if(v){var p=v.split(S);v=p[0]===k.timestamp?p[1]:undefined;}}return v;},getCacheKeyPartsAsyc:function(m){var C=[];var p=m.metadataLoaded().then(function(P){var s;if(P&&P.lastModified){s=new Date(P.lastModified).getTime()+"";}else{l.warning("TemplateComponent: no valid cache key segment last modification date provided by the OData Model");s=new Date().getTime()+"";}return s;});C.push(p);var a=m.annotationsLoaded().then(function(P){var b=0;if(P){for(var i=0;i<P.length;i++){if(P[i].lastModified){var d=new Date(P[i].lastModified).getTime();if(d>b){b=d;}}else{l.warning("No valid cache key segment last modification date provided by OData annotations");b=new Date().getTime()+"";}}}if(b===0){l.warning("TemplateComponent: no valid cache key segment last modification date provided by OData annotations");b=new Date().getTime();}return b+"";});C.push(a);return C;},getCacheKey:function(a,e,k){return{key:a+"-"+e,timestamp:k.join("-")};},writeToLocalStorageAsync:function(a,e,k,C){return Promise.all(k).then(function(K){var o=this.getCacheKey(a,e,K);this.writeToLocalStorage(o,C);}.bind(this));}};return c;});
