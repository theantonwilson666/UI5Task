sap.ui.define(["sap/suite/ui/generic/template/changeHandler/util/AnnotationChangeUtilsV2","sap/suite/ui/generic/template/changeHandler/util/ChangeHandlerUtils","sap/suite/ui/generic/template/designtime/utils/DesigntimeUtils","sap/base/util/extend","sap/base/util/deepExtend","sap/base/util/isEmptyObject"],function(A,C,D,e,d,i){"use strict";var a={},b="DataField",c="ConnectedFields",f="Chart",g="RatingIndicator",h="ProgressIndicator",j="Contact",k="DataFieldWithIntentBasedNavigation",l="DataFieldForIntentBasedNavigation",m="DataFieldWithNavigationPath",n="DataFieldForAction",o="DataFieldWithUrl",p="ToolbarButton",L="com.sap.vocabularies.UI.v1.LineItem",q="com.sap.vocabularies.UI.v1.DataPoint",r="com.sap.vocabularies.UI.v1.DataField",s="com.sap.vocabularies.UI.v1.Chart",F="com.sap.vocabularies.UI.v1.FieldGroup",t="com.sap.vocabularies.Communication.v1.Contact",u="com.sap.vocabularies.UI.v1.DataFieldWithUrl",v="com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath",w="com.sap.vocabularies.UI.v1.DataFieldForAnnotation",x="com.sap.vocabularies.UI.v1.DataFieldForAction",y="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation",I="com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation";a.createNewColumn=function(R,O){var P,z={Label:{},Criticality:{},CriticalityRepresentation:{},IconUrl:{}},B={};B[r]=e({},z,{Value:{Path:""}});B[u]=e({},z,{Value:{Path:""},Url:{String:""}});B[v]=e({},z,{Value:{Path:""},Target:{NavigationPropertyPath:""}});B[w]=e({},z,{Target:{AnnotationPath:""}});B[x]=e({},z,{Inline:{Bool:"true"},Determining:{Bool:"false"},Action:{String:""},InvocationGrouping:{}});B[I]=e({},z,{Action:{String:""},SemanticObject:{String:""},Value:{Path:""}});B[y]=e({},z,{Inline:{Bool:"true"},Determining:{Bool:"false"},Action:{String:""},SemanticObject:{String:""}});var N={"com.sap.vocabularies.UI.v1.Importance":{"EnumMember":"com.sap.vocabularies.UI.v1.ImportanceType/High"},"RecordType":R};d(N,B[R]);for(P in N){if(P!=="RecordType"&&O&&O[P]){e(N[P],O[P]);}if(i(N[P])){delete N[P];}}return N;};a.createNewDataPointForColumn=function(z,Q,T){var V="com.sap.vocabularies.UI.v1.VisualizationType/"+Q,R=C.getLineItemRecordForColumn(z);var N={TargetValue:{String:T},Visualization:{EnumMember:V},RecordType:q+"Type",Title:{String:Q}};if(R&&R.Value&&R.Value.Path&&(R.RecordType===r||R.RecordType===I||R.RecordType===u)){N.Value={Path:R.Value.Path};}return N;};a.fixQualifierForNewColumn=function(z,T,B){var E=C.getLineItems(z),G=C.getLineItemRecordIndex(z,E),H=D.fixQualifierForAnnotationPath(E,T,B,G);return H;};a.getColumnTypeValues=function(z){var V={DataField:{displayName:"Data Field"},DataFieldWithUrl:{displayName:"Data Field with URL"},Contact:{displayName:"Contact"},DataFieldForAction:{displayName:"Inline Action"},DataFieldWithIntentBasedNavigation:{displayName:"Navigation Field"},DataFieldWithNavigationPath:{displayName:"Data Field with Nav Path"},DataFieldForIntentBasedNavigation:{displayName:"Navigation Button"},ConnectedFields:{displayName:"Connected Fields"},RatingIndicator:{displayName:"Rating Indicator"},ProgressIndicator:{displayName:"Progress Indicator"},Chart:{displayName:"Chart"}};return V;};a.getColumnType=function(E){var R=C.getLineItemRecordForColumn(E),z;if(!R){return z;}switch(R.RecordType){case x:if(R.Inline&&R.Determining!==true){z=n;}else{z=p;}break;case w:var B=R.Target.AnnotationPath;if(B){if(B.indexOf(q)>=0){var G=C.getEntityTypeFromAnnotationPath(E,B);var Q=B.search("#");var H=B.substring(Q);var J=H?q+H:q;var K=G[J];if(K){if(K.Visualization.EnumMember==="com.sap.vocabularies.UI.v1.VisualizationType/Rating"){z=g;}if(K.Visualization.EnumMember==="com.sap.vocabularies.UI.v1.VisualizationType/Progress"){z=h;}}}else if(R.Target.AnnotationPath.indexOf(t)>=0){z=j;}else if(R.Target.AnnotationPath.indexOf(s)>=0){z=f;}else if(R.Target.AnnotationPath.indexOf(F)>=0){z=c;}}break;case I:z=k;break;case y:if(R.Inline&&R.Determining!==true){z=l;}else{z=p;}break;case r:z=b;break;case u:z=o;break;case v:z=m;break;default:break;}return z;};a.setColumnType=function(z,N,B){B.noRefreshOnChange=true;B.delayRefresh=false;var O=a.getColumnType(z);if(O===N){return;}B.refreshPropertiesPane=true;var E=[],G={},H={},R,J,K={},T=C.getEntityType(C.getComponent(z));switch(N){case b:R=r;break;case o:R=u;break;case n:R=x;break;case k:R=I;break;case l:R=y;break;case m:R=v;break;case c:S=C.getLineItems(z);U=C.getLineItemRecordIndex(z,S);V=S[U]?S[U]:{};J=a.fixQualifierForNewColumn(z,F,"FE",H);var M=C.createNewFieldGroup(V);G=A.createCustomAnnotationTermChange(T,M,{},J);E.push(G);R=w;break;case f:J=a.fixQualifierForNewColumn(z,s,"FE",H);var P=D.createNewChart();G=A.createCustomAnnotationTermChange(T,P,{},J);E.push(G);R=w;break;case j:J=a.fixQualifierForNewColumn(z,t,"FE",H);var Q=D.createNewContact();G=A.createCustomAnnotationTermChange(T,Q,{},J);E.push(G);R=w;break;case g:J=a.fixQualifierForNewColumn(z,q,"FE",H);K=a.createNewDataPointForColumn(z,"Rating","4");G=A.createCustomAnnotationTermChange(T,K,{},J);E.push(G);R=w;break;case h:J=a.fixQualifierForNewColumn(z,q,"FE",H);K=a.createNewDataPointForColumn(z,"Progress","100");G=A.createCustomAnnotationTermChange(T,K,{},J);E.push(G);R=w;break;default:break;}if(!R){return;}var S=C.getLineItems(z);var U=C.getLineItemRecordIndex(z,S);if(U===-1){throw"invalid index for old column";}var V=S[U];var W=[];W.push.apply(W,S);var X=a.createNewColumn(R,V);switch(N){case g:case h:case f:case c:X.Target={AnnotationPath:"@"+J};break;case j:X.Target={AnnotationPath:"@"+J};if(!X.Label){X.Label={"String":"New Contact"};}break;default:break;}D._setP13nData(z,X);W.splice(U,1,X);G=A.createCustomAnnotationTermChange(T,W,S,L);E.push(G);return E;};return a;});
