sap.ui.define(["sap/suite/ui/generic/template/changeHandler/util/ChangeHandlerUtils","sap/suite/ui/generic/template/changeHandler/util/AnnotationChangeUtilsV2","sap/suite/ui/generic/template/designtime/utils/DesigntimeUtils","sap/base/util/extend","sap/base/util/isEmptyObject"],function(U,A,D,e,a){"use strict";var S={};var F="com.sap.vocabularies.UI.v1.FieldGroup";var b="com.sap.vocabularies.UI.v1.Facets";var L="com.sap.vocabularies.UI.v1.LineItem";var C="com.sap.vocabularies.UI.v1.Chart";var c="com.sap.vocabularies.UI.v1.CollectionFacet";var R="com.sap.vocabularies.UI.v1.ReferenceFacet";var I="com.sap.vocabularies.UI.v1.Identification";var d="com.sap.vocabularies.UI.v1.DataField";var f="com.sap.vocabularies.UI.v1.FieldGroupType";var g="com.sap.vocabularies.Communication.v1.Contact";var h="com.sap.vocabularies.Communication.v1.Address";var j="SmartForm";var k="SmartTable";var l="SmartChart";var m="Contact";var n="Address";S.createNewSection=function(o,s){var N,i={"Label":{"String":"New Group"},"ID":{},"Target":{},"RecordType":R};if(s){i.Target.AnnotationPath="@"+s;N={"ID":{},"Label":{},"Facets":[i],"RecordType":c};}var p=s?N:i;for(var P in o){if(P!=="RecordType"&&P!=="Target"&&P!=="Facets"&&p[P]){e(p[P],o[P]);}if(a(p[P])){delete p[P];}}return p;};S.getSectionTypeValues=function(){var v={SmartForm:{displayName:"Smart Form"},SmartTable:{displayName:"Smart Table"},SmartChart:{displayName:"Smart Chart"},Contact:{displayName:"Contact"},Address:{displayName:"Address"}};return v;};S.getSectionType=function(s){var i,o;var E=U.getODataEntityType(U.getComponent(s));var p=E[b];var q=s.getId();q=q.split("--")[1];if(q){q=q.substring(0,q.lastIndexOf("::"));var r=D.getFacetIndexFromID(q,p);if(r===undefined){return;}o=p[r];if(o.RecordType===c){var N=o.Facets;var t,T,u;for(i=0;i<N.length;i++){if(N[i].RecordType===c){return;}if(N[i].Target.AnnotationPath.indexOf(F)>-1||N[i].Target.AnnotationPath.indexOf(I)>-1){t=true;}else if(N[i].Target.AnnotationPath.indexOf(L)>-1){T=true;}}if(t&&T){u="invalid";}else{u=t?j:k;}return u;}else{if(o.Target&&(o.Target.AnnotationPath.indexOf(F)>-1||o.Target.AnnotationPath.indexOf(I)>-1)){return j;}if(o.Target&&o.Target.AnnotationPath.indexOf(L)>-1){return k;}if(o.Target&&o.Target.AnnotationPath.indexOf(C)>-1){return l;}if(o.Target&&o.Target.AnnotationPath.indexOf(g)>-1){return m;}if(o.Target&&o.Target.AnnotationPath.indexOf(h)>-1){return n;}}}};S.setSectionType=function(s,v,o){var i,r,O=S.getSectionType(s);o.noRefreshOnChange=true;o.delayRefresh=false;if(O===v){return;}o.refreshPropertiesPane=true;switch(v){case j:r=F;break;case k:r=L;break;case l:r=C;break;case m:r=g;break;case n:r=h;break;default:break;}if(!r){return;}var E=U.getODataEntityType(U.getComponent(s));var p=E[b];p.splice();var q=s.getId().split("--")[1];q=q.substring(0,q.lastIndexOf("::"));i=D.getFacetIndexFromID(q,p);if(i===undefined){return;}var t=p[i];var N=[],u=[],w={},x;var T=U.getEntityType(U.getComponent(s));N.push.apply(N,p);if(v===j){x=U.createFieldGroupTerm(E);w[x]={"Data":[{"RecordType":d}],"RecordType":f};}var y=S.createNewSection(t,x);if(v===j&&!(y.ID&&y.ID.String)){y.ID={"String":v+i};}N.splice(i,1,y);var z=A.createCustomAnnotationTermChange(T,N,p,b);var B=A.createCustomAnnotationTermChange(T,w[x],{},x);u.push(z);u.push(B);return u;};return S;});
