/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./library","sap/m/Text","sap/m/Title","sap/m/FormattedText","sap/f/Illustration","sap/ui/core/Control","sap/ui/core/Core","sap/ui/core/ResizeHandler","./IllustratedMessageRenderer"],function(l,T,a,F,I,C,b,R,c){"use strict";var d=l.IllustratedMessageSize;var e=l.IllustratedMessageType;var f=C.extend("sap.f.IllustratedMessage",{metadata:{library:"sap.f",properties:{description:{type:"string",group:"Misc",defaultValue:""},enableFormattedText:{type:"boolean",group:"Appearance",defaultValue:false},illustrationSize:{type:"sap.f.IllustratedMessageSize",group:"Appearance",defaultValue:d.Auto},illustrationType:{type:"string",group:"Appearance",defaultValue:e.NoSearchResults},title:{type:"string",group:"Misc",defaultValue:""}},aggregations:{additionalContent:{type:"sap.m.Button",multiple:true},_formattedText:{type:"sap.m.FormattedText",multiple:false,visibility:"hidden"},_illustration:{type:"sap.f.Illustration",visibility:"hidden",multiple:false},_text:{type:"sap.m.Text",multiple:false,visibility:"hidden"},_title:{type:"sap.m.Title",multiple:false,visibility:"hidden"}},dnd:{draggable:false,droppable:true}}});f.PREPENDS={DESCRIPTION:"IllustratedMessage_DESCRIPTION_",TITLE:"IllustratedMessage_TITLE_"};f.BREAK_POINTS={DIALOG:679,SPOT:319,BASE:259};f.MEDIA={BASE:"sapFIllustratedMessage-Base",SPOT:"sapFIllustratedMessage-Spot",DIALOG:"sapFIllustratedMessage-Dialog",SCENE:"sapFIllustratedMessage-Scene"};f.RESIZE_HANDLER_ID={CONTENT:"_sContentResizeHandlerId"};f.prototype.init=function(){this._updateInternalIllustrationSetAndType(this.getIllustrationType());};f.prototype.onBeforeRendering=function(){this._detachResizeHandlers();};f.prototype.onAfterRendering=function(){this._updateDomSize();this._attachResizeHandlers();};f.prototype.exit=function(){this._detachResizeHandlers();};f.prototype.setIllustrationType=function(v){if(this.getIllustrationType()===v){return this;}this._updateInternalIllustrationSetAndType(v);return this.setProperty("illustrationType",v);};f.prototype._getDefaultDescription=function(){return this._getResourceBundle().getText(f.PREPENDS.DESCRIPTION+this._sIllustrationType,null,true);};f.prototype._getDescription=function(){return this.getEnableFormattedText()?this._getFormattedText():this._getText();};f.prototype._getFormattedText=function(){var D=this.getDescription(),o=this.getAggregation("_formattedText");if(!o){o=new F();this.setAggregation("_formattedText",o);}if(D){o.setHtmlText(D);}else{o.setHtmlText(this._getDefaultDescription());}return o;};f.prototype._getIllustration=function(){var i=this.getAggregation("_illustration");if(!i){i=new I();this.setAggregation("_illustration",i);}return i;};f.prototype._getResourceBundle=function(){return b.getLibraryResourceBundle("sap.f");};f.prototype._getText=function(){var D=this.getDescription(),t=this.getAggregation("_text");if(!t){t=new T();this.setAggregation("_text",t);}if(D){t.setText(D);}else{t.setText(this._getDefaultDescription());}return t;};f.prototype._getTitle=function(){var t=this.getTitle(),o=this.getAggregation("_title");if(!o){o=new a();this.setAggregation("_title",o);}if(t){o.setText(t);}else{o.setText(this._getResourceBundle().getText(f.PREPENDS.TITLE+this._sIllustrationType,null,true));}return o;};f.prototype._updateDomSize=function(){var D=this.getDomRef(),s;if(D){s=this.getIllustrationSize();if(s===d.Auto){this._updateMedia(D.getBoundingClientRect().width);}else{this._updateMediaStyle(f.MEDIA[s.toUpperCase()]);}}};f.prototype._updateInternalIllustrationSetAndType=function(v){var V=v.split("-");this._sIllustrationSet=V[0];this._sIllustrationType=V[1];};f.prototype._onResize=function(E){var i=E.size.width;this._updateMedia(i);};f.prototype._updateMedia=function(w){if(!w){return;}if(w<=f.BREAK_POINTS.BASE){this._updateMediaStyle(f.MEDIA.BASE);}else if(w<=f.BREAK_POINTS.SPOT){this._updateMediaStyle(f.MEDIA.SPOT);}else if(w<=f.BREAK_POINTS.DIALOG){this._updateMediaStyle(f.MEDIA.DIALOG);}else{this._updateMediaStyle(f.MEDIA.SCENE);}};f.prototype._updateMediaStyle=function(s){Object.keys(f.MEDIA).forEach(function(m){var E=s===f.MEDIA[m],i=m.charAt(0)+m.slice(1).toLowerCase();this.toggleStyleClass(f.MEDIA[m],E);if(E&&s!==f.MEDIA.BASE){this._getIllustration().setSet(this._sIllustrationSet,true).setMedia(i,true).setType(this._sIllustrationType);}},this);};f.prototype._attachResizeHandlers=function(){var i=this.getIllustrationSize();if(this.getDomRef()&&i===d.Auto){this._registerResizeHandler(f.RESIZE_HANDLER_ID.CONTENT,this,this._onResize.bind(this));}};f.prototype._detachResizeHandlers=function(){this._deRegisterResizeHandler(f.RESIZE_HANDLER_ID.CONTENT);};f.prototype._registerResizeHandler=function(h,o,H){if(!this[h]){this[h]=R.register(o,H);}};f.prototype._deRegisterResizeHandler=function(h){if(this[h]){R.deregister(this[h]);this[h]=null;}};return f;});
