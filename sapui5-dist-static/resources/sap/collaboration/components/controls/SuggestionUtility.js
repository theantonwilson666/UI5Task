/*
* ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
*/
sap.ui.define(["sap/ui/base/Object"],function(B){"use strict";var S=B.extend("sap.collaboration.components.controls.SuggestionUtility",{});S.maintainAtMentionIndices=function(a,l){a.startIndex=a.startIndex+l;a.endIndex=a.endIndex+l;};S.getChangesInTextArea=function(t,a){if(a!==""){var l=t.length>a.length?t.length:a.length;var c=Math.abs(t.length-a.length);var g=function(c,s){return t.substring(s,s+c);};var G=function(c,s){return a.substring(s,s+c);};for(var i=0;i<l;i++){if(t[i]!==a[i]){return t.length>a.length?{operation:"addChar",charactersChanged:g(c,i),changeIndex:i,numberOfCharsChanged:c}:{operation:"deleteChar",charactersChanged:G(c,i),changeIndex:i,numberOfCharsChanged:c};}}}else{return{operation:"addChar",charactersChanged:t,changeIndex:0};}};S.convertTextWithFullNamesToEmailAliases=function(v,a){var t="";var b=a.length;var s=0;if(b!==0){for(var i=0;i<b;i++){if(a[i].atMentioned){var e="@"+a[i].email.split("@")[0];t=t+v.substring(s,a[i].startIndex)+e;}else{t=t+v.substring(s,a[i].endIndex+1);}s=a[i].endIndex+1;}t=t+v.substring(a[b-1].endIndex+1,v.length);return t;}return v;};S.getStringAfterAtMention=function(i,t,a){var s="";var b=i;function c(){while(t[b+1]!==" "&&t[b+1]!==undefined&&t[b+1]!=='\n'){s=s.concat(t[b+1]);b+=1;}}c();if(a.atMentioned&&t[b+1]===" "&&t[b+1]<=a.endIndex){s=s.concat(t[b+1]);b+=1;c();}return s;};S.getStringBeforeAtMention=function(a,t,b){var s=t.substring(a.startIndex+1,b);return s;};S.addToAtMentionBuffer=function(a,t,b){var A=0;var c=a.length;if(c===0){a.push({startIndex:t,endIndex:t+b.length-1,atMentioned:false});A=0;}else{for(var i=0;i<c;i++){if(t<=a[i].startIndex){this.maintainAtMentionIndices(a[i],b.length);}}for(var i=c-1;i>=0;i--){if(t>a[i].startIndex){a.splice(i+1,0,{startIndex:t,endIndex:t+b.length-1,atMentioned:false});A=i+1;break;}else if(i===0){a.splice(0,0,{startIndex:t,endIndex:t+b.length-1,atMentioned:false});A=0;}}}return A;};S.isDeletedCharPartOfAtMentioned=function(a,t){var A=a.length;for(var i=0;i<A;i++){if(t>=a[i].startIndex&&t<=a[i].endIndex){return i;}}};S.getTextAreaValueAfterSuggestionSelected=function(f,e,c,a,t,n){var s=c.startIndex;var b=c.endIndex;var d=t.length;var N;var A="@notify";if(n){N=t.substr(0,s+1)+A+" "+t.substr(b+1);c.endIndex=s+A.length;c.notifyAll=true;}else{N=t.substr(0,s+1)+f+" "+t.substr(b+1);c.endIndex=s+f.length;c.atMentioned=true;c.email=e;}var g=N.length;var D=g-d;var I=a.indexOf(c);for(var i=I+1;i<a.length;i++){this.maintainAtMentionIndices(a[i],D);}return N;};S.atMentionsButtonPressed=function(t,c){var C;var T=t.slice(0,c);var s=t.slice(c,t.length);var a="";if(t[c-1]===" "||t[c-1]==="\n"||t[c-1]===undefined){a="@";C=c+1;}else{a=" @";C=c+2;}var n=T+a+s;return{newValue:n,cursorPosition:C};};return S;});
