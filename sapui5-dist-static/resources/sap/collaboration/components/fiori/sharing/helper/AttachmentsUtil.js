/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.define(['sap/collaboration/components/utils/CommonUtil','sap/ui/base/Object','sap/ui/model/Filter','sap/ui/model/FilterOperator','sap/m/SelectDialog','sap/m/StandardListItem','sap/m/library','sap/ui/model/json/JSONModel','sap/m/Bar','sap/m/Button','sap/m/Label','sap/m/Dialog','sap/ui/Device','sap/ui/core/mvc/View','sap/ui/core/library'],function(C,B,F,a,S,b,m,J,c,d,L,D,e,V,f){"use strict";var g=f.mvc.ViewType;var h=m.ButtonType;var j=m.ListType;var A=B.extend("sap.collaboration.components.fiori.sharing.helper.AttachmentsUtil",{constructor:function(l,o,i){this.oCommonUtil=new C();this.oLangBundle=l;this.oODataUtil=o;this.oJamODataModel=i;},createFileSelectionDialog:function(p,o,O,w,H){var i=function(E){var v=E.getParameter("value");var k=new F("name",a.Contains,v);var l=E.getSource().getBinding("items");l.filter([k]);};this.oFileSelectionDialog=new S(p+"_FileSelectionDialog",{multiSelect:true,rememberSelections:true,title:this.oLangBundle.getText("ATTACHMENTS_FIELD_TEXT",[""]),confirm:O,search:i,liveChange:i});if(w){this.oFileSelectionDialog.setContentWidth(w.toString()+"px");}if(H){this.oFileSelectionDialog.setContentHeight(H.toString()+"px");}var I=new b({title:"{name}",icon:"{icon}",iconDensityAware:false,iconInset:true,type:j.Active});this.oFileSelectionDialog.setModel(o);this.oFileSelectionDialog.bindAggregation("items","/attachments",I);return this.oFileSelectionDialog;},createAttachmentsModel:function(k){var l=[];for(var i=0;i<k.length;i++){l.push({name:k[i].getName(),mimeType:k[i].getMimeType(),url:k[i].getUrl(),icon:this.oCommonUtil.getIconFromMimeType(k[i].getMimeType())});}var o=new J({attachments:l});return o;},createFolderSelectionDialog:function(p,G,o,O,w,H){var s=this;var i=function(E){s.oFolderSelectionDialog.getContent()[0].getController().navigateBack();};var k=new c(p+"_FolderSelectionDialogHeaderBar",{contentLeft:[new d(p+"_FolderSelectionDialogHeaderBarBackButton",{type:h.Back,visible:false,press:i})],contentMiddle:[new L(p+"_FolderSelectionDialogHeaderBarTitle",{text:this.oLangBundle.getText("TARGET_FOLDER_FIELD_TEXT")})]});var l=new d(p+"_FolderSelectionDialogOKButton",{text:this.oLangBundle.getText("OK_BUTTON_TEXT"),press:function(r){o(r);s.oFolderSelectionDialog.close();}});var n=new d(p+"_FolderSelectionDialogCancelButton",{text:this.oLangBundle.getText("CANCEL_BUTTON_TEXT"),press:function(r){O(r);s.oFolderSelectionDialog.close();}});this.oFolderSelectionDialog=new D(p+"_FolderSelectionDialog",{beginButton:l,endButton:n,customHeader:k}).addStyleClass("sapUiPopupWithPadding");var q=this.createFolderSelectionView(p,G,w,H);this.oFolderSelectionDialog.addContent(q);if(e.system.phone){this.oFolderSelectionDialog.setStretch(true);}return this.oFolderSelectionDialog;},createFolderSelectionView:function(p,G,w,H){var o=sap.ui.view({id:p+"_FolderSelectionView",viewData:{controlId:p,groupId:G,languageBundle:this.oLangBundle,oDataUtil:this.oODataUtil,oDataModel:this.oJamODataModel,folderSelectionDialog:this.oFolderSelectionDialog},type:g.JS,viewName:"sap.collaboration.components.fiori.sharing.FolderSelection"});if(w){o.setWidth(w.toString()+"px");}if(H){o.setHeight(H.toString()+"px");}return o;},getCurrentFolder:function(){if(this.oFolderSelectionDialog){return this.oFolderSelectionDialog.getContent()[0].getController().getCurrentFolder();}return{name:this.oLangBundle.getText("TARGET_FOLDER_FIELD_TEXT"),id:""};},getCurrentGroupId:function(){return this.oFolderSelectionDialog.getContent()[0].getController().sGroupId;},resetFolderSelection:function(G){if(this.oFolderSelectionDialog){this.oFolderSelectionDialog.getContent()[0].getController().sGroupId=G;this.oFolderSelectionDialog.getContent()[0].getController().sCurrentFolderId='';this.oFolderSelectionDialog.getContent()[0].getController().aFolderBuffer=[];}},setCurrentFolderId:function(s){this.oFolderSelectionDialog.getContent()[0].getController().sCurrentFolderId=s;}});return A;});
