/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/StandardListItem","sap/m/library","sap/collaboration/components/utils/OdataUtil","sap/collaboration/components/utils/JamUtil","sap/collaboration/library","sap/ui/model/json/JSONModel"],function(C,S,m,O,J,l,a){"use strict";var F=l.FeedType;var L=m.ListType;sap.ui.controller("sap.collaboration.components.fiori.feed.splitApp.GroupMaster",{onInit:function(){this.oOdataModel=this.getView().getViewData().odataModel;this.oBusinessObject=this.getView().getViewData().object;this.sFeedType=this.getView().getViewData().feedType;this.sPageTitle=this.getView().getViewData().pageTitle;this.sJamToken=this.getView().getViewData().jamToken;this.oLangBundle=this.getView().getViewData().langBundle;this.sPrefixId=this.getView().getViewData().controlId;},onBeforeRendering:function(){var s=this;this.getView().groupMasterPage.setTitle(this.sPageTitle);this.initializeUtils();this.setViewModel();var o=new S();o.bindProperty("title","Name");o.setType(L.Active);o.attachPress(function(){var g=this.getBindingContext().getProperty(this.getBindingContext().getPath()).Id;var G=this.getBindingContext().getProperty(this.getBindingContext().getPath()).Name;var w=s.oJamUtil.prepareWidgetData(s.sJamToken,s.sFeedType,g);s.oJamUtil.createJamWidget(s.sPrefixId+"widgetContainer",w);sap.ui.getCore().byId(s.sPrefixId+"feedDetailsPage").setTitle(G);});sap.ui.getCore().byId(this.sPrefixId+"groupsList").bindItems("/groupsData",o);var b=new S({title:this.oLangBundle.getText("GROUP_MASTER_LIST_All_GROUPS")});b.setType(L.Active);b.attachPress(function(){var g=s.oODataUtil.getGroupIds(s.aGroupData);var w=s.oJamUtil.prepareWidgetData(s.sJamToken,s.sFeedType,g);s.oJamUtil.createJamWidget(s.sPrefixId+"widgetContainer",w);sap.ui.getCore().byId(s.sPrefixId+"feedDetailsPage").setTitle(s.oLangBundle.getText("GROUP_MASTER_LIST_All_GROUPS"));});sap.ui.getCore().byId(this.sPrefixId+"groupsList").insertItem(b,0);},onAfterRendering:function(){},initializeUtils:function(){this.oODataUtil=new O();this.oJamUtil=new J();},setViewModel:function(){this.aGroupData;this.sFeedType===F.group?this.aGroupData=this.oODataUtil.getGroupsData(this.oOdataModel,"/Groups"):this.aGroupData=this.oODataUtil.getGroupsData(this.oOdataModel,"/BusinessObjects('"+this.oBusinessObject.id+"')/AssignedGroups");this.oViewData={groupsData:this.aGroupData};this.oViewModel=new a(this.oViewData);this.getView().setModel(this.oViewModel);},onNavButtonTap:function(){sap.ui.getCore().getEventBus().publish("nav","back");}});});
