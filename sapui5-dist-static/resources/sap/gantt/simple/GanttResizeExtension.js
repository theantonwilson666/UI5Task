/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/thirdparty/jquery","sap/base/Log","sap/ui/events/KeyCodes","sap/ui/core/Core","./GanttExtension","./CoordinateUtils","./GanttUtils","sap/ui/core/theming/Parameters","sap/ui/Device","sap/gantt/misc/Utility","sap/gantt/misc/Format"],function(q,L,K,C,G,a,b,P,D,U,F){"use strict";var c=G.extend("sap.gantt.simple.GanttResizeExtension",{_init:function(g,s){this._initResizeStatus();return"ResizeExtension";}});var _=".sapGanttResizing";var m={strokeWidth:1,strokeDasharray:"5, 1",fillOpacity:0,shapeColor:null};var R={None:0,LeftResize:1,RightResize:2};var v=function($,d){return parseFloat($.attr(d),10);};c.prototype.getSelectionSettings=function(){if(!this.mSelectionSettings){m.color=P.get("sapUiBaseText");var d=this.getGantt().getShapeSelectionSettings();if(q.isEmptyObject(d)){return m;}var e=q.extend(true,{},m);for(var s in e){if(d[s]){e[s]=d[s];}}if(!e.shapeColor){e.fillOpacity=0;}else{if(e.fillOpacity===0){e.fillOpacity=0.4;}}this.mSelectionSettings=e;}return this.mSelectionSettings;};c.prototype.getSelectionInlineStyle=function(){var s=this.getSelectionSettings();var S={fill:s.shapeColor,stroke:s.color,"fill-opacity":s.fillOpacity,"stroke-width":s.strokeWidth,"stroke-dasharray":s.strokeDasharray};return Object.keys(S).reduce(function(d,e){d+=(e+":"+S[e]+";");return d;},"");};c.prototype.initDomSelector=function(){this.mDoms={};};c.prototype.updateDomSelector=function(e){if(e){this.origin.shapeUid=q(e.target).parents("g").attr(b.SELECT_FOR_DATASET_KEY);}var r='g['+b.SELECT_FOR_DATASET_KEY+'="'+this.origin.shapeUid+'"]';var s={leftLine:r+" .leftLine",rightLine:r+" .rightLine",topLine:r+" .topLine",bottomLine:r+" .bottomLine",leftLineTrigger:r+" line.leftTrigger",rightLineTrigger:r+" line.rightTrigger",leftRectTrigger:r+" rect.leftTrigger",rightRectTrigger:r+" rect.rightTrigger",resizeRectCover:r+" rect.resizeCover"};for(var k in s){if(s.hasOwnProperty(k)){this.mDoms[k]=q(s[k]);}}};c.prototype.getSvgElement=function(){var $=q(document.getElementById(this.getGantt().getId()));if($.length===0){L.warning("can not find gantt chart, use gantt chart instance sId as the key is required");}return $.find("svg.sapGanttChartSvg").get(0);};c.prototype.getHeaderSvgElement=function(){var $=q(document.getElementById(this.getGantt().getId()));if($.length===0){L.warning("can not find gantt chart, use gantt chart instance sId as the key is required");}return $.find("svg.sapGanttChartHeaderSvg").get(0);};c.prototype._getShapeSelectionRootNode=function(){var s=this.getSvgElement(),$=q(s).find("g.sapGanttChartSelection");return d3.select($.get(0));};c.prototype._getDeltaMarkerSelectionRootNode=function(){var s=this.getHeaderSvgElement(),$=q(s).find("g.sapGanttChartHeaderSelection");return d3.select($.get(0));};c.prototype.toggleOutline=function(e){if(!e.getSelected()){this.removeOutline(e);return;}this.setFrame(e.getDomRef().getBBox());var d=e.getConnectable(),r=e.getResizable(),s=e.getSelectable();if(s){if(d||r){this.renderResizerOutline(e);}else{this.renderPlainOutline(e);}}};c.prototype.addDeltaLineResizer=function(e){this.setFrame(e.getDomRef().getBBox());this.clearAllDeltaOutline();var p=this.getOutlineLines(e);var s=this.createResizeContainer(e,true);this.renderSelectionBorders(p,s);this.renderResizeTriggerAndCover(p,s);this.attachHeaderMouseEvent();};c.prototype.addResizerOnMouseOver=function(e){this.setFrame(e.getDomRef().getBBox());var r=e.getResizable();if(r){this.renderResizerOutlineOnMouseOver(e);}};c.prototype.clearAllOutline=function(s){this._getShapeSelectionRootNode().selectAll("*").remove();};c.prototype.clearAllDeltaOutline=function(){this._getDeltaMarkerSelectionRootNode().selectAll("*").remove();};c.prototype.renderPlainOutline=function(e){var d=e.getDomRef();if(d){var r=!!e.getRlsAnchors;var B=U.getShapeBias(e);var E=r?e.getD():this.determineOutlineByFrame(d.getBBox(),B);var s=null;if(r&&e.getEnableCurvedEdge()){s=b.getPathCorners(e.getD(),5);}var f=this._getShapeSelectionRootNode();var p=r?this.createOutlineRlsNode(e,E,s):this.createOutlinePathNode(e,E);f.node().appendChild(p);}};c.prototype.createOutlineRlsNode=function(e,o,E){var g=document.createElementNS(d3.ns.prefix.svg,"g");var A=document.createElementNS(d3.ns.prefix.svg,"path");var l=document.createElementNS(d3.ns.prefix.svg,"path");var d=document.createElementNS(d3.ns.prefix.svg,"path");g.setAttribute("id",e.getShapeUid()+"-selected");g.setAttribute("aria-hidden","false");g.setAttribute("class","resizeContainer sapGanttSelectedPath");g.setAttribute("style",e.getSelectedStyle());if(!E){l.setAttribute("d",o);}else{l.setAttribute("fill","none");l.setAttribute("d",E);}g.appendChild(l);A.setAttribute("stroke-width",1);A.setAttribute("fill",e.getSelectedStartShapeColor());A.setAttribute("stroke-dasharray","none");A.setAttribute("d",e.getConnectorStartPath(o,e.getGanttChartBase().getId(),e.getProcessedType()));d.setAttribute("stroke-width",1);d.setAttribute("fill",e.getSelectedEndShapeColor());d.setAttribute("stroke-dasharray","none");d.setAttribute("d",e.getConnectorEndPath(o,e.getGanttChartBase().getId(),e.getProcessedType()));g.appendChild(A);g.appendChild(d);return g;};c.prototype.createOutlinePathNode=function(e,o){var p=document.createElementNS(d3.ns.prefix.svg,"path");p.setAttribute("id",e.getShapeUid()+"-selected");p.setAttribute("aria-hidden","false");p.setAttribute("class","resizeContainer sapGanttSelectedPath");var s=e.getSelectedStyle?e.getSelectedStyle():this.getSelectionInlineStyle();p.setAttribute("style",s);p.setAttribute("d",o);return p;};c.prototype.determineOutlineByFrame=function(r,B){var x=r.x,y=r.y,w=r.width,h=r.height,d=x+w,e=y+h;var s=this.getSelectionSettings().strokeWidth,H=s/2;x=x-H+B.x;y=y-H+B.y;d=d+H+B.x;e=e+H+B.y;var f=["M",x,y,"L",d,y,"L",d,e,"L",x,e,"z"].join(" ").trim();return f;};c.prototype.removeOutline=function(e){var r=document.getElementById(e.getShapeUid()+"-selected");if(r){q(r).remove();}};c.prototype.removeDeltaOutline=function(e){var r=document.getElementById(e.getId()+"-selected");if(r){q(r).remove();}};c.prototype.renderResizerOutline=function(e){this.removeOutline(e);var d=e.getConnectable(),r=e.getResizable();var p=this.getOutlineLines(e);var s=this.createResizeContainer(e);this.renderSelectionBorders(p,s);if(r){this.renderResizeTriggerAndCover(p,s);this.attachMousedownEvent();}if(d){this.renderShapeConnectTrigger(e,s);this.getGantt()._getConnectExtension().attachShapeConnectEvents();}if(this.isResizing()){this.updateDomSelector();this.updateOriginShapeFrame();this.attachResizeEvents();}};c.prototype.renderResizerOutlineOnMouseOver=function(e){this.removeOutline(e);var p=this.getOutlineLines(e);var s=this.createResizeContainer(e);this.renderSelectionBorders(p,s,true);this.renderResizeTriggerAndCover(p,s,true);this.attachMousedownEvent();if(this.isResizing()){this.updateDomSelector();this.updateOriginShapeFrame();this.attachResizeEvents();}};c.prototype.showShapeConnectTrigger=function(e){var E=this.getGantt()._getConnectExtension();var s=E.getRlsStartShape().shapeUid;return E.isShapeConnecting()?s===e.getShapeUid():true;};c.prototype.renderSelectionBorders=function(p,g,o){g.selectAll(".border").data(p.border).enter().append("line").each(function(d){if(o){d.stroke="transparent";}d3.select(this).attr(d);}).attr("class",function(d){return"border "+d.class+"Line";});};c.prototype.renderResizeTriggerAndCover=function(p,g,h){g.selectAll(".lineTrigger").data(p.indicator).enter().append("line").each(function(d){d3.select(this).attr(d);}).attr("class",function(d){return"resizeTrigger lineTrigger "+d.class+"Trigger";}).attr({opacity:0,"stroke-width":3,style:"cursor: ew-resize"});if(!h){var e=this.getResizeRectCoverAttrs();g.append("rect").attr(e);}};c.prototype.createResizeContainer=function(e,i){var s=i?this._getDeltaMarkerSelectionRootNode():this._getShapeSelectionRootNode();var d=i?e.getId():e.getShapeUid();var g=s.append("g").classed("resizeContainer",true).attr("id",d+"-selected").attr(b.SELECT_FOR_DATASET_KEY,d);return g;};c.prototype.renderShapeConnectTrigger=function(e,g){var s=this.showShapeConnectTrigger(e);var r=this.getConnectSquaresData(s,e);g.selectAll(".rectTrigger").data(r.slice()).enter().append("rect").each(function(d){d3.select(this).attr(d);}).attr("class",function(d){return"shapeConnectTrigger rectTrigger "+d.class+"Trigger";}).attr({stroke:"#000","stroke-width":1});};c.prototype.attachMousedownEvent=function(){var $=q(document.getElementById(this.getGantt().getId()+"-svg"));var d=$.find(".resizeTrigger");d.off(_);d.bind("mousedown"+_,q.proxy(this.beforeResizing,this));};c.prototype.attachHeaderMouseEvent=function(){var $=q(document.getElementById(this.getGantt().getId()+"-header-svg"));var d=$.find(".resizeTrigger");d.off(_);d.bind("mousedown"+_,q.proxy(this.beforeDeltaResizing,this));};c.prototype.attachResizeEvents=function(){this._removeDragEvents();var $=q(document);$.bind("mousemove"+_,q.proxy(this.onResizing,this));$.bind("mouseup"+_,q.proxy(this.endResizing,this));$.bind("keydown"+_,q.proxy(this.onKeydown,this));};c.prototype.attachDeltaResizeEvents=function(){this._removeDragEvents();var $=q(document);$.bind("mousemove"+_,q.proxy(this.onDeltaResizing,this));$.bind("mouseup"+_,q.proxy(this.onDeltaResize,this));$.bind("keydown"+_,q.proxy(this.onKeydown,this));};c.prototype._removeDragEvents=function(){var $=q(document);$.off(_);};c.prototype.beforeResizing=function(e){var $=q(e.target),s=$.parents("g").attr(b.SELECT_FOR_DATASET_KEY);var E=this._getShapeByUid(s);if(!E){return;}this.setFrame(E.getDomRef().getBBox());this.updateDomSelector(e);this.origin.eventTarget=e.target;this.updateOriginShapeFrame();this.origin.resizeFor=s;if($.hasClass("leftTrigger")){this.currentAction=R.LeftResize;}else{this.currentAction=R.RightResize;}this._updateResizingEffect(true);this.attachResizeEvents();};c.prototype.beforeDeltaResizing=function(e){var $=q(e.target),i=$.parents("g").attr(b.SELECT_FOR_DATASET_KEY);var E=sap.ui.getCore().byId(i);if(!E){return;}var p=a.getEventSVGPoint(this.getDomRefs().headerSvg,e),f=e.target.getBBox();this.mResizePoint={cursorX:p.x,cursorY:p.y,shapeX:f.x,shapeY:f.y,shapeWidth:f.width};this.setFrame(E.getDomRef().getBBox());this.updateDomSelector(e);this.origin.eventTarget=e.target;this.updateOriginShapeFrame();this.origin.resizeFor=i;if($.hasClass("leftTrigger")){this.currentAction=R.LeftResize;}else{this.currentAction=R.RightResize;}this._updateResizingEffect(true);this.attachDeltaResizeEvents();this.deltaResize=true;};c.prototype.updateOriginShapeFrame=function(){var f=this.getFrame();this.origin.minX=f.x;this.origin.maxX=f.x+f.width;};c.prototype.onResizing=function(e){if(this._shallSkip(e)){return;}this._updateResizingEffect(true);var s=this.getSvgElement();var E=a.getEventSVGPoint(s,e).x;var p=this.getGantt()._getPointerExtension();E=E+p._getAutoScrollStep();if(this.currentAction===R.RightResize){this._updateRightPartDoms(E);}else if(this.currentAction===R.LeftResize){this._updateLeftPartDoms(E);}};c.prototype.onDeltaResizing=function(e){if(this._shallSkip(e)){return;}this._updateResizingEffect(true);var s=this.getHeaderSvgElement();var E=a.getEventSVGPoint(s,e).x;var p=this.getGantt()._getPointerExtension();E=E+p._getAutoScrollStep();if(this.currentAction===R.RightResize){this._updateRightPartDoms(E,e);}else if(this.currentAction===R.LeftResize){this._updateLeftPartDoms(E,e);}if(e){if(!this.deltaResizeStart){this.$ghost=this.createResizeGhost(E,this.currentAction);this.deltaResizeStart=true;}else{if(this._isValidResize(E)){this.showGhost(e);}}}};c.prototype._isValidResize=function(e){if(this.currentAction===R.LeftResize){return!(e>(this.mElementFrame.x+this.mElementFrame.width));}else if(this.currentAction===R.RightResize){return!(e<this.mElementFrame.x);}};c.prototype._updateResizingEffect=function(r){var o=r?0.4:0;this.mDoms.resizeRectCover.attr("opacity",o);};c.prototype.isResizing=function(){return this.currentAction===R.LeftResize||this.currentAction===R.RightResize;};c.prototype.removeGhost=function(){this.$ghost=null;q(document.getElementById("sapGanttDragGhostWrapper")).remove();};c.prototype._updateRightPartDoms=function(e,E){var n=function(x){if(x-this.origin.minX<=2*this.getMargin()){return this.origin.minX+2*this.getMargin();}return x;}.bind(this);var x=n(e);this.mDoms.rightLine.attr({x1:x,x2:x});this.mDoms.rightLineTrigger.attr({x1:x,x2:x});this.mDoms.topLine.attr({x2:x});this.mDoms.bottomLine.attr({x2:x});this.mDoms.rightRectTrigger.attr({x:x+b.SHAPE_CONNECT_INDICATOR_WIDTH/2-2});var N=x-this.origin.minX;this.mDoms.resizeRectCover.attr({width:N});};c.prototype.showGhost=function(e){var o=this.calcGhostAligmentForLines(e);var t=b.getTimeLabel(e,this.getGantt().getAxisTime(),this.getGantt().getLocale(),this.getDomRefs().headerSvg);document.getElementById("sapGanttDragText").innerHTML=t;q(document.getElementById("sapGanttDragGhostWrapper")).css(o).css({"visibility":"visible"});};c.prototype.calcGhostAligmentForLines=function(e){var i=a.xPosOfEvent(e);var s=a.getSvgScreenPoint(this.getDomRefs().headerSvg,{pageX:this.mResizePoint.cursorX,clientX:this.mResizePoint.cursorX,pageY:this.mResizePoint.cursorY,clientY:this.mResizePoint.cursorY});return{left:i+"px",top:s.y+"px"};};c.prototype.createResizeGhost=function(e,d){var $=q("<div id='sapGanttDragGhostWrapper'></div>");q(document.body).append($);var f=document.createElement("canvas");var g=this.origin.eventTarget.getBBox();f.width=1;f.height=g.height;var h=q(this.origin.eventTarget),i=h.parents("g").attr(b.SELECT_FOR_DATASET_KEY);var E=sap.ui.getCore().byId(i);var j=E.getParent();var s=j._getStartLine();var o=j._getEndLine();var H=j._getHeaderStartLine();var k=j._getHeaderEndLine();var l=document.getElementById(s.sId);var n=document.getElementById(o.sId);var p=document.getElementById(H.sId);var r=document.getElementById(k.sId);var t={headerStartLine:p,startLine:l,headerEndLine:r,endLine:n};var u=p.getBBox();var w=l.getBBox();f.height+=w.height+u.height;this.createGhostImage(this.origin.eventTarget,f,t);return $;};c.prototype.createGhostImage=function(l,d,e){var s=this.serializeClonedSvg(d,l,e);var B=this._b64EncodeUnicode(s);var f="data:image/svg+xml;base64,"+B;this.appendGhostImageToWrapper(l,f);};c.prototype._b64EncodeUnicode=function(s){return btoa(encodeURIComponent(s).replace(/%([0-9A-F]{2})/g,function t(d,p){return String.fromCharCode('0x'+p);}));};c.prototype.serializeClonedSvg=function(d,o,e){var s=d3.ns.prefix.svg;var f=e.headerEndLine.getBBox();var g=document.createElementNS(s,"svg");g.setAttribute("width",d.width);g.setAttribute("height",d.height);var h=document.createElementNS(s,"g");h.setAttribute("transform","translate("+-(f.x)+", "+-(f.y)+")");var i=e.headerEndLine.cloneNode(true);h.appendChild(i);var j=e.endLine.cloneNode(true);h.appendChild(j);var S=this.getGantt().getSvgDefs();if(S){var k=q(document.getElementById(S.getId())).get(0).cloneNode(true);g.appendChild(k);}g.appendChild(h);return new XMLSerializer().serializeToString(g);};c.prototype.appendGhostImageToWrapper=function(l,d){var $=q(document.getElementById("sapGanttDragGhostWrapper"));q("<div class='sapGanttDragGhost'>"+"<img class='sapGanttDragGhostImg' src='"+d+"'>"+"<div id='sapGanttDragText' class='sapGanttDragTextOverlay'></div>"+"</div>").appendTo($);};c.prototype._updateLeftPartDoms=function(e){var n=function(x){var M=this.origin.maxX;var l=2*this.getMargin();if(M-x<=l){return M-l;}return x;}.bind(this);var x=n(e);this.mDoms.leftLine.attr({x1:x,x2:x});this.mDoms.leftLineTrigger.attr({x1:x,x2:x});this.mDoms.topLine.attr({x1:x});this.mDoms.bottomLine.attr({x1:x});this.mDoms.leftRectTrigger.attr({x:x-this.getMargin()-b.SHAPE_CONNECT_INDICATOR_WIDTH-2});var r=Math.abs(x-v(this.mDoms.rightLineTrigger,"x1"))-2;this.mDoms.resizeRectCover.attr({x:x+this.getMargin(),width:r<0?0:r});};c.prototype.onKeydown=function(e){if(e.keyCode===K.ESCAPE){if(this.isResizing()){this._updateLeftPartDoms(this.origin.minX-this.getMargin());this._updateRightPartDoms(this.origin.maxX+this.getMargin());this._updateResizingEffect(false);this._initResizeStatus();}this._removeDragEvents();}};c.prototype.endResizing=function(e){this._removeDragEvents();if(this._shallSkip(e)){return;}var d=v(this.mDoms.leftLine,"x1")+this.getMargin(),f=v(this.mDoms.rightLine,"x1")-this.getMargin();var s=this._getShapeByUid(this.origin.resizeFor),g=this.getGantt();if(s){this.renderResizerOutline(s);this._fireShapeResizeEvent(g,s,d,f);b.rerenderAssociatedRelationships(g,s);}this._initResizeStatus();};c.prototype.onDeltaResize=function(e){var $=q(this.origin.eventTarget),i=$.parents("g").attr(b.SELECT_FOR_DATASET_KEY);var E=sap.ui.getCore().byId(i);var d=E.getParent();var o=this._getDeltaResizeEventData(e);if(o){d.fireDeltalineResize(o);}this.removeGhost();this._initResizeStatus();this._removeDragEvents();};c.prototype._getDeltaResizeEventData=function(e){var i=C.getConfiguration().getRTL();var $=q(this.origin.eventTarget),d=$.parents("g").attr(b.SELECT_FOR_DATASET_KEY);var E=sap.ui.getCore().byId(d);var f=E.getParent();var p=a.getEventSVGPoint(this.getDomRefs().headerSvg,e);var g=this.getGantt();var A=g.getAxisTime();var h=F.dateToAbapTimestamp(A.viewToTime(p.x));if(i){if(this.currentAction===R.LeftResize){if(p.x>(this.mElementFrame.x+this.mElementFrame.width)){h=F.dateToAbapTimestamp(A.viewToTime(this.mElementFrame.x+this.mElementFrame.width));}return{newTimeStamp:f.getTimeStamp(),newEndTimeStamp:h,oldTimeStamp:f.getTimeStamp(),oldEndTimeStamp:f.getEndTimeStamp()};}else{if(p.x<this.mElementFrame.x){h=F.dateToAbapTimestamp(A.viewToTime(this.mElementFrame.x));}return{newTimeStamp:h,newEndTimeStamp:f.getEndTimeStamp(),oldTimeStamp:f.getTimeStamp(),oldEndTimeStamp:f.getEndTimeStamp()};}}else{if(this.currentAction===R.LeftResize){if(p.x>(this.mElementFrame.x+this.mElementFrame.width)){h=F.dateToAbapTimestamp(A.viewToTime(this.mElementFrame.x+this.mElementFrame.width));}return{newTimeStamp:h,newEndTimeStamp:f.getEndTimeStamp(),oldTimeStamp:f.getTimeStamp(),oldEndTimeStamp:f.getEndTimeStamp()};}else if(this.currentAction===R.RightResize){if(p.x<this.mElementFrame.x){h=F.dateToAbapTimestamp(A.viewToTime(this.mElementFrame.x));}return{newTimeStamp:f.getTimeStamp(),newEndTimeStamp:h,oldTimeStamp:f.getTimeStamp(),oldEndTimeStamp:f.getEndTimeStamp()};}}};c.prototype._getShapeByUid=function(s){var S=b.getShapesWithUid(this.getGantt().getId(),[s]);if(S.length>0){return S[0];}};c.prototype._fireShapeResizeEvent=function(g,s,d,e){var n,N;var M=e.toString().split(".")[1]?parseInt(e.toString().split(".")[1].length,10):0;var i=d.toString().split(".")[1]?parseInt(d.toString().split(".")[1].length,10):0;if(C.getConfiguration().getRTL()){if(D.browser.msie){n=e===(M?parseFloat(this.origin.maxX.toFixed(M)):this.origin.maxX)?s.getTime():g.getAxisTime().viewToTime(e);N=d===(i?parseFloat(this.origin.minX.toFixed(i)):this.origin.minX)?s.getEndTime():g.getAxisTime().viewToTime(d);}else{n=e===this.origin.maxX?s.getTime():g.getAxisTime().viewToTime(e);N=d===this.origin.minX?s.getEndTime():g.getAxisTime().viewToTime(d);}}else{if(D.browser.msie){n=d===(i?parseFloat(this.origin.minX.toFixed(i)):this.origin.minX)?s.getTime():g.getAxisTime().viewToTime(d);N=e===(M?parseFloat(this.origin.maxX.toFixed(M)):this.origin.maxX)?s.getEndTime():g.getAxisTime().viewToTime(e);}else{n=d===this.origin.minX?s.getTime():g.getAxisTime().viewToTime(d);N=e===this.origin.maxX?s.getEndTime():g.getAxisTime().viewToTime(e);}}g.fireShapeResize({shape:s,shapeUid:s.getShapeUid(),rowObject:s.getParent(),oldTime:[s.getTime(),s.getEndTime()],newTime:[n,N]});};c.prototype._initResizeStatus=function(){this.currentAction=R.None;this.origin={minX:-1,maxX:-1,eventTarget:null,resizeFor:null};this.mElementFrame=null;this.iOutlineMargin=0;this.initDomSelector();this.deltaResize=false;this.deltaResizeStart=false;this.$ghost=null;this.mResizePoint={};};c.prototype.setFrame=function(f){this.mElementFrame=f;};c.prototype.getFrame=function(){return this.mElementFrame;};c.prototype.setMargin=function(M){this.iOutlineMargin=M;};c.prototype.getMargin=function(){return this.iOutlineMargin;};c.prototype._shallSkip=function(e){if(!this.isResizing()){return true;}if(this.origin.eventTarget&&!q(this.origin.eventTarget).hasClass("resizeTrigger")){return true;}return false;};c.prototype.getConnectSquaresData=function(s,e){var f=this.getFrame(),x=f.x,y=f.y,w=f.width,h=f.height;var M=this.getMargin();var r=s?b.SHAPE_CONNECT_INDICATOR_WIDTH:0;var d={width:r,height:r,stroke:"#000","stroke-width":1};var B=U.getShapeBias(e);var l=x-M-r-2+B.x,i=y+(h/2)-(r/2)+B.y;var g=(x+w+M)+2+B.x,j=i;return[q.extend({x:l,y:i,"class":"left"},d),q.extend({x:g,y:j,"class":"right"},d)];};c.prototype.getResizeRectCoverAttrs=function(){var f=this.getFrame(),M=this.getMargin(),s=this.getSelectionSettings(),S=s.strokeWidth;var d={stroke:"none","stroke-width":0,fill:s.shapeColor,"class":"resizeCover",opacity:s.fillOpacity,style:"pointer-events: none;"};var o=(2*M)-(2*S);return q.extend({x:f.x-M+S,y:f.y-M+S,width:f.width+o,height:f.height+o},d);};c.prototype.getOutlineLines=function(e){var f=this.getFrame(),x=f.x,y=f.y,w=f.width,h=f.height;var M=this.getMargin();var s=this.getSelectionSettings();var d={"stroke-dasharray":s.strokeDasharray,fill:s.shapeColor,"fill-opacity":s.fillOpacity,stroke:s.color,"stroke-width":s.strokeWidth};var B=U.getShapeBias(e);var p={minX:x-M+B.x,minY:y-M+B.y,maxX:x+w+M+B.x,maxY:y+h+M+B.y};var g={top:{x1:p.minX,y1:p.minY,x2:p.maxX,y2:p.minY},right:{x1:p.maxX,y1:p.minY,x2:p.maxX,y2:p.maxY},bottom:{x1:p.minX,y1:p.maxY,x2:p.maxX,y2:p.maxY},left:{x1:p.minX,y1:p.minY,x2:p.minX,y2:p.maxY}};var i=["top","right","bottom","left"];var l=i.map(function(k){return q.extend(g[k],{"class":k},d);});var j=q.extend(true,g);var I=["left","right"].map(function(k){return q.extend(j[k],{"class":k},d);});return{border:l,indicator:I};};c.prototype._getResizeTime=function(e){var d=v(this.mDoms.leftLine,"x1")+this.getMargin(),f=v(this.mDoms.rightLine,"x1")-this.getMargin();if(isNaN(d)||isNaN(f)){return null;}var g=this.getGantt();var s=g.getAxisTime().viewToTime(d),h=g.getAxisTime().viewToTime(f),t;var r=C.getConfiguration().getRTL();if(r){t=h;h=s;s=t;}return{time:s,endTime:h};};return c;});
