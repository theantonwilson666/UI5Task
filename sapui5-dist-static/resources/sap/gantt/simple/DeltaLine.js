/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/core/Element","./GanttUtils","sap/m/ResponsivePopover","sap/ui/core/theming/Parameters"],function(E,G,R,P){"use strict";var D=E.extend("sap.gantt.simple.DeltaLine",{metadata:{library:"sap.gantt",properties:{stroke:{type:"sap.gantt.ValueSVGPaintServer"},_strokeWidth:{type:"float",defaultValue:1},strokeDasharray:{type:"string"},strokeOpacity:{type:"float",defaultValue:1},timeStamp:{type:"string"},endTimeStamp:{type:"string"},description:{type:"string"},visible:{type:"boolean",defaultValue:true},timeDelay:{type:"int",defaultValue:300},draggable:{type:"boolean",defaultValue:false},resizable:{type:"boolean",defaultValue:false},_enableChartDeltaAreaHighlight:{type:"boolean",defaultValue:true},_isSelected:{type:"boolean",defaultValue:false},_level:{type:"int",defaultValue:1},_visibleMarker:{type:"boolean",defaultValue:false}},aggregations:{_startLine:{type:"sap.gantt.simple.BaseLine",multiple:false},_endLine:{type:"sap.gantt.simple.BaseLine",multiple:false},_forwardMarker:{type:"sap.gantt.simple.BaseTriangle",multiple:false},_backwardMarker:{type:"sap.gantt.simple.BaseTriangle",multiple:false},_headerDeltaArea:{type:"sap.gantt.simple.BaseDeltaRectangle",multiple:false},_headerStartLine:{type:"sap.gantt.simple.BaseLine",multiple:false},_headerEndLine:{type:"sap.gantt.simple.BaseLine",multiple:false},_chartDeltaArea:{type:"sap.gantt.simple.BaseDeltaRectangle",multiple:false}},events:{press:{},mouseEnter:{},mouseLeave:{},deltalineDrop:{parameters:{newStartTime:{type:"string"},newEndTime:{type:"string"},oldStartTime:{type:"string"},oldEndTime:{type:"string"}}},deltalineResize:{parameters:{newTimeStamp:{type:"string"},newEndTimeStamp:{type:"string"},oldTimeStamp:{type:"string"},oldEndTimeStamp:{type:"string"},deltaline:{type:"sap.gantt.simple.DeltaLine"}}}}},renderer:{apiVersion:2}});D.prototype._getStrokeWidth=function(){return this.getProperty("_strokeWidth");};D.prototype._setStartLine=function(v){this.setAggregation("_startLine",v,true);};D.prototype._getStartLine=function(){return this.getAggregation("_startLine");};D.prototype._setEndLine=function(v){this.setAggregation("_endLine",v,true);};D.prototype._getEndLine=function(){return this.getAggregation("_endLine");};D.prototype._setForwardMarker=function(v){this.setAggregation("_forwardMarker",v,true);};D.prototype._getForwardMarker=function(){return this.getAggregation("_forwardMarker");};D.prototype._setBackwardMarker=function(v){this.setAggregation("_backwardMarker",v,true);};D.prototype._getBackwardMarker=function(){return this.getAggregation("_backwardMarker");};D.prototype._setHeaderDeltaArea=function(v){this.setAggregation("_headerDeltaArea",v,true);};D.prototype._getHeaderDeltaArea=function(){return this.getAggregation("_headerDeltaArea");};D.prototype._setHeaderStartLine=function(v){this.setAggregation("_headerStartLine",v,true);};D.prototype._getHeaderStartLine=function(){return this.getAggregation("_headerStartLine");};D.prototype._setHeaderEndLine=function(v){this.setAggregation("_headerEndLine",v,true);};D.prototype._getHeaderEndLine=function(){return this.getAggregation("_headerEndLine");};D.prototype._setChartDeltaArea=function(v){this.setAggregation("_chartDeltaArea",v,true);};D.prototype._getChartDeltaArea=function(){return this.getAggregation("_chartDeltaArea");};D.prototype._setEnableChartDeltaAreaHighlight=function(v){this.setProperty("_enableChartDeltaAreaHighlight",v,true);};D.prototype._getEnableChartDeltaAreaHighlight=function(){return this.getProperty("_enableChartDeltaAreaHighlight");};D.prototype._setIsSelected=function(v){this.setProperty("_isSelected",v,true);};D.prototype._getIsSelected=function(){return this.getProperty("_isSelected");};D.prototype._setLevel=function(v){this.setProperty("_level",v,true);};D.prototype._getLevel=function(){return this.getProperty("_level");};D.prototype._setVisibleMarker=function(v){this.setProperty("_visibleMarker",v,true);};D.prototype._getVisibleMarker=function(){return this.getProperty("_visibleMarker");};D.prototype.press=function(e){this.onMouseClick();setTimeout(function(){if(this._oPopover){this._oPopover.close();this._oPopover=null;}}.bind(this),this.timeDelay);};D.prototype.mouseEnter=function(e){this.onMouseEnter();var s=e.getSource();var d=this.getProperty("description");if(d){setTimeout(function(){if(!this._oPopover){this._oPopover=new R({placement:sap.m.PlacementType.PreferredRightOrFlip,showArrow:false,showHeader:false,offsetX:5,content:[new sap.m.Text({text:d})],afterClose:function(e){e.getSource().destroy();}}).addStyleClass("sapGanntChartMarkerTooltip");this._oPopover.openBy(s);}else{this._oPopover.openBy(s);}}.bind(this),this.timeDelay);}};D.prototype.mouseLeave=function(e){this.onMouseLeave();setTimeout(function(){if(this._oPopover){this._oPopover.close();this._oPopover=null;}}.bind(this),this.timeDelay);};D.prototype.onMouseClick=function(){if(!this._getIsSelected()){G.resetStrokeDasharray(this.getParent());this._setIsSelected(true);}var c=this._getChartDeltaArea();var h=this._getHeaderDeltaArea();var s=this._getStartLine();var e=this._getEndLine();var H=this._getHeaderStartLine();var o=this._getHeaderEndLine();var f=this._getForwardMarker();var b=this._getBackwardMarker();var m=P.get("sapUiChartDataPointBorderColor");if(c){var $=document.getElementById(c.sId);if(this._getEnableChartDeltaAreaHighlight()===true){$.style.opacity=1.0;}if(s&&e&&f&&b&&h){var a=document.getElementById(s.sId);var d=document.getElementById(e.sId);var g=document.getElementById(H.sId);var i=document.getElementById(o.sId);var j=document.getElementById(f.sId);var k=document.getElementById(b.sId);var l=document.getElementById(h.sId);a.style.strokeDasharray=0;d.style.strokeDasharray=0;g.style.strokeDasharray=0;i.style.strokeDasharray=0;a.style.strokeWidth=this._getStrokeWidth()+1;d.style.strokeWidth=this._getStrokeWidth()+1;g.style.strokeWidth=this._getStrokeWidth()+1;i.style.strokeWidth=this._getStrokeWidth()+1;j.style.fillOpacity=1;k.style.fillOpacity=1;j.style.stroke=m;k.style.stroke=m;l.style.opacity=1;}}if(this._getIsSelected()&&this.getDraggable()){l.style.cursor="Move";}if(this._getIsSelected()&&this.getResizable()){var r=this.getParent()._getResizeExtension();r.addDeltaLineResizer(this._getHeaderDeltaArea());}};D.prototype.onMouseEnter=function(){var s=this._getStartLine();var e=this._getEndLine();var h=this._getHeaderStartLine();var H=this._getHeaderEndLine();var f=this._getForwardMarker();var b=this._getBackwardMarker();var o=this._getHeaderDeltaArea();if(s&&e){var $=document.getElementById(s.sId);var a=document.getElementById(e.sId);var c=document.getElementById(h.sId);var d=document.getElementById(H.sId);var g=document.getElementById(f.sId);var i=document.getElementById(b.sId);var j=document.getElementById(o.sId);$.style.strokeDasharray=0;a.style.strokeDasharray=0;c.style.strokeDasharray=0;d.style.strokeDasharray=0;$.style.strokeWidth=this._getStrokeWidth()+1;a.style.strokeWidth=this._getStrokeWidth()+1;c.style.strokeWidth=this._getStrokeWidth()+1;d.style.strokeWidth=this._getStrokeWidth()+1;g.style.fillOpacity=1;i.style.fillOpacity=1;g.style.stroke=P.get("sapUiChartDataPointBorderColor");i.style.stroke=P.get("sapUiChartDataPointBorderColor");j.style.opacity=1;}};D.prototype.onMouseLeave=function(){var i=this._getIsSelected();var s=this._getStartLine();var e=this._getEndLine();var h=this._getHeaderStartLine();var H=this._getHeaderEndLine();var f=this._getForwardMarker();var b=this._getBackwardMarker();var o=this._getHeaderDeltaArea();if(!i){if(s&&e&&f&&b){var $=document.getElementById(s.sId);var a=document.getElementById(e.sId);var c=document.getElementById(h.sId);var d=document.getElementById(H.sId);var g=document.getElementById(f.sId);var j=document.getElementById(b.sId);var k=document.getElementById(o.sId);$.style.strokeDasharray=this.getStrokeDasharray();a.style.strokeDasharray=this.getStrokeDasharray();c.style.strokeDasharray=this.getStrokeDasharray();d.style.strokeDasharray=this.getStrokeDasharray();$.style.strokeWidth=this._getStrokeWidth();a.style.strokeWidth=this._getStrokeWidth();c.style.strokeWidth=this._getStrokeWidth();d.style.strokeWidth=this._getStrokeWidth();k.style.opacity=1;var m=P.get("sapUiChartDataPointBorderColor");if(this._getVisibleMarker()===true){g.style.fillOpacity=1;j.style.fillOpacity=1;g.style.stroke=m;j.style.stroke=m;}else{g.style.fillOpacity=0;j.style.fillOpacity=0;g.style.stroke=null;j.style.stroke=null;}}}};return D;},true);
