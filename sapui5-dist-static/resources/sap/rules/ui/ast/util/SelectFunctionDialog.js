sap.ui.define(["sap/ui/core/Control","sap/m/List","sap/ui/model/json/JSONModel","sap/rules/ui/ast/constants/Constants","sap/rules/ui/parser/infrastructure/util/utilsBase"],function(C,L,J,a,i){"use strict";var b;var S=function(){this.oBundle=sap.ui.getCore().getLibraryResourceBundle("sap.rules.ui.i18n");this.functionLabelDisplay="";this.functionLabel="";this._selectFunctionSelected="";this._whereExpressionId="";this.dataObjectId="";this._count=0;this.dataObjectLabel="";this.dataObjectIdSelected="";this.enableCountField=true;this.sortOrder=[{name:a.NOSORT,label:this.oBundle.getText("no_sorting")},{name:a.SORTASC,label:this.oBundle.getText("sort_ascending")},{name:a.SORTDESC,label:this.oBundle.getText("sort_descending")}];this.selectedData=[{attributeSelected:"",sortOrder:a.NOSORT,cancelButton:false,addButton:true}];this.enabledData={enabled:false};this.dataObjectIdData={dataObjectId:""};};S.prototype._filterSelectFunction=function(s){var f=[];if(s&&s.selection){for(var c=0;c<s.selection.length;c++){if(s.selection[c].name!==a.SORTASC&&s.selection[c].name!==a.SORTDESC&&s.selection[c].name!==a.BOTTOM){f.push(s.selection[c]);}}return{selection:f};}};S.prototype._createFunctionSelectionDropDown=function(s,A){var t=this;s=this._filterSelectFunction(s);var m=new sap.ui.model.json.JSONModel(s);this.functionSelect=new sap.m.Select({width:"200px",selectedKey:this._selectFunctionSelected,forceSelection:false,showSecondaryValues:true,layoutData:new sap.ui.layout.GridData({span:"L3 M3 S12"}),ariaLabelledBy:A,change:function(e){t._selectFunctionSelected=e.getSource().getSelectedItem().getText();if(t._selectFunctionSelected===a.SELECT||t._selectFunctionSelected===a.FIRST){t._countField.setEnabled(false);t._countField.setValue("");t._count="";}else{t._countField.setEnabled(true);}if(t.dataObjectId&&t._selectFunctionSelected&&(t._count||t._selectFunctionSelected===a.SELECT||t._selectFunctionSelected===a.FIRST)){t.functionLabelDisplay=t._count?t._selectFunctionSelected+'('+t.dataObjectLabel+','+t._count+')':t._selectFunctionSelected+'('+t.dataObjectLabel+')';t.functionLabel=t._count?t._selectFunctionSelected+'('+t.dataObjectId+','+t._count+')':t._selectFunctionSelected+'('+t.dataObjectId+')';t.functionLabelField.setValue(t.functionLabelDisplay);if((t._selectFunctionSelected!==a.SELECT&&t._count>0)||(this.oModel.getData().selectionData[0].attributeSelected!==""&&t._selectFunctionSelected===a.SELECT)||(t._selectFunctionSelected===a.FIRST&&t.dataObjectId)){this.applyButton.setEnabled(true);}else{this.applyButton.setEnabled(false);}this.astExpressionBasicForWhere.setEditable(true);}else{this.applyButton.setEnabled(false);this.astExpressionBasicForWhere.setEditable(false);this.astExpressionBasicForWhere.setValue("");this.functionLabelField.setValue("");}}.bind(this)}).addStyleClass("sapAstExpressionDialogField");this.functionSelect.setModel(m);this.functionSelect.bindItems({path:"/selection",template:new sap.ui.core.ListItem({text:"{name}",key:"{name}",additionalText:"{label}"})});return this.functionSelect;};S.prototype._getAttributeAstExpressionBasic=function(A){var t=this;this.astExpressionBasicForAttribute=new sap.rules.ui.AstExpressionBasic({astExpressionLanguage:this._oAstExpressionLanguage,enableAggregateFunctionWhereClause:true,value:"{attributeSelected}",dataObjectInfo:"{/dataObjectIdData/dataObjectId}",isAttributeContext:true,editable:"{/enabledData/enabled}",ariaLabelledBy:A,change:function(e){var s=parseInt(e.getSource().getBindingContext().sPath.split("/")[2]);t._AttributeExpressionId=e.getParameter("newValue");var c=t.oModel.getData().selectionData;if(this._attributeAlreadySelected(c)){e.oSource.setValueState("Error");e.oSource.setValueStateText(this.oBundle.getText("duplicateAttribute"));}else{e.oSource.setValueState("None");}if(t._AttributeExpressionId){c[s].attributeSelected=t._AttributeExpressionId.trim();}var d=t._setDataObjectInfoForWhereConditionAutoSuggestion();t.astExpressionBasicForWhere.setDataObjectInfo(d);if((t._selectFunctionSelected!==a.SELECT&&t._count>0)||(this.oModel.getData().selectionData[0].attributeSelected!==""&&t._selectFunctionSelected===a.SELECT)||(t._selectFunctionSelected===a.FIRST&&t.dataObjectId)){this.applyButton.setEnabled(true);}else{this.applyButton.setEnabled(false);}this.astExpressionBasicForWhere.setValue("");this._whereExpressionId="";}.bind(this)});this.astExpressionBasicForAttribute.addStyleClass("sapAstExpressionDialog");return this.astExpressionBasicForAttribute;};S.prototype._attributeAlreadySelected=function(s){var c=0;for(var e in s){if(s[e].attributeSelected.trim()===this._AttributeExpressionId.trim()){c++;}}if(c>1){return true;}return false;};S.prototype._tableColumnsFactory=function(I,c){var t=this;var d=new sap.m.ColumnListItem({cells:[t._getAttributeAstExpressionBasic("selectAttributeLabelId"+t.selectLabelUUID),new sap.m.Select({enabled:"{/enabledData/enabled}",items:{path:"/sortOrder",template:new sap.ui.core.ListItem({key:'{name}',text:'{label}'})},change:function(e){var s=parseInt(e.getSource().getBindingContext().sPath.split("/")[2]);t._sortOrder=e.getSource().getSelectedItem().getKey();t.oModel.getData().selectionData[s].sortOrder=t._sortOrder}.bind(this),selectedKey:"{sortOrder}",width:'200px',tooltip:t.oBundle.getText("sort_attributes_tooltip"),}).addStyleClass("sapAstExpressionDialogField sapAstExpressionSortSelect"),new sap.ui.layout.HorizontalLayout({content:[new sap.m.Button({type:sap.m.ButtonType.Transparent,icon:sap.ui.core.IconPool.getIconURI("sys-cancel"),visible:"{cancelButton}",enabled:"{/enabledData/enabled}",press:function(e){var s=e.getSource().getParent().getParent().getBindingContextPath().split("/")[2];this._removeColumnFromJsonModel(parseInt(s));}.bind(this)}),new sap.m.Button({type:sap.m.ButtonType.Transparent,icon:sap.ui.core.IconPool.getIconURI("add"),visible:"{addButton}",enabled:"{/enabledData/enabled}",press:function(e){var s=e.getSource().getParent().getParent().getBindingContextPath().split("/")[2];this._addColumnToJsonModel(parseInt(s));}.bind(this)})]})]});return d;};S.prototype._addColumnToJsonModel=function(s){var n={attributeSelected:"",sortOrder:a.NOSORT,cancelButton:true,addButton:true,};this.selectedData.splice(s+1,0,n);if(this.selectedData.length>1){this.selectedData[0].cancelButton=true;}this.oModel.setData({sortOrder:this.sortOrder,selectionData:this.selectedData,enabledData:this.enabledData,dataObjectIdData:this.dataObjectIdData});};S.prototype._removeColumnFromJsonModel=function(s){this.selectedData.splice(s,1);if(this.selectedData.length===1){this.selectedData[0].cancelButton=false;}this.oModel.setData({sortOrder:this.sortOrder,selectionData:this.selectedData,enabledData:this.enabledData,dataObjectIdData:this.dataObjectIdData});var c=this._setDataObjectInfoForWhereConditionAutoSuggestion();this.astExpressionBasicForWhere.setDataObjectInfo(c);this.astExpressionBasicForWhere.setValue("");this._whereExpressionId="";};S.prototype._getSuggestionsForTheGivenInput=function(c){var t=this._oAstExpressionLanguage.getTokensForGivenStringInput(c);var u=this._oAstExpressionLanguage.convertTokensToUiModelForAutoSuggestion(t);var s={};s.AttributeContext=true;s.OperationsContext=false;var d=this._oAstExpressionLanguage.getSuggesstions(u,s);return d;};S.prototype._createDataObjectDropDown=function(A){var t=this;var c=this._getSuggestionsForTheGivenInput("");var d=c.autoComplete.categories;var m=new sap.ui.model.json.JSONModel(d);this.vocabularySelect=new sap.m.Select({width:"200px",selectedKey:this.dataObjectIdSelected,forceSelection:false,ariaLabelledBy:A,layoutData:new sap.ui.layout.GridData({span:"L3 M3 S12"}),change:function(E){t.dataObjectIdSelected=E.getSource().getSelectedItem().getKey();t.dataObjectId="/"+E.getSource().getSelectedItem().getKey();t.dataObjectLabel=E.getSource().getSelectedItem().getText();if(t.dataObjectId){t.oModel.getData().dataObjectIdData.dataObjectId=t.dataObjectId;t.oModel.getData().enabledData.enabled=true;}this.selectedData=[{attributeSelected:"",sortOrder:a.NOSORT,cancelButton:false,addButton:true}];var s=t._setDataObjectInfoForWhereConditionAutoSuggestion();t.astExpressionBasicForWhere.setDataObjectInfo(s);if(t.dataObjectId&&t._selectFunctionSelected&&(t._count||t._selectFunctionSelected===a.SELECT||t._selectFunctionSelected===a.FIRST)){t.functionLabelDisplay=t._count?t._selectFunctionSelected+'('+t.dataObjectLabel+','+t._count+')':t._selectFunctionSelected+'('+t.dataObjectLabel+')';t.functionLabel=t._count?t._selectFunctionSelected+'('+t.dataObjectId+','+t._count+')':t._selectFunctionSelected+'('+t.dataObjectId+')';t.functionLabelField.setValue(t.functionLabelDisplay);if((t._selectFunctionSelected!==a.SELECT&&t._count>0)||(this.oModel.getData().selectionData[0].attributeSelected!==""&&t._selectFunctionSelected===a.SELECT)||(t._selectFunctionSelected===a.FIRST&&t.dataObjectId)){this.applyButton.setEnabled(true);}else{this.applyButton.setEnabled(false);}this.astExpressionBasicForWhere.setValue("");this._whereExpressionId="";this.astExpressionBasicForWhere.setEditable(true);}else{this.applyButton.setEnabled(false);this.astExpressionBasicForWhere.setEditable(false);this.astExpressionBasicForWhere.setValue("");this.functionLabelField.setValue("");}t._bindAttributes();}.bind(this)}).addStyleClass("sapAstExpressionDialogField");this.vocabularySelect.setModel(m);this.vocabularySelect.bindItems({path:"/terms",template:new sap.ui.core.ListItem({text:"{label}",key:"{id}"})});var v=c.autoComplete.categories.vocabularyRules;for(var e in v){var f=new sap.ui.core.ListItem({text:v[e].label,key:v[e].id});this.vocabularySelect.addItem(f);}return this.vocabularySelect;};S.prototype._bindAttributes=function(){this.oModel=new sap.ui.model.json.JSONModel();this.oModel.setData({sortOrder:this.sortOrder,selectionData:this.selectedData,enabledData:this.enabledData,dataObjectIdData:this.dataObjectIdData});this.conditionsTable.setModel(this.oModel);};S.prototype._createWhereAstExpressionBasic=function(A){var t=this;this.astExpressionBasicForWhere=new sap.rules.ui.AstExpressionBasic({astExpressionLanguage:this._oAstExpressionLanguage,enableAggregateFunctionWhereClause:true,value:this._whereExpressionId,editable:"{/value}",dataObjectInfo:this._setDataObjectInfoForWhereConditionAutoSuggestion(),ariaLabelledBy:A,change:function(e){t._whereExpressionId=e.getParameter("newValue");}.bind(this)});this.astExpressionBasicForWhere.addStyleClass("sapAstExpressionDialog");return this.astExpressionBasicForWhere;};S.prototype._setDataObjectInfoForWhereConditionAutoSuggestion=function(){if(this.dataObjectId){var d=this._returnDataObjectBasedOnCommonAssociationAndCardinality(this.dataObjectId,this._getSelectedAttributeJsons());return this._selectFunctionSelected+"("+a.FILTER+"("+d+",";}};S.prototype._createFunctionLabel=function(){this.functionLabelField=new sap.m.TextArea({value:this.functionLabelDisplay,enabled:false,width:"100%"}).addStyleClass("sapAstExpressionDialogTextField");return this.functionLabelField;};S.prototype._clearData=function(){this.functionLabelDisplay="";this.functionLabel="";this._selectFunctionSelected="";this._whereExpressionId="";this.dataObjectId="";this._count="";this.dataObjectLabel="";this.dataObjectIdSelected="";this.enableCountField=false;this.attributeJson={};this.sortOrder=[{name:a.NOSORT,label:this.oBundle.getText("no_sorting")},{name:a.SORTASC,label:this.oBundle.getText("sort_ascending")},{name:a.SORTDESC,label:this.oBundle.getText("sort_descending")}];this.selectedData=[{attributeSelected:"",sortOrder:a.NOSORT,cancelButton:false,addButton:true}];this.enabledData={enabled:false};this.dataObjectIdData={dataObjectId:""};};S.prototype._createTable=function(){var t=this;this.conditionsTable=new sap.m.Table({backgroundDesign:sap.m.BackgroundDesign.Solid,showSeparators:sap.m.ListSeparators.None,layoutData:new sap.ui.layout.form.GridContainerData({halfGrid:false}),columns:[new sap.m.Column({width:"50%"}).setStyleClass("sapAstAttributeColumn"),new sap.m.Column({width:"25%"}).setStyleClass("sapAstSortColumn"),new sap.m.Column({width:"20%"})]}).addStyleClass("sapAstAttributeTable");this._bindAttributes();var c=t._tableColumnsFactory();this.conditionsTable.bindItems("/selectionData",c);return this.conditionsTable;};S.prototype._createCountField=function(A){var t=this;this._countField=new sap.m.TextArea({value:t._count,enabled:this.enableCountField,ariaLabelledBy:A,layoutData:new sap.ui.layout.GridData({span:"L1 M1 S12"}),change:function(e){t._count=e.getSource().getValue();if(t.dataObjectId&&t._selectFunctionSelected&&(t._count||t._selectFunctionSelected===a.SELECT||t._selectFunctionSelected===a.FIRST)){t.functionLabelDisplay=t._count?t._selectFunctionSelected+'('+t.dataObjectLabel+','+t._count+')':t._selectFunctionSelected+'('+t.dataObjectLabel+')';t.functionLabel=t._count?t._selectFunctionSelected+'('+t.dataObjectId+','+t._count+')':t._selectFunctionSelected+'('+t.dataObjectId+')';t.functionLabelField.setValue(t.functionLabelDisplay);if((t._selectFunctionSelected!==a.SELECT&&t._count>0)||(this.oModel.getData().selectionData[0].attributeSelected!==""&&t._selectFunctionSelected===a.SELECT)||(t._selectFunctionSelected===a.FIRST&&t.dataObjectId)){this.applyButton.setEnabled(true);}else{this.applyButton.setEnabled(false);}this.astExpressionBasicForWhere.setEditable(true);}else{this.applyButton.setEnabled(false);this.astExpressionBasicForWhere.setEditable(false);this.astExpressionBasicForWhere.setValue("");this.functionLabelField.setValue("");}}.bind(this)}).addStyleClass("sapAstSelectCountField sapAstExpressionDialogTextField");return this._countField;};S.prototype._convertFunctionLabelToText=function(d,f){this.termsProvider=this._oAstExpressionLanguage._astBunldeInstance.TermsProvider.TermsProvider;var o=this.termsProvider.getTermNameFromASTNodeReference(d);f=f.replace(d,o);return f};S.prototype._createSelectFunctionDialog=function(d,c,A,e,j){var t=this;var s=0;this._clearData();this.selectLabelUUID=this._createUUId();this.oBundle=sap.ui.getCore().getLibraryResourceBundle("sap.rules.ui.i18n");this._oAstExpressionLanguage=A;if(j){this._selectFunctionSelected=j.function;this._whereExpressionId=j.filter;this.dataObjectId=j.dataObject;this.functionLabel=j.functionLabel;this.dataObjectIdSelected=j.dataObject.replace("/","");this.attributeJson=j.attributes;if(j.count){this._count=j.count;this.enableCountField=true;}t.functionLabelDisplay=this._convertFunctionLabelToText(j.dataObject,j.functionLabel);;if(this.dataObjectId){var f=this._returnDataObjectBasedOnCommonAssociationSelection(j.doVocabId,j.attributes);this.attributeJson=this._addAssociationIdFromAttribute(j.attributes,f,this.dataObjectId);this.dataObjectIdData.dataObjectId=this.dataObjectId;this.enabledData.enabled=true;this.termsProvider=this._oAstExpressionLanguage._astBunldeInstance.TermsProvider.TermsProvider;this.dataObjectLabel=this.termsProvider.getTermNameFromASTNodeReference(this.dataObjectId);}if(!jQuery.isEmptyObject(this.attributeJson)){this.selectedData=[];for(var k in this.attributeJson){var n={attributeSelected:"",sortOrder:a.NOSORT,cancelButton:true,addButton:true,};n.attributeSelected=k;n.sortOrder=this.attributeJson[k];this.selectedData.push(n);s++;}if(s===1){this.selectedData[0].cancelButton=false;}}if(this._selectFunctionSelected===a.SELECT){this.enableCountField=false;}}var g=t._createFunctionSelectionDropDown(d,"selectFunctionSelectionLabelId",+t.selectLabelUUID);var h=new sap.m.Text({text:"Count",tooltip:"Count",textAlign:"End",layoutData:new sap.ui.layout.GridData({span:"L1 M1 S12"})});var v=new sap.m.Text({text:t.oBundle.getText("vocabulary"),tooltip:t.oBundle.getText("vocabulary"),textAlign:"End",layoutData:new sap.ui.layout.GridData({span:"L2 M2 S12"})});var l=t._createTable();var w=t._createWhereAstExpressionBasic("selectWhereLabelId"+t.selectLabelUUID);var F=t._createFunctionLabel();var m=new sap.ui.layout.form.SimpleForm({layout:sap.ui.layout.form.SimpleFormLayout.ResponsiveGridLayout,editable:true,content:[new sap.m.Label("selectFunctionSelectionLabelId"+t.selectLabelUUID,{text:t.oBundle.getText("function"),tooltip:t.oBundle.getText("function"),labelFor:g.getId()}),g,h,t._createCountField(h.getId()),v,t._createDataObjectDropDown(v.getId()),new sap.m.Label("selectAttributeLabelId"+t.selectLabelUUID,{text:t.oBundle.getText("attributes"),tooltip:t.oBundle.getText("attributes"),labelFor:l.getId()}).addStyleClass("sapAstAttributeLabel"),l,new sap.m.Label("selectWhereLabelId"+t.selectLabelUUID,{text:t.oBundle.getText("where"),tooltip:t.oBundle.getText("where"),labelFor:w.getId()}),w,new sap.m.Label({text:t.oBundle.getText("function_label"),tooltip:t.oBundle.getText("function_label"),labelFor:F.getId()}),F]});var o=new sap.m.Dialog({title:this.oBundle.getText("selectFunctionTitle"),contentWidth:"800px",showHeader:true,draggable:true,beforeClose:function(){e(false);},content:[m],buttons:[this.applyButton=new sap.m.Button({text:this.oBundle.getText("apply"),tooltip:this.oBundle.getText("applyChangesBtnTooltip"),press:function(p){var q=t._createJson();p.getSource().mProperties={value:t.functionLabel,jsonData:q};c(p);t._setModal(false);o.close();o.destroy();}}),new sap.m.Button({text:this.oBundle.getText("cancel"),tooltip:this.oBundle.getText("cancelBtnTooltip"),press:function(p){t._setModal(false);o.close();o.destroy();}})]}).addStyleClass("sapUiSizeCompact");;t._setModal(true);o.open();};S.prototype._setModal=function(v){var p=sap.ui.getCore().byId("popover");if(p){p.setModal(v);}};S.prototype._getSelectedAttributeJsons=function(){var k="";var v="";var j={};for(var c=0;c<this.oModel.getData().selectionData.length;c++){if(this.oModel.getData().selectionData[c].attributeSelected!==""){k=this.oModel.getData().selectionData[c].attributeSelected;v=this.oModel.getData().selectionData[c].sortOrder;j[k]=v;}}return j;};S.prototype._returnDataObjectBasedOnCommonAssociationSelection=function(d,c){var s="";var e="";if(d&&Object.keys(c).length!==0&&c.constructor===Object){var f=Object.keys(c)[0];s=d+f.replace(".","");if(Object.keys(c).length>1){for(var k in c){e=d+k.replace(".","");var g=s.split("/");var h=e.split("/");if(g.length>2&&h.length>2){s="";for(var j=1;j<(g<h?g.length:h.length);j++){if(g[j]===h[j]){s+="/"+g[j];}}}}}else{var g=s.split("/");s="";for(var j=1;j<g.length-1;j++){s+="/"+g[j];}}if(this._hasAssociationId(s)){return s;}}if(!this.includes(d,"/")){d="/"+d;}return d;};S.prototype._returnDataObjectBasedOnCommonAssociationAndCardinality=function(d,c){var s="";var e="";if(d&&Object.keys(c).length!==0&&c.constructor===Object){var f=Object.keys(c)[0];s=d+f.replace(".","");if(Object.keys(c).length>1){for(var k in c){e=d+k.replace(".","");var g=s.split("/");var h=e.split("/");if(g.length>2&&h.length>2){s="";for(var j=1;j<(g<h?g.length:h.length);j++){if(g[j]===h[j]){s+="/"+g[j];}}}}}else{var g=s.split("/");s="";for(var j=1;j<g.length-1;j++){s+="/"+g[j];}}if(this._hasAssociationId(s)){return this._returnDataObjectBasedOnCardinality(s);}}return d;};S.prototype._returnDataObjectBasedOnCardinality=function(v){var c=v;if(c){var s=c.split("/");var d=s[1];var e=0;var t;var f="";if(s.length>2){for(var g=2;g<s.length;g++){d+="."+s[g];t=this._oAstExpressionLanguage._astBunldeInstance.TermsProvider.TermsProvider.getTermByTermId(d);if(t&&t._dataObjectType==="AO"&&t._cardinality==="1..n"){e=g;}}if(e>0){for(var g=1;g<=e;g++){f+="/"+s[g];}}}if(f){return f;}else{return"/"+s[1];}}};S.prototype._hasAssociationId=function(v){var c=v;if(c){var s=c.split("/");var d=s[1];if(s.length>2){for(var e=2;e<s.length;e++){d+="."+s[e];}}if(this._oAstExpressionLanguage._astBunldeInstance.TermsProvider.TermsProvider.getTermByTermId(d)&&this._oAstExpressionLanguage._astBunldeInstance.TermsProvider.TermsProvider.getTermByTermId(d)._dataObjectType==="AO"){return true;}}return false;};S.prototype._returnAssociationForAttributesBasedOnCardinality=function(c){if(c){var s=c.split("/");var d=s[1];var e=0;var t;var f="";if(s.length>2){for(var g=2;g<s.length;g++){d+="."+s[g];t=this._oAstExpressionLanguage._astBunldeInstance.TermsProvider.TermsProvider.getTermByTermId(d);if(t&&t._dataObjectType==="AO"&&t._cardinality==="1..n"){e=g;}}if(e>0){for(var g=2;g<=e;g++){f+="/"+s[g];}}}return f;}};S.prototype._addAssociationIdToWhere=function(w,c){var e="";var I;if(w){I=w.split(" ");for(var d=0;d<I.length;d++){if(I[d].indexOf("./")!==-1){I[d]="."+I[d].replace(/\./,c)}e+=I[d]+" ";}return e.trim();}return w;};S.prototype._removeAssociationIdFromAttribute=function(c,d,D){var e="";var I;var n={};var f=this._returnAssociationForAttributesBasedOnCardinality(d);if(D&&Object.keys(c).length!==0&&c.constructor===Object&&f){var k=Object.keys(c);for(var j=0;j<k.length;j++){var g=k[j];var v=c[g];g=g.replace(f,"");n[g]=v;}return n;}return c};S.prototype._removeAssociationIdToWhere=function(w){var e="";var I;if(w){I=w.split(" ");for(var c=0;c<I.length;c++){if(I[c].indexOf("./")!==-1){var s=I[c].split("/");I[c]="./"+s[s.length-1];}e+=I[c]+" ";}return e.trim();}return w;};S.prototype._addAssociationIdFromAttribute=function(c,d,D){var e="";var I;var n={};var f=this._returnAssociationForAttributesBasedOnCardinality(d);if(D&&Object.keys(c).length!==0&&c.constructor===Object&&f){var k=Object.keys(c);for(var j=0;j<k.length;j++){var g=k[j];var v=c[g];g="."+g.replace(/\./,f);n[g]=v;}return n;}return c};S.prototype._createJson=function(){var c=this._getSelectedAttributeJsons();var w=this._whereExpressionId;var d=this._returnDataObjectBasedOnCommonAssociationSelection(this.dataObjectId,c);var e=this._returnDataObjectBasedOnCommonAssociationAndCardinality(this.dataObjectId,c);c=this._removeAssociationIdFromAttribute(c,d,this.dataObjectId);var j={"function":this._selectFunctionSelected,"filter":w,"functionLabel":this.functionLabel,"dataObject":this.dataObjectId,"attributes":c,"doVocabId":e};if(this._count){j["count"]=this._count;}return j;};S.prototype.includes=function(p,s){var r=false;if(p.indexOf(s)!==-1){r=true;}return r;};S.prototype._createUUId=function(){this.infraUtils=new sap.rules.ui.parser.infrastructure.util.utilsBase.lib.utilsBaseLib();return this.infraUtils.createUUID()};return{getInstance:function(){b=new S();return b;}};},true);
