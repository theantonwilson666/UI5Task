sap.ui.define(["sap/ui/thirdparty/jquery","../../library","sap/ui/core/Control","sap/m/List","sap/ui/model/json/JSONModel","sap/m/ListMode","sap/ui/core/CustomData","sap/ui/model/Sorter","sap/rules/ui/parser/infrastructure/util/utilsBase"],function(q,l,C,R,L,J,a,b,S,i){"use strict";var c=C.extend("sap.rules.ui.ast.autoCompleteContent.AutoSuggestionTimeAndDurationFunctionPanel",{metadata:{library:"sap.rules.ui",properties:{reference:{type:"object",defaultValue:null,},dialogOpenedCallbackReference:{type:"object",defaultValue:null,},data:{type:"object",defaultValue:null},expand:{type:"boolean",defaultValue:false}},aggregations:{PanelLayout:{type:"sap.m.Panel",multiple:false}},events:{}},init:function(){this.oBundle=sap.ui.getCore().getLibraryResourceBundle("sap.rules.ui.i18n");this.infraUtils=new sap.rules.ui.parser.infrastructure.util.utilsBase.lib.utilsBaseLib();this.needCreateLayout=true;this.AttributeSegmentSelected=true;this.dataObjectName="";},onBeforeRendering:function(){this._reference=this.getReference();this._dialogOpenedCallbackReference=this.getDialogOpenedCallbackReference();if(this.needCreateLayout){var d=this._createLayout();this.setAggregation("PanelLayout",d,true);this.needCreateLayout=false;}},initializeVariables:function(){},_createLayout:function(){var t=this;this.vocabularyData=this.getData();var m=new sap.ui.model.json.JSONModel();this.timeAndDurationFunctionlist=new sap.m.List({growingScrollToLoad:true,enableBusyIndicator:true,});var d=[];for(var e=0;e<5&&e<this.vocabularyData.length;e++){d.push(this.vocabularyData[e]);}m.setData(d);this.timeAndDurationFunctionlist.bindItems({path:"/",sorter:new sap.ui.model.Sorter("name"),rememberSelections:false,mode:a.SingleSelectMaster,template:new sap.m.DisplayListItem({label:"{name}",value:"{label}",type:"Active",press:function(E){t._reference(E);}})});this.timeAndDurationFunctionlist.setModel(m);var f=this.getMoreTimeAndDurationLink();var t=this;var g=new sap.m.Panel({headerText:this.oBundle.getText("timeAndDurationFunctionsPanelTitle"),expandable:true,expanded:this.getExpand(),content:this.timeAndDurationFunctionlist,width:"auto"});if(this.vocabularyData.length>=5){g.addContent(f);}return g;},getMoreTimeAndDurationLink:function(){var t=this;var s=this.getData();var m=new sap.m.Link({text:this.oBundle.getText("more_link"),tooltip:this.oBundle.getText("more_link_tooltip"),enabled:true,press:function(e){t._setModal(true);t._dialogOpenedCallbackReference(true);if(t.vocabularyData){t.getTimeAndDurationDialog();}}});return m;},_setModal:function(v){var p=sap.ui.getCore().byId("popover");if(p){p.setModal(v);}},getTimeAndDurationDialog:function(){var t=this;var s=this.oBundle.getText("searchTextTimeAndDuration");var d=this.getSearchField(s);this.detailedTimeAndDurationList=this.initializeTimeAndDurationList(this.vocabularyData);this.bindFilteredTermsToList(this.detailedTimeAndDurationList,"",false);var v=new sap.ui.layout.VerticalLayout({content:[d,t.detailedTimeAndDurationList]}).addStyleClass("sapAstVocabularyPanel");this.timeAndDurationDialog=new sap.m.Dialog({title:this.oBundle.getText("selectTimeAndDurationTitle"),contentWidth:"500px",contentHeight:"500px",showHeader:true,content:[v],afterClose:function(){t._dialogOpenedCallbackReference(false);},buttons:[new sap.m.Button({text:this.oBundle.getText("cancelBtn"),tooltip:this.oBundle.getText("cancelBtn"),press:function(e){t._setModal(false);t.timeAndDurationDialog.close();}})]});t.timeAndDurationDialog.open();},bindFilteredTermsToList:function(o,s,r){var m=new sap.ui.model.json.JSONModel(this.vocabularyData);var t=this;var d="/";if(!o){o=new sap.m.List({});}o.setModel(m);o.bindItems({path:d,template:new sap.m.DisplayListItem({label:"{name}",value:"{label}",type:"Active",press:function(E){t._setModal(false);if(t.timeAndDurationDialog.isOpen()){t.timeAndDurationDialog.close();}t._reference(E);}}),rememberSelections:false,mode:a.SingleSelectMaster});if(r){var f=[];var e="name";f.push(new sap.ui.model.Filter(e,sap.ui.model.FilterOperator.Contains,s));o.getBinding("items").filter(f);o.getModel().refresh(true);}},initializeTimeAndDurationList:function(v){var m=new sap.ui.model.json.JSONModel(v);var d="/";var t=new sap.m.List({headerText:this.oBundle.getText("timeAndDuration")});t.setModel(m);t.bindItems({path:d,template:new sap.m.DisplayListItem({label:"{name}",value:"{label}",type:"Active",})});return t;},getSearchField:function(p){var t=this;this.searchField=new sap.m.SearchField({showSearchButton:false,width:"462px",placeholder:p,liveChange:function(e){t.bindFilteredTermsToList(t.detailedTimeAndDurationList,e.getParameter("newValue"),true);}});return this.searchField;}});return c;},true);
