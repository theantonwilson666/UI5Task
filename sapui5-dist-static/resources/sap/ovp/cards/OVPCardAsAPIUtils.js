sap.ui.define(["sap/ovp/cards/ovpLogger"],function(o){"use strict";var l=new o("OVP.cards.OVPCardsAsAPIUtils");var s=["sap.ovp.cards.list","sap.ovp.cards.table","sap.ovp.cards.v4.list","sap.ovp.cards.v4.table","sap.ovp.cards.stack","sap.ovp.cards.linklist","sap.ovp.cards.charts.analytical","sap.ovp.cards.charts.smart.chart","sap.ovp.cards.charts.bubble","sap.ovp.cards.charts.donut","sap.ovp.cards.charts.line","sap.ovp.cards.error"];function g(){return s;}function e(m,d,E){var f={};f.message=m;if(E){f._oError=E;f.getActualError=function(){return f._oError;};}l.error(f.message);d(f);}function c(C){var d=false;var f=C.getOwnerComponent();if(!!f){var h=f.getComponentData();if(!!h&&h.ovpCardsAsApi){d=true;}}return d;}function r(C,d){var m=d.manifest;var f;for(var h in m.cards){f=h;}var i=m.cards[f];if(i.template==="sap.ovp.cards.charts.analytical"||i.template==="sap.ovp.cards.charts.smart.chart"){i.settings.chartAnnotationPath=C.chartAnnotationPath;i.settings.navigation=C.navigation;}if(C.entitySet){i.settings.entitySet=C.entitySet;}i.settings.annotationPath=C.annotationPath;i.settings.dynamicSubtitleAnnotationPath=C.dynamicSubtitleAnnotationPath;i.settings.presentationAnnotationPath=C.presentationAnnotationPath;i.settings.selectionAnnotationPath=C.selectionAnnotationPath;i.settings.selectionPresentationAnnotationPath=C.selectionPresentationAnnotationPath;i.settings.kpiAnnotationPath=C.kpiAnnotationPath;i.settings.dataPointAnnotationPath=C.dataPointAnnotationPath;i.settings.identificationAnnotationPath=C.identificationAnnotationPath;i.settings.headerAnnotationPath=C.headerAnnotationPath;i.settings.selectedKey=C.selectedKey;if(i){m.cards[f]=i;O.createCardComponent(d.parentView,m,d.containerId,d.selectionVariant);}}function _(C){var d=true;if(C.template==="sap.ovp.cards.error"||(C.template==="sap.ovp.cards.linklist"&&C.settings.staticContent)){d=false;}return d;}function a(C,S){var f=[],p=[],i,j;var d=S.getSelectOptionsPropertyNames();for(i=0;i<d.length;i++){var h=S.getSelectOption(d[i]);if(h&&h.length>0){for(j=0;j<h.length;j++){if(h[j]){var F={path:d[i],operator:h[j].Option,value1:h[j].Low,sign:h[j].Sign};if(h[j].High){F.value2=h[j].High;}f.push(F);}}}}var P=S.getParameterNames();for(i=0;i<P.length;i++){var k={path:P[i],value:S.getParameter(P[i])};p.push(k);}C.settings.filters=f;C.settings.parameters=p;return C;}function b(v,m,C,S,f){return new Promise(function(d,h){var i,j,M="";if(!!m){for(var k in m.cards){if(m.cards.hasOwnProperty(k)){i=m.cards[k];j=k;}}if(!!i&&!!j){if(!!i.template&&!!i.settings&&(!!i.model||!_(i))){if(s.indexOf(i.template)!==-1){if(!!C&&typeof C==='string'){if(!!v){var n=(!i.model)?undefined:v.getModel(i.model);var p;if(!_(i)){p=Promise.resolve();}else{if(n&&n.getODataVersion&&n.getODataVersion()=="4.0"){p=n.getMetaModel().requestObject("/"+i.settings.entitySet);}else{p=n.getMetaModel().loaded();}}p.then(function(){var I=false;if(S){i=a(i,S);I=true;}i.settings.ignoreSelectionVariant=I;var q={async:true,name:i.template,componentData:{model:n,ovpCardsAsApi:true,parentView:v,manifest:m,containerId:C,selectionVariant:S,fnCheckNavigation:f,showDateInRelativeFormat:m.showDateInRelativeFormat,disableTableCardFlexibility:m.disableTableCardFlexibility,template:i.template,i18n:v.getModel("@i18n"),cardId:j,settings:i.settings,appComponent:null,mainComponent:null}};sap.ui.component(q).then(function(t){var u=v.byId(C);if(!!u){var w=u.getComponentInstance();t.setModel(n);u.setComponent(t);if(w){setTimeout(function(){w.destroy();},0);}d(true);}else{M="Component Container '"+C+"' is not present in the current View";e(M,h);}},function(E){M="Component creation failed";e(M,h,E);});},function(E){M="MetaModel was not loaded";e(M,h,E);});}else{M="First argument oView is null";e(M,h);}}else{M="ContainerId should be of type string and not null";e(M,h);}}else{M=i.template+" card type is not supported in the API";e(M,h);}}else{M="Cards template or model or settings are not defined";e(M,h);}}else{M="Cards manifest entry or cardId is null";e(M,h);}}else{M="Second argument oManifest is null";e(M,h);}});}var O={createCardComponent:b,recreateCard:r,checkIfAPIIsUsed:c,getSupportedCardTypes:g};return O;},true);
