sap.ui.define(["sap/ui/core/format/NumberFormat","sap/ui/core/format/DateFormat","sap/ovp/cards/CommonUtils","sap/ui/model/odata/v4/AnnotationHelper","sap/ui/model/FilterOperator","sap/ui/Device","sap/ui/model/analytics/odata4analytics","sap/ui/generic/app/navigation/service/SelectionVariant","sap/ovp/app/resources","sap/base/strings/formatMessage","sap/base/util/isPlainObject","sap/base/util/each","sap/ovp/cards/MetadataAnalyser","sap/base/security/encodeURL","sap/base/util/merge","sap/ovp/cards/ovpLogger","sap/base/util/isEmptyObject","sap/ovp/app/OVPUtils"],function(N,D,C,O,F,a,o,S,b,f,c,e,M,d,m,g,h,l){"use strict";var n={StateValues:{None:"None",Negative:"Error",Critical:"Warning",Positive:"Success"},ColorValues:{None:"Neutral",Negative:"Error",Critical:"Critical",Positive:"Good"}};var A={TEXT:"com.sap.vocabularies.Common.v1.Text",TEXT_ARRANGEMENT:"com.sap.vocabularies.UI.v1.TextArrangement"};var T={TEXT_LAST:"com.sap.vocabularies.UI.v1.TextArrangementType/TextLast",TEXT_FIRST:"com.sap.vocabularies.UI.v1.TextArrangementType/TextFirst",TEXT_ONLY:"com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly",TEXT_SEPARATE:"com.sap.vocabularies.UI.v1.TextArrangementType/TextSeparate"};var I={"List_condensed":{phone:5,tablet:5,desktop:5},"List_extended":{phone:3,tablet:3,desktop:3},"List_condensed_bar":{phone:5,tablet:5,desktop:5},"List_extended_bar":{phone:3,tablet:3,desktop:3},"Table":{phone:5,tablet:5,desktop:5},"Stack_simple":{phone:20,tablet:20,desktop:20},"Stack_complex":{phone:5,tablet:5,desktop:5}};var L=new g("OVP.cards.V4AnnotationHelper");function p(i,j){var k=i.getSetting('ovpCardProperties');var p3=k.getProperty('/showLabelText');if(p3==="true"){var q3=j.Address[0];if(typeof q3.country!=="undefined"){return"{path:'"+q3.country.Path+"'}";}else if(typeof q3.locality!=="undefined"){return"{path:'"+q3.locality.Path+"'}";}else if(typeof q3.street!=="undefined"){return"{path:'"+q3.street.Path+"'}";}else if(typeof q3.code!=="undefined"){return"{path:'"+q3.code.Path+"'}";}}else{return null;}}p.requiresIContext=true;function q(i,j){if(!j){return"";}if(j.Label){return j.Label;}var k=i.getSetting&&i.getSetting('ovpCardProperties');var p3=k&&k.getProperty("/metaModel");var q3=k&&k.getProperty("/entityType");if(!p3||!q3){return"";}var r3;if(j.Value){r3=j.Value.$Path;}if(j.Target){var s3="/"+J(q3.$Type,j);var t3=s3&&p3.getProperty(s3);r3=t3&&t3.Value.$Path;}if(!r3||!r3.length>0||r3===" "){return"";}var u3=p3.getData()["$Annotations"][q3.$Type+"/"+r3];if(!u3){return"";}var v3=u3["sap:label"]||(u3["@com.sap.vocabularies.Common.v1.Label"]||"")||"";return v3;}q.requiresIContext=true;function s(i){if(i.EdmType==="Edm.DateTime"||i.EdmType==="Edm.DateTimeOffset"){return'Right';}return'Left';}s.requiresContext=true;function r(i,k){if(i.getSetting){var j=i.getSetting("_ovpCache");if(j){return j[k];}}return undefined;}function t(i,k,j){if(i.getSetting){var p3=i.getSetting("_ovpCache");if(p3){p3[k]=j;}}}function u(i,j){var k;if(j){k=j.None;if(i&&i.EnumMember){var p3=i.EnumMember;if(w(p3,'Negative')){k=j.Negative;}else if(w(p3,'Critical')){k=j.Critical;}else if(w(p3,'Positive')){k=j.Positive;}}}return k;}function v(i){if(i=="Error"){i=1;}else if(i=="Warning"){i=2;}else if(i=="Success"){i=3;}else{i=0;}return i;}function w(i,j){return i&&i.indexOf(j,i.length-j.length)!==-1;}function x(i,j,k,p3,q3,r3,s3){if(typeof i=="string"){i=N.getIntegerInstance().parse(i);}var t3={};t3.EnumMember="None";var u3=Number.NEGATIVE_INFINITY;var v3=Number.POSITIVE_INFINITY;if((!q3&&q3!==0)&&(k||k===0)){q3=k;}if((!r3&&r3!==0)&&(p3||p3===0)){r3=p3;}if(!k&&k!==0){k=u3;}if(!p3&&p3!==0){p3=v3;}if(i!==undefined){i=Number(i);if(w(j,"Minimize")||w(j,"Minimizing")){if((r3||r3===0)&&(p3||p3===0)){if(i<=parseFloat(r3)){t3.EnumMember="Positive";}else if(i>parseFloat(p3)){t3.EnumMember="Negative";}else{t3.EnumMember="Critical";}}}else if(w(j,"Maximize")||w(j,"Maximizing")){if((q3||q3===0)&&(k||k===0)){if(i>=parseFloat(q3)){t3.EnumMember="Positive";}else if(i<parseFloat(k)){t3.EnumMember="Negative";}else{t3.EnumMember="Critical";}}}else if(w(j,"Target")){if((r3||r3===0)&&(p3||p3===0)&&(q3||q3===0)&&(k||k===0)){if(i>=parseFloat(q3)&&i<=parseFloat(r3)){t3.EnumMember="Positive";}else if(i<parseFloat(k)||i>parseFloat(p3)){t3.EnumMember="Negative";}else{t3.EnumMember="Critical";}}}}return u(t3,s3);}function y(i,j,k,p3){if(typeof i=="string"){i=N.getIntegerInstance().parse(i);}if(!i||!j){return;}i=Number(i);if(!p3&&(i-j>=0)){return"Up";}if(!k&&(i-j<=0)){return"Down";}if(j&&p3&&(i-j>=p3)){return"Up";}if(j&&k&&(i-j<=k)){return"Down";}}function z(i,j){var k=i.getPath(0)+"-DataFields-Sorted";var p3=r(i,k);if(!p3){var q3=B(i,j);var r3=q3.map(function(s3){return s3.Value.$Path;});r3=r3.filter(function(s3){return!!s3;});p3=j.filter(function(s3){if(s3.$Type==="com.sap.vocabularies.UI.v1.DataField"&&r3.indexOf(s3.Value.$Path)===-1){return true;}return false;});p3=P(p3);t(i,k,p3);}return p3;}z.requiresIContext=true;function B(j,k,p3){var q3=j.getPath(0)+"-DataPoints-Sorted";var r3=r(j,q3);if(!r3){if(p3){r3=k.filter(G);}else{r3=k.filter(E);}r3=P(r3);var s3;for(var i=0;i<r3.length;i++){s3=j.getPath(0).substr(0,j.getPath(0).lastIndexOf("/")+1);r3[i]=j.getModel(0).getProperty(J(s3,r3[i]));s3="";}t(j,q3,r3);}return r3;}B.requiresIContext=true;function E(i){if(i.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&i.Target.$AnnotationPath.match(/@com.sap.vocabularies.UI.v1.DataPoint.*/)){return true;}return false;}function G(i){if((i.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&i.Target.$AnnotationPath.match(/@com.sap.vocabularies.UI.v1.DataPoint.*/))||(i.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&i.Target.$AnnotationPath.match(/@com.sap.vocabularies.Communication.v1.Contact.*/))){return true;}return false;}function H(i){if(!i||!i.Criticality||!i.Criticality.Path){return;}return"{path:'"+i.Criticality.Path+"'}";}function J(i,j){return i+j.Target.$AnnotationPath;}function K(i){var j,k;if(i["@com.sap.vocabularies.UI.v1.Importance"]){j=i["@com.sap.vocabularies.UI.v1.Importance"].$EnumMember;switch(j){case"com.sap.vocabularies.UI.v1.ImportanceType/High":k=1;break;case"com.sap.vocabularies.UI.v1.ImportanceType/Medium":k=2;break;case"com.sap.vocabularies.UI.v1.ImportanceType/Low":k=3;break;}}else{k=4;}return k;}function P(i){if(i.length<2){return i;}var j=parseInt(i.length/2,10);var k=i.slice(0,j);var p3=i.slice(j,i.length);return Q(P(k),P(p3));}function Q(i,j){var k=[];while(i.length&&j.length){var p3=K(i[0]),q3=K(j[0]);if(p3<=q3){k.push(i.shift());}else{k.push(j.shift());}}while(i.length){k.push(i.shift());}while(j.length){k.push(j.shift());}return k;}function R(i,j,k){var p3=z(i,j)[k];if(p3){return $(i,p3);}return"";}function U(i,j,k){var p3=z(i,j)[k];return q(i,p3);}function V(i,j,k){var p3=B(i,j)[k];if(p3&&p3.Title){return p3.Title.String;}return"";}function W(i,j,k){var p3=j.filter(E);p3=P(p3);if(!p3||!p3.length||!p3.length>0){return"";}return q(i,p3[0]);}function X(i,j,k,p3){var q3=B(i,j)[k];if(!q3){return"";}var r3=i.getSetting('ovpCardProperties');var s3=r3.getProperty("/entityType");var t3=r3.getProperty("/metaModel");return _(i,q3,s3,t3,p3);}function Y(i,j,k){var p3=B(i,j)[k];if(p3&&p3.Criticality){return true;}}function Z(i,j,k){var p3=B(i,j)[k];var q3=p3.Criticality.Path;return"{path:'"+q3+"'}";}function _(i,j,k,p3,q3){if(!j||!j.Value){return"";}var r3=i.getSetting('ovpCardProperties');var s3=false;if(r3){var t3=r3.getProperty("/ignoreSapText");s3=t3==undefined?s3:t3;}var u3=p3.getData()["$Annotations"][k.$Type+"/"+j.Value.$Path];var v3=false;if(s3==true){if(u3&&(u3["@com.sap.vocabularies.Analytics.v1.Measure"]||u3["sap:aggregation-role"]=="measure")){v3=true;}}if(!v3&&u3){var w3;if(u3["com.sap.vocabularies.Common.v1.Text"]){w3=u3["com.sap.vocabularies.Common.v1.Text"]?u3["com.sap.vocabularies.Common.v1.Text"]:u3["com.sap.vocabularies.Common.v1.Text"].$Path;}else if(u3["sap:text"]){w3=u3["sap:text"];}if(w3){j={Value:{$Path:w3}};}}return $(i,j,q3);}function $(i,j,k,p3){if(j.Value.Apply){return O.format(i,j.Value);}var q3=i.getSetting('ovpCardProperties');var r3=q3.getProperty("/entityType");var s3=q3.getProperty("/metaModel");return b1(i,j,r3,s3,k,p3);}$.requiresIContext=true;function a1(i,j,k,p3){if((!k)||(typeof p3!=='string')){return p3;}var q3=k["@"+A.TEXT];if(!q3){return p3;}var r3,s3;r3=k["@"+A.TEXT+"@"+A.TEXT_ARRANGEMENT];s3=r3&&r3.$EnumMember;if(!s3){r3=q3&&q3["@"+A.TEXT_ARRANGEMENT];s3=r3&&r3.$EnumMember;}if(!s3){r3=j&&j[A.TEXT_ARRANGEMENT];s3=r3&&r3.$EnumMember;}if(!s3){return p3;}var t3=O.format(q3,{context:i});if(!t3||t3===" "){return p3;}var u3;switch(s3){case T.TEXT_FIRST:u3=t3+" ("+p3+")";break;case T.TEXT_LAST:u3=p3+" ("+t3+")";break;case T.TEXT_ONLY:u3=t3;break;case T.TEXT_SEPARATE:u3=p3+" ("+t3+")";break;default:u3=p3;break;}return u3;}function b1(j,k,p3,q3,r3,s3,t3){if(k.Value.Apply){return O.format(j,k.Value);}var u3=k.Value.$Path?k.Value.$Path:k.Value.String;var v3=c1(q3,p3,k.Value.$Path),w3="",x3,y3;var z3=j.getSetting("ovpCardProperties");var A3=z3&&z3.getProperty("/contentFragment");if(!s3){if(k.Value.$Path&&k.Value.$Path.split("/").length>1){v3=h1(q3,p3,k.Value.$Path);}if(!v3){return"";}if(v3&&(v3.$Type==='Edm.DateTime'||v3.$Type==='Edm.DateTimeOffset')){var B3={'relative':true,'relativeScale':'auto'},C3=z3&&z3.getProperty("/showDateInRelativeFormat");if(C3!==undefined&&!C3){B3={'style':'medium'};}y3={dateFormat:B3,bUTC:v3.$Type==='Edm.DateTime'?true:false};x3="sap.ovp.cards.AnnotationHelper.formatDate";w3=d1([k.Value.$Path?k.Value.$Path:u3.split("/")[u3.split("/").length-1]],x3,y3);}else if((k.ValueFormat&&(k.ValueFormat.NumberOfFractionalDigits>=0))||v3["scale"]){var D3=(k.ValueFormat&&k.ValueFormat.NumberOfFractionalDigits)?k.ValueFormat.NumberOfFractionalDigits:0,E3;var F3=(k.ValueFormat&&k.ValueFormat.ScaleFactor&&k.ValueFormat.ScaleFactor.$Decimal);if(v3["@Org.OData.Measures.V1.ISOCurrency"]){E3=v3["@Org.OData.Measures.V1.ISOCurrency"].$Path?v3["@Org.OData.Measures.V1.ISOCurrency"].$Path:v3["@Org.OData.Measures.V1.ISOCurrency"];}else if(v3["@Org.OData.Measures.V1.Unit"]){E3=v3["@Org.OData.Measures.V1.Unit"].$Path?v3["@Org.OData.Measures.V1.Unit"].$Path:v3["@Org.OData.Measures.V1.Unit"];}else if(v3["@sap:unit"]){E3=v3["@sap:unit"];}var G3=E3?q3.getProperty("/"+p3.$Type)[E3]:null,H3=[k.Value.$Path?k.Value.$Path:u3.split("/")[u3.split("/").length-1]];if(D3>2){D3=2;}y3={numberOfFractionalDigits:D3,scaleFactor:F3};if(v3["@Org.OData.Measures.V1.ISOCurrency"]){var I3=v3["@Org.OData.Measures.V1.ISOCurrency"];if(I3.$Path){x3="sap.ovp.cards.v4.V4AnnotationHelper.formatCurrency";H3.push(I3.$Path);}else if(I3.String){y3.currencyString=I3.String;x3="sap.ovp.cards.v4.V4AnnotationHelper.formatCurrency";}}else if(G3&&(G3["Org.OData.Measures.V1.ISOCurrency"]||G3["sap:semantics"]==="currency-code")){x3="sap.ovp.cards.v4.V4AnnotationHelper.formatCurrency";H3.push(E3);}else{x3="sap.ovp.cards.v4.V4AnnotationHelper.formatNumberCalculation";}w3=d1(H3,x3,y3);}else{if(t3){w3=O.format(k.Value,{context:j});}else{var J3=O.format(k.Value,j.getModel()?{context:j}:{context:j.getInterface(0)});var K3=J3.split(",");var L3=[];if(K3.length>1){for(var i=0;i<K3.length;i++){if(K3[i].indexOf("path:")>=0||K3[i].indexOf("type:")>=0){L3.push(K3[i]);}}if(L3.length>0){w3=w3+L3.join(',');if(w3.substring(w3.length-1)!=="}"){w3=w3+"}";}}}else{w3=J3;}}}if(A3){w3=a1(j,p3,v3,w3);}if(v3&&v3["@Org.OData.Measures.V1.Unit"]){var M3=v3["@Org.OData.Measures.V1.Unit"];if(M3.Path){w3+=(" "+d1([M3.Path]));}else if(M3.String){if(M3.String!=="%"){w3+=" ";}w3+=M3.String;}}}if(!r3){if(v3["@Org.OData.Measures.V1.ISOCurrency"]){var I3=v3["@Org.OData.Measures.V1.ISOCurrency"];if(I3.$Path){w3+=(" "+d1([I3.$Path]));}else if(I3){w3+=(" "+I3);}}}if(w3[0]===" "){w3=w3.substring(1);}w3=w3.replace("\\","");w3=w3.replace("\\","");w3=w3.replace("Unsupported: ","");w3=w3.replace("$P","p");return w3;}function c1(i,j,k){var p3=i.getData().$Annotations[j.$Type+"/"+k];var q3=i.getObject("/"+j.$Type.split(".")[1]+"/"+k);var r3=l.merge(true,{},p3,q3);return r3;}function d1(j,k,p3){var q3="",r3=j.length;if(r3>1||p3){q3="{parts:[";for(var i=0;i<r3;i++){q3+=("{path: '"+j[i]+"'}"+(((i===r3-1)&&!p3)?"]":", "));}if(p3){var s3="{value:"+JSON.stringify(p3)+", model: 'ovpCardProperties'}";q3+=s3+"]";}}else{q3="{path: '"+j[0]+"'";}q3+=(k?(", formatter: '"+k+"'"):"")+"}";return q3;}function e1(){var i=arguments[arguments.length-1],j=arguments[0];var k=N.getFloatInstance({style:'short',showMeasure:false,shortRefNumber:i.scaleFactor,minFractionDigits:i.numberOfFractionalDigits,maxFractionDigits:i.numberOfFractionalDigits});if(typeof j=="string"){j=N.getIntegerInstance().parse(j);}return k.format(Number(j));}function f1(){var i=arguments[arguments.length-1],j=arguments[0];var k=D.getInstance(i.dateFormat);if(!j){j="";return j;}return k.format(new Date(j),i.bUTC);}function g1(){var i=arguments[arguments.length-1],j=arguments[0],k=arguments[1];var p3="";var q3=N.getCurrencyInstance({style:'short',showMeasure:false,shortRefNumber:i.scaleFactor,minFractionDigits:i.numberOfFractionalDigits,maxFractionDigits:i.numberOfFractionalDigits});if(typeof j=="string"){j=N.getIntegerInstance().parse(j);}if(k){p3=q3.format(j,k);}else{p3=i.currencyString?q3.format(j,i.currencyString):q3.format(j);}return p3;}function h1(j,k,p3){var q3=p3.split("/");if(q3.length>1){for(var i=0;i<(q3.length-1);i++){k=j.getProperty("/"+k.$Type)[q3[i]];}return c1(j,k,q3[q3.length-1]);}}function i1(i,j,k){var p3=B(i,j);var q3=n.StateValues;var r3=p3[k];if(!r3){return q3.None;}if(r3.Criticality){return m1(i,r3,q3);}return o1(i,r3,q3);}function j1(i,j,k){var p3=B(i,j);if(p3&&p3.length){var q3=p3[0];if(q3&&(q3.Criticality||q3.CriticalityCalculation)){return true;}}return false;}function k1(i,j,k){if(j1(i,j,k)){return'';}return'#5cbae6';}k1.requiresIContext=true;function l1(i,j,k){var p3=B(i,j),q3=n.ColorValues;var r3=q3.None;if(p3.length>k){var s3=p3[k];if(s3&&s3.Criticality){r3=m1(i,s3,q3);}else{r3=o1(i,s3,q3);}}return r3;}function m1(i,j,k){var p3=k.None;var q3;var r3=j.Criticality;if(r3){q3="'{'= ({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Negative'') || ({0} === ''1'') || ({0} === 1) ? ''"+k.Negative+"'' : "+"({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Critical'') || ({0} === ''2'') || ({0} === 2) ? ''"+k.Critical+"'' : "+"({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Positive'') || ({0} === ''3'') || ({0} === 3) ? ''"+k.Positive+"'' : "+"''"+k.None+"'' '}'";if(r3.$Path){var s3='$'+O.format(r3,{context:i});p3=f(q3,s3);}else if(r3.$EnumMember){var t3="'"+r3.$EnumMember+"'";p3=f(q3,t3);}else{L.warning("Case not supported, returning the default Neutral state");}}else{L.warning("Case not supported, returning the default Neutral state");}return p3;}function n1(i,j,k){var p3=B(i,j);var q3="None";if(p3.length>k){var r3=p3[k];if(r3&&r3.Criticality&&r3.Criticality.Path){q3=Z(i,j,k);}else{q3=o1(i,r3,n.StateValues);q3=v(q3);}}return q3;}function o1(i,j,k){var p3=k.None;if(j.Criticality){p3=u(j.Criticality,k);}else if(j.CriticalityCalculation&&j.Value&&j.Value&&j.Value.$Path){p3=p1(i,j,k);}return p3;}function p1(i,j,k){var p3=H1(j.Value);var q3=j.CriticalityCalculation.ImprovementDirection.$EnumMember;var r3=H1(j.CriticalityCalculation.DeviationRangeLowValue);var s3=H1(j.CriticalityCalculation.DeviationRangeHighValue);var t3=H1(j.CriticalityCalculation.ToleranceRangeLowValue);var u3=H1(j.CriticalityCalculation.ToleranceRangeHighValue);var v3=r1(r3);var w3=r1(s3);var x3=r1(t3);var y3=r1(u3);var z3={"deviationLow":r3,"deviationHigh":s3,"toleranceLow":t3,"toleranceHigh":u3,"bIsDeviationLowBinding":v3,"bIsDeviationHighBinding":w3,"bIsToleranceLowBinding":x3,"bIsToleranceHighBinding":y3,"sImprovementDirection":q3,"oCriticalityConfigValues":k};var A3="{value:"+JSON.stringify(z3)+", model: 'ovpCardProperties'}";var B3="parts: ["+p3;B3+=v3?","+r3:"";B3+=w3?","+s3:"";B3+=x3?","+t3:"";B3+=y3?","+u3:"";B3+=","+A3;B3+="]";var C3="sap.ovp.cards.v4.V4AnnotationHelper.formatColor";return"{"+B3+", formatter: '"+C3+"'}";}function q1(){var i=arguments[arguments.length-1];var j=1;return x(arguments[0],i.sImprovementDirection,i.bIsDeviationLowBinding?arguments[j++]:i.deviationLow,i.bIsDeviationHighBinding?arguments[j++]:i.deviationHigh,i.bIsToleranceLowBinding?arguments[j++]:i.toleranceLow,i.bIsToleranceHighBinding?arguments[j++]:i.toleranceHigh,i.oCriticalityConfigValues);}function r1(i){return(typeof i==="string")&&i.charAt(0)==="{";}function s1(i,j,k){var p3="";var q3=k.split("/");if(q3.length>1){q3.pop();p3=q3.join("/");}return p3;}function t1(i){var j;if(i&&typeof i.getData==='function'){var k=i.getData();if(k.tabs){var p3=0;var q3=k.selectedKey;if(q3&&k.tabs.length>=q3){p3=q3-1;}j=k.tabs[p3].mFilterPreference;}else{j=k.mFilterPreference;}}return!!j;}function u1(j,k){var p3=j.getSetting('ovpCardProperties');var q3=p3.getProperty("/addODataSelect");var r3=p3.getProperty("/metaModel");var s3=r3.getData();var t3=k;var u3,v3,w3,x3;if(p3.getProperty('/selectionAnnotationPath')){u3="@"+p3.getProperty('/selectionAnnotationPath');v3=s3["$Annotations"][t3.$Type][u3];}if(p3.getProperty('/presentationAnnotationPath')){w3=p3.getProperty('/presentationAnnotationPath');w3="@"+w3;x3=s3["$Annotations"][t3.$Type][w3];}var y3="/"+p3.getProperty("/entitySet");var z3=Array.prototype.slice.call(arguments,2);var A3=j.getSetting('ovpCardProperties'),B3=A3.getProperty('/parameters');if(v3||!!B3){if((v3&&v3.Parameters&&v3.Parameters.length>0)||!!B3){y3=E2(j.getSetting('dataModel'),k,v3,B3);}}if(p3.getProperty("/cardLayout")&&p3.getProperty("/cardLayout/noOfItems")){var C3="{path: '"+y3+"', length: "+ +(p3.getProperty("/cardLayout/noOfItems"));}else{var C3="{path: '"+y3+"', length: "+I1(p3);}var D3=[];if(q3){D3=w1(j,r3,t3,z3);var E3=p3.getProperty("/template");if(E3!="sap.ovp.cards.charts.analytical"&&E3!="sap.ovp.cards.charts.smart.chart"){var F3=z1(x3);for(var i=0;i<F3.length;i++){if(D3.indexOf(F3[i])===-1){D3.push(F3[i]);}}}}var G3=v1(r3,t3.$Type,z3);var H3=t1(p3);if(H3||D3.length>0||G3.length>0){C3=C3+", parameters: {";}if(D3.length>0||G3.length>0){if(D3.length>0){C3=C3+"select: '"+D3.join(',')+"'";}if(G3.length>0){if(D3.length>0){C3=C3+", ";}C3=C3+"$expand: '"+G3.join(',')+"'";}if(H3){C3=C3+", ";}}if(H3){C3=C3+"custom: {cardId: '"+p3.getProperty("/cardId")+"'}";}if(H3||D3.length>0||G3.length>0){C3=C3+", $count: true}";}else{C3=C3+", parameters: {$count:true}";}var I3=y1(p3,x3);if(I3.length>0){C3=C3+", sorter:"+JSON.stringify(I3);}var J3=D1(p3,v3);if(J3.length>0){C3=C3+", filters:"+JSON.stringify(J3);}C3=C3+"}";return C3;}u1.requiresIContext=true;function v1(k,p3,q3){var r3=[];var s3,t3;for(var i=0;i<q3.length;i++){if(!q3[i]){continue;}s3=k.getData()["$Annotations"][p3]["@"+q3[i]];s3=s3?s3:[];for(var j=0;j<s3.length;j++){if(s3[j].Value&&s3[j].Value.$Path){t3=s1(k,p3,s3[j].Value.$Path);if(t3&&r3.indexOf(t3)===-1){r3.push(t3);}}}}return r3;}function w1(p3,q3,r3,s3){var t3=[];var u3,v3,w3;for(var i=0;i<s3.length;i++){if(!s3[i]){continue;}u3=r3.$Type.split(".")[1]+"/@"+s3[i];v3=p3.getModel(0);var x3={};if(p3&&p3.bDummyContext){m(x3,p3,v3,true);}else{x3=p3;}w3=v3.getObject("/"+u3);if(!w3){w3=[];}else if(c(w3)){if(w3.Data){w3=w3.Data;}else{w3=[];}}var y3;var z3;var A3;var B3;for(var j=0;j<w3.length;j++){z3=[];y3=w3[j];A3="";B3=y3.$Type;if(B3==="com.sap.vocabularies.UI.v1.DataField"){A3=b1(x3.getInterface(0),y3,r3,q3,undefined,undefined,true);}else if(B3==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){var C3=J(r3.$path,y3);A3=_(x3,q3.getProperty(C3),r3,q3);var D3=H(q3.getProperty(C3));if(D3&&D3.length>0){A3+=D3;}}else if(B3==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"&&y3.Url){var E3;if(!y3.Url.UrlRef){E3=O.format(x3,y3.Url);}if(E3&&E3.substring(0,2)==="{="){A3=E3;}}if(A3){var F3=O.format(y3.Value,{context:x3.getInterface(0)});if(A3.indexOf("(")<0&&A3!==F3){A3=[].concat(F3,A3).join(" ");}z3=x1(A3);}if(z3&&z3.length>0){var G3;for(var k=0;k<z3.length;k++){G3=z3[k];if(!t3[G3]){t3[G3]=true;var H3={};H3[G3]=c1(q3,r3,G3);var I3=M2(G3,H3);if(I3&&I3!==G3){t3[I3]=true;}var J3=f3(q3,r3,G3);if(J3&&J3!==G3){t3[J3]=true;}}}}}}return Object.keys(t3);}function x1(j){var i,k=0,p3=j.length,q3="",r3;for(i=0;i<p3;i++){r3=j.charAt(i);if(!r3){return;}switch(r3){case"{":k++;break;case"}":k--;break;default:if(k<=0){continue;}break;}q3+=r3;}j=q3;var s3=/\${([a-zA-Z0-9\_|\/]*)/g;var t3=/[^[{]*[a-zA-Z0-9\_]/g;var u3=/path *\: *\'([a-zA-Z0-9\_]+)*\'/g;var v3,w3,x3=[];if(j.indexOf("{parts:[")!==-1){j=j.replace("{parts:[","");}if(j.substring(0,2)==="{="){v3=s3;w3=1;}else if(j.indexOf("path")!==-1){var y3=t3.exec(j);while(y3){if(y3[0].indexOf("path")===-1&&y3[0].indexOf("@i18n")!==0&&y3[0].indexOf("model: 'ovpCardProperties'")<-1){x3.push(y3[0]);}y3=t3.exec(j);}v3=u3;w3=1;}else{v3=t3;w3=0;}var z3=v3.exec(j);while(z3){if(z3[w3]&&z3[w3].indexOf("@i18n")!==0){x3.push(z3[w3]);}z3=v3.exec(j);}return x3;}function y1(j,k){var p3=[];var q3,r3;var s3=j.getProperty("/sortBy");if(s3){var t3=j.getProperty('/sortOrder');if(t3&&t3.toLowerCase()!=='descending'){r3=false;}else{r3=true;}q3={path:s3,descending:r3};p3.push(q3);}var u3=k&&k.SortOrder||undefined;var v3,s3;if(u3){for(var i=0;i<u3.length;i++){v3=u3[i];s3=v3.Property.$PropertyPath;r3=E1(v3.Descending,true);q3={path:s3,descending:r3};p3.push(q3);}}return p3;}function z1(j){var k=[];var p3=j&&j.RequestAtLeast||undefined;if(p3){for(var i=0;i<p3.length;i++){if(p3[i].PropertyPath){k.push(p3[i].PropertyPath);}}}return k;}function A1(i){var j=i.getProperty('/entityType');var k=j[i.getProperty('/selectionAnnotationPath')];return{filters:D1(i,k),parameters:C1(k)};}function B1(j){if(!j){return;}var k=j.getProperty('/entityType');var p3=k[j.getProperty('/presentationAnnotationPath')];var q3=y1(j,p3);var r3=[];var i,s3=q3.length;for(i=0;i<s3;i++){if(!q3[i].path){continue;}r3.push({Property:q3[i].path,Descending:q3[i].descending});}if(r3.length>0){return{SortOrder:r3};}}function C1(j){var k,p3=[];if(!j||!j.Parameters){return p3;}var q3=j.Parameters.length;for(var i=0;i<q3;i++){k=j.Parameters[i];if(!k.PropertyName||!k.PropertyName.PropertyPath){continue;}if(!k.PropertyValue){L.error("Missing value for parameter "+k.PropertyName.PropertyPath);continue;}p3[p3.length]={path:k.PropertyName.PropertyPath,value:G1(k.PropertyValue)};}return p3;}function D1(k,p3){var q3=[];var r3;var s3=k.getProperty("/filters");if(s3){q3=q3.concat(s3);}if(p3&&p3.SelectOptions){r3=p3.SelectOptions;}else{r3=p3;}var t3,u3,v3;if(r3){for(var i=0;i<r3.length;i++){t3=r3[i];u3=t3.PropertyName.$PropertyPath;for(var j=0;j<t3.Ranges.length;j++){v3=t3.Ranges[j];if(v3.Sign.$EnumMember){var w3={path:u3,operator:v3.Option.$EnumMember.split("/")[1],value1:G1(v3.Low),value2:G1(v3.High),sign:v3.Sign.$EnumMember==="com.sap.vocabularies.UI.v1.SelectionRangeSignType/I"?"I":"E"};if(w3.sign==="E"&&w3.operator!==F.EQ){L.error("Exclude sign is supported only with EQ operator");continue;}if(w3.sign==="E"&&w3.operator===F.EQ){w3.operator=F.NE;w3.sign="I";}if(w3.operator==="CP"&&w3.sign==="I"){var x3=F.Contains;var y3=w3.value1;if(y3){var z3=y3.indexOf('*');var A3=y3.lastIndexOf('*');if(z3>-1){if((z3===0)&&(A3!==(y3.length-1))){x3=F.EndsWith;y3=y3.substring(1,y3.length);}else if((z3!==0)&&(A3===(y3.length-1))){x3=F.StartsWith;y3=y3.substring(0,y3.length-1);}else{y3=y3.substring(1,y3.length-1);}}}w3.operator=x3;w3.value1=y3;}q3.push(w3);}}}}return q3;}function E1(i,j){if(i&&i.Boolean){if(i.Boolean.toLowerCase()==="true"){return true;}else if(i.Boolean.toLowerCase()==="false"){return false;}}else if(i&&i.Bool){if(i.Bool.toLowerCase()==="true"){return true;}else if(i.Bool.toLowerCase()==="false"){return false;}}return j;}function F1(i){var j;if(i){if(i.String){j=Number(i.String);}else if(i.Int){j=Number(i.Int);}else if(i.$Decimal){j=Number(i.$Decimal);}else if(i.Double){j=Number(i.Double);}else if(i.Single){j=Number(i.Single);}else if(typeof i==="number"){return i;}}return j;}function G1(i){var j;if(i){if(i.String||i.String===""){j=i.String;}else if(typeof(i)=="string"){j=i;}else if(i.Boolean||i.Bool){j=E1(i);}else if(i.DateTime){j=i.DateTime;}else if(i.DateTimeOffset){j=i.DateTimeOffset;}else{j=F1(i);}}return j;}function H1(i){if(i){if(i.$Path){return"{path:'"+i.$Path+"'}";}else{return G1(i);}}else{return"";}}function I1(i){var j=i.getProperty('/contentFragment');var k=i.getProperty('/listType');var p3=i.getProperty('/listFlavor');var q3;var r3="desktop";if(a.system.phone){r3="phone";}else if(a.system.tablet){r3="tablet";}if(j=="sap.ovp.cards.list.List"){if(k=="extended"){if(p3=="bar"){q3=I["List_extended_bar"];}else{q3=I["List_extended"];}}else if(p3=="bar"){q3=I["List_condensed_bar"];}else{q3=I["List_condensed"];}}else if(j=="sap.ovp.cards.table.Table"){q3=I["Table"];}else if(j=="sap.ovp.cards.stack.Stack"){if(i.getProperty('/objectStreamCardsNavigationProperty')){q3=I["Stack_complex"];}else{q3=I["Stack_simple"];}}if(q3){return q3[r3];}return 5;}function J1(i){var j=i.getObject();var k=B(i,j,true);var p3=k.map(function(q3){if(q3&&q3.Value&&q3.Value.$Path){return q3.Value.$Path;}else if(q3&&q3.fn&&q3.fn.$Path){return q3.fn.$Path;}});j.filter(function(q3,r3){if(q3.$Type==="com.sap.vocabularies.UI.v1.DataField"&&p3.indexOf(q3.Value.$Path)>-1){j.splice(r3,1);}});return i.sPath;}J1.requiresIContext=true;function K1(i,j){if(j.charAt(0)==='/'||j.indexOf("http")===0){return j;}var k=i.getModel(0).getProperty("/baseUrl");if(k){return k+"/"+j;}return j;}K1.requiresIContext=true;function L1(i,j){var k=B(i,j);return k.length;}L1.requiresIContext=true;function M1(i,j){return O1(i,j,0);}M1.requiresIContext=true;function N1(i,j){return O1(i,j,1);}N1.requiresIContext=true;function O1(i,j,k){var p3=B(i,j),q3=p3[k];if(q3&&q3.Value&&q3.Value.$Path){return q3.Value.$Path;}return"";}function P1(i,j){return U(i,j,0);}P1.requiresIContext=true;function Q1(i,j){return U(i,j,1);}Q1.requiresIContext=true;function R1(i,j){return U(i,j,2);}R1.requiresIContext=true;function S1(i,j){return U(i,j,3);}S1.requiresIContext=true;function T1(i,j){return U(i,j,4);}T1.requiresIContext=true;function U1(i,j,k){return R(i,j,k);}U1.requiresIContext=true;function V1(i,j,k){return X(i,j,k);}V1.requiresIContext=true;function W1(i,j,k,p3){var q3=L1(i,j);if(q3>0){return V1(i,j,k);}else{return U1(i,j,p3);}}W1.requiresIContext=true;function X1(i,j,k){return q2(i,j,k);}X1.requiresIContext=true;function Y1(i,j){return V(i,j,0);}Y1.requiresIContext=true;function Z1(i,j){return V(i,j,1);}Z1.requiresIContext=true;function $1(i,j){return V(i,j,2);}$1.requiresIContext=true;function _1(i,j){return W(i,j,0);}_1.requiresIContext=true;function a2(j,k){for(var i=0;i<k.length;i++){var p3=k[i];if(p3.$Type==="com.sap.vocabularies.UI.v1.DataField"){if(p3.IconUrl&&p3.IconUrl.String){return p3.IconUrl.String;}if(p3.IconUrl&&p3.IconUrl.$Path){return O.format(p3.IconUrl,{context:j});}}}}a2.requiresIContext=true;function b2(i,j,k){var p3="";var q3;if(Array.isArray(j)){q3=B(i,j)[k];}else{var r3=Object.assign({},j);var s3=Object.assign({},i);q3=o2(s3,r3);}if(!q3||!q3.Value){return p3;}var t3=i.getSetting('ovpCardProperties');var u3=t3&&t3.getProperty("/entityType");var v3=t3&&t3.getProperty("/metaModel");var w3=v3&&v3.getData()["$Annotations"][u3.$Type+"/"+q3.Value.$Path];var x3=w3&&w3["@Org.OData.Measures.V1.ISOCurrency"];if(x3&&x3.$Path){p3+=(" "+d1([x3.$Path]));}else if(x3){p3+=(" "+x3);}return p3;}b2.requiresIContext=true;function c2(i,j,k,p3){return X(i,j,k,p3);}c2.requiresIContext=true;function d2(i,j){return i1(i,j,0);}d2.requiresIContext=true;function e2(i,j){return l1(i,j,0);}e2.requiresIContext=true;function f2(i,j){return i1(i,j,1);}f2.requiresIContext=true;function g2(i,j){return i1(i,j,2);}g2.requiresIContext=true;function h2(i,j){return n1(i,j,0);}h2.requiresIContext=true;function i2(i){var j={};j.EnumMember="None";if(Number(i)===1){j.EnumMember="Negative";}else if(Number(i)===2){j.EnumMember="Critical";}else if(Number(i)===3){j.EnumMember="Positive";}return u(j,n.ColorValues);}function j2(i,j){if(j&&j.Criticality&&j.Criticality.$Path){return"{parts: [{path:'"+j.Criticality.$Path+"'}], formatter: 'sap.ovp.cards.v4.V4AnnotationHelper.kpiValueCriticality'}";}else{return o1(i,j,n.ColorValues);}}j2.requiresIContext=true;function k2(i,j){return Y(i,j,0);}k2.requiresIContext=true;function l2(i,j){var k=B(i,j)[0];if(k&&(k.Criticality||k.CriticalityCalculation)){return true;}return false;}l2.requiresIContext=true;function m2(i,j){return Y(i,j,1);}m2.requiresIContext=true;function n2(i,j){return Y(i,j,2);}n2.requiresIContext=true;function o2(i,j){var k=i.getPath(0);var p3=k.slice(0,k.lastIndexOf("/"));p3=p3.slice(0,p3.lastIndexOf("/"));var q3=J(p3,j);j=i.getModel(0).getProperty(q3);return j;}function p2(i,j){if(!j){return"";}return $(i,j);}p2.requiresIContext=true;function q2(i,j,k,p3){var q3;var r3=p3==undefined?k:z(i,k)[p3];var s3=i.getSetting('ovpCardProperties');var t3=s3.getProperty("/metaModel");var u3=j.$Type;var v3=t3.getData()["$Annotations"][u3+"/"+r3.Value.$Path];if(v3){q3=v3["@com.sap.vocabularies.Common.v1.SemanticObject"];if(q3){return O.format(q3,i.getModel()?{context:i}:{context:i.getInterface(0)});}else{return"";}}}function r2(i,j,k){var p3=k===undefined?j.Value.$Path:j[k].Value.$Path;var q3=(p3.indexOf("/")!=-1)?p3.split('/')[0]:"";return q3;}r2.requiresIContext=true;function s2(i,j){var k=i.getSetting('ovpCardProperties');var p3=k.getProperty("/metaModel");var q3=p3.getData()["$Annotations"][j.$Type];if(q3["@com.sap.vocabularies.Communication.v1.Contact"]){return true;}return false;}s2.requiresIContext=true;function t2(i,j,k){if(!j){return"";}var p3=i.getSetting('ovpCardProperties');var q3=p3.getProperty("/entityType");var r3=p3.getProperty("/metaModel");var s3=Object.assign({},j);var t3=Object.assign({},i);j=o2(t3,s3);return _(i,j,q3,r3,k);}t2.requiresIContext=true;function u2(i,j){var k=Object.assign({},j);var p3=Object.assign({},i);var q3="None",r3=n.StateValues;j=o2(p3,k);if(j&&j.Criticality){q3=m1(i,j,r3);}else{q3=o1(i,j,r3);}return q3;}u2.requiresIContext=true;function v2(i,j){var k=Object.assign({},j);var p3=Object.assign({},i);j=o2(p3,k);if(j&&j.Criticality){return true;}}v2.requiresIContext=true;function w2(i,j){var k=Object.assign({},j);var p3=Object.assign({},i);var q3=i.getSetting('ovpCardProperties');var r3=q3.getProperty("/entityType");var s3=q3.getProperty("/metaModel");j=o2(p3,k);if(!j){return;}var t3=s3.getProperty("/"+r3.$Type)[j.Value.$Path];if(j&&t3&&t3.$Type=="Edm.String"&&(j.Criticality||j.CriticalityCalculation)){return'Center';}if(t3&&((t3.$Type=="Edm.DateTime")||(t3.$Type=="Edm.DateTimeOffset"))){return'Right';}}w2.requiresIContext=true;function x2(i,j){var k=Object.assign({},j);var p3=Object.assign({},i);j=o2(p3,k);var q3="None";if(j&&j.Criticality&&j.Criticality.Path){q3="{path:'"+j.Criticality.Path+"'}";}else{q3=o1(i,j,n.StateValues);q3=v(q3);}return q3;}x2.requiresIContext=true;function y2(j,k){var p3;for(var i=0;i<k.length;i++){p3=k[i];if(p3.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"||p3.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"||p3.RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"){return 1;}}return 0;}y2.requiresIContext=true;function z2(i,j){var k=B(i,j)[0];if(k&&k.Value&&k.Value.$Path){var p3=i.getPath(0).substr(0,i.getPath(0).lastIndexOf("/")+1);var q3=i.getModel(0);var r3=q3.getData(k.Value.$Path);var s3=p3.substr(1,p3.length-2);if(r3&&r3[s3][k.Value.$Path]["Org.OData.Measures.V1.Unit"]){return r3["Org.OData.Measures.V1.Unit"].String==="%";}}return false;}z2.requiresIContext=true;function A2(i){var j=i.getObject();var k=i.getModel();var p3=k.getProperty("/metaModel");var q3="/"+k.getProperty("/entitySet");var r3=p3.getObject(q3);j="/"+r3.$Type+"/@"+j;return p3.createBindingContext(j);}function B2(i,j){if(i==='Edm.String'){var k=j.PropertyValue.String;return k;}return j.PropertyValue.String;}function C2(i,j,k,p3){var q3="";var r3=[];if(p3&&p3.Parameters){i.parameters.forEach(function(t3){p3.Parameters.forEach(function(u3){var v3=u3.PropertyName.PropertyPath.split("/");v3=v3[v3.length-1];if(v3===t3){var w3=B2(i['parameterType'][t3],u3);w3=d(j.formatValue(w3,i['parameterType'][t3]));r3.push(v3+'='+w3);}});});}else{q3="/"+k.name;L.error("SelectionParameters","There are no parameters to resolve");return q3;}try{q3='/'+i.entitySetName+'('+r3.join(',')+')/'+i.navPropertyName;}catch(s3){q3="/"+k.name;L.error("getEntitySetPathWithParameters","binding path with parameters failed - "+s3||s3.message);}return q3;}function D2(j,k,p3,q3,r3){var s3="";var t3=new o.Model(o.Model.ReferenceByModel(j));var u3=t3.findQueryResultByName(k.name);var v3=new o.QueryResultRequest(u3);var w3=u3.getParameterization();if(!w3){s3="/"+k.name;return s3;}if(r3){var x3=r3.getAnalyticalParameters();}if(w3){var y3;v3.setParameterizationRequest(new o.ParameterizationRequest(w3));if(p3&&p3.Parameters){e(p3.Parameters,function(){if(this.RecordType==="com.sap.vocabularies.UI.v1.IntervalParameter"){y3=this.PropertyNameFrom.PropertyPath.split("/");v3.getParameterizationRequest().setParameterValue(y3[y3.length-1],this.PropertyValueFrom.String,this.PropertyValueTo.String);}else{y3=this.PropertyName.PropertyPath.split("/");v3.getParameterizationRequest().setParameterValue(y3[y3.length-1],this.PropertyValue.String);}});}else if(q3){e(q3,function(){v3.getParameterizationRequest().setParameterValue(this.path,this.value);});}else if(x3&&x3.length>0){var z3=r3&&r3.getUiState({allFilters:false});var A3=z3?JSON.stringify(z3.getSelectionVariant()):"{}";var p3=new S(A3);for(var B3 in w3.getAllParameters()){for(var i=0;i<x3.length;i++){if(x3[i]&&(x3[i].name==B3)){var C3=x3[i].name;var D3=p3.getParameter(C3);if(!D3){var E3=p3.getSelectOption(C3);D3=E3&&E3[0]&&E3[0].Low;}v3.getParameterizationRequest().setParameterValue(B3,D3);}}}}else{s3="/"+k.name;L.error("SelectionParameters","There are no parameters to resolve");return s3;}}try{s3=v3.getURIToQueryResultEntitySet();}catch(F3){u3=v3.getQueryResult();s3="/"+u3.getEntitySet().getQName();L.error("getEntitySetPathWithParameters","binding path with parameters failed - "+F3||F3.message);}return s3;}function E2(i,j,k,p3,q3){var r3="";if(M.checkAnalyticalParameterisedEntitySet(i,j.name)){r3=D2(i,j,k,p3,q3);}else{var s3=M.getParametersByEntitySet(i,j.name);var t3=M.getPropertyOfEntitySet(i,j.name);var u3={};if(s3){s3['parameters'].forEach(function(v3){t3.forEach(function(w3){if(w3['name']==v3){u3[v3]=w3['type'];}});});s3['parameterType']=u3;r3=C2(s3,i,j,k);}else{r3="/"+j.name;}}return r3;}function F2(j,k,ns){var p3=j.getServiceMetadata().dataServices.schema[0].association;for(var i=0;i<p3.length;i++){if(ns+"."+p3[i].name===k){return p3[i];}}}function G2(i,j){var k=i.filter(function(q3){if(q3.$Type==="com.sap.vocabularies.UI.v1.DataField"){return true;}return false;});var p3=P(k);if(p3){return p3[j];}return;}function H2(i,j,k){if(!k||!k.length||k.length===0){return false;}k=G2(k,0);return q2(i,j,k);}H2.requiresIContext=true;function I2(i,j,k){if(!k||!k.length||k.length===0){return false;}k=G2(k,1);return q2(i,j,k);}I2.requiresIContext=true;function J2(i,j){var k=i.filter(function(q3){if(q3.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&q3.Target.$AnnotationPath.indexOf("@com.sap.vocabularies.Communication.v1.Contact")!==-1){return true;}return false;});var p3=P(k);if(p3){return p3[j];}return;}function K2(i){if(!i||!i.length||i.length===0){return false;}var j=J2(i,0);if(j){return true;}return false;}function L2(i,j,k,p3){var q3,r3,s3;if(k&&k.Value&&k.Value.$Path){q3=k.Value.$Path;}else if(k&&k.Description&&k.Description.Value&&k.Description.Value.$Path){q3=k.Description.Value.$Path;}if(k&&k.Description&&k.Description.$Path){r3=k.Description.$Path;}else if(k&&k.Title&&k.Title.$Path){s3=k.Title.$Path;}var t3="";var u3=p3&&p3.Parameters;var v3="";var w3=i.getSetting('ovpCardProperties'),x3=w3.getProperty('/parameters');u3=u3||!!x3;if(u3){var y3=i.getSetting("dataModel");var z3=E2(y3,j,p3,x3);t3+="{path: '"+z3+"'";}else{t3+="{path: '/"+j.$Type.split(".")[1]+"'";}t3+=", length: 1";var A3=i.getSetting('ovpCardProperties');var B3=A3.getProperty("/entityType");var C3=i.getModel(0);var D3=C3.getObject("/"+j.$Type.split(".")[1]+"/");var E3,F3;for(E3 in D3){if(E3.startsWith("$")){continue;}F3=B3.$Type.concat("/",E3);D3[E3].annotations=C3.getData(E3).$Annotations[F3];}var G3=M2(q3,D3);var H3=D1(A3,p3);if(H3.length>0){v3+=", filters: "+JSON.stringify(H3);}var I3=[];I3.push(q3);if(r3){I3.push(r3);}else if(s3){I3.push(s3);}if(k&&k.Criticality&&k.Criticality.$Path){I3.push(k.Criticality.$Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.DeviationRangeLowValue){I3.push(k.CriticalityCalculation.DeviationRangeLowValue);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.ToleranceRangeLowValue){I3.push(k.CriticalityCalculation.ToleranceRangeLowValue);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.DeviationRangeHighValue){I3.push(k.CriticalityCalculation.DeviationRangeHighValue);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.ToleranceRangeHighValue){I3.push(k.CriticalityCalculation.ToleranceRangeHighValue);}if(G3){I3.push(G3);}if(k&&k.TrendCalculation&&k.TrendCalculation.ReferenceValue){I3.push(k.TrendCalculation.ReferenceValue);}var J3=t1(w3);var K3=J3?", custom: {cardId: '"+w3.getProperty("/cardId")+"'}":"";return t3+", parameters:{select:'"+I3.join(",")+"'"+K3+"}"+v3+"}";}L2.requiresIContext=true;function M2(i,j,k){var p3;var q3,r3,s3;for(s3 in j){if(s3!==i){continue;}if(j[s3].annotations&&j[s3].annotations.hasOwnProperty("@Org.OData.Measures.V1.ISOCurrency")){q3=j[s3].annotations["@Org.OData.Measures.V1.ISOCurrency"].$Path;r3=j[s3].annotations["@Org.OData.Measures.V1.ISOCurrency"].$String;if(q3){return q3;}else{return(k?r3:"");}}if(j[s3].annotations&&j[s3].annotations.hasOwnProperty("@Org.OData.Measures.V1.Unit")){q3=j[s3].annotations.hasOwnProperty("@Org.OData.Measures.V1.Unit").$Path;r3=j[s3].annotations["@Org.OData.Measures.V1.Unit"].$String;if(q3){p3=q3;}else{p3=k?r3:"";}if(p3&&p3!="%"){return p3;}else{return null;}}if(j[s3].annotations&&j[s3].annotations.hasOwnProperty("sap:unit")){return j[s3].annotations["sap:unit"];}break;}return null;}function N2(i){if(!i||!i.Value||!i.Value.$Path){return"";}var j=this.getModel('ovpCardProperties');var k=j.getProperty("/entityType");var p3=j.getProperty("/metaModel");var q3=c1(p3,k,i.Value.$Path);if(q3["Org.OData.Measures.V1.Unit"]){var r3=q3["Org.OData.Measures.V1.Unit"];if(r3.String=="%"){this.getModel("ovpCardProperties").oData.percentageAvailable=true;}}if(i&&i.ValueFormat&&i.ValueFormat.NumberOfFractionalDigits){this.getModel("ovpCardProperties").oData.NumberOfFractionalDigits=i.ValueFormat.NumberOfFractionalDigits;}var s3={NumberOfFractionalDigits:this.getModel("ovpCardProperties").oData.NumberOfFractionalDigits?this.getModel("ovpCardProperties").oData.NumberOfFractionalDigits:0,percentageAvailable:this.getModel("ovpCardProperties").oData.percentageAvailable?this.getModel("ovpCardProperties").oData.percentageAvailable:false};var t3='sap.ovp.cards.v4.V4AnnotationHelper.KpiValueFormatter';var u3=[i.Value.$Path];return d1(u3,t3,s3);}function O2(){var i=arguments[arguments.length-1],k=arguments[0];var j=N.getFloatInstance({minFractionDigits:i.NumberOfFractionalDigits,maxFractionDigits:i.NumberOfFractionalDigits,style:"short",showScale:true,shortRefNumber:k});if(i.percentageAvailable){return j.format(Number(k))+" %";}else{return j.format(Number(k));}}function P2(i,j){if(!j||!j.Value||!j.Value.$Path||!j.TrendCalculation){return"";}var k=H1(j.Value);var p3=H1(j.TrendCalculation.ReferenceValue);var q3=H1(j.TrendCalculation.DownDifference);var r3=H1(j.TrendCalculation.UpDifference);var s3=r1(p3);var t3=r1(q3);var u3=r1(r3);var v3={"referenceValue":p3,"downDifference":q3,"upDifference":r3,"bIsRefValBinding":s3,"bIsDownDiffBinding":t3,"bIsUpDiffBinding":u3};var w3="{value:"+JSON.stringify(v3)+", model: 'ovpCardProperties'}";var x3="parts: ["+k;x3+=s3?","+p3:"";x3+=t3?","+q3:"";x3+=u3?","+r3:"";x3+=","+w3;x3+="]";var y3="sap.ovp.cards.v4.V4AnnotationHelper.formatTrendIcon";return"{"+x3+", formatter: '"+y3+"'}";}P2.requiresIContext=true;function Q2(){var i=arguments[arguments.length-1];var j=1;return y(arguments[0],i.bIsRefValBinding?arguments[j++]:i.referenceValue,i.bIsDownDiffBinding?arguments[j++]:i.downDifference,i.bIsUpDiffBinding?arguments[j++]:i.upDifference);}function R2(i){if(!i||!i.TrendCalculation||!i.TrendCalculation.ReferenceValue){return"";}if(i&&i.ValueFormat&&i.ValueFormat.NumberOfFractionalDigits){this.getModel("ovpCardProperties").oData.NumberOfFractionalDigits=i.ValueFormat.NumberOfFractionalDigits;}if(i.TrendCalculation.ReferenceValue.$Path){return"{parts: [{path:'"+i.Value.$Path+"'}, {path:'"+i.TrendCalculation.ReferenceValue.$Path+"'}], formatter: 'sap.ovp.cards.v4.V4AnnotationHelper.returnPercentageChange'}";}else{return"{parts: [{path:'"+i.Value.$Path+"'}], formatter: 'sap.ovp.cards.v4.V4AnnotationHelper.returnPercentageChange'}";}}function S2(k,i){var j,p3,q3,r3,s3=false;if(typeof k=="string"){k=N.getIntegerInstance().parse(k);}if(isNaN(+k)){return"";}if(k==0){r3=i;}else{r3=k;}p3=this.getModel('ovpCardProperties');if(p3.getProperty("/iNumberOfFractionalDigits")){q3=+(p3.getProperty("/iNumberOfFractionalDigits"));}if(p3.getProperty("/bPercentageAvailableForTarget")){s3=true;}if(i){j=i;}else{if(p3.getProperty("/sManifestTargetValue")){j=p3.getProperty("/sManifestTargetValue");}}if(!q3||q3<0){q3=0;}else if(q3>2){q3=2;}if(j){var t3=N.getFloatInstance({minFractionDigits:q3,maxFractionDigits:q3,style:"short",showScale:true,shortRefNumber:r3});if(s3){return t3.format(+(j))+" %";}else{return t3.format(+(j));}}}function T2(i){if(!i||!i.TrendCalculation||!i.TrendCalculation.ReferenceValue){return"";}if(!i||!i.Value||!i.Value.$Path){return"";}var j=this.getModel('ovpCardProperties');var k=j.getProperty("/entityType");var p3=j.getProperty("/metaModel");if(i&&i.ValueFormat&&i.ValueFormat.NumberOfFractionalDigits){j.setProperty("/iNumberOfFractionalDigits",i.ValueFormat.NumberOfFractionalDigits);}if(i.TrendCalculation.ReferenceValue){if(i.TrendCalculation.ReferenceValue){j.setProperty("/sManifestTargetValue",i.TrendCalculation.ReferenceValue);return"{parts: [{path:'"+i.Value.$Path+"'}], formatter: 'sap.ovp.cards.v4.V4AnnotationHelper.TargetValueFormatter'}";}if(i.TrendCalculation.ReferenceValue.$Path){var q3=c1(p3,k,i.TrendCalculation.ReferenceValue.$Path);if(q3["Org.OData.Measures.V1.Unit"]){var r3=q3["Org.OData.Measures.V1.Unit"];if(r3.String=="%"){j.setProperty("/bPercentageAvailableForTarget",true);}}return"{parts: [{path:'"+i.Value.$Path+"'},{path:'"+i.TrendCalculation.ReferenceValue.$Path+"'}], formatter: 'sap.ovp.cards.v4.V4AnnotationHelper.TargetValueFormatter'}";}}}function U2(k,i){var j,p3,q3;if(typeof k=="string"){k=N.getIntegerInstance().parse(k);}if(isNaN(+k)){return"";}k=+(k);q3=this.getModel('ovpCardProperties');if(q3.getProperty("/iNumberOfFractionalDigits")){j=+(q3.getProperty("/iNumberOfFractionalDigits"));}if(i){p3=+(i);}else{if(q3.getProperty("/sManifestTargetValue")){p3=+(q3.getProperty("/sManifestTargetValue"));}}if(!j||j<0){j=0;}else if(j>2){j=2;}if(p3){var r3=((k-p3)/p3);var s3=N.getPercentInstance({style:'short',minFractionDigits:j,maxFractionDigits:j,showScale:true});return s3.format(r3);}}function V2(i){if(i&&i.GroupBy&&!(h(i.GroupBy))&&i.GroupBy[0].hasOwnProperty('$PropertyPath')){return true;}else{return false;}}function W2(j,k){var p3;for(var i=0;j&&i<j.length;i++){if(j[i].value==k){p3=j[i];break;}}return p3?p3.name:null;}function X2(i,k){return W2(i,k);}function Y2(i,k){var j=W2(i,k);return j?j:b.getText("OVP_KEYUSER_LABEL_NO_NAVIGATION");}function Z2(i){var j="";var k=i&&i.GroupBy;if(!k){return j;}var p3=this.getModel('ovpCardProperties').getProperty("/metaModel");var q3=this.getModel('ovpCardProperties').getProperty("/entityType");var r3;if(i.GroupBy.constructor===Array){r3=i.GroupBy;}else if(!i.GroupBy.Collection){return j;}else{r3=i.GroupBy.Collection;}var s3;e(r3,function(){s3=e3(p3,q3,this.$PropertyPath);if(!s3){return;}j+=s3;j+=", ";});if(j[j.length-1]===" "&&j[j.length-2]===","){j=j.substring(0,j.length-2);}return j==""?"":b.getText("By",[j]);}function $2(i,j,k){var p3=true;var q3=k["SelectOptions"].length-1;if(j.PropertyName.PropertyPath===k["SelectOptions"][q3].PropertyName.PropertyPath){p3=false;}j=[j];var r3=i.getSetting('ovpCardProperties');var s3=r3.getProperty("/entityType");var t3=r3.getProperty("/metaModel");var u3=D1(r3,j);if(u3.length==0){return"";}var v3;var w3;v3=u3[0].path;w3=f3(t3,s3,v3);if(w3!==v3){return"";}var x3=t3.getODataProperty(s3,j[0].PropertyName.PropertyPath)["type"];var y3=c3(u3,x3);if(p3===true){return y3+", ";}return y3;}$2.requiresIContext=true;function _2(i,j,k){var p3=!(j.index===(k.length-1));var q3=i.getSetting('ovpCardProperties');var r3=q3.getProperty("/metaModel");var s3=q3.getProperty("/entityType");var t3=r3.getODataProperty(s3,k[j.index].path)["type"];var u3=c3([k[j.index]],t3);if(p3===true){return u3+", ";}return u3;}_2.requiresIContext=true;function a3(i){return i.id;}function b3(i){return i.id;}function c3(j,k){var p3=[];for(var i=0;i<j.length;i++){p3.push(d3(j[i],k));}return p3.join(', ');}function d3(i,j){var k=false;var p3,q3=D.getInstance({'style':'medium'});if(j==='Edm.DateTime'){p3=q3.format(new Date(i.value1));}else if(j==='Edm.DateTimeOffset'){p3=q3.format(new Date(i.value1),true);}else{p3=i.value1;}if(i.operator[0]==="N"){k=true;}if(i.value2){if(j==='Edm.DateTime'){p3+=" - "+q3.format(new Date(i.value1));}else if(j==='Edm.DateTimeOffset'){p3+=" - "+q3.format(new Date(i.value1),true);}else{p3+=" - "+i.value1;}}if(k){p3=b.getText("kpiHeader_Filter_NotOperator",[p3]);}return p3;}function e3(i,j,k){return g3(i,j,k,"com.sap.vocabularies.Common.v1.Label");}function f3(i,j,k){return g3(i,j,k,"sap:text");}function g3(i,j,k,p3){var q3={};q3[k]=c1(i,j,k);if(!q3){L.error("No Property Found for with Name '"+k+" For Entity-Type '"+j.name+"'");return;}if(q3[k].annotations){var r3=q3[k].annotations["@"+p3];}if(r3){return r3;}return Object.keys(q3)[0];}function h3(i){if(!i||!i.Value||!i.Value.$Path){return"";}var j={NumberOfFractionalDigits:this.getModel("ovpCardProperties").oData.NumberOfFractionalDigits?this.getModel("ovpCardProperties").oData.NumberOfFractionalDigits:0,percentageAvailable:this.getModel("ovpCardProperties").oData.percentageAvailable?this.getModel("ovpCardProperties").oData.percentageAvailable:false};var k='sap.ovp.cards.v4.V4AnnotationHelper.KpiValueFormatter';var p3=[i.Value.$Path];return d1(p3,k,j);}function i3(i,j){if(j.hasOwnProperty(i)){return true;}return false;}function j3(i,j){var k;if(j[i].customDateRangeImplementation){return j[i].customDateRangeImplementation;}else if(j[i].filter){k={module:'sap.ui.comp.config.condition.DateRangeType',operations:{filter:j[i].filter}};return JSON.stringify(k);}else{k={module:'sap.ui.comp.config.condition.DateRangeType',operations:{filter:[{path:'key',contains:j[i].selectedValues,exclude:j[i].exclude}]}};return JSON.stringify(k);}}function k3(i){if(i){return undefined;}return"_BASIC";}function l3(j,k){for(var i=0;i<k.length;i++){if(k[i].type.$EnumMember.indexOf('ContactInformationType/work')>=0){var p3=O.format(k[i].address,{context:j});return p3;}}return"";}l3.requiresIContext=true;function m3(j,k){for(var i=0;i<k.length;i++){if(k[i].type.$EnumMember.indexOf('PhoneType/work')>=0){var p3=O.format(k[i].uri,{context:j});return p3;}}return"";}m3.requiresIContext=true;function n3(j,k){for(var i=0;i<k.length;i++){if(k[i].type.$EnumMember.indexOf('PhoneType/cell')>=0){var p3=O.format(k[i].uri,{context:j});return p3;}}return"";}n3.requiresIContext=true;function o3(j,k){for(var i=0;i<k.length;i++){if(k[i].type.$EnumMember.indexOf('PhoneType/fax')>=0){var p3=O.format(k[i].uri,{context:j});return p3;}}return"";}o3.requiresIContext=true;return{getGroupID:k3,getConditionTypeForDateProperties:j3,isDateRangeType:i3,criticalityConstants:n,TextArrangementType:T,getLabelForDataItem:q,colorPaletteForComparisonMicroChart:k1,formatField:$,checkFilterPreference:t1,formatItems:u1,getCardSelections:A1,getCardSorters:B1,getFilters:D1,getPrimitiveValue:G1,getAnnotationLabel:X2,getApplicationName:Y2,removeDuplicateDataField:J1,formatUrl:K1,getDataPointsCount:L1,getFirstDataPointValue:M1,getFirstDataFieldName:P1,getSecondDataFieldName:Q1,getRequestFields:z1,getThirdDataFieldName:R1,formatDataFieldValueOnIndex:U1,formatDataPointValueOnIndex:V1,formatDataPointOrField:W1,formatsemanticObjectOfDataFieldGeneric:X1,getLabelForFirstDataPoint:_1,formatImageUrl:a2,formatUnit:b2,formatObjectNumber:c2,formatFirstDataPointState:d2,formatFirstDataPointColor:e2,formatSecondDataPointState:f2,formatThirdDataPointState:g2,formatFirstDataPointStateForSmartField:h2,formatKPIHeaderState:j2,isFirstDataPointCriticality:k2,isFirstDataPointCriticalityForTableStatus:l2,getSortedDataFields:z,getSortedDataPoints:B,formatDataFieldValueGeneric:p2,formatDataPointValue:t2,formatDataPointStateGeneric:u2,checkCriticalityGeneric:v2,checkCriticalityGenericForTableStatus:w2,formatDataPointStateForSmartFieldGeneric:x2,hasActions:y2,isFirstDataPointPercentageUnit:z2,resolveEntityTypePath:A2,resolveParameterizedEntitySet:E2,getAssociationObject:F2,semanticObjectOfFirstDataField:H2,semanticObjectOfSecondDataField:I2,isFirstContactAnnotation:K2,getAggregateNumber:L2,KpiValueFormatter:O2,kpiValueCriticality:i2,formThePathForAggregateNumber:N2,formThePathForTrendIcon:P2,formPathForPercentageChange:R2,TargetValueFormatter:S2,formPathForTargetValue:T2,returnPercentageChange:U2,isPresentationVarientPresent:V2,listGroupBy:Z2,formTheFilterByString:$2,formTheFilterByStringNotFromSelVar:_2,formTheIdForFilter:a3,formTheIdForFilterNotFromSelVar:b3,_criticality2state:u,_calculateCriticalityState:x,_calculateTrendDirection:y,_getPropertiesFromBindingString:x1,sortCollectionByImportance:P,checkNavTargetForContactAnno:r2,checkForContactAnnotation:s2,getKPIHeaderAggregateNumber:h3,formatColor:q1,formatTrendIcon:Q2,formatNumberCalculation:e1,formatCurrency:g1,formatDate:f1,getEmail:l3,getPhone:m3,getDevice:n3,getPhoneType:o3};},true);
