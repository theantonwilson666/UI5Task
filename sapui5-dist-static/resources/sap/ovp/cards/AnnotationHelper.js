sap.ui.define(["sap/ui/core/format/NumberFormat","sap/ui/core/format/DateFormat","sap/ovp/cards/CommonUtils","sap/ui/model/odata/AnnotationHelper","sap/ui/model/FilterOperator","sap/ui/Device","sap/ui/model/analytics/odata4analytics","sap/ui/generic/app/navigation/service/SelectionVariant","sap/ovp/app/resources","sap/base/strings/formatMessage","sap/base/util/isPlainObject","sap/base/util/each","sap/ovp/cards/MetadataAnalyser","sap/base/security/encodeURL","sap/base/util/merge","sap/ovp/cards/ovpLogger","sap/base/util/isEmptyObject"],function(N,D,C,O,F,a,o,S,b,f,c,e,M,d,m,g,h){"use strict";var l={StateValues:{None:"None",Negative:"Error",Critical:"Warning",Positive:"Success"},ColorValues:{None:"Neutral",Negative:"Error",Critical:"Critical",Positive:"Good"}};var A={TEXT:"com.sap.vocabularies.Common.v1.Text",TEXT_ARRANGEMENT:"com.sap.vocabularies.UI.v1.TextArrangement"};var T={TEXT_LAST:"com.sap.vocabularies.UI.v1.TextArrangementType/TextLast",TEXT_FIRST:"com.sap.vocabularies.UI.v1.TextArrangementType/TextFirst",TEXT_ONLY:"com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly",TEXT_SEPARATE:"com.sap.vocabularies.UI.v1.TextArrangementType/TextSeparate"};var I={"List_condensed":{phone:5,tablet:5,desktop:5},"List_extended":{phone:3,tablet:3,desktop:3},"List_condensed_bar":{phone:5,tablet:5,desktop:5},"List_extended_bar":{phone:3,tablet:3,desktop:3},"Table":{phone:5,tablet:5,desktop:5},"Stack_simple":{phone:20,tablet:20,desktop:20},"Stack_complex":{phone:5,tablet:5,desktop:5}};var L=new g("OVP.cards.AnnotationHelper");function n(i,j){var k=i.getSetting('ovpCardProperties');var i3=k.getProperty('/showLabelText');if(i3==="true"){var j3=j.Address[0];if(typeof j3.country!=="undefined"){return"{path:'"+j3.country.Path+"'}";}else if(typeof j3.locality!=="undefined"){return"{path:'"+j3.locality.Path+"'}";}else if(typeof j3.street!=="undefined"){return"{path:'"+j3.street.Path+"'}";}else if(typeof j3.code!=="undefined"){return"{path:'"+j3.code.Path+"'}";}}else{return null;}}n.requiresIContext=true;function p(i,j){if(!j){return"";}if(j.Label){return j.Label.String;}var k=i.getSetting&&i.getSetting('ovpCardProperties');var i3=k&&k.getProperty("/metaModel");var j3=k&&k.getProperty("/entityType");if(!i3||!j3){return"";}var k3;if(j.Value){k3=j.Value.Path;}if(j.Target){var l3=H(j3.$path,j);var m3=l3&&i3.getProperty(l3);k3=m3&&m3.Value.Path;}if(!k3||!k3.length>0||k3===" "){return"";}var n3=i3.getODataProperty(j3,k3);if(!n3){return"";}var o3=n3["sap:label"]||(n3["com.sap.vocabularies.Common.v1.Label"]||"").String||"";return o3;}p.requiresIContext=true;function s(i){if(i.EdmType==="Edm.DateTime"||i.EdmType==="Edm.DateTimeOffset"){return'Right';}return'Left';}s.requiresContext=true;function q(i,k){if(i.getSetting){var j=i.getSetting("_ovpCache");if(j){return j[k];}}return undefined;}function r(i,k,j){if(i.getSetting){var i3=i.getSetting("_ovpCache");if(i3){i3[k]=j;}}}function t(i,j){var k;if(j){k=j.None;if(i&&i.EnumMember){var i3=i.EnumMember;if(v(i3,'Negative')){k=j.Negative;}else if(v(i3,'Critical')){k=j.Critical;}else if(v(i3,'Positive')){k=j.Positive;}}}return k;}function u(i){if(i=="Error"){i=1;}else if(i=="Warning"){i=2;}else if(i=="Success"){i=3;}else{i=0;}return i;}function v(i,j){return i&&i.indexOf(j,i.length-j.length)!==-1;}function w(i,j,k,i3,j3,k3,l3){var m3={};m3.EnumMember="None";var n3=Number.NEGATIVE_INFINITY;var o3=Number.POSITIVE_INFINITY;if((!j3&&j3!==0)&&(k||k===0)){j3=k;}if((!k3&&k3!==0)&&(i3||i3===0)){k3=i3;}if(!k&&k!==0){k=n3;}if(!i3&&i3!==0){i3=o3;}if(i!==undefined){i=Number(i);if(v(j,"Minimize")||v(j,"Minimizing")){if((k3||k3===0)&&(i3||i3===0)){if(i<=parseFloat(k3)){m3.EnumMember="Positive";}else if(i>parseFloat(i3)){m3.EnumMember="Negative";}else{m3.EnumMember="Critical";}}}else if(v(j,"Maximize")||v(j,"Maximizing")){if((j3||j3===0)&&(k||k===0)){if(i>=parseFloat(j3)){m3.EnumMember="Positive";}else if(i<parseFloat(k)){m3.EnumMember="Negative";}else{m3.EnumMember="Critical";}}}else if(v(j,"Target")){if((k3||k3===0)&&(i3||i3===0)&&(j3||j3===0)&&(k||k===0)){if(i>=parseFloat(j3)&&i<=parseFloat(k3)){m3.EnumMember="Positive";}else if(i<parseFloat(k)||i>parseFloat(i3)){m3.EnumMember="Negative";}else{m3.EnumMember="Critical";}}}}return t(m3,l3);}function x(i,j,k,i3){if(!i||!j){return;}i=Number(i);if(!i3&&(i-j>=0)){return"Up";}if(!k&&(i-j<=0)){return"Down";}if(j&&i3&&(i-j>=i3)){return"Up";}if(j&&k&&(i-j<=k)){return"Down";}}function y(i,j){var k=i.getPath(0)+"-DataFields-Sorted";var i3=q(i,k);if(!i3){var j3=z(i,j);var k3=j3.map(function(l3){return l3.Value.Path;});k3=k3.filter(function(l3){return!!l3;});i3=j.filter(function(l3){if(l3.RecordType==="com.sap.vocabularies.UI.v1.DataField"&&k3.indexOf(l3.Value.Path)===-1){return true;}return false;});i3=K(i3);r(i,k,i3);}return i3;}y.requiresIContext=true;function z(j,k,i3){var j3=j.getPath(0)+"-DataPoints-Sorted";var k3=q(j,j3);if(!k3){if(i3){k3=k.filter(E);}else{k3=k.filter(B);}k3=K(k3);var l3;for(var i=0;i<k3.length;i++){l3=j.getPath(0).substr(0,j.getPath(0).lastIndexOf("/")+1);k3[i]=j.getModel(0).getProperty(H(l3,k3[i]));l3="";}r(j,j3,k3);}return k3;}z.requiresIContext=true;function B(i){if(i.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&i.Target.AnnotationPath.match(/@com.sap.vocabularies.UI.v1.DataPoint.*/)){return true;}return false;}function E(i){if((i.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&i.Target.AnnotationPath.match(/@com.sap.vocabularies.UI.v1.DataPoint.*/))||(i.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&i.Target.AnnotationPath.match(/@com.sap.vocabularies.Communication.v1.Contact.*/))){return true;}return false;}function G(i){if(!i||!i.Criticality||!i.Criticality.Path){return;}return"{path:'"+i.Criticality.Path+"'}";}function H(i,j){if(i&&!v(i,'/')){i+='/';}return i+j.Target.AnnotationPath.slice(1);}function J(i){var j,k;if(i["com.sap.vocabularies.UI.v1.Importance"]){j=i["com.sap.vocabularies.UI.v1.Importance"].EnumMember;switch(j){case"com.sap.vocabularies.UI.v1.ImportanceType/High":k=1;break;case"com.sap.vocabularies.UI.v1.ImportanceType/Medium":k=2;break;case"com.sap.vocabularies.UI.v1.ImportanceType/Low":k=3;break;}}else{k=4;}return k;}function K(i){if(i.length<2){return i;}var j=parseInt(i.length/2,10);var k=i.slice(0,j);var i3=i.slice(j,i.length);return P(K(k),K(i3));}function P(i,j){var k=[];while(i.length&&j.length){var i3=J(i[0]),j3=J(j[0]);if(i3<=j3){k.push(i.shift());}else{k.push(j.shift());}}while(i.length){k.push(i.shift());}while(j.length){k.push(j.shift());}return k;}function Q(i,j,k){var i3=y(i,j)[k];if(i3){return Z(i,i3);}return"";}function R(i,j,k){var i3=y(i,j)[k];return p(i,i3);}function U(i,j,k){var i3=z(i,j)[k];if(i3&&i3.Title){return i3.Title.String;}return"";}function V(i,j,k){var i3=j.filter(B);i3=K(i3);if(!i3||!i3.length||!i3.length>0){return"";}return p(i,i3[0]);}function W(i,j,k,i3){var j3=z(i,j)[k];if(!j3){return"";}var k3=i.getSetting('ovpCardProperties');var l3=k3.getProperty("/entityType");var m3=k3.getProperty("/metaModel");return _(i,j3,l3,m3,i3);}function X(i,j,k){var i3=z(i,j)[k];if(i3&&i3.Criticality){return true;}}function Y(i,j,k){var i3=z(i,j)[k];var j3=i3.Criticality.Path;return"{path:'"+j3+"'}";}function _(i,j,k,i3,j3){if(!j||!j.Value){return"";}var k3=i.getSetting('ovpCardProperties');var l3=false;if(k3){var m3=k3.getProperty("/ignoreSapText");l3=m3==undefined?l3:m3;}var n3=i3.getODataProperty(k,j.Value.Path);var o3=false;if(l3==true){if(n3&&(n3["com.sap.vocabularies.Analytics.v1.Measure"]||n3["sap:aggregation-role"]=="measure")){o3=true;}}if(!o3&&n3){var p3;if(n3["com.sap.vocabularies.Common.v1.Text"]){p3=n3["com.sap.vocabularies.Common.v1.Text"].String?n3["com.sap.vocabularies.Common.v1.Text"].String:n3["com.sap.vocabularies.Common.v1.Text"].Path;}else if(n3["sap:text"]){p3=n3["sap:text"];}if(p3){n3=i3.getODataProperty(k,p3);j={Value:{Path:n3.name}};}}return Z(i,j,j3);}function Z(i,j,k,i3){if(j.Value.Apply){return O.format(i,j.Value);}var j3=i.getSetting('ovpCardProperties');var k3=j3.getProperty("/entityType");var l3=j3.getProperty("/metaModel");return a1(i,j,k3,l3,k,i3);}Z.requiresIContext=true;function $(i,j,k,i3){if((!k)||(typeof i3!=='string')){return i3;}var j3=k[A.TEXT];if(!j3){return i3;}var k3,l3;k3=k[A.TEXT_ARRANGEMENT];l3=k3&&k3.EnumMember;if(!l3){k3=j3&&j3[A.TEXT_ARRANGEMENT];l3=k3&&k3.EnumMember;}if(!l3){k3=j&&j[A.TEXT_ARRANGEMENT];l3=k3&&k3.EnumMember;}if(!l3){return i3;}var m3=O.format(i,j3);if(!m3||m3===" "){return i3;}var n3;switch(l3){case T.TEXT_FIRST:n3=m3+" ("+i3+")";break;case T.TEXT_LAST:n3=i3+" ("+m3+")";break;case T.TEXT_ONLY:n3=m3;break;case T.TEXT_SEPARATE:n3=i3+" ("+m3+")";break;default:n3=i3;break;}return n3;}function a1(j,k,i3,j3,k3,l3,m3){if(k.Value.Apply){return O.format(j,k.Value);}var n3=k.Value.Path?k.Value.Path:k.Value.String;var o3=j3.getODataProperty(i3,n3),p3="",q3,r3;var s3=j.getSetting("ovpCardProperties");var t3=s3&&s3.getProperty("/contentFragment");if(!l3){if(k.Value.Path&&k.Value.Path.split("/").length>1){o3=f1(j3,i3,k.Value.Path);}if(!o3){return"";}if(o3["type"]==='Edm.DateTime'||o3["type"]==='Edm.DateTimeOffset'){var u3={'relative':true,'relativeScale':'auto'},v3=s3&&s3.getProperty("/showDateInRelativeFormat");if(v3!==undefined&&!v3){u3={'style':'medium'};}r3={dateFormat:u3,bUTC:o3["type"]==='Edm.DateTime'?true:false};q3="sap.ovp.cards.AnnotationHelper.formatDate";p3=b1([k.Value.Path?k.Value.Path:o3.name],q3,r3);}else if((k.ValueFormat&&k.ValueFormat.NumberOfFractionalDigits)||o3["scale"]){var w3=(k.ValueFormat&&k.ValueFormat.NumberOfFractionalDigits)?k.ValueFormat.NumberOfFractionalDigits.Int:0,x3;var y3=(k.ValueFormat&&k.ValueFormat.ScaleFactor&&k.ValueFormat.ScaleFactor.Decimal);if(o3["Org.OData.Measures.V1.ISOCurrency"]){x3=o3["Org.OData.Measures.V1.ISOCurrency"].Path?o3["Org.OData.Measures.V1.ISOCurrency"].Path:o3["Org.OData.Measures.V1.ISOCurrency"].String;}else if(o3["Org.OData.Measures.V1.Unit"]){x3=o3["Org.OData.Measures.V1.Unit"].Path?o3["Org.OData.Measures.V1.Unit"].Path:o3["Org.OData.Measures.V1.Unit"].String;}else if(o3["sap:unit"]){x3=o3["sap:unit"];}var z3=x3?j3.getODataProperty(i3,x3):null,A3=[k.Value.Path?k.Value.Path:o3.name];if(w3>2){w3=2;}r3={numberOfFractionalDigits:w3,scaleFactor:y3};if(o3["Org.OData.Measures.V1.ISOCurrency"]){var B3=o3["Org.OData.Measures.V1.ISOCurrency"];if(B3.Path){q3="sap.ovp.cards.AnnotationHelper.formatCurrency";A3.push(B3.Path);}else if(B3.String){r3.currencyString=B3.String;q3="sap.ovp.cards.AnnotationHelper.formatCurrency";}}else if(z3&&(z3["Org.OData.Measures.V1.ISOCurrency"]||z3["sap:semantics"]==="currency-code")){q3="sap.ovp.cards.AnnotationHelper.formatCurrency";A3.push(x3);}else{q3="sap.ovp.cards.AnnotationHelper.formatNumberCalculation";}p3=b1(A3,q3,r3);}else{if(m3){p3=O.simplePath(j,k.Value);}else{var C3=O.format(j.getModel()?j:j.getInterface(0),k.Value);var D3=C3.split(",");var E3=[];if(D3.length>1){for(var i=0;i<D3.length;i++){if(D3[i].indexOf("path:")>=0||D3[i].indexOf("type:")>=0){E3.push(D3[i]);}}if(E3.length>0){p3=p3+E3.join(',');if(p3.substring(p3.length-1)!=="}"){p3=p3+"}";}}}else{p3=C3;}}}if(t3){p3=$(j,i3,o3,p3);}if(o3["Org.OData.Measures.V1.Unit"]){var F3=o3["Org.OData.Measures.V1.Unit"];if(F3.Path){p3+=(" "+b1([F3.Path]));}else if(F3.String){if(F3.String!=="%"){p3+=" ";}p3+=F3.String;}}}if(!k3){if(o3["Org.OData.Measures.V1.ISOCurrency"]){var B3=o3["Org.OData.Measures.V1.ISOCurrency"];if(B3.Path){p3+=(" "+b1([B3.Path]));}else if(B3.String){p3+=(" "+B3.String);}}}if(p3[0]===" "){p3=p3.substring(1);}return p3;}function b1(j,k,i3){var j3="",k3=j.length;if(k3>1||i3){j3="{parts:[";for(var i=0;i<k3;i++){j3+=("{path: '"+j[i]+"'}"+(((i===k3-1)&&!i3)?"]":", "));}if(i3){var l3="{value:"+JSON.stringify(i3)+", model: 'ovpCardProperties'}";j3+=l3+"]";}}else{j3="{path: '"+j[0]+"'";}j3+=(k?(", formatter: '"+k+"'"):"")+"}";return j3;}function c1(){var i=arguments[arguments.length-1],j=arguments[0];var k=N.getFloatInstance({style:'short',showMeasure:false,shortRefNumber:i.scaleFactor,minFractionDigits:i.numberOfFractionalDigits,maxFractionDigits:i.numberOfFractionalDigits});return k.format(Number(j));}function d1(){var i=arguments[arguments.length-1],j=arguments[0];var k=D.getInstance(i.dateFormat);if(!j){j="";return j;}return k.format(new Date(j),i.bUTC);}function e1(){var i=arguments[arguments.length-1],j=arguments[0],k=arguments[1];var i3="";var j3=N.getCurrencyInstance({style:'short',showMeasure:false,shortRefNumber:i.scaleFactor,minFractionDigits:i.numberOfFractionalDigits,maxFractionDigits:i.numberOfFractionalDigits});if(k){i3=j3.format(j,k);}else{i3=i.currencyString?j3.format(j,i.currencyString):j3.format(j);}return i3;}function f1(j,k,i3){var j3=i3.split("/");if(j3.length>1){for(var i=0;i<(j3.length-1);i++){var k3=j.getODataAssociationEnd(k,j3[i]);if(k3){k=j.getODataEntityType(k3.type);}}return j.getODataProperty(k,j3[j3.length-1]);}}function g1(i,j,k){var i3=z(i,j);var j3=l.StateValues;var k3=i3[k];if(!k3){return j3.None;}if(k3.Criticality){return k1(i,k3,j3);}return m1(i,k3,j3);}function h1(i,j,k){var i3=z(i,j);if(i3&&i3.length){var j3=i3[0];if(j3&&(j3.Criticality||j3.CriticalityCalculation)){return true;}}return false;}function i1(i,j,k){if(h1(i,j,k)){return'';}return'sapUiChartPaletteQualitativeHue1';}i1.requiresIContext=true;function j1(i,j,k){var i3=z(i,j),j3=l.ColorValues;var k3=j3.None;if(i3.length>k){var l3=i3[k];if(l3&&l3.Criticality){k3=k1(i,l3,j3);}else{k3=m1(i,l3,j3);}}return k3;}function k1(i,j,k){var i3=k.None;var j3;var k3=j.Criticality;if(k3){j3="'{'= ({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Negative'') || ({0} === ''1'') || ({0} === 1) ? ''"+k.Negative+"'' : "+"({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Critical'') || ({0} === ''2'') || ({0} === 2) ? ''"+k.Critical+"'' : "+"({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Positive'') || ({0} === ''3'') || ({0} === 3) ? ''"+k.Positive+"'' : "+"''"+k.None+"'' '}'";if(k3.Path){var l3='$'+O.simplePath(i,k3);i3=f(j3,l3);}else if(k3.EnumMember){var m3="'"+k3.EnumMember+"'";i3=f(j3,m3);}else{L.warning("Case not supported, returning the default Neutral state");}}else{L.warning("Case not supported, returning the default Neutral state");}return i3;}function l1(i,j,k){var i3=z(i,j);var j3="None";if(i3.length>k){var k3=i3[k];if(k3&&k3.Criticality&&k3.Criticality.Path){j3=Y(i,j,k);}else{j3=m1(i,k3,l.StateValues);j3=u(j3);}}return j3;}function m1(i,j,k){var i3=k.None;if(j.Criticality){i3=t(j.Criticality,k);}else if(j.CriticalityCalculation&&j.Value&&j.Value&&j.Value.Path){i3=n1(i,j,k);}return i3;}function n1(i,j,k){var i3=F1(j.Value);var j3=j.CriticalityCalculation.ImprovementDirection.EnumMember;var k3=F1(j.CriticalityCalculation.DeviationRangeLowValue);var l3=F1(j.CriticalityCalculation.DeviationRangeHighValue);var m3=F1(j.CriticalityCalculation.ToleranceRangeLowValue);var n3=F1(j.CriticalityCalculation.ToleranceRangeHighValue);var o3=p1(k3);var p3=p1(l3);var q3=p1(m3);var r3=p1(n3);var s3={"deviationLow":k3,"deviationHigh":l3,"toleranceLow":m3,"toleranceHigh":n3,"bIsDeviationLowBinding":o3,"bIsDeviationHighBinding":p3,"bIsToleranceLowBinding":q3,"bIsToleranceHighBinding":r3,"sImprovementDirection":j3,"oCriticalityConfigValues":k};var t3="{value:"+JSON.stringify(s3)+", model: 'ovpCardProperties'}";var u3="parts: ["+i3;u3+=o3?","+k3:"";u3+=p3?","+l3:"";u3+=q3?","+m3:"";u3+=r3?","+n3:"";u3+=","+t3;u3+="]";var v3="sap.ovp.cards.AnnotationHelper.formatColor";return"{"+u3+", formatter: '"+v3+"'}";}function o1(){var i=arguments[arguments.length-1];var j=1;return w(arguments[0],i.sImprovementDirection,i.bIsDeviationLowBinding?arguments[j++]:i.deviationLow,i.bIsDeviationHighBinding?arguments[j++]:i.deviationHigh,i.bIsToleranceLowBinding?arguments[j++]:i.toleranceLow,i.bIsToleranceHighBinding?arguments[j++]:i.toleranceHigh,i.oCriticalityConfigValues);}function p1(i){return(typeof i==="string")&&i.charAt(0)==="{";}function q1(j,k,i3){var j3="";var k3=i3.split("/");if(k3.length>1){for(var i=0;i<(k3.length-1);i++){var l3=j.getODataAssociationEnd(k,k3[i]);if(l3){k=j.getODataEntityType(l3.type);if(j3){j3=j3+"/";}j3=j3+k3[i];}else{return j3;}}}return j3;}function r1(i){var j;if(i&&typeof i.getData==='function'){var k=i.getData();if(k.tabs){var i3=0;var j3=k.selectedKey;if(j3&&k.tabs.length>=j3){i3=j3-1;}j=k.tabs[i3].mFilterPreference;}else{j=k.mFilterPreference;}}return!!j;}function s1(j,k){var i3=j.getSetting('ovpCardProperties');var j3=i3.getProperty("/addODataSelect");var k3=i3.getProperty("/metaModel");var l3=k3.getODataEntityType(k.entityType);var m3=l3[i3.getProperty('/selectionAnnotationPath')];var n3=l3[i3.getProperty('/presentationAnnotationPath')];var o3="/"+k.name;var p3=Array.prototype.slice.call(arguments,2);var q3=j.getSetting('ovpCardProperties'),r3=q3.getProperty('/parameters');if(m3||!!r3){if((m3&&m3.Parameters&&m3.Parameters.length>0)||!!r3){o3=C2(j.getSetting('dataModel'),k,m3,r3);}}if(i3.getProperty("/cardLayout")&&i3.getProperty("/cardLayout/noOfItems")){var s3="{path: '"+o3+"', length: "+ +(i3.getProperty("/cardLayout/noOfItems"));}else{var s3="{path: '"+o3+"', length: "+G1(i3);}var t3=[];if(j3){t3=u1(j,k3,l3,p3);var u3=i3.getProperty("/template");if(u3!="sap.ovp.cards.charts.analytical"&&u3!="sap.ovp.cards.charts.smart.chart"){var v3=x1(n3);for(var i=0;i<v3.length;i++){if(t3.indexOf(v3[i])===-1){t3.push(v3[i]);}}}}var w3=t1(k3,l3,p3);var x3=r1(i3);if(x3||t3.length>0||w3.length>0){s3=s3+", parameters: {";}if(t3.length>0||w3.length>0){if(t3.length>0){s3=s3+"select: '"+t3.join(',')+"'";}if(w3.length>0){if(t3.length>0){s3=s3+", ";}s3=s3+"expand: '"+w3.join(',')+"'";}if(x3){s3=s3+", ";}}if(x3){s3=s3+"custom: {cardId: '"+i3.getProperty("/cardId")+"'}";}if(x3||t3.length>0||w3.length>0){s3=s3+"}";}var y3=w1(i3,n3);if(y3.length>0){s3=s3+", sorter:"+JSON.stringify(y3);}var z3=B1(i3,m3);if(z3.length>0){s3=s3+", filters:"+JSON.stringify(z3);}s3=s3+"}";return s3;}s1.requiresIContext=true;function t1(k,i3,j3){var k3=[];var l3,m3,n3,o3;for(var i=0;i<j3.length;i++){if(!j3[i]){continue;}l3=i3.$path+"/"+j3[i];m3=k.createBindingContext(l3);n3=m3.getObject();n3=n3?n3:[];for(var j=0;j<n3.length;j++){if(n3[j].Value&&n3[j].Value.Path){o3=q1(k,i3,n3[j].Value.Path);if(o3&&k3.indexOf(o3)===-1){k3.push(o3);}}}}return k3;}function u1(i3,j3,k3,l3){var m3=[];var n3,o3,p3;for(var i=0;i<l3.length;i++){if(!l3[i]){continue;}n3=k3.$path+"/"+l3[i];o3=j3.createBindingContext(n3);var q3={};if(i3&&i3.bDummyContext){m(q3,i3,o3,true);}else{q3=i3;}p3=o3.getObject();if(!p3){p3=[];}else if(c(p3)){if(p3.Data){p3=p3.Data;}else{p3=[];}}var r3;var s3;var t3;var u3;for(var j=0;j<p3.length;j++){s3=[];r3=p3[j];t3="";u3=r3.RecordType;if(u3==="com.sap.vocabularies.UI.v1.DataField"){t3=a1(q3,r3,k3,j3,undefined,undefined,true);}else if(u3==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){var v3=H(k3.$path,r3);t3=_(q3,j3.getProperty(v3),k3,j3);var w3=G(j3.getProperty(v3));if(w3&&w3.length>0){t3+=w3;}}else if(u3==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"&&r3.Url){var x3;if(!r3.Url.UrlRef){x3=O.format(q3,r3.Url);}if(x3&&x3.substring(0,2)==="{="){t3=x3;}}if(t3){var y3=O.simplePath(q3,r3.Value);if(t3.indexOf("(")<0&&t3!==y3){t3=[].concat(y3,t3).join(" ");}s3=v1(t3);}if(s3&&s3.length>0){var z3;for(var k=0;k<s3.length;k++){z3=s3[k];if(!m3[z3]){m3[z3]=true;var A3=C.getUnitColumn(z3,k3);if(A3&&A3!==z3){m3[A3]=true;}var B3=c3(j3,k3,z3);if(B3&&B3!==z3){m3[B3]=true;}}}}}}return Object.keys(m3);}function v1(j){var i,k=0,i3=j.length,j3="",k3;for(i=0;i<i3;i++){k3=j.charAt(i);if(!k3){return;}switch(k3){case"{":k++;break;case"}":k--;break;default:if(k<=0){continue;}break;}j3+=k3;}j=j3;var l3=/\${([a-zA-Z0-9\_|\/]*)/g;var m3=/[^[{]*[a-zA-Z0-9\_]/g;var n3=/path *\: *\'([a-zA-Z0-9\_]+)*\'/g;var o3,p3,q3=[];if(j.indexOf("{parts:[")!==-1){j=j.replace("{parts:[","");}if(j.substring(0,2)==="{="){o3=l3;p3=1;}else if(j.indexOf("path")!==-1){var r3=m3.exec(j);while(r3){if(r3[0].indexOf("path")===-1&&r3[0].indexOf("@i18n")!==0&&r3[0].indexOf("model: 'ovpCardProperties'")<-1){q3.push(r3[0]);}r3=m3.exec(j);}o3=n3;p3=1;}else{o3=m3;p3=0;}var s3=o3.exec(j);while(s3){if(s3[p3]&&s3[p3].indexOf("@i18n")!==0){q3.push(s3[p3]);}s3=o3.exec(j);}return q3;}function w1(j,k){var i3=[];var j3,k3;var l3=j.getProperty("/sortBy");if(l3){var m3=j.getProperty('/sortOrder');if(m3&&m3.toLowerCase()!=='descending'){k3=false;}else{k3=true;}j3={path:l3,descending:k3};i3.push(j3);}var n3=k&&k.SortOrder||undefined;var o3,l3;if(n3){for(var i=0;i<n3.length;i++){o3=n3[i];l3=o3.Property.PropertyPath;k3=C1(o3.Descending,true);j3={path:l3,descending:k3};i3.push(j3);}}return i3;}function x1(j){var k=[];var i3=j&&j.RequestAtLeast||undefined;if(i3){for(var i=0;i<i3.length;i++){if(i3[i].PropertyPath){k.push(i3[i].PropertyPath);}}}return k;}function y1(i){var j=i.getProperty('/entityType');var k=j[i.getProperty('/selectionAnnotationPath')];return{filters:B1(i,k),parameters:A1(k)};}function z1(j){if(!j){return;}var k=j.getProperty('/entityType');var i3=k[j.getProperty('/presentationAnnotationPath')];var j3=w1(j,i3);var k3=[];var i,l3=j3.length;for(i=0;i<l3;i++){if(!j3[i].path){continue;}k3.push({Property:j3[i].path,Descending:j3[i].descending});}if(k3.length>0){return{SortOrder:k3};}}function A1(j){var k,i3=[];if(!j||!j.Parameters){return i3;}var j3=j.Parameters.length;for(var i=0;i<j3;i++){k=j.Parameters[i];if(!k.PropertyName||!k.PropertyName.PropertyPath){continue;}if(!k.PropertyValue){L.error("Missing value for parameter "+k.PropertyName.PropertyPath);continue;}i3[i3.length]={path:k.PropertyName.PropertyPath,value:E1(k.PropertyValue)};}return i3;}function B1(k,i3){var j3=[];var k3;var l3=k.getProperty("/filters");if(l3){j3=j3.concat(l3);}if(i3&&i3.SelectOptions){k3=i3.SelectOptions;}else{k3=i3;}var m3,n3,o3;if(k3){for(var i=0;i<k3.length;i++){m3=k3[i];n3=m3.PropertyName.PropertyPath;for(var j=0;j<m3.Ranges.length;j++){o3=m3.Ranges[j];if(o3.Sign.EnumMember){var p3={path:n3,operator:o3.Option.EnumMember.split("/")[1],value1:E1(o3.Low),value2:E1(o3.High),sign:o3.Sign.EnumMember==="com.sap.vocabularies.UI.v1.SelectionRangeSignType/I"?"I":"E"};if(p3.sign==="E"&&p3.operator!==F.EQ){L.error("Exclude sign is supported only with EQ operator");continue;}if(p3.sign==="E"&&p3.operator===F.EQ){p3.operator=F.NE;p3.sign="I";}if(p3.operator==="CP"&&p3.sign==="I"){var q3=F.Contains;var r3=p3.value1;if(r3){var s3=r3.indexOf('*');var t3=r3.lastIndexOf('*');if(s3>-1){if((s3===0)&&(t3!==(r3.length-1))){q3=F.EndsWith;r3=r3.substring(1,r3.length);}else if((s3!==0)&&(t3===(r3.length-1))){q3=F.StartsWith;r3=r3.substring(0,r3.length-1);}else{r3=r3.substring(1,r3.length-1);}}}p3.operator=q3;p3.value1=r3;}j3.push(p3);}}}}return j3;}function C1(i,j){if(i&&i.Boolean){if(i.Boolean.toLowerCase()==="true"){return true;}else if(i.Boolean.toLowerCase()==="false"){return false;}}else if(i&&i.Bool){if(i.Bool.toLowerCase()==="true"){return true;}else if(i.Bool.toLowerCase()==="false"){return false;}}return j;}function D1(i){var j;if(i){if(i.String){j=Number(i.String);}else if(i.Int){j=Number(i.Int);}else if(i.Decimal){j=Number(i.Decimal);}else if(i.Double){j=Number(i.Double);}else if(i.Single){j=Number(i.Single);}}return j;}function E1(i){var j;if(i){if(i.String||i.String===""){j=i.String;}else if(i.Boolean||i.Bool){j=C1(i);}else if(i.DateTime){j=i.DateTime;}else if(i.DateTimeOffset){j=i.DateTimeOffset;}else{j=D1(i);}}return j;}function F1(i){if(i){if(i.Path){return"{path:'"+i.Path+"'}";}else{return E1(i);}}else{return"";}}function G1(i){var j=i.getProperty('/contentFragment');var k=i.getProperty('/listType');var i3=i.getProperty('/listFlavor');var j3;var k3="desktop";if(a.system.phone){k3="phone";}else if(a.system.tablet){k3="tablet";}if(j=="sap.ovp.cards.list.List"){if(k=="extended"){if(i3=="bar"){j3=I["List_extended_bar"];}else{j3=I["List_extended"];}}else if(i3=="bar"){j3=I["List_condensed_bar"];}else{j3=I["List_condensed"];}}else if(j=="sap.ovp.cards.table.Table"){j3=I["Table"];}else if(j=="sap.ovp.cards.stack.Stack"){if(i.getProperty('/objectStreamCardsNavigationProperty')){j3=I["Stack_complex"];}else{j3=I["Stack_simple"];}}if(j3){return j3[k3];}return 5;}function H1(i){var j=i.getObject();var k=z(i,j,true);var i3=k.map(function(j3){if(j3&&j3.Value&&j3.Value.Path){return j3.Value.Path;}else if(j3&&j3.fn&&j3.fn.Path){return j3.fn.Path;}});j.filter(function(j3,k3){if(j3.RecordType==="com.sap.vocabularies.UI.v1.DataField"&&i3.indexOf(j3.Value.Path)>-1){j.splice(k3,1);}});}H1.requiresIContext=true;function I1(i,j){if(j.charAt(0)==='/'||j.indexOf("http")===0){return j;}var k=i.getModel(0).getProperty("/baseUrl");if(k){return k+"/"+j;}return j;}I1.requiresIContext=true;function J1(i,j){var k=z(i,j);return k.length;}J1.requiresIContext=true;function K1(i,j){return M1(i,j,0);}K1.requiresIContext=true;function L1(i,j){return M1(i,j,1);}L1.requiresIContext=true;function M1(i,j,k){var i3=z(i,j),j3=i3[k];if(j3&&j3.Value&&j3.Value.Path){return j3.Value.Path;}return"";}function N1(i,j){return R(i,j,0);}N1.requiresIContext=true;function O1(i,j){return R(i,j,1);}O1.requiresIContext=true;function P1(i,j){return R(i,j,2);}P1.requiresIContext=true;function Q1(i,j){return R(i,j,3);}Q1.requiresIContext=true;function R1(i,j){return R(i,j,4);}R1.requiresIContext=true;function S1(i,j,k){return Q(i,j,k);}S1.requiresIContext=true;function T1(i,j,k){return W(i,j,k);}T1.requiresIContext=true;function U1(i,j,k,i3){var j3=J1(i,j);if(j3>0){return T1(i,j,k);}else{return S1(i,j,i3);}}U1.requiresIContext=true;function V1(i,j,k){return o2(i,j,k);}V1.requiresIContext=true;function W1(i,j){return U(i,j,0);}W1.requiresIContext=true;function X1(i,j){return U(i,j,1);}X1.requiresIContext=true;function Y1(i,j){return U(i,j,2);}Y1.requiresIContext=true;function Z1(i,j){return V(i,j,0);}Z1.requiresIContext=true;function $1(j,k){for(var i=0;i<k.length;i++){var i3=k[i];if(i3.RecordType==="com.sap.vocabularies.UI.v1.DataField"){if(i3.IconUrl&&i3.IconUrl.String){return i3.IconUrl.String;}if(i3.IconUrl&&i3.IconUrl.Path){return O.simplePath(j,i3.IconUrl);}}}}$1.requiresIContext=true;function _1(i,j,k){var i3="";var j3;if(Array.isArray(j)){j3=z(i,j)[k];}else{var k3=Object.assign({},j);var l3=Object.assign({},i);j3=m2(l3,k3);}if(!j3||!j3.Value){return i3;}var m3=i.getSetting('ovpCardProperties');var n3=m3&&m3.getProperty("/entityType");var o3=m3&&m3.getProperty("/metaModel");var p3=o3&&o3.getODataProperty(n3,j3.Value.Path);var q3=p3&&p3["Org.OData.Measures.V1.ISOCurrency"];if(q3&&q3.Path){i3+=(" "+b1([q3.Path]));}else if(q3&&q3.String){i3+=(" "+q3.String);}return i3;}_1.requiresIContext=true;function a2(i,j,k,i3){return W(i,j,k,i3);}a2.requiresIContext=true;function b2(i,j){return g1(i,j,0);}b2.requiresIContext=true;function c2(i,j){return j1(i,j,0);}c2.requiresIContext=true;function d2(i,j){return g1(i,j,1);}d2.requiresIContext=true;function e2(i,j){return g1(i,j,2);}e2.requiresIContext=true;function f2(i,j){return l1(i,j,0);}f2.requiresIContext=true;function g2(i){var j={};j.EnumMember="None";if(Number(i)===1){j.EnumMember="Negative";}else if(Number(i)===2){j.EnumMember="Critical";}else if(Number(i)===3){j.EnumMember="Positive";}return t(j,l.ColorValues);}function h2(i,j){if(j&&j.Criticality&&j.Criticality.Path){return"{parts: [{path:'"+j.Criticality.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.kpiValueCriticality'}";}else{return m1(i,j,l.ColorValues);}}h2.requiresIContext=true;function i2(i,j){return X(i,j,0);}i2.requiresIContext=true;function j2(i,j){var k=z(i,j)[0];if(k&&(k.Criticality||k.CriticalityCalculation)){return true;}return false;}j2.requiresIContext=true;function k2(i,j){return X(i,j,1);}k2.requiresIContext=true;function l2(i,j){return X(i,j,2);}l2.requiresIContext=true;function m2(i,j){var k=i.getPath(0);var i3=k.slice(0,k.lastIndexOf("/"));i3=i3.slice(0,i3.lastIndexOf("/"));var j3=H(i3,j);j=i.getModel(0).getProperty(j3);return j;}function n2(i,j){if(!j){return"";}return Z(i,j);}n2.requiresIContext=true;function o2(j,k,i3,j3){var k3;var l3=j3==undefined?i3:y(j,i3)[j3];var m3=j.getSetting('ovpCardProperties');var n3=m3.getProperty("/metaModel");var o3=n3.getODataEntityType(k.entityType);var p3=o3.property;if(p3){for(var i=0;i<p3.length;i++){if(l3.Value.Path===p3[i].name){k3=p3[i]["com.sap.vocabularies.Common.v1.SemanticObject"];if(k3){return O.format(j,k3);}else{return"";}}}}}function p2(i,j,k){var i3=k===undefined?j.Value.Path:j[k].Value.Path;var j3=(i3.indexOf("/")!=-1)?i3.split('/')[0]:"";return j3;}p2.requiresIContext=true;function q2(i,j){var k=i.getSetting('ovpCardProperties');var i3=k.getProperty("/metaModel");var j3=i3.getODataEntityType(j.entityType);if(j3["com.sap.vocabularies.Communication.v1.Contact"]){return true;}return false;}q2.requiresIContext=true;function r2(i,j,k){if(!j){return"";}var i3=i.getSetting('ovpCardProperties');var j3=i3.getProperty("/entityType");var k3=i3.getProperty("/metaModel");var l3=Object.assign({},j);var m3=Object.assign({},i);j=m2(m3,l3);return _(i,j,j3,k3,k);}r2.requiresIContext=true;function s2(i,j){var k=Object.assign({},j);var i3=Object.assign({},i);var j3="None",k3=l.StateValues;j=m2(i3,k);if(j&&j.Criticality){j3=k1(i,j,k3);}else{j3=m1(i,j,k3);}return j3;}s2.requiresIContext=true;function t2(i,j){var k=Object.assign({},j);var i3=Object.assign({},i);j=m2(i3,k);if(j&&j.Criticality){return true;}}t2.requiresIContext=true;function u2(i,j){var k=Object.assign({},j);var i3=Object.assign({},i);var j3=i.getSetting('ovpCardProperties');var k3=j3.getProperty("/entityType");var l3=j3.getProperty("/metaModel");j=m2(i3,k);if(!j){return;}var m3=l3.getODataProperty(k3,j.Value.Path);if(j&&m3&&m3.type=="Edm.String"&&(j.Criticality||j.CriticalityCalculation)){return'Center';}if(m3&&((m3.type=="Edm.DateTime")||(m3.type=="Edm.DateTimeOffset"))){return'Right';}}u2.requiresIContext=true;function v2(i,j){var k=Object.assign({},j);var i3=Object.assign({},i);j=m2(i3,k);var j3="None";if(j&&j.Criticality&&j.Criticality.Path){j3="{path:'"+j.Criticality.Path+"'}";}else{j3=m1(i,j,l.StateValues);j3=u(j3);}return j3;}v2.requiresIContext=true;function w2(j,k){var i3;for(var i=0;i<k.length;i++){i3=k[i];if(i3.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"||i3.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"||i3.RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"){return 1;}}return 0;}w2.requiresIContext=true;function x2(i,j){var k=z(i,j)[0];if(k&&k.Value&&k.Value.Path){var i3=i.getPath(0).substr(0,i.getPath(0).lastIndexOf("/")+1);var j3=i.getModel(0);var k3=j3.getProperty(i3);var l3=j3.getODataProperty(k3,k.Value.Path);if(l3&&l3["Org.OData.Measures.V1.Unit"]){return l3["Org.OData.Measures.V1.Unit"].String==="%";}}return false;}x2.requiresIContext=true;function y2(i){var j=i.getObject();var k=i.getModel();var i3=k.getProperty("/metaModel");var j3=i3.getODataEntitySet(k.getProperty("/entitySet"));var k3=i3.getODataEntityType(j3.entityType);j=k3.$path+"/"+j;return i3.createBindingContext(j);}function z2(i,j){if(i==='Edm.String'){var k=j.PropertyValue.String;return k;}return j.PropertyValue.String;}function A2(i,j,k,i3){var j3="";var k3=[];if(i3&&i3.Parameters){i.parameters.forEach(function(m3){i3.Parameters.forEach(function(n3){var o3=n3.PropertyName.PropertyPath.split("/");o3=o3[o3.length-1];if(o3===m3){var p3=z2(i['parameterType'][m3],n3);p3=d(j.formatValue(p3,i['parameterType'][m3]));k3.push(o3+'='+p3);}});});}else{j3="/"+k.name;L.error("SelectionParameters","There are no parameters to resolve");return j3;}try{j3='/'+i.entitySetName+'('+k3.join(',')+')/'+i.navPropertyName;}catch(l3){j3="/"+k.name;L.error("getEntitySetPathWithParameters","binding path with parameters failed - "+l3||l3.message);}return j3;}function B2(j,k,i3,j3,k3){var l3="";var m3=new o.Model(o.Model.ReferenceByModel(j));var n3=m3.findQueryResultByName(k.name);var o3=new o.QueryResultRequest(n3);var p3=n3.getParameterization();if(!p3){l3="/"+k.name;return l3;}if(k3){var q3=k3.getAnalyticalParameters();}if(p3){var r3;o3.setParameterizationRequest(new o.ParameterizationRequest(p3));if(i3&&i3.Parameters){e(i3.Parameters,function(){if(this.RecordType==="com.sap.vocabularies.UI.v1.IntervalParameter"){r3=this.PropertyNameFrom.PropertyPath.split("/");o3.getParameterizationRequest().setParameterValue(r3[r3.length-1],this.PropertyValueFrom.String,this.PropertyValueTo.String);}else{r3=this.PropertyName.PropertyPath.split("/");o3.getParameterizationRequest().setParameterValue(r3[r3.length-1],this.PropertyValue.String);}});}else if(j3){e(j3,function(){o3.getParameterizationRequest().setParameterValue(this.path,this.value);});}else if(q3&&q3.length>0){var s3=k3&&k3.getUiState({allFilters:false});var t3=s3?JSON.stringify(s3.getSelectionVariant()):"{}";var i3=new S(t3);for(var u3 in p3.getAllParameters()){for(var i=0;i<q3.length;i++){if(q3[i]&&(q3[i].name==u3)){var v3=q3[i].name;var w3=i3.getParameter(v3);if(!w3){var x3=i3.getSelectOption(v3);w3=x3&&x3[0]&&x3[0].Low;}o3.getParameterizationRequest().setParameterValue(u3,w3);}}}}else{l3="/"+k.name;L.error("SelectionParameters","There are no parameters to resolve");return l3;}}try{l3=o3.getURIToQueryResultEntitySet();}catch(y3){n3=o3.getQueryResult();l3="/"+n3.getEntitySet().getQName();L.error("getEntitySetPathWithParameters","binding path with parameters failed - "+y3||y3.message);}return l3;}function C2(i,j,k,i3,j3){var k3="";if(M.checkAnalyticalParameterisedEntitySet(i,j.name)){k3=B2(i,j,k,i3,j3);}else{var l3=M.getParametersByEntitySet(i,j.name);var m3=M.getPropertyOfEntitySet(i,j.name);var n3={};if(l3){l3['parameters'].forEach(function(o3){m3.forEach(function(p3){if(p3['name']==o3){n3[o3]=p3['type'];}});});l3['parameterType']=n3;k3=A2(l3,i,j,k);}else{k3="/"+j.name;}}return k3;}function D2(j,k,ns){var i3=j.getServiceMetadata().dataServices.schema[0].association;for(var i=0;i<i3.length;i++){if(ns+"."+i3[i].name===k){return i3[i];}}}function E2(i,j){var k=i.filter(function(j3){if(j3.RecordType==="com.sap.vocabularies.UI.v1.DataField"){return true;}return false;});var i3=K(k);if(i3){return i3[j];}return;}function F2(i,j,k){if(!k||!k.length||k.length===0){return false;}k=E2(k,0);return o2(i,j,k);}F2.requiresIContext=true;function G2(i,j,k){if(!k||!k.length||k.length===0){return false;}k=E2(k,1);return o2(i,j,k);}G2.requiresIContext=true;function H2(i,j){var k=i.filter(function(j3){if(j3.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&j3.Target.AnnotationPath.indexOf("@com.sap.vocabularies.Communication.v1.Contact")!==-1){return true;}return false;});var i3=K(k);if(i3){return i3[j];}return;}function I2(i){if(!i||!i.length||i.length===0){return false;}var j=H2(i,0);if(j){return true;}return false;}function J2(i,j,k,i3){var j3,k3,l3;if(k&&k.Value&&k.Value.Path){j3=k.Value.Path;}else if(k&&k.Description&&k.Description.Value&&k.Description.Value.Path){j3=k.Description.Value.Path;}if(k&&k.Description&&k.Description.Path){k3=k.Description.Path;}else if(k&&k.Title&&k.Title.Path){l3=k.Title.Path;}var m3="";var n3=i3&&i3.Parameters;var o3="";var p3=i.getSetting('ovpCardProperties'),q3=p3.getProperty('/parameters');n3=n3||!!q3;if(n3){var r3=i.getSetting("dataModel");var s3=C2(r3,j,i3,q3);m3+="{path: '"+s3+"'";}else{m3+="{path: '/"+j.name+"'";}m3+=", length: 1";var t3=i.getSetting('ovpCardProperties');var u3=t3.getProperty("/entityType");var v3=C.getUnitColumn(j3,u3);var w3=B1(t3,i3);if(w3.length>0){o3+=", filters: "+JSON.stringify(w3);}var x3=[];x3.push(j3);if(k3){x3.push(k3);}else if(l3){x3.push(l3);}if(k&&k.Criticality&&k.Criticality.Path){x3.push(k.Criticality.Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.DeviationRangeLowValue&&k.CriticalityCalculation.DeviationRangeLowValue.Path){x3.push(k.CriticalityCalculation.DeviationRangeLowValue.Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.ToleranceRangeLowValue&&k.CriticalityCalculation.ToleranceRangeLowValue.Path){x3.push(k.CriticalityCalculation.ToleranceRangeLowValue.Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.DeviationRangeHighValue&&k.CriticalityCalculation.DeviationRangeHighValue.Path){x3.push(k.CriticalityCalculation.DeviationRangeHighValue.Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.ToleranceRangeHighValue&&k.CriticalityCalculation.ToleranceRangeHighValue.Path){x3.push(k.CriticalityCalculation.ToleranceRangeHighValue.Path);}if(v3){x3.push(v3);}if(k&&k.TrendCalculation&&k.TrendCalculation.ReferenceValue&&k.TrendCalculation.ReferenceValue.Path){x3.push(k.TrendCalculation.ReferenceValue.Path);}var y3=r1(p3);var z3=y3?", custom: {cardId: '"+p3.getProperty("/cardId")+"'}":"";return m3+", parameters:{select:'"+x3.join(",")+"'"+z3+"}"+o3+"}";}J2.requiresIContext=true;function K2(i){if(!i||!i.Value||!i.Value.Path){return"";}var j=this.getModel('ovpCardProperties');var k=j.getProperty("/entityType");var i3=j.getProperty("/metaModel");var j3=i3.getODataProperty(k,i.Value.Path);if(j3["Org.OData.Measures.V1.Unit"]){var k3=j3["Org.OData.Measures.V1.Unit"];if(k3.String=="%"){this.getModel("ovpCardProperties").oData.percentageAvailable=true;}}if(i&&i.ValueFormat&&i.ValueFormat.NumberOfFractionalDigits&&i.ValueFormat.NumberOfFractionalDigits.Int){this.getModel("ovpCardProperties").oData.NumberOfFractionalDigits=i.ValueFormat.NumberOfFractionalDigits.Int;}var l3={NumberOfFractionalDigits:this.getModel("ovpCardProperties").oData.NumberOfFractionalDigits?this.getModel("ovpCardProperties").oData.NumberOfFractionalDigits:0,percentageAvailable:this.getModel("ovpCardProperties").oData.percentageAvailable?this.getModel("ovpCardProperties").oData.percentageAvailable:false};var m3='sap.ovp.cards.AnnotationHelper.KpiValueFormatter';var n3=[i.Value.Path];return b1(n3,m3,l3);}function L2(){var i=arguments[arguments.length-1],k=arguments[0];var j=N.getFloatInstance({minFractionDigits:i.NumberOfFractionalDigits,maxFractionDigits:i.NumberOfFractionalDigits,style:"short",showScale:true,shortRefNumber:k});if(i.percentageAvailable){return j.format(Number(k))+" %";}else{return j.format(Number(k));}}function M2(i,j){if(!j||!j.Value||!j.Value.Path||!j.TrendCalculation){return"";}var k=F1(j.Value);var i3=F1(j.TrendCalculation.ReferenceValue);var j3=F1(j.TrendCalculation.DownDifference);var k3=F1(j.TrendCalculation.UpDifference);var l3=p1(i3);var m3=p1(j3);var n3=p1(k3);var o3={"referenceValue":i3,"downDifference":j3,"upDifference":k3,"bIsRefValBinding":l3,"bIsDownDiffBinding":m3,"bIsUpDiffBinding":n3};var p3="{value:"+JSON.stringify(o3)+", model: 'ovpCardProperties'}";var q3="parts: ["+k;q3+=l3?","+i3:"";q3+=m3?","+j3:"";q3+=n3?","+k3:"";q3+=","+p3;q3+="]";var r3="sap.ovp.cards.AnnotationHelper.formatTrendIcon";return"{"+q3+", formatter: '"+r3+"'}";}M2.requiresIContext=true;function N2(){var i=arguments[arguments.length-1];var j=1;return x(arguments[0],i.bIsRefValBinding?arguments[j++]:i.referenceValue,i.bIsDownDiffBinding?arguments[j++]:i.downDifference,i.bIsUpDiffBinding?arguments[j++]:i.upDifference);}function O2(i){if(!i||!i.TrendCalculation||!i.TrendCalculation.ReferenceValue){return"";}if(i&&i.ValueFormat&&i.ValueFormat.NumberOfFractionalDigits&&i.ValueFormat.NumberOfFractionalDigits.Int){this.getModel("ovpCardProperties").oData.NumberOfFractionalDigits=i.ValueFormat.NumberOfFractionalDigits.Int;}if(i.TrendCalculation.ReferenceValue.Path){return"{parts: [{path:'"+i.Value.Path+"'}, {path:'"+i.TrendCalculation.ReferenceValue.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.returnPercentageChange'}";}else{return"{parts: [{path:'"+i.Value.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.returnPercentageChange'}";}}function P2(k,i){var j,i3,j3,k3,l3=false;if(isNaN(+k)){return"";}if(k==0){k3=i;}else{k3=k;}i3=this.getModel('ovpCardProperties');if(i3.getProperty("/iNumberOfFractionalDigits")){j3=+(i3.getProperty("/iNumberOfFractionalDigits"));}if(i3.getProperty("/bPercentageAvailableForTarget")){l3=true;}if(i){j=i;}else{if(i3.getProperty("/sManifestTargetValue")){j=i3.getProperty("/sManifestTargetValue");}}if(!j3||j3<0){j3=0;}else if(j3>2){j3=2;}if(j){var m3=N.getFloatInstance({minFractionDigits:j3,maxFractionDigits:j3,style:"short",showScale:true,shortRefNumber:k3});if(l3){return m3.format(+(j))+" %";}else{return m3.format(+(j));}}}function Q2(i){if(!i||!i.TrendCalculation||!i.TrendCalculation.ReferenceValue){return"";}if(!i||!i.Value||!i.Value.Path){return"";}var j=this.getModel('ovpCardProperties');var k=j.getProperty("/entityType");var i3=j.getProperty("/metaModel");if(i&&i.ValueFormat&&i.ValueFormat.NumberOfFractionalDigits&&i.ValueFormat.NumberOfFractionalDigits.Int){j.setProperty("/iNumberOfFractionalDigits",i.ValueFormat.NumberOfFractionalDigits.Int);}if(i.TrendCalculation.ReferenceValue){if(i.TrendCalculation.ReferenceValue.String){j.setProperty("/sManifestTargetValue",i.TrendCalculation.ReferenceValue.String);return"{parts: [{path:'"+i.Value.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.TargetValueFormatter'}";}if(i.TrendCalculation.ReferenceValue.Path){var j3=i3.getODataProperty(k,i.TrendCalculation.ReferenceValue.Path);if(j3["Org.OData.Measures.V1.Unit"]){var k3=j3["Org.OData.Measures.V1.Unit"];if(k3.String=="%"){j.setProperty("/bPercentageAvailableForTarget",true);}}return"{parts: [{path:'"+i.Value.Path+"'},{path:'"+i.TrendCalculation.ReferenceValue.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.TargetValueFormatter'}";}}}function R2(k,i){var j,i3,j3;if(isNaN(+k)){return"";}k=+(k);j3=this.getModel('ovpCardProperties');if(j3.getProperty("/iNumberOfFractionalDigits")){j=+(j3.getProperty("/iNumberOfFractionalDigits"));}if(i){i3=+(i);}else{if(j3.getProperty("/sManifestTargetValue")){i3=+(j3.getProperty("/sManifestTargetValue"));}}if(!j||j<0){j=0;}else if(j>2){j=2;}if(i3){var k3=((k-i3)/i3);var l3=N.getPercentInstance({style:'short',minFractionDigits:j,maxFractionDigits:j,showScale:true});return l3.format(k3);}}function S2(i){if(i&&i.GroupBy&&!(h(i.GroupBy))&&i.GroupBy[0].hasOwnProperty('PropertyPath')){return true;}else{return false;}}function T2(j,k){var i3;for(var i=0;j&&i<j.length;i++){if(j[i].value==k){i3=j[i];break;}}return i3?i3.name:null;}function U2(i,k){return T2(i,k);}function V2(i,k){var j=T2(i,k);return j?j:b.getText("OVP_KEYUSER_LABEL_NO_NAVIGATION");}function W2(i){var j="";var k=i&&i.GroupBy;if(!k){return j;}var i3=this.getModel('ovpCardProperties').getProperty("/metaModel");var j3=this.getModel('ovpCardProperties').getProperty("/entityType");var k3;if(i.GroupBy.constructor===Array){k3=i.GroupBy;}else if(!i.GroupBy.Collection){return j;}else{k3=i.GroupBy.Collection;}var l3;e(k3,function(){l3=b3(i3,j3,this.PropertyPath);if(!l3){return;}j+=l3;j+=", ";});if(j[j.length-1]===" "&&j[j.length-2]===","){j=j.substring(0,j.length-2);}return j==""?"":b.getText("By",[j]);}function X2(i,j,k){var i3=true;var j3=k["SelectOptions"].length-1;if(j.PropertyName.PropertyPath===k["SelectOptions"][j3].PropertyName.PropertyPath){i3=false;}j=[j];var k3=i.getSetting('ovpCardProperties');var l3=k3.getProperty("/entityType");var m3=k3.getProperty("/metaModel");var n3=B1(k3,j);if(n3.length==0){return"";}var o3;var p3;o3=n3[0].path;p3=c3(m3,l3,o3);if(p3!==o3){return"";}var q3=m3.getODataProperty(l3,j[0].PropertyName.PropertyPath)["type"];var r3=_2(n3,q3);if(i3===true){return r3+", ";}return r3;}X2.requiresIContext=true;function Y2(i,j,k){var i3=!(j.index===(k.length-1));var j3=i.getSetting('ovpCardProperties');var k3=j3.getProperty("/metaModel");var l3=j3.getProperty("/entityType");var m3=k3.getODataProperty(l3,k[j.index].path)["type"];var n3=_2([k[j.index]],m3);if(i3===true){return n3+", ";}return n3;}Y2.requiresIContext=true;function Z2(i){return i.id;}function $2(i){return i.id;}function _2(j,k){var i3=[];for(var i=0;i<j.length;i++){i3.push(a3(j[i],k));}return i3.join(', ');}function a3(i,j){var k=false;var i3,j3=D.getInstance({'style':'medium'});if(j==='Edm.DateTime'){i3=j3.format(new Date(i.value1));}else if(j==='Edm.DateTimeOffset'){i3=j3.format(new Date(i.value1),true);}else{i3=i.value1;}if(i.operator[0]==="N"){k=true;}if(i.value2){if(j==='Edm.DateTime'){i3+=" - "+j3.format(new Date(i.value1));}else if(j==='Edm.DateTimeOffset'){i3+=" - "+j3.format(new Date(i.value1),true);}else{i3+=" - "+i.value1;}}if(k){i3=b.getText("kpiHeader_Filter_NotOperator",[i3]);}return i3;}function b3(i,j,k){return d3(i,j,k,"com.sap.vocabularies.Common.v1.Label");}function c3(i,j,k){return d3(i,j,k,"sap:text");}function d3(i,j,k,i3){var j3=i.getODataProperty(j,k);if(!j3){L.error("No Property Found for with Name '"+k+" For Entity-Type '"+j.name+"'");return;}var k3=j3[i3];if(k3){if(i3==="com.sap.vocabularies.Common.v1.Label"){return k3.String;}return k3;}return j3.name;}function e3(i){if(!i||!i.Value||!i.Value.Path){return"";}var j={NumberOfFractionalDigits:this.getModel("ovpCardProperties").oData.NumberOfFractionalDigits?this.getModel("ovpCardProperties").oData.NumberOfFractionalDigits:0,percentageAvailable:this.getModel("ovpCardProperties").oData.percentageAvailable?this.getModel("ovpCardProperties").oData.percentageAvailable:false};var k='sap.ovp.cards.AnnotationHelper.KpiValueFormatter';var i3=[i.Value.Path];return b1(i3,k,j);}function f3(i,j){if(j.hasOwnProperty(i)){return true;}return false;}function g3(i,j){var k;if(j[i].customDateRangeImplementation){return j[i].customDateRangeImplementation;}else if(j[i].filter){k={module:'sap.ui.comp.config.condition.DateRangeType',operations:{filter:j[i].filter}};return JSON.stringify(k);}else{k={module:'sap.ui.comp.config.condition.DateRangeType',operations:{filter:[{path:'key',contains:j[i].selectedValues,exclude:j[i].exclude}]}};return JSON.stringify(k);}}function h3(i){if(i){return undefined;}return"_BASIC";}return{getGroupID:h3,getConditionTypeForDateProperties:g3,isDateRangeType:f3,criticalityConstants:l,TextArrangementType:T,getLabelForDataItem:p,colorPaletteForComparisonMicroChart:i1,formatField:Z,checkFilterPreference:r1,formatItems:s1,getCardSelections:y1,getCardSorters:z1,getFilters:B1,getPrimitiveValue:E1,getAnnotationLabel:U2,getApplicationName:V2,removeDuplicateDataField:H1,formatUrl:I1,getDataPointsCount:J1,getFirstDataPointValue:K1,getFirstDataFieldName:N1,getSecondDataFieldName:O1,getRequestFields:x1,getThirdDataFieldName:P1,formatDataFieldValueOnIndex:S1,formatDataPointValueOnIndex:T1,formatDataPointOrField:U1,formatsemanticObjectOfDataFieldGeneric:V1,getLabelForFirstDataPoint:Z1,formatImageUrl:$1,formatUnit:_1,formatObjectNumber:a2,formatFirstDataPointState:b2,formatFirstDataPointColor:c2,formatSecondDataPointState:d2,formatThirdDataPointState:e2,formatFirstDataPointStateForSmartField:f2,formatKPIHeaderState:h2,isFirstDataPointCriticality:i2,isFirstDataPointCriticalityForTableStatus:j2,getSortedDataFields:y,getSortedDataPoints:z,formatDataFieldValueGeneric:n2,formatDataPointValue:r2,formatDataPointStateGeneric:s2,checkCriticalityGeneric:t2,checkCriticalityGenericForTableStatus:u2,formatDataPointStateForSmartFieldGeneric:v2,hasActions:w2,isFirstDataPointPercentageUnit:x2,resolveEntityTypePath:y2,resolveParameterizedEntitySet:C2,getAssociationObject:D2,semanticObjectOfFirstDataField:F2,semanticObjectOfSecondDataField:G2,isFirstContactAnnotation:I2,getAggregateNumber:J2,KpiValueFormatter:L2,kpiValueCriticality:g2,formThePathForAggregateNumber:K2,formThePathForTrendIcon:M2,formPathForPercentageChange:O2,TargetValueFormatter:P2,formPathForTargetValue:Q2,returnPercentageChange:R2,isPresentationVarientPresent:S2,listGroupBy:W2,formTheFilterByString:X2,formTheFilterByStringNotFromSelVar:Y2,formTheIdForFilter:Z2,formTheIdForFilterNotFromSelVar:$2,_criticality2state:t,_calculateCriticalityState:w,_calculateTrendDirection:x,_getPropertiesFromBindingString:v1,sortCollectionByImportance:K,checkNavTargetForContactAnno:p2,checkForContactAnnotation:q2,getKPIHeaderAggregateNumber:e3,formatColor:o1,formatTrendIcon:N2,formatNumberCalculation:c1,formatCurrency:e1,formatDate:d1};},true);
