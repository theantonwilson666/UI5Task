sap.ui.define(["sap/base/util/isEmptyObject","sap/ui/model/odata/v2/ODataModel","sap/ui/model/odata/ODataMetadata","sap/ui/model/Filter","sap/ovp/cards/v4/V4AnnotationHelper"],function(a,O,b,F,V){"use strict";function g(c){var d;if(c){if(c.settings.tabs){var i=0;var s=c.settings.selectedKey;if(s&&c.settings.tabs.length>=s){i=s-1;}d=c.settings.tabs[i]['selectionAnnotationPath'];}else{d=c.settings['selectionAnnotationPath'];}}return d;}return{_getEntityRelevantFilters:function(e,f){var r=[];if(f.length>0&&e){var R=this._checkRelevantFiltersRecursive(e,f[0]);if(R){r.push(R);}}return r;},_checkRelevantFiltersRecursive:function(e,f){if(!f._bMultiFilter){f.sPath=f.sPath.split('/').pop();var m=this._getPropertyMapping(e,f.sPath);if(m){f.sPath=m;return f;}}else{var d=f.aFilters;var s,S=[];if(d){for(var i=0;i<d.length;i++){s=this._checkRelevantFiltersRecursive(e,d[i]);if(s){S.push(s);}}if(S.length>0){return(new F(S,f.bAnd));}}}},_getPropertyMapping:function(e,t){if(t in e){return t;}},mergeFilters:function(e,s){if(s&&s.length===0&&s&&e.length===0){return[];}var f=[];if(s&&s.length>0){var t=[];var p={};s.forEach(function(c){if(p[c.path]){p[c.path].push(new F(c));}else{p[c.path]=[new F(c)];}});Object.keys(p).forEach(function(c){t.push(new F({filters:p[c],and:false}));});f.push(new F({filters:t,and:true}));}if(!a(e[0])){f.push(e[0]);}return new F({filters:f,and:true});},getSelectionVariantFilters:function(c,o,e){var p=o.getData(),d=c.filter(function(f){return(f.id===p.cardId);})[0],s="@"+g(d),S=e[s];return S?V.getFilters(o,S):[];},formatLiteral:function(v,t){var r=/'/g;if(v===undefined){throw new Error("Illegal value: undefined");}if(v===null){return"null";}switch(t){case"Edm.Binary":return"binary'"+v+"'";case"Edm.Boolean":case"Edm.Byte":case"Edm.Double":case"Edm.Int16":case"Edm.Int32":case"Edm.SByte":case"Edm.Single":return String(v);case"Edm.Date":case"Edm.DateTimeOffset":case"Edm.Decimal":case"Edm.Guid":case"Edm.Int64":case"Edm.TimeOfDay":return v;case"Edm.Duration":return"duration'"+v+"'";case"Edm.String":return"'"+v.replace(r,"''")+"'";default:throw new Error("Unsupported type: "+t);}}};},true);
